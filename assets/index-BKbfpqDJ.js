var MX=Object.defineProperty;var zX=(t,e,n)=>e in t?MX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Uf=(t,e,n)=>zX(t,typeof e!="symbol"?e+"":e,n);function TM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Sa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function aN(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var NM={exports:{}},Jx={},IM={exports:{}},at={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Om=Symbol.for("react.element"),BX=Symbol.for("react.portal"),jX=Symbol.for("react.fragment"),VX=Symbol.for("react.strict_mode"),WX=Symbol.for("react.profiler"),UX=Symbol.for("react.provider"),GX=Symbol.for("react.context"),HX=Symbol.for("react.forward_ref"),KX=Symbol.for("react.suspense"),qX=Symbol.for("react.memo"),XX=Symbol.for("react.lazy"),UO=Symbol.iterator;function ZX(t){return t===null||typeof t!="object"?null:(t=UO&&t[UO]||t["@@iterator"],typeof t=="function"?t:null)}var $M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},EM=Object.assign,AM={};function ah(t,e,n){this.props=t,this.context=e,this.refs=AM,this.updater=n||$M}ah.prototype.isReactComponent={};ah.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ah.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function OM(){}OM.prototype=ah.prototype;function lN(t,e,n){this.props=t,this.context=e,this.refs=AM,this.updater=n||$M}var uN=lN.prototype=new OM;uN.constructor=lN;EM(uN,ah.prototype);uN.isPureReactComponent=!0;var GO=Array.isArray,PM=Object.prototype.hasOwnProperty,cN={current:null},DM={key:!0,ref:!0,__self:!0,__source:!0};function RM(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)PM.call(e,r)&&!DM.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Om,type:t,key:i,ref:o,props:s,_owner:cN.current}}function YX(t,e){return{$$typeof:Om,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function dN(t){return typeof t=="object"&&t!==null&&t.$$typeof===Om}function QX(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var HO=/\/+/g;function iS(t,e){return typeof t=="object"&&t!==null&&t.key!=null?QX(""+t.key):e.toString(36)}function Zv(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Om:case BX:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+iS(o,0):r,GO(s)?(n="",t!=null&&(n=t.replace(HO,"$&/")+"/"),Zv(s,e,n,"",function(u){return u})):s!=null&&(dN(s)&&(s=YX(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(HO,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",GO(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+iS(i,a);o+=Zv(i,e,n,l,s)}else if(l=ZX(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+iS(i,a++),o+=Zv(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function rv(t,e,n){if(t==null)return t;var r=[],s=0;return Zv(t,r,"","",function(i){return e.call(n,i,s++)}),r}function JX(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Gr={current:null},Yv={transition:null},e7={ReactCurrentDispatcher:Gr,ReactCurrentBatchConfig:Yv,ReactCurrentOwner:cN};function LM(){throw Error("act(...) is not supported in production builds of React.")}at.Children={map:rv,forEach:function(t,e,n){rv(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return rv(t,function(){e++}),e},toArray:function(t){return rv(t,function(e){return e})||[]},only:function(t){if(!dN(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};at.Component=ah;at.Fragment=jX;at.Profiler=WX;at.PureComponent=lN;at.StrictMode=VX;at.Suspense=KX;at.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e7;at.act=LM;at.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=EM({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=cN.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)PM.call(e,l)&&!DM.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Om,type:t.type,key:s,ref:i,props:r,_owner:o}};at.createContext=function(t){return t={$$typeof:GX,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:UX,_context:t},t.Consumer=t};at.createElement=RM;at.createFactory=function(t){var e=RM.bind(null,t);return e.type=t,e};at.createRef=function(){return{current:null}};at.forwardRef=function(t){return{$$typeof:HX,render:t}};at.isValidElement=dN;at.lazy=function(t){return{$$typeof:XX,_payload:{_status:-1,_result:t},_init:JX}};at.memo=function(t,e){return{$$typeof:qX,type:t,compare:e===void 0?null:e}};at.startTransition=function(t){var e=Yv.transition;Yv.transition={};try{t()}finally{Yv.transition=e}};at.unstable_act=LM;at.useCallback=function(t,e){return Gr.current.useCallback(t,e)};at.useContext=function(t){return Gr.current.useContext(t)};at.useDebugValue=function(){};at.useDeferredValue=function(t){return Gr.current.useDeferredValue(t)};at.useEffect=function(t,e){return Gr.current.useEffect(t,e)};at.useId=function(){return Gr.current.useId()};at.useImperativeHandle=function(t,e,n){return Gr.current.useImperativeHandle(t,e,n)};at.useInsertionEffect=function(t,e){return Gr.current.useInsertionEffect(t,e)};at.useLayoutEffect=function(t,e){return Gr.current.useLayoutEffect(t,e)};at.useMemo=function(t,e){return Gr.current.useMemo(t,e)};at.useReducer=function(t,e,n){return Gr.current.useReducer(t,e,n)};at.useRef=function(t){return Gr.current.useRef(t)};at.useState=function(t){return Gr.current.useState(t)};at.useSyncExternalStore=function(t,e,n){return Gr.current.useSyncExternalStore(t,e,n)};at.useTransition=function(){return Gr.current.useTransition()};at.version="18.3.1";IM.exports=at;var E=IM.exports;const Rp=wi(E),t7=TM({__proto__:null,default:Rp},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n7=E,r7=Symbol.for("react.element"),s7=Symbol.for("react.fragment"),i7=Object.prototype.hasOwnProperty,o7=n7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a7={key:!0,ref:!0,__self:!0,__source:!0};function FM(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)i7.call(e,r)&&!a7.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:r7,type:t,key:i,ref:o,props:s,_owner:o7.current}}Jx.Fragment=s7;Jx.jsx=FM;Jx.jsxs=FM;NM.exports=Jx;var z=NM.exports,MM={exports:{}},Ms={},zM={exports:{}},BM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,J){var Y=B.length;B.push(J);e:for(;0<Y;){var ie=Y-1>>>1,ne=B[ie];if(0<s(ne,J))B[ie]=J,B[Y]=ne,Y=ie;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var J=B[0],Y=B.pop();if(Y!==J){B[0]=Y;e:for(var ie=0,ne=B.length,pe=ne>>>1;ie<pe;){var me=2*(ie+1)-1,de=B[me],fe=me+1,ke=B[fe];if(0>s(de,Y))fe<ne&&0>s(ke,de)?(B[ie]=ke,B[fe]=Y,ie=fe):(B[ie]=de,B[me]=Y,ie=me);else if(fe<ne&&0>s(ke,Y))B[ie]=ke,B[fe]=Y,ie=fe;else break e}}return J}function s(B,J){var Y=B.sortIndex-J.sortIndex;return Y!==0?Y:B.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,d=null,f=3,p=!1,m=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(B){for(var J=n(u);J!==null;){if(J.callback===null)r(u);else if(J.startTime<=B)r(u),J.sortIndex=J.expirationTime,e(l,J);else break;J=n(u)}}function S(B){if(y=!1,_(B),!m)if(n(l)!==null)m=!0,Z(k);else{var J=n(u);J!==null&&se(S,J.startTime-B)}}function k(B,J){m=!1,y&&(y=!1,x(A),A=-1),p=!0;var Y=f;try{for(_(J),d=n(l);d!==null&&(!(d.expirationTime>J)||B&&!M());){var ie=d.callback;if(typeof ie=="function"){d.callback=null,f=d.priorityLevel;var ne=ie(d.expirationTime<=J);J=t.unstable_now(),typeof ne=="function"?d.callback=ne:d===n(l)&&r(l),_(J)}else r(l);d=n(l)}if(d!==null)var pe=!0;else{var me=n(u);me!==null&&se(S,me.startTime-J),pe=!1}return pe}finally{d=null,f=Y,p=!1}}var T=!1,$=null,A=-1,D=5,F=-1;function M(){return!(t.unstable_now()-F<D)}function j(){if($!==null){var B=t.unstable_now();F=B;var J=!0;try{J=$(!0,B)}finally{J?H():(T=!1,$=null)}}else T=!1}var H;if(typeof b=="function")H=function(){b(j)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Q=K.port2;K.port1.onmessage=j,H=function(){Q.postMessage(null)}}else H=function(){v(j,0)};function Z(B){$=B,T||(T=!0,H())}function se(B,J){A=v(function(){B(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,Z(k))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(B){switch(f){case 1:case 2:case 3:var J=3;break;default:J=f}var Y=f;f=J;try{return B()}finally{f=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,J){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Y=f;f=B;try{return J()}finally{f=Y}},t.unstable_scheduleCallback=function(B,J,Y){var ie=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ie+Y:ie):Y=ie,B){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=Y+ne,B={id:c++,callback:J,priorityLevel:B,startTime:Y,expirationTime:ne,sortIndex:-1},Y>ie?(B.sortIndex=Y,e(u,B),n(l)===null&&B===n(u)&&(y?(x(A),A=-1):y=!0,se(S,Y-ie))):(B.sortIndex=ne,e(l,B),m||p||(m=!0,Z(k))),B},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(B){var J=f;return function(){var Y=f;f=J;try{return B.apply(this,arguments)}finally{f=Y}}}})(BM);zM.exports=BM;var l7=zM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u7=E,Os=l7;function we(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jM=new Set,Lp={};function mc(t,e){$d(t,e),$d(t+"Capture",e)}function $d(t,e){for(Lp[t]=e,t=0;t<e.length;t++)jM.add(e[t])}var ca=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_k=Object.prototype.hasOwnProperty,c7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,KO={},qO={};function d7(t){return _k.call(qO,t)?!0:_k.call(KO,t)?!1:c7.test(t)?qO[t]=!0:(KO[t]=!0,!1)}function h7(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function f7(t,e,n,r){if(e===null||typeof e>"u"||h7(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Hr(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var hr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){hr[t]=new Hr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];hr[e]=new Hr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){hr[t]=new Hr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){hr[t]=new Hr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){hr[t]=new Hr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){hr[t]=new Hr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){hr[t]=new Hr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){hr[t]=new Hr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){hr[t]=new Hr(t,5,!1,t.toLowerCase(),null,!1,!1)});var hN=/[\-:]([a-z])/g;function fN(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(hN,fN);hr[e]=new Hr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(hN,fN);hr[e]=new Hr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(hN,fN);hr[e]=new Hr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){hr[t]=new Hr(t,1,!1,t.toLowerCase(),null,!1,!1)});hr.xlinkHref=new Hr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){hr[t]=new Hr(t,1,!1,t.toLowerCase(),null,!0,!0)});function pN(t,e,n,r){var s=hr.hasOwnProperty(e)?hr[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(f7(e,n,s,r)&&(n=null),r||s===null?d7(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ka=u7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sv=Symbol.for("react.element"),ed=Symbol.for("react.portal"),td=Symbol.for("react.fragment"),mN=Symbol.for("react.strict_mode"),Sk=Symbol.for("react.profiler"),VM=Symbol.for("react.provider"),WM=Symbol.for("react.context"),gN=Symbol.for("react.forward_ref"),kk=Symbol.for("react.suspense"),Ck=Symbol.for("react.suspense_list"),yN=Symbol.for("react.memo"),Ua=Symbol.for("react.lazy"),UM=Symbol.for("react.offscreen"),XO=Symbol.iterator;function Gf(t){return t===null||typeof t!="object"?null:(t=XO&&t[XO]||t["@@iterator"],typeof t=="function"?t:null)}var en=Object.assign,oS;function dp(t){if(oS===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);oS=e&&e[1]||""}return`
`+oS+t}var aS=!1;function lS(t,e){if(!t||aS)return"";aS=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{aS=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?dp(t):""}function p7(t){switch(t.tag){case 5:return dp(t.type);case 16:return dp("Lazy");case 13:return dp("Suspense");case 19:return dp("SuspenseList");case 0:case 2:case 15:return t=lS(t.type,!1),t;case 11:return t=lS(t.type.render,!1),t;case 1:return t=lS(t.type,!0),t;default:return""}}function Tk(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case td:return"Fragment";case ed:return"Portal";case Sk:return"Profiler";case mN:return"StrictMode";case kk:return"Suspense";case Ck:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case WM:return(t.displayName||"Context")+".Consumer";case VM:return(t._context.displayName||"Context")+".Provider";case gN:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case yN:return e=t.displayName||null,e!==null?e:Tk(t.type)||"Memo";case Ua:e=t._payload,t=t._init;try{return Tk(t(e))}catch{}}return null}function m7(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tk(e);case 8:return e===mN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ml(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function GM(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function g7(t){var e=GM(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function iv(t){t._valueTracker||(t._valueTracker=g7(t))}function HM(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=GM(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function f0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Nk(t,e){var n=e.checked;return en({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ZO(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ml(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function KM(t,e){e=e.checked,e!=null&&pN(t,"checked",e,!1)}function Ik(t,e){KM(t,e);var n=ml(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$k(t,e.type,n):e.hasOwnProperty("defaultValue")&&$k(t,e.type,ml(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function YO(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function $k(t,e,n){(e!=="number"||f0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var hp=Array.isArray;function gd(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ml(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Ek(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(we(91));return en({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function QO(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(we(92));if(hp(n)){if(1<n.length)throw Error(we(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ml(n)}}function qM(t,e){var n=ml(e.value),r=ml(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function JO(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function XM(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ak(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?XM(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ov,ZM=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ov=ov||document.createElement("div"),ov.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ov.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Sp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},y7=["Webkit","ms","Moz","O"];Object.keys(Sp).forEach(function(t){y7.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Sp[e]=Sp[t]})});function YM(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Sp.hasOwnProperty(t)&&Sp[t]?(""+e).trim():e+"px"}function QM(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=YM(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var v7=en({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ok(t,e){if(e){if(v7[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(we(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(we(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(we(61))}if(e.style!=null&&typeof e.style!="object")throw Error(we(62))}}function Pk(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dk=null;function vN(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Rk=null,yd=null,vd=null;function eP(t){if(t=Rm(t)){if(typeof Rk!="function")throw Error(we(280));var e=t.stateNode;e&&(e=sb(e),Rk(t.stateNode,t.type,e))}}function JM(t){yd?vd?vd.push(t):vd=[t]:yd=t}function e3(){if(yd){var t=yd,e=vd;if(vd=yd=null,eP(t),e)for(t=0;t<e.length;t++)eP(e[t])}}function t3(t,e){return t(e)}function n3(){}var uS=!1;function r3(t,e,n){if(uS)return t(e,n);uS=!0;try{return t3(t,e,n)}finally{uS=!1,(yd!==null||vd!==null)&&(n3(),e3())}}function Mp(t,e){var n=t.stateNode;if(n===null)return null;var r=sb(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(we(231,e,typeof n));return n}var Lk=!1;if(ca)try{var Hf={};Object.defineProperty(Hf,"passive",{get:function(){Lk=!0}}),window.addEventListener("test",Hf,Hf),window.removeEventListener("test",Hf,Hf)}catch{Lk=!1}function x7(t,e,n,r,s,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var kp=!1,p0=null,m0=!1,Fk=null,b7={onError:function(t){kp=!0,p0=t}};function w7(t,e,n,r,s,i,o,a,l){kp=!1,p0=null,x7.apply(b7,arguments)}function _7(t,e,n,r,s,i,o,a,l){if(w7.apply(this,arguments),kp){if(kp){var u=p0;kp=!1,p0=null}else throw Error(we(198));m0||(m0=!0,Fk=u)}}function gc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function s3(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function tP(t){if(gc(t)!==t)throw Error(we(188))}function S7(t){var e=t.alternate;if(!e){if(e=gc(t),e===null)throw Error(we(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return tP(s),t;if(i===r)return tP(s),e;i=i.sibling}throw Error(we(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(we(189))}}if(n.alternate!==r)throw Error(we(190))}if(n.tag!==3)throw Error(we(188));return n.stateNode.current===n?t:e}function i3(t){return t=S7(t),t!==null?o3(t):null}function o3(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=o3(t);if(e!==null)return e;t=t.sibling}return null}var a3=Os.unstable_scheduleCallback,nP=Os.unstable_cancelCallback,k7=Os.unstable_shouldYield,C7=Os.unstable_requestPaint,hn=Os.unstable_now,T7=Os.unstable_getCurrentPriorityLevel,xN=Os.unstable_ImmediatePriority,l3=Os.unstable_UserBlockingPriority,g0=Os.unstable_NormalPriority,N7=Os.unstable_LowPriority,u3=Os.unstable_IdlePriority,eb=null,So=null;function I7(t){if(So&&typeof So.onCommitFiberRoot=="function")try{So.onCommitFiberRoot(eb,t,void 0,(t.current.flags&128)===128)}catch{}}var Hi=Math.clz32?Math.clz32:A7,$7=Math.log,E7=Math.LN2;function A7(t){return t>>>=0,t===0?32:31-($7(t)/E7|0)|0}var av=64,lv=4194304;function fp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function y0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=fp(a):(i&=o,i!==0&&(r=fp(i)))}else o=n&~s,o!==0?r=fp(o):i!==0&&(r=fp(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Hi(e),s=1<<n,r|=t[n],e&=~s;return r}function O7(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P7(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Hi(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=O7(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Mk(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function c3(){var t=av;return av<<=1,!(av&4194240)&&(av=64),t}function cS(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Pm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Hi(e),t[e]=n}function D7(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Hi(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function bN(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Hi(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var St=0;function d3(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var h3,wN,f3,p3,m3,zk=!1,uv=[],nl=null,rl=null,sl=null,zp=new Map,Bp=new Map,qa=[],R7="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rP(t,e){switch(t){case"focusin":case"focusout":nl=null;break;case"dragenter":case"dragleave":rl=null;break;case"mouseover":case"mouseout":sl=null;break;case"pointerover":case"pointerout":zp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bp.delete(e.pointerId)}}function Kf(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Rm(e),e!==null&&wN(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function L7(t,e,n,r,s){switch(e){case"focusin":return nl=Kf(nl,t,e,n,r,s),!0;case"dragenter":return rl=Kf(rl,t,e,n,r,s),!0;case"mouseover":return sl=Kf(sl,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return zp.set(i,Kf(zp.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Bp.set(i,Kf(Bp.get(i)||null,t,e,n,r,s)),!0}return!1}function g3(t){var e=wu(t.target);if(e!==null){var n=gc(e);if(n!==null){if(e=n.tag,e===13){if(e=s3(n),e!==null){t.blockedOn=e,m3(t.priority,function(){f3(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Qv(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Bk(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Dk=r,n.target.dispatchEvent(r),Dk=null}else return e=Rm(n),e!==null&&wN(e),t.blockedOn=n,!1;e.shift()}return!0}function sP(t,e,n){Qv(t)&&n.delete(e)}function F7(){zk=!1,nl!==null&&Qv(nl)&&(nl=null),rl!==null&&Qv(rl)&&(rl=null),sl!==null&&Qv(sl)&&(sl=null),zp.forEach(sP),Bp.forEach(sP)}function qf(t,e){t.blockedOn===e&&(t.blockedOn=null,zk||(zk=!0,Os.unstable_scheduleCallback(Os.unstable_NormalPriority,F7)))}function jp(t){function e(s){return qf(s,t)}if(0<uv.length){qf(uv[0],t);for(var n=1;n<uv.length;n++){var r=uv[n];r.blockedOn===t&&(r.blockedOn=null)}}for(nl!==null&&qf(nl,t),rl!==null&&qf(rl,t),sl!==null&&qf(sl,t),zp.forEach(e),Bp.forEach(e),n=0;n<qa.length;n++)r=qa[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<qa.length&&(n=qa[0],n.blockedOn===null);)g3(n),n.blockedOn===null&&qa.shift()}var xd=ka.ReactCurrentBatchConfig,v0=!0;function M7(t,e,n,r){var s=St,i=xd.transition;xd.transition=null;try{St=1,_N(t,e,n,r)}finally{St=s,xd.transition=i}}function z7(t,e,n,r){var s=St,i=xd.transition;xd.transition=null;try{St=4,_N(t,e,n,r)}finally{St=s,xd.transition=i}}function _N(t,e,n,r){if(v0){var s=Bk(t,e,n,r);if(s===null)bS(t,e,r,x0,n),rP(t,r);else if(L7(s,t,e,n,r))r.stopPropagation();else if(rP(t,r),e&4&&-1<R7.indexOf(t)){for(;s!==null;){var i=Rm(s);if(i!==null&&h3(i),i=Bk(t,e,n,r),i===null&&bS(t,e,r,x0,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else bS(t,e,r,null,n)}}var x0=null;function Bk(t,e,n,r){if(x0=null,t=vN(r),t=wu(t),t!==null)if(e=gc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=s3(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return x0=t,null}function y3(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(T7()){case xN:return 1;case l3:return 4;case g0:case N7:return 16;case u3:return 536870912;default:return 16}default:return 16}}var Ya=null,SN=null,Jv=null;function v3(){if(Jv)return Jv;var t,e=SN,n=e.length,r,s="value"in Ya?Ya.value:Ya.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Jv=s.slice(t,1<r?1-r:void 0)}function e0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function cv(){return!0}function iP(){return!1}function zs(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?cv:iP,this.isPropagationStopped=iP,this}return en(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=cv)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=cv)},persist:function(){},isPersistent:cv}),e}var lh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kN=zs(lh),Dm=en({},lh,{view:0,detail:0}),B7=zs(Dm),dS,hS,Xf,tb=en({},Dm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:CN,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xf&&(Xf&&t.type==="mousemove"?(dS=t.screenX-Xf.screenX,hS=t.screenY-Xf.screenY):hS=dS=0,Xf=t),dS)},movementY:function(t){return"movementY"in t?t.movementY:hS}}),oP=zs(tb),j7=en({},tb,{dataTransfer:0}),V7=zs(j7),W7=en({},Dm,{relatedTarget:0}),fS=zs(W7),U7=en({},lh,{animationName:0,elapsedTime:0,pseudoElement:0}),G7=zs(U7),H7=en({},lh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),K7=zs(H7),q7=en({},lh,{data:0}),aP=zs(q7),X7={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z7={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Y7={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Q7(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Y7[t])?!!e[t]:!1}function CN(){return Q7}var J7=en({},Dm,{key:function(t){if(t.key){var e=X7[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=e0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Z7[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:CN,charCode:function(t){return t.type==="keypress"?e0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?e0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),eZ=zs(J7),tZ=en({},tb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lP=zs(tZ),nZ=en({},Dm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:CN}),rZ=zs(nZ),sZ=en({},lh,{propertyName:0,elapsedTime:0,pseudoElement:0}),iZ=zs(sZ),oZ=en({},tb,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),aZ=zs(oZ),lZ=[9,13,27,32],TN=ca&&"CompositionEvent"in window,Cp=null;ca&&"documentMode"in document&&(Cp=document.documentMode);var uZ=ca&&"TextEvent"in window&&!Cp,x3=ca&&(!TN||Cp&&8<Cp&&11>=Cp),uP=" ",cP=!1;function b3(t,e){switch(t){case"keyup":return lZ.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function w3(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var nd=!1;function cZ(t,e){switch(t){case"compositionend":return w3(e);case"keypress":return e.which!==32?null:(cP=!0,uP);case"textInput":return t=e.data,t===uP&&cP?null:t;default:return null}}function dZ(t,e){if(nd)return t==="compositionend"||!TN&&b3(t,e)?(t=v3(),Jv=SN=Ya=null,nd=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return x3&&e.locale!=="ko"?null:e.data;default:return null}}var hZ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dP(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!hZ[t.type]:e==="textarea"}function _3(t,e,n,r){JM(r),e=b0(e,"onChange"),0<e.length&&(n=new kN("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Tp=null,Vp=null;function fZ(t){P3(t,0)}function nb(t){var e=id(t);if(HM(e))return t}function pZ(t,e){if(t==="change")return e}var S3=!1;if(ca){var pS;if(ca){var mS="oninput"in document;if(!mS){var hP=document.createElement("div");hP.setAttribute("oninput","return;"),mS=typeof hP.oninput=="function"}pS=mS}else pS=!1;S3=pS&&(!document.documentMode||9<document.documentMode)}function fP(){Tp&&(Tp.detachEvent("onpropertychange",k3),Vp=Tp=null)}function k3(t){if(t.propertyName==="value"&&nb(Vp)){var e=[];_3(e,Vp,t,vN(t)),r3(fZ,e)}}function mZ(t,e,n){t==="focusin"?(fP(),Tp=e,Vp=n,Tp.attachEvent("onpropertychange",k3)):t==="focusout"&&fP()}function gZ(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return nb(Vp)}function yZ(t,e){if(t==="click")return nb(e)}function vZ(t,e){if(t==="input"||t==="change")return nb(e)}function xZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Yi=typeof Object.is=="function"?Object.is:xZ;function Wp(t,e){if(Yi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!_k.call(e,s)||!Yi(t[s],e[s]))return!1}return!0}function pP(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function mP(t,e){var n=pP(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=pP(n)}}function C3(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?C3(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function T3(){for(var t=window,e=f0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=f0(t.document)}return e}function NN(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function bZ(t){var e=T3(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&C3(n.ownerDocument.documentElement,n)){if(r!==null&&NN(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=mP(n,i);var o=mP(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var wZ=ca&&"documentMode"in document&&11>=document.documentMode,rd=null,jk=null,Np=null,Vk=!1;function gP(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vk||rd==null||rd!==f0(r)||(r=rd,"selectionStart"in r&&NN(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Np&&Wp(Np,r)||(Np=r,r=b0(jk,"onSelect"),0<r.length&&(e=new kN("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=rd)))}function dv(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var sd={animationend:dv("Animation","AnimationEnd"),animationiteration:dv("Animation","AnimationIteration"),animationstart:dv("Animation","AnimationStart"),transitionend:dv("Transition","TransitionEnd")},gS={},N3={};ca&&(N3=document.createElement("div").style,"AnimationEvent"in window||(delete sd.animationend.animation,delete sd.animationiteration.animation,delete sd.animationstart.animation),"TransitionEvent"in window||delete sd.transitionend.transition);function rb(t){if(gS[t])return gS[t];if(!sd[t])return t;var e=sd[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in N3)return gS[t]=e[n];return t}var I3=rb("animationend"),$3=rb("animationiteration"),E3=rb("animationstart"),A3=rb("transitionend"),O3=new Map,yP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ol(t,e){O3.set(t,e),mc(e,[t])}for(var yS=0;yS<yP.length;yS++){var vS=yP[yS],_Z=vS.toLowerCase(),SZ=vS[0].toUpperCase()+vS.slice(1);Ol(_Z,"on"+SZ)}Ol(I3,"onAnimationEnd");Ol($3,"onAnimationIteration");Ol(E3,"onAnimationStart");Ol("dblclick","onDoubleClick");Ol("focusin","onFocus");Ol("focusout","onBlur");Ol(A3,"onTransitionEnd");$d("onMouseEnter",["mouseout","mouseover"]);$d("onMouseLeave",["mouseout","mouseover"]);$d("onPointerEnter",["pointerout","pointerover"]);$d("onPointerLeave",["pointerout","pointerover"]);mc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));mc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));mc("onBeforeInput",["compositionend","keypress","textInput","paste"]);mc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));mc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));mc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kZ=new Set("cancel close invalid load scroll toggle".split(" ").concat(pp));function vP(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,_7(r,e,void 0,t),t.currentTarget=null}function P3(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;vP(s,a,u),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;vP(s,a,u),i=l}}}if(m0)throw t=Fk,m0=!1,Fk=null,t}function Lt(t,e){var n=e[Kk];n===void 0&&(n=e[Kk]=new Set);var r=t+"__bubble";n.has(r)||(D3(e,t,2,!1),n.add(r))}function xS(t,e,n){var r=0;e&&(r|=4),D3(n,t,r,e)}var hv="_reactListening"+Math.random().toString(36).slice(2);function Up(t){if(!t[hv]){t[hv]=!0,jM.forEach(function(n){n!=="selectionchange"&&(kZ.has(n)||xS(n,!1,t),xS(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[hv]||(e[hv]=!0,xS("selectionchange",!1,e))}}function D3(t,e,n,r){switch(y3(e)){case 1:var s=M7;break;case 4:s=z7;break;default:s=_N}n=s.bind(null,e,n,t),s=void 0,!Lk||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function bS(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=wu(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}r3(function(){var u=i,c=vN(n),d=[];e:{var f=O3.get(t);if(f!==void 0){var p=kN,m=t;switch(t){case"keypress":if(e0(n)===0)break e;case"keydown":case"keyup":p=eZ;break;case"focusin":m="focus",p=fS;break;case"focusout":m="blur",p=fS;break;case"beforeblur":case"afterblur":p=fS;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=oP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=V7;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=rZ;break;case I3:case $3:case E3:p=G7;break;case A3:p=iZ;break;case"scroll":p=B7;break;case"wheel":p=aZ;break;case"copy":case"cut":case"paste":p=K7;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=lP}var y=(e&4)!==0,v=!y&&t==="scroll",x=y?f!==null?f+"Capture":null:f;y=[];for(var b=u,_;b!==null;){_=b;var S=_.stateNode;if(_.tag===5&&S!==null&&(_=S,x!==null&&(S=Mp(b,x),S!=null&&y.push(Gp(b,S,_)))),v)break;b=b.return}0<y.length&&(f=new p(f,m,null,n,c),d.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==Dk&&(m=n.relatedTarget||n.fromElement)&&(wu(m)||m[da]))break e;if((p||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=u,m=m?wu(m):null,m!==null&&(v=gc(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(y=oP,S="onMouseLeave",x="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(y=lP,S="onPointerLeave",x="onPointerEnter",b="pointer"),v=p==null?f:id(p),_=m==null?f:id(m),f=new y(S,b+"leave",p,n,c),f.target=v,f.relatedTarget=_,S=null,wu(c)===u&&(y=new y(x,b+"enter",m,n,c),y.target=_,y.relatedTarget=v,S=y),v=S,p&&m)t:{for(y=p,x=m,b=0,_=y;_;_=qc(_))b++;for(_=0,S=x;S;S=qc(S))_++;for(;0<b-_;)y=qc(y),b--;for(;0<_-b;)x=qc(x),_--;for(;b--;){if(y===x||x!==null&&y===x.alternate)break t;y=qc(y),x=qc(x)}y=null}else y=null;p!==null&&xP(d,f,p,y,!1),m!==null&&v!==null&&xP(d,v,m,y,!0)}}e:{if(f=u?id(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var k=pZ;else if(dP(f))if(S3)k=vZ;else{k=gZ;var T=mZ}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=yZ);if(k&&(k=k(t,u))){_3(d,k,n,c);break e}T&&T(t,f,u),t==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&$k(f,"number",f.value)}switch(T=u?id(u):window,t){case"focusin":(dP(T)||T.contentEditable==="true")&&(rd=T,jk=u,Np=null);break;case"focusout":Np=jk=rd=null;break;case"mousedown":Vk=!0;break;case"contextmenu":case"mouseup":case"dragend":Vk=!1,gP(d,n,c);break;case"selectionchange":if(wZ)break;case"keydown":case"keyup":gP(d,n,c)}var $;if(TN)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else nd?b3(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(x3&&n.locale!=="ko"&&(nd||A!=="onCompositionStart"?A==="onCompositionEnd"&&nd&&($=v3()):(Ya=c,SN="value"in Ya?Ya.value:Ya.textContent,nd=!0)),T=b0(u,A),0<T.length&&(A=new aP(A,t,null,n,c),d.push({event:A,listeners:T}),$?A.data=$:($=w3(n),$!==null&&(A.data=$)))),($=uZ?cZ(t,n):dZ(t,n))&&(u=b0(u,"onBeforeInput"),0<u.length&&(c=new aP("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=$))}P3(d,e)})}function Gp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function b0(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Mp(t,n),i!=null&&r.unshift(Gp(t,i,s)),i=Mp(t,e),i!=null&&r.push(Gp(t,i,s))),t=t.return}return r}function qc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function xP(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=Mp(n,i),l!=null&&o.unshift(Gp(n,l,a))):s||(l=Mp(n,i),l!=null&&o.push(Gp(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var CZ=/\r\n?/g,TZ=/\u0000|\uFFFD/g;function bP(t){return(typeof t=="string"?t:""+t).replace(CZ,`
`).replace(TZ,"")}function fv(t,e,n){if(e=bP(e),bP(t)!==e&&n)throw Error(we(425))}function w0(){}var Wk=null,Uk=null;function Gk(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hk=typeof setTimeout=="function"?setTimeout:void 0,NZ=typeof clearTimeout=="function"?clearTimeout:void 0,wP=typeof Promise=="function"?Promise:void 0,IZ=typeof queueMicrotask=="function"?queueMicrotask:typeof wP<"u"?function(t){return wP.resolve(null).then(t).catch($Z)}:Hk;function $Z(t){setTimeout(function(){throw t})}function wS(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),jp(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);jp(e)}function il(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function _P(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var uh=Math.random().toString(36).slice(2),xo="__reactFiber$"+uh,Hp="__reactProps$"+uh,da="__reactContainer$"+uh,Kk="__reactEvents$"+uh,EZ="__reactListeners$"+uh,AZ="__reactHandles$"+uh;function wu(t){var e=t[xo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[da]||n[xo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=_P(t);t!==null;){if(n=t[xo])return n;t=_P(t)}return e}t=n,n=t.parentNode}return null}function Rm(t){return t=t[xo]||t[da],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function id(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(we(33))}function sb(t){return t[Hp]||null}var qk=[],od=-1;function Pl(t){return{current:t}}function Mt(t){0>od||(t.current=qk[od],qk[od]=null,od--)}function Pt(t,e){od++,qk[od]=t.current,t.current=e}var gl={},Nr=Pl(gl),as=Pl(!1),Wu=gl;function Ed(t,e){var n=t.type.contextTypes;if(!n)return gl;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function ls(t){return t=t.childContextTypes,t!=null}function _0(){Mt(as),Mt(Nr)}function SP(t,e,n){if(Nr.current!==gl)throw Error(we(168));Pt(Nr,e),Pt(as,n)}function R3(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(we(108,m7(t)||"Unknown",s));return en({},n,r)}function S0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gl,Wu=Nr.current,Pt(Nr,t),Pt(as,as.current),!0}function kP(t,e,n){var r=t.stateNode;if(!r)throw Error(we(169));n?(t=R3(t,e,Wu),r.__reactInternalMemoizedMergedChildContext=t,Mt(as),Mt(Nr),Pt(Nr,t)):Mt(as),Pt(as,n)}var Ko=null,ib=!1,_S=!1;function L3(t){Ko===null?Ko=[t]:Ko.push(t)}function OZ(t){ib=!0,L3(t)}function Dl(){if(!_S&&Ko!==null){_S=!0;var t=0,e=St;try{var n=Ko;for(St=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ko=null,ib=!1}catch(s){throw Ko!==null&&(Ko=Ko.slice(t+1)),a3(xN,Dl),s}finally{St=e,_S=!1}}return null}var ad=[],ld=0,k0=null,C0=0,ni=[],ri=0,Uu=null,na=1,ra="";function au(t,e){ad[ld++]=C0,ad[ld++]=k0,k0=t,C0=e}function F3(t,e,n){ni[ri++]=na,ni[ri++]=ra,ni[ri++]=Uu,Uu=t;var r=na;t=ra;var s=32-Hi(r)-1;r&=~(1<<s),n+=1;var i=32-Hi(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,na=1<<32-Hi(e)+s|n<<s|r,ra=i+t}else na=1<<i|n<<s|r,ra=t}function IN(t){t.return!==null&&(au(t,1),F3(t,1,0))}function $N(t){for(;t===k0;)k0=ad[--ld],ad[ld]=null,C0=ad[--ld],ad[ld]=null;for(;t===Uu;)Uu=ni[--ri],ni[ri]=null,ra=ni[--ri],ni[ri]=null,na=ni[--ri],ni[ri]=null}var Is=null,Cs=null,Wt=!1,Mi=null;function M3(t,e){var n=ii(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function CP(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Is=t,Cs=il(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Is=t,Cs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Uu!==null?{id:na,overflow:ra}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ii(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Is=t,Cs=null,!0):!1;default:return!1}}function Xk(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Zk(t){if(Wt){var e=Cs;if(e){var n=e;if(!CP(t,e)){if(Xk(t))throw Error(we(418));e=il(n.nextSibling);var r=Is;e&&CP(t,e)?M3(r,n):(t.flags=t.flags&-4097|2,Wt=!1,Is=t)}}else{if(Xk(t))throw Error(we(418));t.flags=t.flags&-4097|2,Wt=!1,Is=t}}}function TP(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Is=t}function pv(t){if(t!==Is)return!1;if(!Wt)return TP(t),Wt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Gk(t.type,t.memoizedProps)),e&&(e=Cs)){if(Xk(t))throw z3(),Error(we(418));for(;e;)M3(t,e),e=il(e.nextSibling)}if(TP(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(we(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Cs=il(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Cs=null}}else Cs=Is?il(t.stateNode.nextSibling):null;return!0}function z3(){for(var t=Cs;t;)t=il(t.nextSibling)}function Ad(){Cs=Is=null,Wt=!1}function EN(t){Mi===null?Mi=[t]:Mi.push(t)}var PZ=ka.ReactCurrentBatchConfig;function Zf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(we(309));var r=n.stateNode}if(!r)throw Error(we(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(we(284));if(!n._owner)throw Error(we(290,t))}return t}function mv(t,e){throw t=Object.prototype.toString.call(e),Error(we(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function NP(t){var e=t._init;return e(t._payload)}function B3(t){function e(x,b){if(t){var _=x.deletions;_===null?(x.deletions=[b],x.flags|=16):_.push(b)}}function n(x,b){if(!t)return null;for(;b!==null;)e(x,b),b=b.sibling;return null}function r(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function s(x,b){return x=ul(x,b),x.index=0,x.sibling=null,x}function i(x,b,_){return x.index=_,t?(_=x.alternate,_!==null?(_=_.index,_<b?(x.flags|=2,b):_):(x.flags|=2,b)):(x.flags|=1048576,b)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,b,_,S){return b===null||b.tag!==6?(b=$S(_,x.mode,S),b.return=x,b):(b=s(b,_),b.return=x,b)}function l(x,b,_,S){var k=_.type;return k===td?c(x,b,_.props.children,S,_.key):b!==null&&(b.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ua&&NP(k)===b.type)?(S=s(b,_.props),S.ref=Zf(x,b,_),S.return=x,S):(S=a0(_.type,_.key,_.props,null,x.mode,S),S.ref=Zf(x,b,_),S.return=x,S)}function u(x,b,_,S){return b===null||b.tag!==4||b.stateNode.containerInfo!==_.containerInfo||b.stateNode.implementation!==_.implementation?(b=ES(_,x.mode,S),b.return=x,b):(b=s(b,_.children||[]),b.return=x,b)}function c(x,b,_,S,k){return b===null||b.tag!==7?(b=Pu(_,x.mode,S,k),b.return=x,b):(b=s(b,_),b.return=x,b)}function d(x,b,_){if(typeof b=="string"&&b!==""||typeof b=="number")return b=$S(""+b,x.mode,_),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case sv:return _=a0(b.type,b.key,b.props,null,x.mode,_),_.ref=Zf(x,null,b),_.return=x,_;case ed:return b=ES(b,x.mode,_),b.return=x,b;case Ua:var S=b._init;return d(x,S(b._payload),_)}if(hp(b)||Gf(b))return b=Pu(b,x.mode,_,null),b.return=x,b;mv(x,b)}return null}function f(x,b,_,S){var k=b!==null?b.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return k!==null?null:a(x,b,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case sv:return _.key===k?l(x,b,_,S):null;case ed:return _.key===k?u(x,b,_,S):null;case Ua:return k=_._init,f(x,b,k(_._payload),S)}if(hp(_)||Gf(_))return k!==null?null:c(x,b,_,S,null);mv(x,_)}return null}function p(x,b,_,S,k){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(_)||null,a(b,x,""+S,k);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case sv:return x=x.get(S.key===null?_:S.key)||null,l(b,x,S,k);case ed:return x=x.get(S.key===null?_:S.key)||null,u(b,x,S,k);case Ua:var T=S._init;return p(x,b,_,T(S._payload),k)}if(hp(S)||Gf(S))return x=x.get(_)||null,c(b,x,S,k,null);mv(b,S)}return null}function m(x,b,_,S){for(var k=null,T=null,$=b,A=b=0,D=null;$!==null&&A<_.length;A++){$.index>A?(D=$,$=null):D=$.sibling;var F=f(x,$,_[A],S);if(F===null){$===null&&($=D);break}t&&$&&F.alternate===null&&e(x,$),b=i(F,b,A),T===null?k=F:T.sibling=F,T=F,$=D}if(A===_.length)return n(x,$),Wt&&au(x,A),k;if($===null){for(;A<_.length;A++)$=d(x,_[A],S),$!==null&&(b=i($,b,A),T===null?k=$:T.sibling=$,T=$);return Wt&&au(x,A),k}for($=r(x,$);A<_.length;A++)D=p($,x,A,_[A],S),D!==null&&(t&&D.alternate!==null&&$.delete(D.key===null?A:D.key),b=i(D,b,A),T===null?k=D:T.sibling=D,T=D);return t&&$.forEach(function(M){return e(x,M)}),Wt&&au(x,A),k}function y(x,b,_,S){var k=Gf(_);if(typeof k!="function")throw Error(we(150));if(_=k.call(_),_==null)throw Error(we(151));for(var T=k=null,$=b,A=b=0,D=null,F=_.next();$!==null&&!F.done;A++,F=_.next()){$.index>A?(D=$,$=null):D=$.sibling;var M=f(x,$,F.value,S);if(M===null){$===null&&($=D);break}t&&$&&M.alternate===null&&e(x,$),b=i(M,b,A),T===null?k=M:T.sibling=M,T=M,$=D}if(F.done)return n(x,$),Wt&&au(x,A),k;if($===null){for(;!F.done;A++,F=_.next())F=d(x,F.value,S),F!==null&&(b=i(F,b,A),T===null?k=F:T.sibling=F,T=F);return Wt&&au(x,A),k}for($=r(x,$);!F.done;A++,F=_.next())F=p($,x,A,F.value,S),F!==null&&(t&&F.alternate!==null&&$.delete(F.key===null?A:F.key),b=i(F,b,A),T===null?k=F:T.sibling=F,T=F);return t&&$.forEach(function(j){return e(x,j)}),Wt&&au(x,A),k}function v(x,b,_,S){if(typeof _=="object"&&_!==null&&_.type===td&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case sv:e:{for(var k=_.key,T=b;T!==null;){if(T.key===k){if(k=_.type,k===td){if(T.tag===7){n(x,T.sibling),b=s(T,_.props.children),b.return=x,x=b;break e}}else if(T.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ua&&NP(k)===T.type){n(x,T.sibling),b=s(T,_.props),b.ref=Zf(x,T,_),b.return=x,x=b;break e}n(x,T);break}else e(x,T);T=T.sibling}_.type===td?(b=Pu(_.props.children,x.mode,S,_.key),b.return=x,x=b):(S=a0(_.type,_.key,_.props,null,x.mode,S),S.ref=Zf(x,b,_),S.return=x,x=S)}return o(x);case ed:e:{for(T=_.key;b!==null;){if(b.key===T)if(b.tag===4&&b.stateNode.containerInfo===_.containerInfo&&b.stateNode.implementation===_.implementation){n(x,b.sibling),b=s(b,_.children||[]),b.return=x,x=b;break e}else{n(x,b);break}else e(x,b);b=b.sibling}b=ES(_,x.mode,S),b.return=x,x=b}return o(x);case Ua:return T=_._init,v(x,b,T(_._payload),S)}if(hp(_))return m(x,b,_,S);if(Gf(_))return y(x,b,_,S);mv(x,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,b!==null&&b.tag===6?(n(x,b.sibling),b=s(b,_),b.return=x,x=b):(n(x,b),b=$S(_,x.mode,S),b.return=x,x=b),o(x)):n(x,b)}return v}var Od=B3(!0),j3=B3(!1),T0=Pl(null),N0=null,ud=null,AN=null;function ON(){AN=ud=N0=null}function PN(t){var e=T0.current;Mt(T0),t._currentValue=e}function Yk(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function bd(t,e){N0=t,AN=ud=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rs=!0),t.firstContext=null)}function pi(t){var e=t._currentValue;if(AN!==t)if(t={context:t,memoizedValue:e,next:null},ud===null){if(N0===null)throw Error(we(308));ud=t,N0.dependencies={lanes:0,firstContext:t}}else ud=ud.next=t;return e}var _u=null;function DN(t){_u===null?_u=[t]:_u.push(t)}function V3(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,DN(e)):(n.next=s.next,s.next=n),e.interleaved=n,ha(t,r)}function ha(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ga=!1;function RN(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function W3(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function oa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ol(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ft&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ha(t,n)}return s=r.interleaved,s===null?(e.next=e,DN(r)):(e.next=s.next,s.next=e),r.interleaved=e,ha(t,n)}function t0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bN(t,n)}}function IP(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function I0(t,e,n,r){var s=t.updateQueue;Ga=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;o=0,c=u=l=null,a=i;do{var f=a.lane,p=a.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,y=a;switch(f=e,p=n,y.tag){case 1:if(m=y.payload,typeof m=="function"){d=m.call(p,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=y.payload,f=typeof m=="function"?m.call(p,d,f):m,f==null)break e;d=en({},d,f);break e;case 2:Ga=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=p,l=d):c=c.next=p,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(c===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Hu|=o,t.lanes=o,t.memoizedState=d}}function $P(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(we(191,s));s.call(r)}}}var Lm={},ko=Pl(Lm),Kp=Pl(Lm),qp=Pl(Lm);function Su(t){if(t===Lm)throw Error(we(174));return t}function LN(t,e){switch(Pt(qp,e),Pt(Kp,t),Pt(ko,Lm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ak(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ak(e,t)}Mt(ko),Pt(ko,e)}function Pd(){Mt(ko),Mt(Kp),Mt(qp)}function U3(t){Su(qp.current);var e=Su(ko.current),n=Ak(e,t.type);e!==n&&(Pt(Kp,t),Pt(ko,n))}function FN(t){Kp.current===t&&(Mt(ko),Mt(Kp))}var Zt=Pl(0);function $0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var SS=[];function MN(){for(var t=0;t<SS.length;t++)SS[t]._workInProgressVersionPrimary=null;SS.length=0}var n0=ka.ReactCurrentDispatcher,kS=ka.ReactCurrentBatchConfig,Gu=0,Jt=null,$n=null,Wn=null,E0=!1,Ip=!1,Xp=0,DZ=0;function gr(){throw Error(we(321))}function zN(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Yi(t[n],e[n]))return!1;return!0}function BN(t,e,n,r,s,i){if(Gu=i,Jt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,n0.current=t===null||t.memoizedState===null?MZ:zZ,t=n(r,s),Ip){i=0;do{if(Ip=!1,Xp=0,25<=i)throw Error(we(301));i+=1,Wn=$n=null,e.updateQueue=null,n0.current=BZ,t=n(r,s)}while(Ip)}if(n0.current=A0,e=$n!==null&&$n.next!==null,Gu=0,Wn=$n=Jt=null,E0=!1,e)throw Error(we(300));return t}function jN(){var t=Xp!==0;return Xp=0,t}function mo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?Jt.memoizedState=Wn=t:Wn=Wn.next=t,Wn}function mi(){if($n===null){var t=Jt.alternate;t=t!==null?t.memoizedState:null}else t=$n.next;var e=Wn===null?Jt.memoizedState:Wn.next;if(e!==null)Wn=e,$n=t;else{if(t===null)throw Error(we(310));$n=t,t={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},Wn===null?Jt.memoizedState=Wn=t:Wn=Wn.next=t}return Wn}function Zp(t,e){return typeof e=="function"?e(t):e}function CS(t){var e=mi(),n=e.queue;if(n===null)throw Error(we(311));n.lastRenderedReducer=t;var r=$n,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,u=i;do{var c=u.lane;if((Gu&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,Jt.lanes|=c,Hu|=c}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=a,Yi(r,e.memoizedState)||(rs=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Jt.lanes|=i,Hu|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function TS(t){var e=mi(),n=e.queue;if(n===null)throw Error(we(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Yi(i,e.memoizedState)||(rs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function G3(){}function H3(t,e){var n=Jt,r=mi(),s=e(),i=!Yi(r.memoizedState,s);if(i&&(r.memoizedState=s,rs=!0),r=r.queue,VN(X3.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Wn!==null&&Wn.memoizedState.tag&1){if(n.flags|=2048,Yp(9,q3.bind(null,n,r,s,e),void 0,null),Hn===null)throw Error(we(349));Gu&30||K3(n,e,s)}return s}function K3(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Jt.updateQueue,e===null?(e={lastEffect:null,stores:null},Jt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function q3(t,e,n,r){e.value=n,e.getSnapshot=r,Z3(e)&&Y3(t)}function X3(t,e,n){return n(function(){Z3(e)&&Y3(t)})}function Z3(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Yi(t,n)}catch{return!0}}function Y3(t){var e=ha(t,1);e!==null&&Ki(e,t,1,-1)}function EP(t){var e=mo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zp,lastRenderedState:t},e.queue=t,t=t.dispatch=FZ.bind(null,Jt,t),[e.memoizedState,t]}function Yp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Jt.updateQueue,e===null?(e={lastEffect:null,stores:null},Jt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Q3(){return mi().memoizedState}function r0(t,e,n,r){var s=mo();Jt.flags|=t,s.memoizedState=Yp(1|e,n,void 0,r===void 0?null:r)}function ob(t,e,n,r){var s=mi();r=r===void 0?null:r;var i=void 0;if($n!==null){var o=$n.memoizedState;if(i=o.destroy,r!==null&&zN(r,o.deps)){s.memoizedState=Yp(e,n,i,r);return}}Jt.flags|=t,s.memoizedState=Yp(1|e,n,i,r)}function AP(t,e){return r0(8390656,8,t,e)}function VN(t,e){return ob(2048,8,t,e)}function J3(t,e){return ob(4,2,t,e)}function ez(t,e){return ob(4,4,t,e)}function tz(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function nz(t,e,n){return n=n!=null?n.concat([t]):null,ob(4,4,tz.bind(null,e,t),n)}function WN(){}function rz(t,e){var n=mi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zN(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function sz(t,e){var n=mi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zN(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function iz(t,e,n){return Gu&21?(Yi(n,e)||(n=c3(),Jt.lanes|=n,Hu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rs=!0),t.memoizedState=n)}function RZ(t,e){var n=St;St=n!==0&&4>n?n:4,t(!0);var r=kS.transition;kS.transition={};try{t(!1),e()}finally{St=n,kS.transition=r}}function oz(){return mi().memoizedState}function LZ(t,e,n){var r=ll(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},az(t))lz(e,n);else if(n=V3(t,e,n,r),n!==null){var s=Lr();Ki(n,t,r,s),uz(n,e,r)}}function FZ(t,e,n){var r=ll(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(az(t))lz(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Yi(a,o)){var l=e.interleaved;l===null?(s.next=s,DN(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=V3(t,e,s,r),n!==null&&(s=Lr(),Ki(n,t,r,s),uz(n,e,r))}}function az(t){var e=t.alternate;return t===Jt||e!==null&&e===Jt}function lz(t,e){Ip=E0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function uz(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bN(t,n)}}var A0={readContext:pi,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},MZ={readContext:pi,useCallback:function(t,e){return mo().memoizedState=[t,e===void 0?null:e],t},useContext:pi,useEffect:AP,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,r0(4194308,4,tz.bind(null,e,t),n)},useLayoutEffect:function(t,e){return r0(4194308,4,t,e)},useInsertionEffect:function(t,e){return r0(4,2,t,e)},useMemo:function(t,e){var n=mo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=mo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=LZ.bind(null,Jt,t),[r.memoizedState,t]},useRef:function(t){var e=mo();return t={current:t},e.memoizedState=t},useState:EP,useDebugValue:WN,useDeferredValue:function(t){return mo().memoizedState=t},useTransition:function(){var t=EP(!1),e=t[0];return t=RZ.bind(null,t[1]),mo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Jt,s=mo();if(Wt){if(n===void 0)throw Error(we(407));n=n()}else{if(n=e(),Hn===null)throw Error(we(349));Gu&30||K3(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,AP(X3.bind(null,r,i,t),[t]),r.flags|=2048,Yp(9,q3.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=mo(),e=Hn.identifierPrefix;if(Wt){var n=ra,r=na;n=(r&~(1<<32-Hi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Xp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=DZ++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zZ={readContext:pi,useCallback:rz,useContext:pi,useEffect:VN,useImperativeHandle:nz,useInsertionEffect:J3,useLayoutEffect:ez,useMemo:sz,useReducer:CS,useRef:Q3,useState:function(){return CS(Zp)},useDebugValue:WN,useDeferredValue:function(t){var e=mi();return iz(e,$n.memoizedState,t)},useTransition:function(){var t=CS(Zp)[0],e=mi().memoizedState;return[t,e]},useMutableSource:G3,useSyncExternalStore:H3,useId:oz,unstable_isNewReconciler:!1},BZ={readContext:pi,useCallback:rz,useContext:pi,useEffect:VN,useImperativeHandle:nz,useInsertionEffect:J3,useLayoutEffect:ez,useMemo:sz,useReducer:TS,useRef:Q3,useState:function(){return TS(Zp)},useDebugValue:WN,useDeferredValue:function(t){var e=mi();return $n===null?e.memoizedState=t:iz(e,$n.memoizedState,t)},useTransition:function(){var t=TS(Zp)[0],e=mi().memoizedState;return[t,e]},useMutableSource:G3,useSyncExternalStore:H3,useId:oz,unstable_isNewReconciler:!1};function Ri(t,e){if(t&&t.defaultProps){e=en({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Qk(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:en({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ab={isMounted:function(t){return(t=t._reactInternals)?gc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Lr(),s=ll(t),i=oa(r,s);i.payload=e,n!=null&&(i.callback=n),e=ol(t,i,s),e!==null&&(Ki(e,t,s,r),t0(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Lr(),s=ll(t),i=oa(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ol(t,i,s),e!==null&&(Ki(e,t,s,r),t0(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Lr(),r=ll(t),s=oa(n,r);s.tag=2,e!=null&&(s.callback=e),e=ol(t,s,r),e!==null&&(Ki(e,t,r,n),t0(e,t,r))}};function OP(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Wp(n,r)||!Wp(s,i):!0}function cz(t,e,n){var r=!1,s=gl,i=e.contextType;return typeof i=="object"&&i!==null?i=pi(i):(s=ls(e)?Wu:Nr.current,r=e.contextTypes,i=(r=r!=null)?Ed(t,s):gl),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ab,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function PP(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ab.enqueueReplaceState(e,e.state,null)}function Jk(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},RN(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=pi(i):(i=ls(e)?Wu:Nr.current,s.context=Ed(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Qk(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&ab.enqueueReplaceState(s,s.state,null),I0(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Dd(t,e){try{var n="",r=e;do n+=p7(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function NS(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function eC(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var jZ=typeof WeakMap=="function"?WeakMap:Map;function dz(t,e,n){n=oa(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){P0||(P0=!0,cC=r),eC(t,e)},n}function hz(t,e,n){n=oa(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){eC(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){eC(t,e),typeof r!="function"&&(al===null?al=new Set([this]):al.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function DP(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new jZ;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=t9.bind(null,t,e,n),e.then(t,t))}function RP(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function LP(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=oa(-1,1),e.tag=2,ol(n,e,1))),n.lanes|=1),t)}var VZ=ka.ReactCurrentOwner,rs=!1;function Or(t,e,n,r){e.child=t===null?j3(e,null,n,r):Od(e,t.child,n,r)}function FP(t,e,n,r,s){n=n.render;var i=e.ref;return bd(e,s),r=BN(t,e,n,r,i,s),n=jN(),t!==null&&!rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fa(t,e,s)):(Wt&&n&&IN(e),e.flags|=1,Or(t,e,r,s),e.child)}function MP(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!YN(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,fz(t,e,i,r,s)):(t=a0(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Wp,n(o,r)&&t.ref===e.ref)return fa(t,e,s)}return e.flags|=1,t=ul(i,r),t.ref=e.ref,t.return=e,e.child=t}function fz(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Wp(i,r)&&t.ref===e.ref)if(rs=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(rs=!0);else return e.lanes=t.lanes,fa(t,e,s)}return tC(t,e,n,r,s)}function pz(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(dd,bs),bs|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pt(dd,bs),bs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Pt(dd,bs),bs|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Pt(dd,bs),bs|=r;return Or(t,e,s,n),e.child}function mz(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function tC(t,e,n,r,s){var i=ls(n)?Wu:Nr.current;return i=Ed(e,i),bd(e,s),n=BN(t,e,n,r,i,s),r=jN(),t!==null&&!rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fa(t,e,s)):(Wt&&r&&IN(e),e.flags|=1,Or(t,e,n,s),e.child)}function zP(t,e,n,r,s){if(ls(n)){var i=!0;S0(e)}else i=!1;if(bd(e,s),e.stateNode===null)s0(t,e),cz(e,n,r),Jk(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=pi(u):(u=ls(n)?Wu:Nr.current,u=Ed(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&PP(e,o,r,u),Ga=!1;var f=e.memoizedState;o.state=f,I0(e,r,o,s),l=e.memoizedState,a!==r||f!==l||as.current||Ga?(typeof c=="function"&&(Qk(e,n,c,r),l=e.memoizedState),(a=Ga||OP(e,n,a,r,f,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,W3(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ri(e.type,a),o.props=u,d=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=pi(l):(l=ls(n)?Wu:Nr.current,l=Ed(e,l));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&PP(e,o,r,l),Ga=!1,f=e.memoizedState,o.state=f,I0(e,r,o,s);var m=e.memoizedState;a!==d||f!==m||as.current||Ga?(typeof p=="function"&&(Qk(e,n,p,r),m=e.memoizedState),(u=Ga||OP(e,n,u,r,f,m,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return nC(t,e,n,r,i,s)}function nC(t,e,n,r,s,i){mz(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&kP(e,n,!1),fa(t,e,i);r=e.stateNode,VZ.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Od(e,t.child,null,i),e.child=Od(e,null,a,i)):Or(t,e,a,i),e.memoizedState=r.state,s&&kP(e,n,!0),e.child}function gz(t){var e=t.stateNode;e.pendingContext?SP(t,e.pendingContext,e.pendingContext!==e.context):e.context&&SP(t,e.context,!1),LN(t,e.containerInfo)}function BP(t,e,n,r,s){return Ad(),EN(s),e.flags|=256,Or(t,e,n,r),e.child}var rC={dehydrated:null,treeContext:null,retryLane:0};function sC(t){return{baseLanes:t,cachePool:null,transitions:null}}function yz(t,e,n){var r=e.pendingProps,s=Zt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Pt(Zt,s&1),t===null)return Zk(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=cb(o,r,0,null),t=Pu(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=sC(n),e.memoizedState=rC,t):UN(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return WZ(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ul(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ul(a,i):(i=Pu(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?sC(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=rC,r}return i=t.child,t=i.sibling,r=ul(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function UN(t,e){return e=cb({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function gv(t,e,n,r){return r!==null&&EN(r),Od(e,t.child,null,n),t=UN(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function WZ(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=NS(Error(we(422))),gv(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=cb({mode:"visible",children:r.children},s,0,null),i=Pu(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Od(e,t.child,null,o),e.child.memoizedState=sC(o),e.memoizedState=rC,i);if(!(e.mode&1))return gv(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(we(419)),r=NS(i,r,void 0),gv(t,e,o,r)}if(a=(o&t.childLanes)!==0,rs||a){if(r=Hn,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ha(t,s),Ki(r,t,s,-1))}return ZN(),r=NS(Error(we(421))),gv(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=n9.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Cs=il(s.nextSibling),Is=e,Wt=!0,Mi=null,t!==null&&(ni[ri++]=na,ni[ri++]=ra,ni[ri++]=Uu,na=t.id,ra=t.overflow,Uu=e),e=UN(e,r.children),e.flags|=4096,e)}function jP(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Yk(t.return,e,n)}function IS(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function vz(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Or(t,e,r.children,n),r=Zt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&jP(t,n,e);else if(t.tag===19)jP(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Pt(Zt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&$0(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),IS(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&$0(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}IS(e,!0,n,null,i);break;case"together":IS(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function s0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fa(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Hu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(we(153));if(e.child!==null){for(t=e.child,n=ul(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ul(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function UZ(t,e,n){switch(e.tag){case 3:gz(e),Ad();break;case 5:U3(e);break;case 1:ls(e.type)&&S0(e);break;case 4:LN(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Pt(T0,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Pt(Zt,Zt.current&1),e.flags|=128,null):n&e.child.childLanes?yz(t,e,n):(Pt(Zt,Zt.current&1),t=fa(t,e,n),t!==null?t.sibling:null);Pt(Zt,Zt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return vz(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Pt(Zt,Zt.current),r)break;return null;case 22:case 23:return e.lanes=0,pz(t,e,n)}return fa(t,e,n)}var xz,iC,bz,wz;xz=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};iC=function(){};bz=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Su(ko.current);var i=null;switch(n){case"input":s=Nk(t,s),r=Nk(t,r),i=[];break;case"select":s=en({},s,{value:void 0}),r=en({},r,{value:void 0}),i=[];break;case"textarea":s=Ek(t,s),r=Ek(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=w0)}Ok(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Lp.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Lp.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Lt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};wz=function(t,e,n,r){n!==r&&(e.flags|=4)};function Yf(t,e){if(!Wt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function yr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function GZ(t,e,n){var r=e.pendingProps;switch($N(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yr(e),null;case 1:return ls(e.type)&&_0(),yr(e),null;case 3:return r=e.stateNode,Pd(),Mt(as),Mt(Nr),MN(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(pv(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Mi!==null&&(fC(Mi),Mi=null))),iC(t,e),yr(e),null;case 5:FN(e);var s=Su(qp.current);if(n=e.type,t!==null&&e.stateNode!=null)bz(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(we(166));return yr(e),null}if(t=Su(ko.current),pv(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[xo]=e,r[Hp]=i,t=(e.mode&1)!==0,n){case"dialog":Lt("cancel",r),Lt("close",r);break;case"iframe":case"object":case"embed":Lt("load",r);break;case"video":case"audio":for(s=0;s<pp.length;s++)Lt(pp[s],r);break;case"source":Lt("error",r);break;case"img":case"image":case"link":Lt("error",r),Lt("load",r);break;case"details":Lt("toggle",r);break;case"input":ZO(r,i),Lt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Lt("invalid",r);break;case"textarea":QO(r,i),Lt("invalid",r)}Ok(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&fv(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&fv(r.textContent,a,t),s=["children",""+a]):Lp.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Lt("scroll",r)}switch(n){case"input":iv(r),YO(r,i,!0);break;case"textarea":iv(r),JO(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=w0)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=XM(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[xo]=e,t[Hp]=r,xz(t,e,!1,!1),e.stateNode=t;e:{switch(o=Pk(n,r),n){case"dialog":Lt("cancel",t),Lt("close",t),s=r;break;case"iframe":case"object":case"embed":Lt("load",t),s=r;break;case"video":case"audio":for(s=0;s<pp.length;s++)Lt(pp[s],t);s=r;break;case"source":Lt("error",t),s=r;break;case"img":case"image":case"link":Lt("error",t),Lt("load",t),s=r;break;case"details":Lt("toggle",t),s=r;break;case"input":ZO(t,r),s=Nk(t,r),Lt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=en({},r,{value:void 0}),Lt("invalid",t);break;case"textarea":QO(t,r),s=Ek(t,r),Lt("invalid",t);break;default:s=r}Ok(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?QM(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ZM(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Fp(t,l):typeof l=="number"&&Fp(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Lp.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Lt("scroll",t):l!=null&&pN(t,i,l,o))}switch(n){case"input":iv(t),YO(t,r,!1);break;case"textarea":iv(t),JO(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ml(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?gd(t,!!r.multiple,i,!1):r.defaultValue!=null&&gd(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=w0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return yr(e),null;case 6:if(t&&e.stateNode!=null)wz(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(we(166));if(n=Su(qp.current),Su(ko.current),pv(e)){if(r=e.stateNode,n=e.memoizedProps,r[xo]=e,(i=r.nodeValue!==n)&&(t=Is,t!==null))switch(t.tag){case 3:fv(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&fv(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xo]=e,e.stateNode=r}return yr(e),null;case 13:if(Mt(Zt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Wt&&Cs!==null&&e.mode&1&&!(e.flags&128))z3(),Ad(),e.flags|=98560,i=!1;else if(i=pv(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(we(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(we(317));i[xo]=e}else Ad(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;yr(e),i=!1}else Mi!==null&&(fC(Mi),Mi=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Zt.current&1?On===0&&(On=3):ZN())),e.updateQueue!==null&&(e.flags|=4),yr(e),null);case 4:return Pd(),iC(t,e),t===null&&Up(e.stateNode.containerInfo),yr(e),null;case 10:return PN(e.type._context),yr(e),null;case 17:return ls(e.type)&&_0(),yr(e),null;case 19:if(Mt(Zt),i=e.memoizedState,i===null)return yr(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Yf(i,!1);else{if(On!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=$0(t),o!==null){for(e.flags|=128,Yf(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Pt(Zt,Zt.current&1|2),e.child}t=t.sibling}i.tail!==null&&hn()>Rd&&(e.flags|=128,r=!0,Yf(i,!1),e.lanes=4194304)}else{if(!r)if(t=$0(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Yf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Wt)return yr(e),null}else 2*hn()-i.renderingStartTime>Rd&&n!==1073741824&&(e.flags|=128,r=!0,Yf(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=hn(),e.sibling=null,n=Zt.current,Pt(Zt,r?n&1|2:n&1),e):(yr(e),null);case 22:case 23:return XN(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?bs&1073741824&&(yr(e),e.subtreeFlags&6&&(e.flags|=8192)):yr(e),null;case 24:return null;case 25:return null}throw Error(we(156,e.tag))}function HZ(t,e){switch($N(e),e.tag){case 1:return ls(e.type)&&_0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Pd(),Mt(as),Mt(Nr),MN(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return FN(e),null;case 13:if(Mt(Zt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(we(340));Ad()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Mt(Zt),null;case 4:return Pd(),null;case 10:return PN(e.type._context),null;case 22:case 23:return XN(),null;case 24:return null;default:return null}}var yv=!1,wr=!1,KZ=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function cd(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){nn(t,e,r)}else n.current=null}function oC(t,e,n){try{n()}catch(r){nn(t,e,r)}}var VP=!1;function qZ(t,e){if(Wk=v0,t=T3(),NN(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,d=t,f=null;t:for(;;){for(var p;d!==n||s!==0&&d.nodeType!==3||(a=o+s),d!==i||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===t)break t;if(f===n&&++u===s&&(a=o),f===i&&++c===r&&(l=o),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Uk={focusedElem:t,selectionRange:n},v0=!1,Ee=e;Ee!==null;)if(e=Ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ee=t;else for(;Ee!==null;){e=Ee;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var y=m.memoizedProps,v=m.memoizedState,x=e.stateNode,b=x.getSnapshotBeforeUpdate(e.elementType===e.type?y:Ri(e.type,y),v);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(we(163))}}catch(S){nn(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,Ee=t;break}Ee=e.return}return m=VP,VP=!1,m}function $p(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&oC(e,n,i)}s=s.next}while(s!==r)}}function lb(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function aC(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function _z(t){var e=t.alternate;e!==null&&(t.alternate=null,_z(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xo],delete e[Hp],delete e[Kk],delete e[EZ],delete e[AZ])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Sz(t){return t.tag===5||t.tag===3||t.tag===4}function WP(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Sz(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function lC(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=w0));else if(r!==4&&(t=t.child,t!==null))for(lC(t,e,n),t=t.sibling;t!==null;)lC(t,e,n),t=t.sibling}function uC(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(uC(t,e,n),t=t.sibling;t!==null;)uC(t,e,n),t=t.sibling}var or=null,Fi=!1;function ja(t,e,n){for(n=n.child;n!==null;)kz(t,e,n),n=n.sibling}function kz(t,e,n){if(So&&typeof So.onCommitFiberUnmount=="function")try{So.onCommitFiberUnmount(eb,n)}catch{}switch(n.tag){case 5:wr||cd(n,e);case 6:var r=or,s=Fi;or=null,ja(t,e,n),or=r,Fi=s,or!==null&&(Fi?(t=or,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):or.removeChild(n.stateNode));break;case 18:or!==null&&(Fi?(t=or,n=n.stateNode,t.nodeType===8?wS(t.parentNode,n):t.nodeType===1&&wS(t,n),jp(t)):wS(or,n.stateNode));break;case 4:r=or,s=Fi,or=n.stateNode.containerInfo,Fi=!0,ja(t,e,n),or=r,Fi=s;break;case 0:case 11:case 14:case 15:if(!wr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&oC(n,e,o),s=s.next}while(s!==r)}ja(t,e,n);break;case 1:if(!wr&&(cd(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){nn(n,e,a)}ja(t,e,n);break;case 21:ja(t,e,n);break;case 22:n.mode&1?(wr=(r=wr)||n.memoizedState!==null,ja(t,e,n),wr=r):ja(t,e,n);break;default:ja(t,e,n)}}function UP(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new KZ),e.forEach(function(r){var s=r9.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Oi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:or=a.stateNode,Fi=!1;break e;case 3:or=a.stateNode.containerInfo,Fi=!0;break e;case 4:or=a.stateNode.containerInfo,Fi=!0;break e}a=a.return}if(or===null)throw Error(we(160));kz(i,o,s),or=null,Fi=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){nn(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Cz(e,t),e=e.sibling}function Cz(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Oi(e,t),po(t),r&4){try{$p(3,t,t.return),lb(3,t)}catch(y){nn(t,t.return,y)}try{$p(5,t,t.return)}catch(y){nn(t,t.return,y)}}break;case 1:Oi(e,t),po(t),r&512&&n!==null&&cd(n,n.return);break;case 5:if(Oi(e,t),po(t),r&512&&n!==null&&cd(n,n.return),t.flags&32){var s=t.stateNode;try{Fp(s,"")}catch(y){nn(t,t.return,y)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&KM(s,i),Pk(a,o);var u=Pk(a,i);for(o=0;o<l.length;o+=2){var c=l[o],d=l[o+1];c==="style"?QM(s,d):c==="dangerouslySetInnerHTML"?ZM(s,d):c==="children"?Fp(s,d):pN(s,c,d,u)}switch(a){case"input":Ik(s,i);break;case"textarea":qM(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?gd(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?gd(s,!!i.multiple,i.defaultValue,!0):gd(s,!!i.multiple,i.multiple?[]:"",!1))}s[Hp]=i}catch(y){nn(t,t.return,y)}}break;case 6:if(Oi(e,t),po(t),r&4){if(t.stateNode===null)throw Error(we(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(y){nn(t,t.return,y)}}break;case 3:if(Oi(e,t),po(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{jp(e.containerInfo)}catch(y){nn(t,t.return,y)}break;case 4:Oi(e,t),po(t);break;case 13:Oi(e,t),po(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(KN=hn())),r&4&&UP(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(wr=(u=wr)||c,Oi(e,t),wr=u):Oi(e,t),po(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Ee=t,c=t.child;c!==null;){for(d=Ee=c;Ee!==null;){switch(f=Ee,p=f.child,f.tag){case 0:case 11:case 14:case 15:$p(4,f,f.return);break;case 1:cd(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(y){nn(r,n,y)}}break;case 5:cd(f,f.return);break;case 22:if(f.memoizedState!==null){HP(d);continue}}p!==null?(p.return=f,Ee=p):HP(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{s=d.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=YM("display",o))}catch(y){nn(t,t.return,y)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(y){nn(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Oi(e,t),po(t),r&4&&UP(t);break;case 21:break;default:Oi(e,t),po(t)}}function po(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Sz(n)){var r=n;break e}n=n.return}throw Error(we(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Fp(s,""),r.flags&=-33);var i=WP(t);uC(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=WP(t);lC(t,a,o);break;default:throw Error(we(161))}}catch(l){nn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function XZ(t,e,n){Ee=t,Tz(t)}function Tz(t,e,n){for(var r=(t.mode&1)!==0;Ee!==null;){var s=Ee,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||yv;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||wr;a=yv;var u=wr;if(yv=o,(wr=l)&&!u)for(Ee=s;Ee!==null;)o=Ee,l=o.child,o.tag===22&&o.memoizedState!==null?KP(s):l!==null?(l.return=o,Ee=l):KP(s);for(;i!==null;)Ee=i,Tz(i),i=i.sibling;Ee=s,yv=a,wr=u}GP(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ee=i):GP(t)}}function GP(t){for(;Ee!==null;){var e=Ee;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:wr||lb(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!wr)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ri(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&$P(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$P(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&jp(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(we(163))}wr||e.flags&512&&aC(e)}catch(f){nn(e,e.return,f)}}if(e===t){Ee=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ee=n;break}Ee=e.return}}function HP(t){for(;Ee!==null;){var e=Ee;if(e===t){Ee=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ee=n;break}Ee=e.return}}function KP(t){for(;Ee!==null;){var e=Ee;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{lb(4,e)}catch(l){nn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){nn(e,s,l)}}var i=e.return;try{aC(e)}catch(l){nn(e,i,l)}break;case 5:var o=e.return;try{aC(e)}catch(l){nn(e,o,l)}}}catch(l){nn(e,e.return,l)}if(e===t){Ee=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ee=a;break}Ee=e.return}}var ZZ=Math.ceil,O0=ka.ReactCurrentDispatcher,GN=ka.ReactCurrentOwner,hi=ka.ReactCurrentBatchConfig,ft=0,Hn=null,xn=null,dr=0,bs=0,dd=Pl(0),On=0,Qp=null,Hu=0,ub=0,HN=0,Ep=null,es=null,KN=0,Rd=1/0,Ho=null,P0=!1,cC=null,al=null,vv=!1,Qa=null,D0=0,Ap=0,dC=null,i0=-1,o0=0;function Lr(){return ft&6?hn():i0!==-1?i0:i0=hn()}function ll(t){return t.mode&1?ft&2&&dr!==0?dr&-dr:PZ.transition!==null?(o0===0&&(o0=c3()),o0):(t=St,t!==0||(t=window.event,t=t===void 0?16:y3(t.type)),t):1}function Ki(t,e,n,r){if(50<Ap)throw Ap=0,dC=null,Error(we(185));Pm(t,n,r),(!(ft&2)||t!==Hn)&&(t===Hn&&(!(ft&2)&&(ub|=n),On===4&&Xa(t,dr)),us(t,r),n===1&&ft===0&&!(e.mode&1)&&(Rd=hn()+500,ib&&Dl()))}function us(t,e){var n=t.callbackNode;P7(t,e);var r=y0(t,t===Hn?dr:0);if(r===0)n!==null&&nP(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&nP(n),e===1)t.tag===0?OZ(qP.bind(null,t)):L3(qP.bind(null,t)),IZ(function(){!(ft&6)&&Dl()}),n=null;else{switch(d3(r)){case 1:n=xN;break;case 4:n=l3;break;case 16:n=g0;break;case 536870912:n=u3;break;default:n=g0}n=Dz(n,Nz.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Nz(t,e){if(i0=-1,o0=0,ft&6)throw Error(we(327));var n=t.callbackNode;if(wd()&&t.callbackNode!==n)return null;var r=y0(t,t===Hn?dr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=R0(t,r);else{e=r;var s=ft;ft|=2;var i=$z();(Hn!==t||dr!==e)&&(Ho=null,Rd=hn()+500,Ou(t,e));do try{JZ();break}catch(a){Iz(t,a)}while(!0);ON(),O0.current=i,ft=s,xn!==null?e=0:(Hn=null,dr=0,e=On)}if(e!==0){if(e===2&&(s=Mk(t),s!==0&&(r=s,e=hC(t,s))),e===1)throw n=Qp,Ou(t,0),Xa(t,r),us(t,hn()),n;if(e===6)Xa(t,r);else{if(s=t.current.alternate,!(r&30)&&!YZ(s)&&(e=R0(t,r),e===2&&(i=Mk(t),i!==0&&(r=i,e=hC(t,i))),e===1))throw n=Qp,Ou(t,0),Xa(t,r),us(t,hn()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(we(345));case 2:lu(t,es,Ho);break;case 3:if(Xa(t,r),(r&130023424)===r&&(e=KN+500-hn(),10<e)){if(y0(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Lr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Hk(lu.bind(null,t,es,Ho),e);break}lu(t,es,Ho);break;case 4:if(Xa(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Hi(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=hn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ZZ(r/1960))-r,10<r){t.timeoutHandle=Hk(lu.bind(null,t,es,Ho),r);break}lu(t,es,Ho);break;case 5:lu(t,es,Ho);break;default:throw Error(we(329))}}}return us(t,hn()),t.callbackNode===n?Nz.bind(null,t):null}function hC(t,e){var n=Ep;return t.current.memoizedState.isDehydrated&&(Ou(t,e).flags|=256),t=R0(t,e),t!==2&&(e=es,es=n,e!==null&&fC(e)),t}function fC(t){es===null?es=t:es.push.apply(es,t)}function YZ(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Yi(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xa(t,e){for(e&=~HN,e&=~ub,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Hi(e),r=1<<n;t[n]=-1,e&=~r}}function qP(t){if(ft&6)throw Error(we(327));wd();var e=y0(t,0);if(!(e&1))return us(t,hn()),null;var n=R0(t,e);if(t.tag!==0&&n===2){var r=Mk(t);r!==0&&(e=r,n=hC(t,r))}if(n===1)throw n=Qp,Ou(t,0),Xa(t,e),us(t,hn()),n;if(n===6)throw Error(we(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,lu(t,es,Ho),us(t,hn()),null}function qN(t,e){var n=ft;ft|=1;try{return t(e)}finally{ft=n,ft===0&&(Rd=hn()+500,ib&&Dl())}}function Ku(t){Qa!==null&&Qa.tag===0&&!(ft&6)&&wd();var e=ft;ft|=1;var n=hi.transition,r=St;try{if(hi.transition=null,St=1,t)return t()}finally{St=r,hi.transition=n,ft=e,!(ft&6)&&Dl()}}function XN(){bs=dd.current,Mt(dd)}function Ou(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,NZ(n)),xn!==null)for(n=xn.return;n!==null;){var r=n;switch($N(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_0();break;case 3:Pd(),Mt(as),Mt(Nr),MN();break;case 5:FN(r);break;case 4:Pd();break;case 13:Mt(Zt);break;case 19:Mt(Zt);break;case 10:PN(r.type._context);break;case 22:case 23:XN()}n=n.return}if(Hn=t,xn=t=ul(t.current,null),dr=bs=e,On=0,Qp=null,HN=ub=Hu=0,es=Ep=null,_u!==null){for(e=0;e<_u.length;e++)if(n=_u[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}_u=null}return t}function Iz(t,e){do{var n=xn;try{if(ON(),n0.current=A0,E0){for(var r=Jt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}E0=!1}if(Gu=0,Wn=$n=Jt=null,Ip=!1,Xp=0,GN.current=null,n===null||n.return===null){On=1,Qp=e,xn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=dr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=RP(o);if(p!==null){p.flags&=-257,LP(p,o,a,i,e),p.mode&1&&DP(i,u,e),e=p,l=u;var m=e.updateQueue;if(m===null){var y=new Set;y.add(l),e.updateQueue=y}else m.add(l);break e}else{if(!(e&1)){DP(i,u,e),ZN();break e}l=Error(we(426))}}else if(Wt&&a.mode&1){var v=RP(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),LP(v,o,a,i,e),EN(Dd(l,a));break e}}i=l=Dd(l,a),On!==4&&(On=2),Ep===null?Ep=[i]:Ep.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=dz(i,l,e);IP(i,x);break e;case 1:a=l;var b=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(al===null||!al.has(_)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=hz(i,a,e);IP(i,S);break e}}i=i.return}while(i!==null)}Az(n)}catch(k){e=k,xn===n&&n!==null&&(xn=n=n.return);continue}break}while(!0)}function $z(){var t=O0.current;return O0.current=A0,t===null?A0:t}function ZN(){(On===0||On===3||On===2)&&(On=4),Hn===null||!(Hu&268435455)&&!(ub&268435455)||Xa(Hn,dr)}function R0(t,e){var n=ft;ft|=2;var r=$z();(Hn!==t||dr!==e)&&(Ho=null,Ou(t,e));do try{QZ();break}catch(s){Iz(t,s)}while(!0);if(ON(),ft=n,O0.current=r,xn!==null)throw Error(we(261));return Hn=null,dr=0,On}function QZ(){for(;xn!==null;)Ez(xn)}function JZ(){for(;xn!==null&&!k7();)Ez(xn)}function Ez(t){var e=Pz(t.alternate,t,bs);t.memoizedProps=t.pendingProps,e===null?Az(t):xn=e,GN.current=null}function Az(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=HZ(n,e),n!==null){n.flags&=32767,xn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{On=6,xn=null;return}}else if(n=GZ(n,e,bs),n!==null){xn=n;return}if(e=e.sibling,e!==null){xn=e;return}xn=e=t}while(e!==null);On===0&&(On=5)}function lu(t,e,n){var r=St,s=hi.transition;try{hi.transition=null,St=1,e9(t,e,n,r)}finally{hi.transition=s,St=r}return null}function e9(t,e,n,r){do wd();while(Qa!==null);if(ft&6)throw Error(we(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(we(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(D7(t,i),t===Hn&&(xn=Hn=null,dr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vv||(vv=!0,Dz(g0,function(){return wd(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=hi.transition,hi.transition=null;var o=St;St=1;var a=ft;ft|=4,GN.current=null,qZ(t,n),Cz(n,t),bZ(Uk),v0=!!Wk,Uk=Wk=null,t.current=n,XZ(n),C7(),ft=a,St=o,hi.transition=i}else t.current=n;if(vv&&(vv=!1,Qa=t,D0=s),i=t.pendingLanes,i===0&&(al=null),I7(n.stateNode),us(t,hn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(P0)throw P0=!1,t=cC,cC=null,t;return D0&1&&t.tag!==0&&wd(),i=t.pendingLanes,i&1?t===dC?Ap++:(Ap=0,dC=t):Ap=0,Dl(),null}function wd(){if(Qa!==null){var t=d3(D0),e=hi.transition,n=St;try{if(hi.transition=null,St=16>t?16:t,Qa===null)var r=!1;else{if(t=Qa,Qa=null,D0=0,ft&6)throw Error(we(331));var s=ft;for(ft|=4,Ee=t.current;Ee!==null;){var i=Ee,o=i.child;if(Ee.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Ee=u;Ee!==null;){var c=Ee;switch(c.tag){case 0:case 11:case 15:$p(8,c,i)}var d=c.child;if(d!==null)d.return=c,Ee=d;else for(;Ee!==null;){c=Ee;var f=c.sibling,p=c.return;if(_z(c),c===u){Ee=null;break}if(f!==null){f.return=p,Ee=f;break}Ee=p}}}var m=i.alternate;if(m!==null){var y=m.child;if(y!==null){m.child=null;do{var v=y.sibling;y.sibling=null,y=v}while(y!==null)}}Ee=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ee=o;else e:for(;Ee!==null;){if(i=Ee,i.flags&2048)switch(i.tag){case 0:case 11:case 15:$p(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Ee=x;break e}Ee=i.return}}var b=t.current;for(Ee=b;Ee!==null;){o=Ee;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,Ee=_;else e:for(o=b;Ee!==null;){if(a=Ee,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:lb(9,a)}}catch(k){nn(a,a.return,k)}if(a===o){Ee=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,Ee=S;break e}Ee=a.return}}if(ft=s,Dl(),So&&typeof So.onPostCommitFiberRoot=="function")try{So.onPostCommitFiberRoot(eb,t)}catch{}r=!0}return r}finally{St=n,hi.transition=e}}return!1}function XP(t,e,n){e=Dd(n,e),e=dz(t,e,1),t=ol(t,e,1),e=Lr(),t!==null&&(Pm(t,1,e),us(t,e))}function nn(t,e,n){if(t.tag===3)XP(t,t,n);else for(;e!==null;){if(e.tag===3){XP(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(al===null||!al.has(r))){t=Dd(n,t),t=hz(e,t,1),e=ol(e,t,1),t=Lr(),e!==null&&(Pm(e,1,t),us(e,t));break}}e=e.return}}function t9(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Lr(),t.pingedLanes|=t.suspendedLanes&n,Hn===t&&(dr&n)===n&&(On===4||On===3&&(dr&130023424)===dr&&500>hn()-KN?Ou(t,0):HN|=n),us(t,e)}function Oz(t,e){e===0&&(t.mode&1?(e=lv,lv<<=1,!(lv&130023424)&&(lv=4194304)):e=1);var n=Lr();t=ha(t,e),t!==null&&(Pm(t,e,n),us(t,n))}function n9(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Oz(t,n)}function r9(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(we(314))}r!==null&&r.delete(e),Oz(t,n)}var Pz;Pz=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||as.current)rs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return rs=!1,UZ(t,e,n);rs=!!(t.flags&131072)}else rs=!1,Wt&&e.flags&1048576&&F3(e,C0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;s0(t,e),t=e.pendingProps;var s=Ed(e,Nr.current);bd(e,n),s=BN(null,e,r,t,s,n);var i=jN();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ls(r)?(i=!0,S0(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,RN(e),s.updater=ab,e.stateNode=s,s._reactInternals=e,Jk(e,r,t,n),e=nC(null,e,r,!0,i,n)):(e.tag=0,Wt&&i&&IN(e),Or(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(s0(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=i9(r),t=Ri(r,t),s){case 0:e=tC(null,e,r,t,n);break e;case 1:e=zP(null,e,r,t,n);break e;case 11:e=FP(null,e,r,t,n);break e;case 14:e=MP(null,e,r,Ri(r.type,t),n);break e}throw Error(we(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ri(r,s),tC(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ri(r,s),zP(t,e,r,s,n);case 3:e:{if(gz(e),t===null)throw Error(we(387));r=e.pendingProps,i=e.memoizedState,s=i.element,W3(t,e),I0(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Dd(Error(we(423)),e),e=BP(t,e,r,n,s);break e}else if(r!==s){s=Dd(Error(we(424)),e),e=BP(t,e,r,n,s);break e}else for(Cs=il(e.stateNode.containerInfo.firstChild),Is=e,Wt=!0,Mi=null,n=j3(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ad(),r===s){e=fa(t,e,n);break e}Or(t,e,r,n)}e=e.child}return e;case 5:return U3(e),t===null&&Zk(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Gk(r,s)?o=null:i!==null&&Gk(r,i)&&(e.flags|=32),mz(t,e),Or(t,e,o,n),e.child;case 6:return t===null&&Zk(e),null;case 13:return yz(t,e,n);case 4:return LN(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Od(e,null,r,n):Or(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ri(r,s),FP(t,e,r,s,n);case 7:return Or(t,e,e.pendingProps,n),e.child;case 8:return Or(t,e,e.pendingProps.children,n),e.child;case 12:return Or(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Pt(T0,r._currentValue),r._currentValue=o,i!==null)if(Yi(i.value,o)){if(i.children===s.children&&!as.current){e=fa(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=oa(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Yk(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(we(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Yk(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Or(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,bd(e,n),s=pi(s),r=r(s),e.flags|=1,Or(t,e,r,n),e.child;case 14:return r=e.type,s=Ri(r,e.pendingProps),s=Ri(r.type,s),MP(t,e,r,s,n);case 15:return fz(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ri(r,s),s0(t,e),e.tag=1,ls(r)?(t=!0,S0(e)):t=!1,bd(e,n),cz(e,r,s),Jk(e,r,s,n),nC(null,e,r,!0,t,n);case 19:return vz(t,e,n);case 22:return pz(t,e,n)}throw Error(we(156,e.tag))};function Dz(t,e){return a3(t,e)}function s9(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ii(t,e,n,r){return new s9(t,e,n,r)}function YN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function i9(t){if(typeof t=="function")return YN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===gN)return 11;if(t===yN)return 14}return 2}function ul(t,e){var n=t.alternate;return n===null?(n=ii(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function a0(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")YN(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case td:return Pu(n.children,s,i,e);case mN:o=8,s|=8;break;case Sk:return t=ii(12,n,e,s|2),t.elementType=Sk,t.lanes=i,t;case kk:return t=ii(13,n,e,s),t.elementType=kk,t.lanes=i,t;case Ck:return t=ii(19,n,e,s),t.elementType=Ck,t.lanes=i,t;case UM:return cb(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case VM:o=10;break e;case WM:o=9;break e;case gN:o=11;break e;case yN:o=14;break e;case Ua:o=16,r=null;break e}throw Error(we(130,t==null?t:typeof t,""))}return e=ii(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Pu(t,e,n,r){return t=ii(7,t,r,e),t.lanes=n,t}function cb(t,e,n,r){return t=ii(22,t,r,e),t.elementType=UM,t.lanes=n,t.stateNode={isHidden:!1},t}function $S(t,e,n){return t=ii(6,t,null,e),t.lanes=n,t}function ES(t,e,n){return e=ii(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function o9(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cS(0),this.expirationTimes=cS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cS(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function QN(t,e,n,r,s,i,o,a,l){return t=new o9(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ii(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},RN(i),t}function a9(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ed,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Rz(t){if(!t)return gl;t=t._reactInternals;e:{if(gc(t)!==t||t.tag!==1)throw Error(we(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ls(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(we(171))}if(t.tag===1){var n=t.type;if(ls(n))return R3(t,n,e)}return e}function Lz(t,e,n,r,s,i,o,a,l){return t=QN(n,r,!0,t,s,i,o,a,l),t.context=Rz(null),n=t.current,r=Lr(),s=ll(n),i=oa(r,s),i.callback=e??null,ol(n,i,s),t.current.lanes=s,Pm(t,s,r),us(t,r),t}function db(t,e,n,r){var s=e.current,i=Lr(),o=ll(s);return n=Rz(n),e.context===null?e.context=n:e.pendingContext=n,e=oa(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ol(s,e,o),t!==null&&(Ki(t,s,o,i),t0(t,s,o)),o}function L0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ZP(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function JN(t,e){ZP(t,e),(t=t.alternate)&&ZP(t,e)}function l9(){return null}var Fz=typeof reportError=="function"?reportError:function(t){console.error(t)};function eI(t){this._internalRoot=t}hb.prototype.render=eI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(we(409));db(t,e,null,null)};hb.prototype.unmount=eI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ku(function(){db(null,t,null,null)}),e[da]=null}};function hb(t){this._internalRoot=t}hb.prototype.unstable_scheduleHydration=function(t){if(t){var e=p3();t={blockedOn:null,target:t,priority:e};for(var n=0;n<qa.length&&e!==0&&e<qa[n].priority;n++);qa.splice(n,0,t),n===0&&g3(t)}};function tI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function fb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function YP(){}function u9(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=L0(o);i.call(u)}}var o=Lz(e,r,t,0,null,!1,!1,"",YP);return t._reactRootContainer=o,t[da]=o.current,Up(t.nodeType===8?t.parentNode:t),Ku(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=L0(l);a.call(u)}}var l=QN(t,0,!1,null,null,!1,!1,"",YP);return t._reactRootContainer=l,t[da]=l.current,Up(t.nodeType===8?t.parentNode:t),Ku(function(){db(e,l,n,r)}),l}function pb(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=L0(o);a.call(l)}}db(e,o,t,s)}else o=u9(n,e,t,s,r);return L0(o)}h3=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=fp(e.pendingLanes);n!==0&&(bN(e,n|1),us(e,hn()),!(ft&6)&&(Rd=hn()+500,Dl()))}break;case 13:Ku(function(){var r=ha(t,1);if(r!==null){var s=Lr();Ki(r,t,1,s)}}),JN(t,1)}};wN=function(t){if(t.tag===13){var e=ha(t,134217728);if(e!==null){var n=Lr();Ki(e,t,134217728,n)}JN(t,134217728)}};f3=function(t){if(t.tag===13){var e=ll(t),n=ha(t,e);if(n!==null){var r=Lr();Ki(n,t,e,r)}JN(t,e)}};p3=function(){return St};m3=function(t,e){var n=St;try{return St=t,e()}finally{St=n}};Rk=function(t,e,n){switch(e){case"input":if(Ik(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=sb(r);if(!s)throw Error(we(90));HM(r),Ik(r,s)}}}break;case"textarea":qM(t,n);break;case"select":e=n.value,e!=null&&gd(t,!!n.multiple,e,!1)}};t3=qN;n3=Ku;var c9={usingClientEntryPoint:!1,Events:[Rm,id,sb,JM,e3,qN]},Qf={findFiberByHostInstance:wu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},d9={bundleType:Qf.bundleType,version:Qf.version,rendererPackageName:Qf.rendererPackageName,rendererConfig:Qf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ka.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=i3(t),t===null?null:t.stateNode},findFiberByHostInstance:Qf.findFiberByHostInstance||l9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xv.isDisabled&&xv.supportsFiber)try{eb=xv.inject(d9),So=xv}catch{}}Ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=c9;Ms.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tI(e))throw Error(we(200));return a9(t,e,null,n)};Ms.createRoot=function(t,e){if(!tI(t))throw Error(we(299));var n=!1,r="",s=Fz;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=QN(t,1,!1,null,null,n,!1,r,s),t[da]=e.current,Up(t.nodeType===8?t.parentNode:t),new eI(e)};Ms.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(we(188)):(t=Object.keys(t).join(","),Error(we(268,t)));return t=i3(e),t=t===null?null:t.stateNode,t};Ms.flushSync=function(t){return Ku(t)};Ms.hydrate=function(t,e,n){if(!fb(e))throw Error(we(200));return pb(null,t,e,!0,n)};Ms.hydrateRoot=function(t,e,n){if(!tI(t))throw Error(we(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Fz;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Lz(e,null,t,1,n??null,s,!1,i,o),t[da]=e.current,Up(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new hb(e)};Ms.render=function(t,e,n){if(!fb(e))throw Error(we(200));return pb(null,t,e,!1,n)};Ms.unmountComponentAtNode=function(t){if(!fb(t))throw Error(we(40));return t._reactRootContainer?(Ku(function(){pb(null,null,t,!1,function(){t._reactRootContainer=null,t[da]=null})}),!0):!1};Ms.unstable_batchedUpdates=qN;Ms.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!fb(n))throw Error(we(200));if(t==null||t._reactInternals===void 0)throw Error(we(38));return pb(t,e,n,!1,r)};Ms.version="18.3.1-next-f1338f8080-20240426";function Mz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Mz)}catch(t){console.error(t)}}Mz(),MM.exports=Ms;var mb=MM.exports,zz,QP=mb;zz=QP.createRoot,QP.hydrateRoot;function Bz(t,e){const n=E.useRef(e);E.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}const h9=1;function f9(t){return Object.freeze({__version:h9,map:t})}function p9(t,e){return Object.freeze({...t,...e})}const jz=E.createContext(null),Vz=jz.Provider;function Wz(){const t=E.useContext(jz);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function m9(t){function e(n,r){const{instance:s,context:i}=t(n).current;return E.useImperativeHandle(r,()=>s),n.children==null?null:Rp.createElement(Vz,{value:i},n.children)}return E.forwardRef(e)}function g9(t){function e(n,r){const[s,i]=E.useState(!1),{instance:o}=t(n,i).current;E.useImperativeHandle(r,()=>o),E.useEffect(function(){s&&o.update()},[o,s,n.children]);const a=o._contentNode;return a?mb.createPortal(n.children,a):null}return E.forwardRef(e)}function y9(t){function e(n,r){const{instance:s}=t(n).current;return E.useImperativeHandle(r,()=>s),null}return E.forwardRef(e)}function Uz(t,e){const n=E.useRef();E.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function nI(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function v9(t,e){return function(r,s){const i=Wz(),o=t(nI(r,i),i);return Bz(i.map,r.attribution),Uz(o.current,r.eventHandlers),e(o.current,i,r,s),o}}var pC={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(Sa,function(n){var r="1.9.4";function s(h){var g,w,C,I;for(w=1,C=arguments.length;w<C;w++){I=arguments[w];for(g in I)h[g]=I[g]}return h}var i=Object.create||function(){function h(){}return function(g){return h.prototype=g,new h}}();function o(h,g){var w=Array.prototype.slice;if(h.bind)return h.bind.apply(h,w.call(arguments,1));var C=w.call(arguments,2);return function(){return h.apply(g,C.length?C.concat(w.call(arguments)):arguments)}}var a=0;function l(h){return"_leaflet_id"in h||(h._leaflet_id=++a),h._leaflet_id}function u(h,g,w){var C,I,P,U;return U=function(){C=!1,I&&(P.apply(w,I),I=!1)},P=function(){C?I=arguments:(h.apply(w,arguments),setTimeout(U,g),C=!0)},P}function c(h,g,w){var C=g[1],I=g[0],P=C-I;return h===C&&w?h:((h-I)%P+P)%P+I}function d(){return!1}function f(h,g){if(g===!1)return h;var w=Math.pow(10,g===void 0?6:g);return Math.round(h*w)/w}function p(h){return h.trim?h.trim():h.replace(/^\s+|\s+$/g,"")}function m(h){return p(h).split(/\s+/)}function y(h,g){Object.prototype.hasOwnProperty.call(h,"options")||(h.options=h.options?i(h.options):{});for(var w in g)h.options[w]=g[w];return h.options}function v(h,g,w){var C=[];for(var I in h)C.push(encodeURIComponent(w?I.toUpperCase():I)+"="+encodeURIComponent(h[I]));return(!g||g.indexOf("?")===-1?"?":"&")+C.join("&")}var x=/\{ *([\w_ -]+) *\}/g;function b(h,g){return h.replace(x,function(w,C){var I=g[C];if(I===void 0)throw new Error("No value provided for variable "+w);return typeof I=="function"&&(I=I(g)),I})}var _=Array.isArray||function(h){return Object.prototype.toString.call(h)==="[object Array]"};function S(h,g){for(var w=0;w<h.length;w++)if(h[w]===g)return w;return-1}var k="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function T(h){return window["webkit"+h]||window["moz"+h]||window["ms"+h]}var $=0;function A(h){var g=+new Date,w=Math.max(0,16-(g-$));return $=g+w,window.setTimeout(h,w)}var D=window.requestAnimationFrame||T("RequestAnimationFrame")||A,F=window.cancelAnimationFrame||T("CancelAnimationFrame")||T("CancelRequestAnimationFrame")||function(h){window.clearTimeout(h)};function M(h,g,w){if(w&&D===A)h.call(g);else return D.call(window,o(h,g))}function j(h){h&&F.call(window,h)}var H={__proto__:null,extend:s,create:i,bind:o,get lastId(){return a},stamp:l,throttle:u,wrapNum:c,falseFn:d,formatNum:f,trim:p,splitWords:m,setOptions:y,getParamString:v,template:b,isArray:_,indexOf:S,emptyImageUrl:k,requestFn:D,cancelFn:F,requestAnimFrame:M,cancelAnimFrame:j};function K(){}K.extend=function(h){var g=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},w=g.__super__=this.prototype,C=i(w);C.constructor=g,g.prototype=C;for(var I in this)Object.prototype.hasOwnProperty.call(this,I)&&I!=="prototype"&&I!=="__super__"&&(g[I]=this[I]);return h.statics&&s(g,h.statics),h.includes&&(Q(h.includes),s.apply(null,[C].concat(h.includes))),s(C,h),delete C.statics,delete C.includes,C.options&&(C.options=w.options?i(w.options):{},s(C.options,h.options)),C._initHooks=[],C.callInitHooks=function(){if(!this._initHooksCalled){w.callInitHooks&&w.callInitHooks.call(this),this._initHooksCalled=!0;for(var P=0,U=C._initHooks.length;P<U;P++)C._initHooks[P].call(this)}},g},K.include=function(h){var g=this.prototype.options;return s(this.prototype,h),h.options&&(this.prototype.options=g,this.mergeOptions(h.options)),this},K.mergeOptions=function(h){return s(this.prototype.options,h),this},K.addInitHook=function(h){var g=Array.prototype.slice.call(arguments,1),w=typeof h=="function"?h:function(){this[h].apply(this,g)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(w),this};function Q(h){if(!(typeof L>"u"||!L||!L.Mixin)){h=_(h)?h:[h];for(var g=0;g<h.length;g++)h[g]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Z={on:function(h,g,w){if(typeof h=="object")for(var C in h)this._on(C,h[C],g);else{h=m(h);for(var I=0,P=h.length;I<P;I++)this._on(h[I],g,w)}return this},off:function(h,g,w){if(!arguments.length)delete this._events;else if(typeof h=="object")for(var C in h)this._off(C,h[C],g);else{h=m(h);for(var I=arguments.length===1,P=0,U=h.length;P<U;P++)I?this._off(h[P]):this._off(h[P],g,w)}return this},_on:function(h,g,w,C){if(typeof g!="function"){console.warn("wrong listener type: "+typeof g);return}if(this._listens(h,g,w)===!1){w===this&&(w=void 0);var I={fn:g,ctx:w};C&&(I.once=!0),this._events=this._events||{},this._events[h]=this._events[h]||[],this._events[h].push(I)}},_off:function(h,g,w){var C,I,P;if(this._events&&(C=this._events[h],!!C)){if(arguments.length===1){if(this._firingCount)for(I=0,P=C.length;I<P;I++)C[I].fn=d;delete this._events[h];return}if(typeof g!="function"){console.warn("wrong listener type: "+typeof g);return}var U=this._listens(h,g,w);if(U!==!1){var re=C[U];this._firingCount&&(re.fn=d,this._events[h]=C=C.slice()),C.splice(U,1)}}},fire:function(h,g,w){if(!this.listens(h,w))return this;var C=s({},g,{type:h,target:this,sourceTarget:g&&g.sourceTarget||this});if(this._events){var I=this._events[h];if(I){this._firingCount=this._firingCount+1||1;for(var P=0,U=I.length;P<U;P++){var re=I[P],ae=re.fn;re.once&&this.off(h,ae,re.ctx),ae.call(re.ctx||this,C)}this._firingCount--}}return w&&this._propagateEvent(C),this},listens:function(h,g,w,C){typeof h!="string"&&console.warn('"string" type argument expected');var I=g;typeof g!="function"&&(C=!!g,I=void 0,w=void 0);var P=this._events&&this._events[h];if(P&&P.length&&this._listens(h,I,w)!==!1)return!0;if(C){for(var U in this._eventParents)if(this._eventParents[U].listens(h,g,w,C))return!0}return!1},_listens:function(h,g,w){if(!this._events)return!1;var C=this._events[h]||[];if(!g)return!!C.length;w===this&&(w=void 0);for(var I=0,P=C.length;I<P;I++)if(C[I].fn===g&&C[I].ctx===w)return I;return!1},once:function(h,g,w){if(typeof h=="object")for(var C in h)this._on(C,h[C],g,!0);else{h=m(h);for(var I=0,P=h.length;I<P;I++)this._on(h[I],g,w,!0)}return this},addEventParent:function(h){return this._eventParents=this._eventParents||{},this._eventParents[l(h)]=h,this},removeEventParent:function(h){return this._eventParents&&delete this._eventParents[l(h)],this},_propagateEvent:function(h){for(var g in this._eventParents)this._eventParents[g].fire(h.type,s({layer:h.target,propagatedFrom:h.target},h),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var se=K.extend(Z);function B(h,g,w){this.x=w?Math.round(h):h,this.y=w?Math.round(g):g}var J=Math.trunc||function(h){return h>0?Math.floor(h):Math.ceil(h)};B.prototype={clone:function(){return new B(this.x,this.y)},add:function(h){return this.clone()._add(Y(h))},_add:function(h){return this.x+=h.x,this.y+=h.y,this},subtract:function(h){return this.clone()._subtract(Y(h))},_subtract:function(h){return this.x-=h.x,this.y-=h.y,this},divideBy:function(h){return this.clone()._divideBy(h)},_divideBy:function(h){return this.x/=h,this.y/=h,this},multiplyBy:function(h){return this.clone()._multiplyBy(h)},_multiplyBy:function(h){return this.x*=h,this.y*=h,this},scaleBy:function(h){return new B(this.x*h.x,this.y*h.y)},unscaleBy:function(h){return new B(this.x/h.x,this.y/h.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=J(this.x),this.y=J(this.y),this},distanceTo:function(h){h=Y(h);var g=h.x-this.x,w=h.y-this.y;return Math.sqrt(g*g+w*w)},equals:function(h){return h=Y(h),h.x===this.x&&h.y===this.y},contains:function(h){return h=Y(h),Math.abs(h.x)<=Math.abs(this.x)&&Math.abs(h.y)<=Math.abs(this.y)},toString:function(){return"Point("+f(this.x)+", "+f(this.y)+")"}};function Y(h,g,w){return h instanceof B?h:_(h)?new B(h[0],h[1]):h==null?h:typeof h=="object"&&"x"in h&&"y"in h?new B(h.x,h.y):new B(h,g,w)}function ie(h,g){if(h)for(var w=g?[h,g]:h,C=0,I=w.length;C<I;C++)this.extend(w[C])}ie.prototype={extend:function(h){var g,w;if(!h)return this;if(h instanceof B||typeof h[0]=="number"||"x"in h)g=w=Y(h);else if(h=ne(h),g=h.min,w=h.max,!g||!w)return this;return!this.min&&!this.max?(this.min=g.clone(),this.max=w.clone()):(this.min.x=Math.min(g.x,this.min.x),this.max.x=Math.max(w.x,this.max.x),this.min.y=Math.min(g.y,this.min.y),this.max.y=Math.max(w.y,this.max.y)),this},getCenter:function(h){return Y((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,h)},getBottomLeft:function(){return Y(this.min.x,this.max.y)},getTopRight:function(){return Y(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(h){var g,w;return typeof h[0]=="number"||h instanceof B?h=Y(h):h=ne(h),h instanceof ie?(g=h.min,w=h.max):g=w=h,g.x>=this.min.x&&w.x<=this.max.x&&g.y>=this.min.y&&w.y<=this.max.y},intersects:function(h){h=ne(h);var g=this.min,w=this.max,C=h.min,I=h.max,P=I.x>=g.x&&C.x<=w.x,U=I.y>=g.y&&C.y<=w.y;return P&&U},overlaps:function(h){h=ne(h);var g=this.min,w=this.max,C=h.min,I=h.max,P=I.x>g.x&&C.x<w.x,U=I.y>g.y&&C.y<w.y;return P&&U},isValid:function(){return!!(this.min&&this.max)},pad:function(h){var g=this.min,w=this.max,C=Math.abs(g.x-w.x)*h,I=Math.abs(g.y-w.y)*h;return ne(Y(g.x-C,g.y-I),Y(w.x+C,w.y+I))},equals:function(h){return h?(h=ne(h),this.min.equals(h.getTopLeft())&&this.max.equals(h.getBottomRight())):!1}};function ne(h,g){return!h||h instanceof ie?h:new ie(h,g)}function pe(h,g){if(h)for(var w=g?[h,g]:h,C=0,I=w.length;C<I;C++)this.extend(w[C])}pe.prototype={extend:function(h){var g=this._southWest,w=this._northEast,C,I;if(h instanceof de)C=h,I=h;else if(h instanceof pe){if(C=h._southWest,I=h._northEast,!C||!I)return this}else return h?this.extend(fe(h)||me(h)):this;return!g&&!w?(this._southWest=new de(C.lat,C.lng),this._northEast=new de(I.lat,I.lng)):(g.lat=Math.min(C.lat,g.lat),g.lng=Math.min(C.lng,g.lng),w.lat=Math.max(I.lat,w.lat),w.lng=Math.max(I.lng,w.lng)),this},pad:function(h){var g=this._southWest,w=this._northEast,C=Math.abs(g.lat-w.lat)*h,I=Math.abs(g.lng-w.lng)*h;return new pe(new de(g.lat-C,g.lng-I),new de(w.lat+C,w.lng+I))},getCenter:function(){return new de((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new de(this.getNorth(),this.getWest())},getSouthEast:function(){return new de(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(h){typeof h[0]=="number"||h instanceof de||"lat"in h?h=fe(h):h=me(h);var g=this._southWest,w=this._northEast,C,I;return h instanceof pe?(C=h.getSouthWest(),I=h.getNorthEast()):C=I=h,C.lat>=g.lat&&I.lat<=w.lat&&C.lng>=g.lng&&I.lng<=w.lng},intersects:function(h){h=me(h);var g=this._southWest,w=this._northEast,C=h.getSouthWest(),I=h.getNorthEast(),P=I.lat>=g.lat&&C.lat<=w.lat,U=I.lng>=g.lng&&C.lng<=w.lng;return P&&U},overlaps:function(h){h=me(h);var g=this._southWest,w=this._northEast,C=h.getSouthWest(),I=h.getNorthEast(),P=I.lat>g.lat&&C.lat<w.lat,U=I.lng>g.lng&&C.lng<w.lng;return P&&U},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(h,g){return h?(h=me(h),this._southWest.equals(h.getSouthWest(),g)&&this._northEast.equals(h.getNorthEast(),g)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function me(h,g){return h instanceof pe?h:new pe(h,g)}function de(h,g,w){if(isNaN(h)||isNaN(g))throw new Error("Invalid LatLng object: ("+h+", "+g+")");this.lat=+h,this.lng=+g,w!==void 0&&(this.alt=+w)}de.prototype={equals:function(h,g){if(!h)return!1;h=fe(h);var w=Math.max(Math.abs(this.lat-h.lat),Math.abs(this.lng-h.lng));return w<=(g===void 0?1e-9:g)},toString:function(h){return"LatLng("+f(this.lat,h)+", "+f(this.lng,h)+")"},distanceTo:function(h){return _e.distance(this,fe(h))},wrap:function(){return _e.wrapLatLng(this)},toBounds:function(h){var g=180*h/40075017,w=g/Math.cos(Math.PI/180*this.lat);return me([this.lat-g,this.lng-w],[this.lat+g,this.lng+w])},clone:function(){return new de(this.lat,this.lng,this.alt)}};function fe(h,g,w){return h instanceof de?h:_(h)&&typeof h[0]!="object"?h.length===3?new de(h[0],h[1],h[2]):h.length===2?new de(h[0],h[1]):null:h==null?h:typeof h=="object"&&"lat"in h?new de(h.lat,"lng"in h?h.lng:h.lon,h.alt):g===void 0?null:new de(h,g,w)}var ke={latLngToPoint:function(h,g){var w=this.projection.project(h),C=this.scale(g);return this.transformation._transform(w,C)},pointToLatLng:function(h,g){var w=this.scale(g),C=this.transformation.untransform(h,w);return this.projection.unproject(C)},project:function(h){return this.projection.project(h)},unproject:function(h){return this.projection.unproject(h)},scale:function(h){return 256*Math.pow(2,h)},zoom:function(h){return Math.log(h/256)/Math.LN2},getProjectedBounds:function(h){if(this.infinite)return null;var g=this.projection.bounds,w=this.scale(h),C=this.transformation.transform(g.min,w),I=this.transformation.transform(g.max,w);return new ie(C,I)},infinite:!1,wrapLatLng:function(h){var g=this.wrapLng?c(h.lng,this.wrapLng,!0):h.lng,w=this.wrapLat?c(h.lat,this.wrapLat,!0):h.lat,C=h.alt;return new de(w,g,C)},wrapLatLngBounds:function(h){var g=h.getCenter(),w=this.wrapLatLng(g),C=g.lat-w.lat,I=g.lng-w.lng;if(C===0&&I===0)return h;var P=h.getSouthWest(),U=h.getNorthEast(),re=new de(P.lat-C,P.lng-I),ae=new de(U.lat-C,U.lng-I);return new pe(re,ae)}},_e=s({},ke,{wrapLng:[-180,180],R:6371e3,distance:function(h,g){var w=Math.PI/180,C=h.lat*w,I=g.lat*w,P=Math.sin((g.lat-h.lat)*w/2),U=Math.sin((g.lng-h.lng)*w/2),re=P*P+Math.cos(C)*Math.cos(I)*U*U,ae=2*Math.atan2(Math.sqrt(re),Math.sqrt(1-re));return this.R*ae}}),ue=6378137,be={R:ue,MAX_LATITUDE:85.0511287798,project:function(h){var g=Math.PI/180,w=this.MAX_LATITUDE,C=Math.max(Math.min(w,h.lat),-w),I=Math.sin(C*g);return new B(this.R*h.lng*g,this.R*Math.log((1+I)/(1-I))/2)},unproject:function(h){var g=180/Math.PI;return new de((2*Math.atan(Math.exp(h.y/this.R))-Math.PI/2)*g,h.x*g/this.R)},bounds:function(){var h=ue*Math.PI;return new ie([-h,-h],[h,h])}()};function xe(h,g,w,C){if(_(h)){this._a=h[0],this._b=h[1],this._c=h[2],this._d=h[3];return}this._a=h,this._b=g,this._c=w,this._d=C}xe.prototype={transform:function(h,g){return this._transform(h.clone(),g)},_transform:function(h,g){return g=g||1,h.x=g*(this._a*h.x+this._b),h.y=g*(this._c*h.y+this._d),h},untransform:function(h,g){return g=g||1,new B((h.x/g-this._b)/this._a,(h.y/g-this._d)/this._c)}};function le(h,g,w,C){return new xe(h,g,w,C)}var Me=s({},_e,{code:"EPSG:3857",projection:be,transformation:function(){var h=.5/(Math.PI*be.R);return le(h,.5,-h,.5)}()}),Be=s({},Me,{code:"EPSG:900913"});function He(h){return document.createElementNS("http://www.w3.org/2000/svg",h)}function Ge(h,g){var w="",C,I,P,U,re,ae;for(C=0,P=h.length;C<P;C++){for(re=h[C],I=0,U=re.length;I<U;I++)ae=re[I],w+=(I?"L":"M")+ae.x+" "+ae.y;w+=g?Ve.svg?"z":"x":""}return w||"M0 0"}var lt=document.documentElement.style,ht="ActiveXObject"in window,Ti=ht&&!document.addEventListener,un="msLaunchUri"in navigator&&!("documentMode"in document),Ws=uo("webkit"),mr=uo("android"),lo=uo("android 2")||uo("android 3"),ys=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ni=mr&&uo("Google")&&ys<537&&!("AudioNode"in window),Us=!!window.opera,Ii=!un&&uo("chrome"),$i=uo("gecko")&&!Ws&&!Us&&!ht,Yl=!Ii&&uo("safari"),Fc=uo("phantom"),Mc="OTransition"in lt,A_=navigator.platform.indexOf("Win")===0,Ql=ht&&"transition"in lt,Ef="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!lo,My="MozPerspective"in lt,bq=!window.L_DISABLE_3D&&(Ql||Ef||My)&&!Mc&&!Fc,Af=typeof orientation<"u"||uo("mobile"),wq=Af&&Ws,_q=Af&&Ef,HA=!window.PointerEvent&&window.MSPointerEvent,KA=!!(window.PointerEvent||HA),qA="ontouchstart"in window||!!window.TouchEvent,Sq=!window.L_NO_TOUCH&&(qA||KA),kq=Af&&Us,Cq=Af&&$i,Tq=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Nq=function(){var h=!1;try{var g=Object.defineProperty({},"passive",{get:function(){h=!0}});window.addEventListener("testPassiveEventSupport",d,g),window.removeEventListener("testPassiveEventSupport",d,g)}catch{}return h}(),Iq=function(){return!!document.createElement("canvas").getContext}(),O_=!!(document.createElementNS&&He("svg").createSVGRect),$q=!!O_&&function(){var h=document.createElement("div");return h.innerHTML="<svg/>",(h.firstChild&&h.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Eq=!O_&&function(){try{var h=document.createElement("div");h.innerHTML='<v:shape adj="1"/>';var g=h.firstChild;return g.style.behavior="url(#default#VML)",g&&typeof g.adj=="object"}catch{return!1}}(),Aq=navigator.platform.indexOf("Mac")===0,Oq=navigator.platform.indexOf("Linux")===0;function uo(h){return navigator.userAgent.toLowerCase().indexOf(h)>=0}var Ve={ie:ht,ielt9:Ti,edge:un,webkit:Ws,android:mr,android23:lo,androidStock:Ni,opera:Us,chrome:Ii,gecko:$i,safari:Yl,phantom:Fc,opera12:Mc,win:A_,ie3d:Ql,webkit3d:Ef,gecko3d:My,any3d:bq,mobile:Af,mobileWebkit:wq,mobileWebkit3d:_q,msPointer:HA,pointer:KA,touch:Sq,touchNative:qA,mobileOpera:kq,mobileGecko:Cq,retina:Tq,passiveEvents:Nq,canvas:Iq,svg:O_,vml:Eq,inlineSvg:$q,mac:Aq,linux:Oq},XA=Ve.msPointer?"MSPointerDown":"pointerdown",ZA=Ve.msPointer?"MSPointerMove":"pointermove",YA=Ve.msPointer?"MSPointerUp":"pointerup",QA=Ve.msPointer?"MSPointerCancel":"pointercancel",P_={touchstart:XA,touchmove:ZA,touchend:YA,touchcancel:QA},JA={touchstart:Mq,touchmove:zy,touchend:zy,touchcancel:zy},zc={},eO=!1;function Pq(h,g,w){return g==="touchstart"&&Fq(),JA[g]?(w=JA[g].bind(this,w),h.addEventListener(P_[g],w,!1),w):(console.warn("wrong event specified:",g),d)}function Dq(h,g,w){if(!P_[g]){console.warn("wrong event specified:",g);return}h.removeEventListener(P_[g],w,!1)}function Rq(h){zc[h.pointerId]=h}function Lq(h){zc[h.pointerId]&&(zc[h.pointerId]=h)}function tO(h){delete zc[h.pointerId]}function Fq(){eO||(document.addEventListener(XA,Rq,!0),document.addEventListener(ZA,Lq,!0),document.addEventListener(YA,tO,!0),document.addEventListener(QA,tO,!0),eO=!0)}function zy(h,g){if(g.pointerType!==(g.MSPOINTER_TYPE_MOUSE||"mouse")){g.touches=[];for(var w in zc)g.touches.push(zc[w]);g.changedTouches=[g],h(g)}}function Mq(h,g){g.MSPOINTER_TYPE_TOUCH&&g.pointerType===g.MSPOINTER_TYPE_TOUCH&&sr(g),zy(h,g)}function zq(h){var g={},w,C;for(C in h)w=h[C],g[C]=w&&w.bind?w.bind(h):w;return h=g,g.type="dblclick",g.detail=2,g.isTrusted=!1,g._simulated=!0,g}var Bq=200;function jq(h,g){h.addEventListener("dblclick",g);var w=0,C;function I(P){if(P.detail!==1){C=P.detail;return}if(!(P.pointerType==="mouse"||P.sourceCapabilities&&!P.sourceCapabilities.firesTouchEvents)){var U=oO(P);if(!(U.some(function(ae){return ae instanceof HTMLLabelElement&&ae.attributes.for})&&!U.some(function(ae){return ae instanceof HTMLInputElement||ae instanceof HTMLSelectElement}))){var re=Date.now();re-w<=Bq?(C++,C===2&&g(zq(P))):C=1,w=re}}}return h.addEventListener("click",I),{dblclick:g,simDblclick:I}}function Vq(h,g){h.removeEventListener("dblclick",g.dblclick),h.removeEventListener("click",g.simDblclick)}var D_=Vy(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Of=Vy(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),nO=Of==="webkitTransition"||Of==="OTransition"?Of+"End":"transitionend";function rO(h){return typeof h=="string"?document.getElementById(h):h}function Pf(h,g){var w=h.style[g]||h.currentStyle&&h.currentStyle[g];if((!w||w==="auto")&&document.defaultView){var C=document.defaultView.getComputedStyle(h,null);w=C?C[g]:null}return w==="auto"?null:w}function pt(h,g,w){var C=document.createElement(h);return C.className=g||"",w&&w.appendChild(C),C}function Xt(h){var g=h.parentNode;g&&g.removeChild(h)}function By(h){for(;h.firstChild;)h.removeChild(h.firstChild)}function Bc(h){var g=h.parentNode;g&&g.lastChild!==h&&g.appendChild(h)}function jc(h){var g=h.parentNode;g&&g.firstChild!==h&&g.insertBefore(h,g.firstChild)}function R_(h,g){if(h.classList!==void 0)return h.classList.contains(g);var w=jy(h);return w.length>0&&new RegExp("(^|\\s)"+g+"(\\s|$)").test(w)}function et(h,g){if(h.classList!==void 0)for(var w=m(g),C=0,I=w.length;C<I;C++)h.classList.add(w[C]);else if(!R_(h,g)){var P=jy(h);L_(h,(P?P+" ":"")+g)}}function cn(h,g){h.classList!==void 0?h.classList.remove(g):L_(h,p((" "+jy(h)+" ").replace(" "+g+" "," ")))}function L_(h,g){h.className.baseVal===void 0?h.className=g:h.className.baseVal=g}function jy(h){return h.correspondingElement&&(h=h.correspondingElement),h.className.baseVal===void 0?h.className:h.className.baseVal}function Gs(h,g){"opacity"in h.style?h.style.opacity=g:"filter"in h.style&&Wq(h,g)}function Wq(h,g){var w=!1,C="DXImageTransform.Microsoft.Alpha";try{w=h.filters.item(C)}catch{if(g===1)return}g=Math.round(g*100),w?(w.Enabled=g!==100,w.Opacity=g):h.style.filter+=" progid:"+C+"(opacity="+g+")"}function Vy(h){for(var g=document.documentElement.style,w=0;w<h.length;w++)if(h[w]in g)return h[w];return!1}function Jl(h,g,w){var C=g||new B(0,0);h.style[D_]=(Ve.ie3d?"translate("+C.x+"px,"+C.y+"px)":"translate3d("+C.x+"px,"+C.y+"px,0)")+(w?" scale("+w+")":"")}function yn(h,g){h._leaflet_pos=g,Ve.any3d?Jl(h,g):(h.style.left=g.x+"px",h.style.top=g.y+"px")}function eu(h){return h._leaflet_pos||new B(0,0)}var Df,Rf,F_;if("onselectstart"in document)Df=function(){Xe(window,"selectstart",sr)},Rf=function(){At(window,"selectstart",sr)};else{var Lf=Vy(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Df=function(){if(Lf){var h=document.documentElement.style;F_=h[Lf],h[Lf]="none"}},Rf=function(){Lf&&(document.documentElement.style[Lf]=F_,F_=void 0)}}function M_(){Xe(window,"dragstart",sr)}function z_(){At(window,"dragstart",sr)}var Wy,B_;function j_(h){for(;h.tabIndex===-1;)h=h.parentNode;h.style&&(Uy(),Wy=h,B_=h.style.outlineStyle,h.style.outlineStyle="none",Xe(window,"keydown",Uy))}function Uy(){Wy&&(Wy.style.outlineStyle=B_,Wy=void 0,B_=void 0,At(window,"keydown",Uy))}function sO(h){do h=h.parentNode;while((!h.offsetWidth||!h.offsetHeight)&&h!==document.body);return h}function V_(h){var g=h.getBoundingClientRect();return{x:g.width/h.offsetWidth||1,y:g.height/h.offsetHeight||1,boundingClientRect:g}}var Uq={__proto__:null,TRANSFORM:D_,TRANSITION:Of,TRANSITION_END:nO,get:rO,getStyle:Pf,create:pt,remove:Xt,empty:By,toFront:Bc,toBack:jc,hasClass:R_,addClass:et,removeClass:cn,setClass:L_,getClass:jy,setOpacity:Gs,testProp:Vy,setTransform:Jl,setPosition:yn,getPosition:eu,get disableTextSelection(){return Df},get enableTextSelection(){return Rf},disableImageDrag:M_,enableImageDrag:z_,preventOutline:j_,restoreOutline:Uy,getSizedParentNode:sO,getScale:V_};function Xe(h,g,w,C){if(g&&typeof g=="object")for(var I in g)U_(h,I,g[I],w);else{g=m(g);for(var P=0,U=g.length;P<U;P++)U_(h,g[P],w,C)}return this}var co="_leaflet_events";function At(h,g,w,C){if(arguments.length===1)iO(h),delete h[co];else if(g&&typeof g=="object")for(var I in g)G_(h,I,g[I],w);else if(g=m(g),arguments.length===2)iO(h,function(re){return S(g,re)!==-1});else for(var P=0,U=g.length;P<U;P++)G_(h,g[P],w,C);return this}function iO(h,g){for(var w in h[co]){var C=w.split(/\d/)[0];(!g||g(C))&&G_(h,C,null,null,w)}}var W_={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function U_(h,g,w,C){var I=g+l(w)+(C?"_"+l(C):"");if(h[co]&&h[co][I])return this;var P=function(re){return w.call(C||h,re||window.event)},U=P;!Ve.touchNative&&Ve.pointer&&g.indexOf("touch")===0?P=Pq(h,g,P):Ve.touch&&g==="dblclick"?P=jq(h,P):"addEventListener"in h?g==="touchstart"||g==="touchmove"||g==="wheel"||g==="mousewheel"?h.addEventListener(W_[g]||g,P,Ve.passiveEvents?{passive:!1}:!1):g==="mouseenter"||g==="mouseleave"?(P=function(re){re=re||window.event,K_(h,re)&&U(re)},h.addEventListener(W_[g],P,!1)):h.addEventListener(g,U,!1):h.attachEvent("on"+g,P),h[co]=h[co]||{},h[co][I]=P}function G_(h,g,w,C,I){I=I||g+l(w)+(C?"_"+l(C):"");var P=h[co]&&h[co][I];if(!P)return this;!Ve.touchNative&&Ve.pointer&&g.indexOf("touch")===0?Dq(h,g,P):Ve.touch&&g==="dblclick"?Vq(h,P):"removeEventListener"in h?h.removeEventListener(W_[g]||g,P,!1):h.detachEvent("on"+g,P),h[co][I]=null}function tu(h){return h.stopPropagation?h.stopPropagation():h.originalEvent?h.originalEvent._stopped=!0:h.cancelBubble=!0,this}function H_(h){return U_(h,"wheel",tu),this}function Ff(h){return Xe(h,"mousedown touchstart dblclick contextmenu",tu),h._leaflet_disable_click=!0,this}function sr(h){return h.preventDefault?h.preventDefault():h.returnValue=!1,this}function nu(h){return sr(h),tu(h),this}function oO(h){if(h.composedPath)return h.composedPath();for(var g=[],w=h.target;w;)g.push(w),w=w.parentNode;return g}function aO(h,g){if(!g)return new B(h.clientX,h.clientY);var w=V_(g),C=w.boundingClientRect;return new B((h.clientX-C.left)/w.x-g.clientLeft,(h.clientY-C.top)/w.y-g.clientTop)}var Gq=Ve.linux&&Ve.chrome?window.devicePixelRatio:Ve.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function lO(h){return Ve.edge?h.wheelDeltaY/2:h.deltaY&&h.deltaMode===0?-h.deltaY/Gq:h.deltaY&&h.deltaMode===1?-h.deltaY*20:h.deltaY&&h.deltaMode===2?-h.deltaY*60:h.deltaX||h.deltaZ?0:h.wheelDelta?(h.wheelDeltaY||h.wheelDelta)/2:h.detail&&Math.abs(h.detail)<32765?-h.detail*20:h.detail?h.detail/-32765*60:0}function K_(h,g){var w=g.relatedTarget;if(!w)return!0;try{for(;w&&w!==h;)w=w.parentNode}catch{return!1}return w!==h}var Hq={__proto__:null,on:Xe,off:At,stopPropagation:tu,disableScrollPropagation:H_,disableClickPropagation:Ff,preventDefault:sr,stop:nu,getPropagationPath:oO,getMousePosition:aO,getWheelDelta:lO,isExternalTarget:K_,addListener:Xe,removeListener:At},uO=se.extend({run:function(h,g,w,C){this.stop(),this._el=h,this._inProgress=!0,this._duration=w||.25,this._easeOutPower=1/Math.max(C||.5,.2),this._startPos=eu(h),this._offset=g.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=M(this._animate,this),this._step()},_step:function(h){var g=+new Date-this._startTime,w=this._duration*1e3;g<w?this._runFrame(this._easeOut(g/w),h):(this._runFrame(1),this._complete())},_runFrame:function(h,g){var w=this._startPos.add(this._offset.multiplyBy(h));g&&w._round(),yn(this._el,w),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(h){return 1-Math.pow(1-h,this._easeOutPower)}}),ct=se.extend({options:{crs:Me,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(h,g){g=y(this,g),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(h),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),g.maxBounds&&this.setMaxBounds(g.maxBounds),g.zoom!==void 0&&(this._zoom=this._limitZoom(g.zoom)),g.center&&g.zoom!==void 0&&this.setView(fe(g.center),g.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Of&&Ve.any3d&&!Ve.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Xe(this._proxy,nO,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(h,g,w){if(g=g===void 0?this._zoom:this._limitZoom(g),h=this._limitCenter(fe(h),g,this.options.maxBounds),w=w||{},this._stop(),this._loaded&&!w.reset&&w!==!0){w.animate!==void 0&&(w.zoom=s({animate:w.animate},w.zoom),w.pan=s({animate:w.animate,duration:w.duration},w.pan));var C=this._zoom!==g?this._tryAnimatedZoom&&this._tryAnimatedZoom(h,g,w.zoom):this._tryAnimatedPan(h,w.pan);if(C)return clearTimeout(this._sizeTimer),this}return this._resetView(h,g,w.pan&&w.pan.noMoveStart),this},setZoom:function(h,g){return this._loaded?this.setView(this.getCenter(),h,{zoom:g}):(this._zoom=h,this)},zoomIn:function(h,g){return h=h||(Ve.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+h,g)},zoomOut:function(h,g){return h=h||(Ve.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-h,g)},setZoomAround:function(h,g,w){var C=this.getZoomScale(g),I=this.getSize().divideBy(2),P=h instanceof B?h:this.latLngToContainerPoint(h),U=P.subtract(I).multiplyBy(1-1/C),re=this.containerPointToLatLng(I.add(U));return this.setView(re,g,{zoom:w})},_getBoundsCenterZoom:function(h,g){g=g||{},h=h.getBounds?h.getBounds():me(h);var w=Y(g.paddingTopLeft||g.padding||[0,0]),C=Y(g.paddingBottomRight||g.padding||[0,0]),I=this.getBoundsZoom(h,!1,w.add(C));if(I=typeof g.maxZoom=="number"?Math.min(g.maxZoom,I):I,I===1/0)return{center:h.getCenter(),zoom:I};var P=C.subtract(w).divideBy(2),U=this.project(h.getSouthWest(),I),re=this.project(h.getNorthEast(),I),ae=this.unproject(U.add(re).divideBy(2).add(P),I);return{center:ae,zoom:I}},fitBounds:function(h,g){if(h=me(h),!h.isValid())throw new Error("Bounds are not valid.");var w=this._getBoundsCenterZoom(h,g);return this.setView(w.center,w.zoom,g)},fitWorld:function(h){return this.fitBounds([[-90,-180],[90,180]],h)},panTo:function(h,g){return this.setView(h,this._zoom,{pan:g})},panBy:function(h,g){if(h=Y(h).round(),g=g||{},!h.x&&!h.y)return this.fire("moveend");if(g.animate!==!0&&!this.getSize().contains(h))return this._resetView(this.unproject(this.project(this.getCenter()).add(h)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new uO,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),g.noMoveStart||this.fire("movestart"),g.animate!==!1){et(this._mapPane,"leaflet-pan-anim");var w=this._getMapPanePos().subtract(h).round();this._panAnim.run(this._mapPane,w,g.duration||.25,g.easeLinearity)}else this._rawPanBy(h),this.fire("move").fire("moveend");return this},flyTo:function(h,g,w){if(w=w||{},w.animate===!1||!Ve.any3d)return this.setView(h,g,w);this._stop();var C=this.project(this.getCenter()),I=this.project(h),P=this.getSize(),U=this._zoom;h=fe(h),g=g===void 0?U:g;var re=Math.max(P.x,P.y),ae=re*this.getZoomScale(U,g),ve=I.distanceTo(C)||1,$e=1.42,Ue=$e*$e;function rt(vn){var nv=vn?-1:1,DX=vn?ae:re,RX=ae*ae-re*re+nv*Ue*Ue*ve*ve,LX=2*DX*Ue*ve,sS=RX/LX,WO=Math.sqrt(sS*sS+1)-sS,FX=WO<1e-9?-18:Math.log(WO);return FX}function Ar(vn){return(Math.exp(vn)-Math.exp(-vn))/2}function jn(vn){return(Math.exp(vn)+Math.exp(-vn))/2}function Ks(vn){return Ar(vn)/jn(vn)}var Xr=rt(0);function Kc(vn){return re*(jn(Xr)/jn(Xr+$e*vn))}function EX(vn){return re*(jn(Xr)*Ks(Xr+$e*vn)-Ar(Xr))/Ue}function AX(vn){return 1-Math.pow(1-vn,1.5)}var OX=Date.now(),jO=(rt(1)-Xr)/$e,PX=w.duration?1e3*w.duration:1e3*jO*.8;function VO(){var vn=(Date.now()-OX)/PX,nv=AX(vn)*jO;vn<=1?(this._flyToFrame=M(VO,this),this._move(this.unproject(C.add(I.subtract(C).multiplyBy(EX(nv)/ve)),U),this.getScaleZoom(re/Kc(nv),U),{flyTo:!0})):this._move(h,g)._moveEnd(!0)}return this._moveStart(!0,w.noMoveStart),VO.call(this),this},flyToBounds:function(h,g){var w=this._getBoundsCenterZoom(h,g);return this.flyTo(w.center,w.zoom,g)},setMaxBounds:function(h){return h=me(h),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),h.isValid()?(this.options.maxBounds=h,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(h){var g=this.options.minZoom;return this.options.minZoom=h,this._loaded&&g!==h&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(h):this},setMaxZoom:function(h){var g=this.options.maxZoom;return this.options.maxZoom=h,this._loaded&&g!==h&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(h):this},panInsideBounds:function(h,g){this._enforcingBounds=!0;var w=this.getCenter(),C=this._limitCenter(w,this._zoom,me(h));return w.equals(C)||this.panTo(C,g),this._enforcingBounds=!1,this},panInside:function(h,g){g=g||{};var w=Y(g.paddingTopLeft||g.padding||[0,0]),C=Y(g.paddingBottomRight||g.padding||[0,0]),I=this.project(this.getCenter()),P=this.project(h),U=this.getPixelBounds(),re=ne([U.min.add(w),U.max.subtract(C)]),ae=re.getSize();if(!re.contains(P)){this._enforcingBounds=!0;var ve=P.subtract(re.getCenter()),$e=re.extend(P).getSize().subtract(ae);I.x+=ve.x<0?-$e.x:$e.x,I.y+=ve.y<0?-$e.y:$e.y,this.panTo(this.unproject(I),g),this._enforcingBounds=!1}return this},invalidateSize:function(h){if(!this._loaded)return this;h=s({animate:!1,pan:!0},h===!0?{animate:!0}:h);var g=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var w=this.getSize(),C=g.divideBy(2).round(),I=w.divideBy(2).round(),P=C.subtract(I);return!P.x&&!P.y?this:(h.animate&&h.pan?this.panBy(P):(h.pan&&this._rawPanBy(P),this.fire("move"),h.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:g,newSize:w}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(h){if(h=this._locateOptions=s({timeout:1e4,watch:!1},h),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var g=o(this._handleGeolocationResponse,this),w=o(this._handleGeolocationError,this);return h.watch?this._locationWatchId=navigator.geolocation.watchPosition(g,w,h):navigator.geolocation.getCurrentPosition(g,w,h),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(h){if(this._container._leaflet_id){var g=h.code,w=h.message||(g===1?"permission denied":g===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:g,message:"Geolocation error: "+w+"."})}},_handleGeolocationResponse:function(h){if(this._container._leaflet_id){var g=h.coords.latitude,w=h.coords.longitude,C=new de(g,w),I=C.toBounds(h.coords.accuracy*2),P=this._locateOptions;if(P.setView){var U=this.getBoundsZoom(I);this.setView(C,P.maxZoom?Math.min(U,P.maxZoom):U)}var re={latlng:C,bounds:I,timestamp:h.timestamp};for(var ae in h.coords)typeof h.coords[ae]=="number"&&(re[ae]=h.coords[ae]);this.fire("locationfound",re)}},addHandler:function(h,g){if(!g)return this;var w=this[h]=new g(this);return this._handlers.push(w),this.options[h]&&w.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Xt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var h;for(h in this._layers)this._layers[h].remove();for(h in this._panes)Xt(this._panes[h]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(h,g){var w="leaflet-pane"+(h?" leaflet-"+h.replace("Pane","")+"-pane":""),C=pt("div",w,g||this._mapPane);return h&&(this._panes[h]=C),C},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var h=this.getPixelBounds(),g=this.unproject(h.getBottomLeft()),w=this.unproject(h.getTopRight());return new pe(g,w)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(h,g,w){h=me(h),w=Y(w||[0,0]);var C=this.getZoom()||0,I=this.getMinZoom(),P=this.getMaxZoom(),U=h.getNorthWest(),re=h.getSouthEast(),ae=this.getSize().subtract(w),ve=ne(this.project(re,C),this.project(U,C)).getSize(),$e=Ve.any3d?this.options.zoomSnap:1,Ue=ae.x/ve.x,rt=ae.y/ve.y,Ar=g?Math.max(Ue,rt):Math.min(Ue,rt);return C=this.getScaleZoom(Ar,C),$e&&(C=Math.round(C/($e/100))*($e/100),C=g?Math.ceil(C/$e)*$e:Math.floor(C/$e)*$e),Math.max(I,Math.min(P,C))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new B(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(h,g){var w=this._getTopLeftPoint(h,g);return new ie(w,w.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(h){return this.options.crs.getProjectedBounds(h===void 0?this.getZoom():h)},getPane:function(h){return typeof h=="string"?this._panes[h]:h},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(h,g){var w=this.options.crs;return g=g===void 0?this._zoom:g,w.scale(h)/w.scale(g)},getScaleZoom:function(h,g){var w=this.options.crs;g=g===void 0?this._zoom:g;var C=w.zoom(h*w.scale(g));return isNaN(C)?1/0:C},project:function(h,g){return g=g===void 0?this._zoom:g,this.options.crs.latLngToPoint(fe(h),g)},unproject:function(h,g){return g=g===void 0?this._zoom:g,this.options.crs.pointToLatLng(Y(h),g)},layerPointToLatLng:function(h){var g=Y(h).add(this.getPixelOrigin());return this.unproject(g)},latLngToLayerPoint:function(h){var g=this.project(fe(h))._round();return g._subtract(this.getPixelOrigin())},wrapLatLng:function(h){return this.options.crs.wrapLatLng(fe(h))},wrapLatLngBounds:function(h){return this.options.crs.wrapLatLngBounds(me(h))},distance:function(h,g){return this.options.crs.distance(fe(h),fe(g))},containerPointToLayerPoint:function(h){return Y(h).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(h){return Y(h).add(this._getMapPanePos())},containerPointToLatLng:function(h){var g=this.containerPointToLayerPoint(Y(h));return this.layerPointToLatLng(g)},latLngToContainerPoint:function(h){return this.layerPointToContainerPoint(this.latLngToLayerPoint(fe(h)))},mouseEventToContainerPoint:function(h){return aO(h,this._container)},mouseEventToLayerPoint:function(h){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(h))},mouseEventToLatLng:function(h){return this.layerPointToLatLng(this.mouseEventToLayerPoint(h))},_initContainer:function(h){var g=this._container=rO(h);if(g){if(g._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Xe(g,"scroll",this._onScroll,this),this._containerId=l(g)},_initLayout:function(){var h=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ve.any3d,et(h,"leaflet-container"+(Ve.touch?" leaflet-touch":"")+(Ve.retina?" leaflet-retina":"")+(Ve.ielt9?" leaflet-oldie":"")+(Ve.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var g=Pf(h,"position");g!=="absolute"&&g!=="relative"&&g!=="fixed"&&g!=="sticky"&&(h.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var h=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),yn(this._mapPane,new B(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(et(h.markerPane,"leaflet-zoom-hide"),et(h.shadowPane,"leaflet-zoom-hide"))},_resetView:function(h,g,w){yn(this._mapPane,new B(0,0));var C=!this._loaded;this._loaded=!0,g=this._limitZoom(g),this.fire("viewprereset");var I=this._zoom!==g;this._moveStart(I,w)._move(h,g)._moveEnd(I),this.fire("viewreset"),C&&this.fire("load")},_moveStart:function(h,g){return h&&this.fire("zoomstart"),g||this.fire("movestart"),this},_move:function(h,g,w,C){g===void 0&&(g=this._zoom);var I=this._zoom!==g;return this._zoom=g,this._lastCenter=h,this._pixelOrigin=this._getNewPixelOrigin(h),C?w&&w.pinch&&this.fire("zoom",w):((I||w&&w.pinch)&&this.fire("zoom",w),this.fire("move",w)),this},_moveEnd:function(h){return h&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(h){yn(this._mapPane,this._getMapPanePos().subtract(h))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(h){this._targets={},this._targets[l(this._container)]=this;var g=h?At:Xe;g(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&g(window,"resize",this._onResize,this),Ve.any3d&&this.options.transform3DLimit&&(h?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=M(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var h=this._getMapPanePos();Math.max(Math.abs(h.x),Math.abs(h.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(h,g){for(var w=[],C,I=g==="mouseout"||g==="mouseover",P=h.target||h.srcElement,U=!1;P;){if(C=this._targets[l(P)],C&&(g==="click"||g==="preclick")&&this._draggableMoved(C)){U=!0;break}if(C&&C.listens(g,!0)&&(I&&!K_(P,h)||(w.push(C),I))||P===this._container)break;P=P.parentNode}return!w.length&&!U&&!I&&this.listens(g,!0)&&(w=[this]),w},_isClickDisabled:function(h){for(;h&&h!==this._container;){if(h._leaflet_disable_click)return!0;h=h.parentNode}},_handleDOMEvent:function(h){var g=h.target||h.srcElement;if(!(!this._loaded||g._leaflet_disable_events||h.type==="click"&&this._isClickDisabled(g))){var w=h.type;w==="mousedown"&&j_(g),this._fireDOMEvent(h,w)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(h,g,w){if(h.type==="click"){var C=s({},h);C.type="preclick",this._fireDOMEvent(C,C.type,w)}var I=this._findEventTargets(h,g);if(w){for(var P=[],U=0;U<w.length;U++)w[U].listens(g,!0)&&P.push(w[U]);I=P.concat(I)}if(I.length){g==="contextmenu"&&sr(h);var re=I[0],ae={originalEvent:h};if(h.type!=="keypress"&&h.type!=="keydown"&&h.type!=="keyup"){var ve=re.getLatLng&&(!re._radius||re._radius<=10);ae.containerPoint=ve?this.latLngToContainerPoint(re.getLatLng()):this.mouseEventToContainerPoint(h),ae.layerPoint=this.containerPointToLayerPoint(ae.containerPoint),ae.latlng=ve?re.getLatLng():this.layerPointToLatLng(ae.layerPoint)}for(U=0;U<I.length;U++)if(I[U].fire(g,ae,!0),ae.originalEvent._stopped||I[U].options.bubblingMouseEvents===!1&&S(this._mouseEvents,g)!==-1)return}},_draggableMoved:function(h){return h=h.dragging&&h.dragging.enabled()?h:this,h.dragging&&h.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var h=0,g=this._handlers.length;h<g;h++)this._handlers[h].disable()},whenReady:function(h,g){return this._loaded?h.call(g||this,{target:this}):this.on("load",h,g),this},_getMapPanePos:function(){return eu(this._mapPane)||new B(0,0)},_moved:function(){var h=this._getMapPanePos();return h&&!h.equals([0,0])},_getTopLeftPoint:function(h,g){var w=h&&g!==void 0?this._getNewPixelOrigin(h,g):this.getPixelOrigin();return w.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(h,g){var w=this.getSize()._divideBy(2);return this.project(h,g)._subtract(w)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(h,g,w){var C=this._getNewPixelOrigin(w,g);return this.project(h,g)._subtract(C)},_latLngBoundsToNewLayerBounds:function(h,g,w){var C=this._getNewPixelOrigin(w,g);return ne([this.project(h.getSouthWest(),g)._subtract(C),this.project(h.getNorthWest(),g)._subtract(C),this.project(h.getSouthEast(),g)._subtract(C),this.project(h.getNorthEast(),g)._subtract(C)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(h){return this.latLngToLayerPoint(h).subtract(this._getCenterLayerPoint())},_limitCenter:function(h,g,w){if(!w)return h;var C=this.project(h,g),I=this.getSize().divideBy(2),P=new ie(C.subtract(I),C.add(I)),U=this._getBoundsOffset(P,w,g);return Math.abs(U.x)<=1&&Math.abs(U.y)<=1?h:this.unproject(C.add(U),g)},_limitOffset:function(h,g){if(!g)return h;var w=this.getPixelBounds(),C=new ie(w.min.add(h),w.max.add(h));return h.add(this._getBoundsOffset(C,g))},_getBoundsOffset:function(h,g,w){var C=ne(this.project(g.getNorthEast(),w),this.project(g.getSouthWest(),w)),I=C.min.subtract(h.min),P=C.max.subtract(h.max),U=this._rebound(I.x,-P.x),re=this._rebound(I.y,-P.y);return new B(U,re)},_rebound:function(h,g){return h+g>0?Math.round(h-g)/2:Math.max(0,Math.ceil(h))-Math.max(0,Math.floor(g))},_limitZoom:function(h){var g=this.getMinZoom(),w=this.getMaxZoom(),C=Ve.any3d?this.options.zoomSnap:1;return C&&(h=Math.round(h/C)*C),Math.max(g,Math.min(w,h))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){cn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(h,g){var w=this._getCenterOffset(h)._trunc();return(g&&g.animate)!==!0&&!this.getSize().contains(w)?!1:(this.panBy(w,g),!0)},_createAnimProxy:function(){var h=this._proxy=pt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(h),this.on("zoomanim",function(g){var w=D_,C=this._proxy.style[w];Jl(this._proxy,this.project(g.center,g.zoom),this.getZoomScale(g.zoom,1)),C===this._proxy.style[w]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Xt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var h=this.getCenter(),g=this.getZoom();Jl(this._proxy,this.project(h,g),this.getZoomScale(g,1))},_catchTransitionEnd:function(h){this._animatingZoom&&h.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(h,g,w){if(this._animatingZoom)return!0;if(w=w||{},!this._zoomAnimated||w.animate===!1||this._nothingToAnimate()||Math.abs(g-this._zoom)>this.options.zoomAnimationThreshold)return!1;var C=this.getZoomScale(g),I=this._getCenterOffset(h)._divideBy(1-1/C);return w.animate!==!0&&!this.getSize().contains(I)?!1:(M(function(){this._moveStart(!0,w.noMoveStart||!1)._animateZoom(h,g,!0)},this),!0)},_animateZoom:function(h,g,w,C){this._mapPane&&(w&&(this._animatingZoom=!0,this._animateToCenter=h,this._animateToZoom=g,et(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:h,zoom:g,noUpdate:C}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&cn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Kq(h,g){return new ct(h,g)}var Ei=K.extend({options:{position:"topright"},initialize:function(h){y(this,h)},getPosition:function(){return this.options.position},setPosition:function(h){var g=this._map;return g&&g.removeControl(this),this.options.position=h,g&&g.addControl(this),this},getContainer:function(){return this._container},addTo:function(h){this.remove(),this._map=h;var g=this._container=this.onAdd(h),w=this.getPosition(),C=h._controlCorners[w];return et(g,"leaflet-control"),w.indexOf("bottom")!==-1?C.insertBefore(g,C.firstChild):C.appendChild(g),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Xt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(h){this._map&&h&&h.screenX>0&&h.screenY>0&&this._map.getContainer().focus()}}),Mf=function(h){return new Ei(h)};ct.include({addControl:function(h){return h.addTo(this),this},removeControl:function(h){return h.remove(),this},_initControlPos:function(){var h=this._controlCorners={},g="leaflet-",w=this._controlContainer=pt("div",g+"control-container",this._container);function C(I,P){var U=g+I+" "+g+P;h[I+P]=pt("div",U,w)}C("top","left"),C("top","right"),C("bottom","left"),C("bottom","right")},_clearControlPos:function(){for(var h in this._controlCorners)Xt(this._controlCorners[h]);Xt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var cO=Ei.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(h,g,w,C){return w<C?-1:C<w?1:0}},initialize:function(h,g,w){y(this,w),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var C in h)this._addLayer(h[C],C);for(C in g)this._addLayer(g[C],C,!0)},onAdd:function(h){this._initLayout(),this._update(),this._map=h,h.on("zoomend",this._checkDisabledLayers,this);for(var g=0;g<this._layers.length;g++)this._layers[g].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(h){return Ei.prototype.addTo.call(this,h),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(h,g){return this._addLayer(h,g),this._map?this._update():this},addOverlay:function(h,g){return this._addLayer(h,g,!0),this._map?this._update():this},removeLayer:function(h){h.off("add remove",this._onLayerChange,this);var g=this._getLayer(l(h));return g&&this._layers.splice(this._layers.indexOf(g),1),this._map?this._update():this},expand:function(){et(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var h=this._map.getSize().y-(this._container.offsetTop+50);return h<this._section.clientHeight?(et(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=h+"px"):cn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return cn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var h="leaflet-control-layers",g=this._container=pt("div",h),w=this.options.collapsed;g.setAttribute("aria-haspopup",!0),Ff(g),H_(g);var C=this._section=pt("section",h+"-list");w&&(this._map.on("click",this.collapse,this),Xe(g,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var I=this._layersLink=pt("a",h+"-toggle",g);I.href="#",I.title="Layers",I.setAttribute("role","button"),Xe(I,{keydown:function(P){P.keyCode===13&&this._expandSafely()},click:function(P){sr(P),this._expandSafely()}},this),w||this.expand(),this._baseLayersList=pt("div",h+"-base",C),this._separator=pt("div",h+"-separator",C),this._overlaysList=pt("div",h+"-overlays",C),g.appendChild(C)},_getLayer:function(h){for(var g=0;g<this._layers.length;g++)if(this._layers[g]&&l(this._layers[g].layer)===h)return this._layers[g]},_addLayer:function(h,g,w){this._map&&h.on("add remove",this._onLayerChange,this),this._layers.push({layer:h,name:g,overlay:w}),this.options.sortLayers&&this._layers.sort(o(function(C,I){return this.options.sortFunction(C.layer,I.layer,C.name,I.name)},this)),this.options.autoZIndex&&h.setZIndex&&(this._lastZIndex++,h.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;By(this._baseLayersList),By(this._overlaysList),this._layerControlInputs=[];var h,g,w,C,I=0;for(w=0;w<this._layers.length;w++)C=this._layers[w],this._addItem(C),g=g||C.overlay,h=h||!C.overlay,I+=C.overlay?0:1;return this.options.hideSingleBase&&(h=h&&I>1,this._baseLayersList.style.display=h?"":"none"),this._separator.style.display=g&&h?"":"none",this},_onLayerChange:function(h){this._handlingClick||this._update();var g=this._getLayer(l(h.target)),w=g.overlay?h.type==="add"?"overlayadd":"overlayremove":h.type==="add"?"baselayerchange":null;w&&this._map.fire(w,g)},_createRadioElement:function(h,g){var w='<input type="radio" class="leaflet-control-layers-selector" name="'+h+'"'+(g?' checked="checked"':"")+"/>",C=document.createElement("div");return C.innerHTML=w,C.firstChild},_addItem:function(h){var g=document.createElement("label"),w=this._map.hasLayer(h.layer),C;h.overlay?(C=document.createElement("input"),C.type="checkbox",C.className="leaflet-control-layers-selector",C.defaultChecked=w):C=this._createRadioElement("leaflet-base-layers_"+l(this),w),this._layerControlInputs.push(C),C.layerId=l(h.layer),Xe(C,"click",this._onInputClick,this);var I=document.createElement("span");I.innerHTML=" "+h.name;var P=document.createElement("span");g.appendChild(P),P.appendChild(C),P.appendChild(I);var U=h.overlay?this._overlaysList:this._baseLayersList;return U.appendChild(g),this._checkDisabledLayers(),g},_onInputClick:function(){if(!this._preventClick){var h=this._layerControlInputs,g,w,C=[],I=[];this._handlingClick=!0;for(var P=h.length-1;P>=0;P--)g=h[P],w=this._getLayer(g.layerId).layer,g.checked?C.push(w):g.checked||I.push(w);for(P=0;P<I.length;P++)this._map.hasLayer(I[P])&&this._map.removeLayer(I[P]);for(P=0;P<C.length;P++)this._map.hasLayer(C[P])||this._map.addLayer(C[P]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var h=this._layerControlInputs,g,w,C=this._map.getZoom(),I=h.length-1;I>=0;I--)g=h[I],w=this._getLayer(g.layerId).layer,g.disabled=w.options.minZoom!==void 0&&C<w.options.minZoom||w.options.maxZoom!==void 0&&C>w.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var h=this._section;this._preventClick=!0,Xe(h,"click",sr),this.expand();var g=this;setTimeout(function(){At(h,"click",sr),g._preventClick=!1})}}),qq=function(h,g,w){return new cO(h,g,w)},q_=Ei.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(h){var g="leaflet-control-zoom",w=pt("div",g+" leaflet-bar"),C=this.options;return this._zoomInButton=this._createButton(C.zoomInText,C.zoomInTitle,g+"-in",w,this._zoomIn),this._zoomOutButton=this._createButton(C.zoomOutText,C.zoomOutTitle,g+"-out",w,this._zoomOut),this._updateDisabled(),h.on("zoomend zoomlevelschange",this._updateDisabled,this),w},onRemove:function(h){h.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(h){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(h.shiftKey?3:1))},_zoomOut:function(h){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(h.shiftKey?3:1))},_createButton:function(h,g,w,C,I){var P=pt("a",w,C);return P.innerHTML=h,P.href="#",P.title=g,P.setAttribute("role","button"),P.setAttribute("aria-label",g),Ff(P),Xe(P,"click",nu),Xe(P,"click",I,this),Xe(P,"click",this._refocusOnMap,this),P},_updateDisabled:function(){var h=this._map,g="leaflet-disabled";cn(this._zoomInButton,g),cn(this._zoomOutButton,g),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||h._zoom===h.getMinZoom())&&(et(this._zoomOutButton,g),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||h._zoom===h.getMaxZoom())&&(et(this._zoomInButton,g),this._zoomInButton.setAttribute("aria-disabled","true"))}});ct.mergeOptions({zoomControl:!0}),ct.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new q_,this.addControl(this.zoomControl))});var Xq=function(h){return new q_(h)},dO=Ei.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(h){var g="leaflet-control-scale",w=pt("div",g),C=this.options;return this._addScales(C,g+"-line",w),h.on(C.updateWhenIdle?"moveend":"move",this._update,this),h.whenReady(this._update,this),w},onRemove:function(h){h.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(h,g,w){h.metric&&(this._mScale=pt("div",g,w)),h.imperial&&(this._iScale=pt("div",g,w))},_update:function(){var h=this._map,g=h.getSize().y/2,w=h.distance(h.containerPointToLatLng([0,g]),h.containerPointToLatLng([this.options.maxWidth,g]));this._updateScales(w)},_updateScales:function(h){this.options.metric&&h&&this._updateMetric(h),this.options.imperial&&h&&this._updateImperial(h)},_updateMetric:function(h){var g=this._getRoundNum(h),w=g<1e3?g+" m":g/1e3+" km";this._updateScale(this._mScale,w,g/h)},_updateImperial:function(h){var g=h*3.2808399,w,C,I;g>5280?(w=g/5280,C=this._getRoundNum(w),this._updateScale(this._iScale,C+" mi",C/w)):(I=this._getRoundNum(g),this._updateScale(this._iScale,I+" ft",I/g))},_updateScale:function(h,g,w){h.style.width=Math.round(this.options.maxWidth*w)+"px",h.innerHTML=g},_getRoundNum:function(h){var g=Math.pow(10,(Math.floor(h)+"").length-1),w=h/g;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:1,g*w}}),Zq=function(h){return new dO(h)},Yq='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',X_=Ei.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ve.inlineSvg?Yq+" ":"")+"Leaflet</a>"},initialize:function(h){y(this,h),this._attributions={}},onAdd:function(h){h.attributionControl=this,this._container=pt("div","leaflet-control-attribution"),Ff(this._container);for(var g in h._layers)h._layers[g].getAttribution&&this.addAttribution(h._layers[g].getAttribution());return this._update(),h.on("layeradd",this._addAttribution,this),this._container},onRemove:function(h){h.off("layeradd",this._addAttribution,this)},_addAttribution:function(h){h.layer.getAttribution&&(this.addAttribution(h.layer.getAttribution()),h.layer.once("remove",function(){this.removeAttribution(h.layer.getAttribution())},this))},setPrefix:function(h){return this.options.prefix=h,this._update(),this},addAttribution:function(h){return h?(this._attributions[h]||(this._attributions[h]=0),this._attributions[h]++,this._update(),this):this},removeAttribution:function(h){return h?(this._attributions[h]&&(this._attributions[h]--,this._update()),this):this},_update:function(){if(this._map){var h=[];for(var g in this._attributions)this._attributions[g]&&h.push(g);var w=[];this.options.prefix&&w.push(this.options.prefix),h.length&&w.push(h.join(", ")),this._container.innerHTML=w.join(' <span aria-hidden="true">|</span> ')}}});ct.mergeOptions({attributionControl:!0}),ct.addInitHook(function(){this.options.attributionControl&&new X_().addTo(this)});var Qq=function(h){return new X_(h)};Ei.Layers=cO,Ei.Zoom=q_,Ei.Scale=dO,Ei.Attribution=X_,Mf.layers=qq,Mf.zoom=Xq,Mf.scale=Zq,Mf.attribution=Qq;var ho=K.extend({initialize:function(h){this._map=h},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ho.addTo=function(h,g){return h.addHandler(g,this),this};var Jq={Events:Z},hO=Ve.touch?"touchstart mousedown":"mousedown",za=se.extend({options:{clickTolerance:3},initialize:function(h,g,w,C){y(this,C),this._element=h,this._dragStartTarget=g||h,this._preventOutline=w},enable:function(){this._enabled||(Xe(this._dragStartTarget,hO,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(za._dragging===this&&this.finishDrag(!0),At(this._dragStartTarget,hO,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(h){if(this._enabled&&(this._moved=!1,!R_(this._element,"leaflet-zoom-anim"))){if(h.touches&&h.touches.length!==1){za._dragging===this&&this.finishDrag();return}if(!(za._dragging||h.shiftKey||h.which!==1&&h.button!==1&&!h.touches)&&(za._dragging=this,this._preventOutline&&j_(this._element),M_(),Df(),!this._moving)){this.fire("down");var g=h.touches?h.touches[0]:h,w=sO(this._element);this._startPoint=new B(g.clientX,g.clientY),this._startPos=eu(this._element),this._parentScale=V_(w);var C=h.type==="mousedown";Xe(document,C?"mousemove":"touchmove",this._onMove,this),Xe(document,C?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(h){if(this._enabled){if(h.touches&&h.touches.length>1){this._moved=!0;return}var g=h.touches&&h.touches.length===1?h.touches[0]:h,w=new B(g.clientX,g.clientY)._subtract(this._startPoint);!w.x&&!w.y||Math.abs(w.x)+Math.abs(w.y)<this.options.clickTolerance||(w.x/=this._parentScale.x,w.y/=this._parentScale.y,sr(h),this._moved||(this.fire("dragstart"),this._moved=!0,et(document.body,"leaflet-dragging"),this._lastTarget=h.target||h.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),et(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(w),this._moving=!0,this._lastEvent=h,this._updatePosition())}},_updatePosition:function(){var h={originalEvent:this._lastEvent};this.fire("predrag",h),yn(this._element,this._newPos),this.fire("drag",h)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(h){cn(document.body,"leaflet-dragging"),this._lastTarget&&(cn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),At(document,"mousemove touchmove",this._onMove,this),At(document,"mouseup touchend touchcancel",this._onUp,this),z_(),Rf();var g=this._moved&&this._moving;this._moving=!1,za._dragging=!1,g&&this.fire("dragend",{noInertia:h,distance:this._newPos.distanceTo(this._startPos)})}});function fO(h,g,w){var C,I=[1,4,2,8],P,U,re,ae,ve,$e,Ue,rt;for(P=0,$e=h.length;P<$e;P++)h[P]._code=ru(h[P],g);for(re=0;re<4;re++){for(Ue=I[re],C=[],P=0,$e=h.length,U=$e-1;P<$e;U=P++)ae=h[P],ve=h[U],ae._code&Ue?ve._code&Ue||(rt=Gy(ve,ae,Ue,g,w),rt._code=ru(rt,g),C.push(rt)):(ve._code&Ue&&(rt=Gy(ve,ae,Ue,g,w),rt._code=ru(rt,g),C.push(rt)),C.push(ae));h=C}return h}function pO(h,g){var w,C,I,P,U,re,ae,ve,$e;if(!h||h.length===0)throw new Error("latlngs not passed");Hs(h)||(console.warn("latlngs are not flat! Only the first ring will be used"),h=h[0]);var Ue=fe([0,0]),rt=me(h),Ar=rt.getNorthWest().distanceTo(rt.getSouthWest())*rt.getNorthEast().distanceTo(rt.getNorthWest());Ar<1700&&(Ue=Z_(h));var jn=h.length,Ks=[];for(w=0;w<jn;w++){var Xr=fe(h[w]);Ks.push(g.project(fe([Xr.lat-Ue.lat,Xr.lng-Ue.lng])))}for(re=ae=ve=0,w=0,C=jn-1;w<jn;C=w++)I=Ks[w],P=Ks[C],U=I.y*P.x-P.y*I.x,ae+=(I.x+P.x)*U,ve+=(I.y+P.y)*U,re+=U*3;re===0?$e=Ks[0]:$e=[ae/re,ve/re];var Kc=g.unproject(Y($e));return fe([Kc.lat+Ue.lat,Kc.lng+Ue.lng])}function Z_(h){for(var g=0,w=0,C=0,I=0;I<h.length;I++){var P=fe(h[I]);g+=P.lat,w+=P.lng,C++}return fe([g/C,w/C])}var eX={__proto__:null,clipPolygon:fO,polygonCenter:pO,centroid:Z_};function mO(h,g){if(!g||!h.length)return h.slice();var w=g*g;return h=rX(h,w),h=nX(h,w),h}function gO(h,g,w){return Math.sqrt(zf(h,g,w,!0))}function tX(h,g,w){return zf(h,g,w)}function nX(h,g){var w=h.length,C=typeof Uint8Array<"u"?Uint8Array:Array,I=new C(w);I[0]=I[w-1]=1,Y_(h,I,g,0,w-1);var P,U=[];for(P=0;P<w;P++)I[P]&&U.push(h[P]);return U}function Y_(h,g,w,C,I){var P=0,U,re,ae;for(re=C+1;re<=I-1;re++)ae=zf(h[re],h[C],h[I],!0),ae>P&&(U=re,P=ae);P>w&&(g[U]=1,Y_(h,g,w,C,U),Y_(h,g,w,U,I))}function rX(h,g){for(var w=[h[0]],C=1,I=0,P=h.length;C<P;C++)sX(h[C],h[I])>g&&(w.push(h[C]),I=C);return I<P-1&&w.push(h[P-1]),w}var yO;function vO(h,g,w,C,I){var P=C?yO:ru(h,w),U=ru(g,w),re,ae,ve;for(yO=U;;){if(!(P|U))return[h,g];if(P&U)return!1;re=P||U,ae=Gy(h,g,re,w,I),ve=ru(ae,w),re===P?(h=ae,P=ve):(g=ae,U=ve)}}function Gy(h,g,w,C,I){var P=g.x-h.x,U=g.y-h.y,re=C.min,ae=C.max,ve,$e;return w&8?(ve=h.x+P*(ae.y-h.y)/U,$e=ae.y):w&4?(ve=h.x+P*(re.y-h.y)/U,$e=re.y):w&2?(ve=ae.x,$e=h.y+U*(ae.x-h.x)/P):w&1&&(ve=re.x,$e=h.y+U*(re.x-h.x)/P),new B(ve,$e,I)}function ru(h,g){var w=0;return h.x<g.min.x?w|=1:h.x>g.max.x&&(w|=2),h.y<g.min.y?w|=4:h.y>g.max.y&&(w|=8),w}function sX(h,g){var w=g.x-h.x,C=g.y-h.y;return w*w+C*C}function zf(h,g,w,C){var I=g.x,P=g.y,U=w.x-I,re=w.y-P,ae=U*U+re*re,ve;return ae>0&&(ve=((h.x-I)*U+(h.y-P)*re)/ae,ve>1?(I=w.x,P=w.y):ve>0&&(I+=U*ve,P+=re*ve)),U=h.x-I,re=h.y-P,C?U*U+re*re:new B(I,P)}function Hs(h){return!_(h[0])||typeof h[0][0]!="object"&&typeof h[0][0]<"u"}function xO(h){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Hs(h)}function bO(h,g){var w,C,I,P,U,re,ae,ve;if(!h||h.length===0)throw new Error("latlngs not passed");Hs(h)||(console.warn("latlngs are not flat! Only the first ring will be used"),h=h[0]);var $e=fe([0,0]),Ue=me(h),rt=Ue.getNorthWest().distanceTo(Ue.getSouthWest())*Ue.getNorthEast().distanceTo(Ue.getNorthWest());rt<1700&&($e=Z_(h));var Ar=h.length,jn=[];for(w=0;w<Ar;w++){var Ks=fe(h[w]);jn.push(g.project(fe([Ks.lat-$e.lat,Ks.lng-$e.lng])))}for(w=0,C=0;w<Ar-1;w++)C+=jn[w].distanceTo(jn[w+1])/2;if(C===0)ve=jn[0];else for(w=0,P=0;w<Ar-1;w++)if(U=jn[w],re=jn[w+1],I=U.distanceTo(re),P+=I,P>C){ae=(P-C)/I,ve=[re.x-ae*(re.x-U.x),re.y-ae*(re.y-U.y)];break}var Xr=g.unproject(Y(ve));return fe([Xr.lat+$e.lat,Xr.lng+$e.lng])}var iX={__proto__:null,simplify:mO,pointToSegmentDistance:gO,closestPointOnSegment:tX,clipSegment:vO,_getEdgeIntersection:Gy,_getBitCode:ru,_sqClosestPointOnSegment:zf,isFlat:Hs,_flat:xO,polylineCenter:bO},Q_={project:function(h){return new B(h.lng,h.lat)},unproject:function(h){return new de(h.y,h.x)},bounds:new ie([-180,-90],[180,90])},J_={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ie([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(h){var g=Math.PI/180,w=this.R,C=h.lat*g,I=this.R_MINOR/w,P=Math.sqrt(1-I*I),U=P*Math.sin(C),re=Math.tan(Math.PI/4-C/2)/Math.pow((1-U)/(1+U),P/2);return C=-w*Math.log(Math.max(re,1e-10)),new B(h.lng*g*w,C)},unproject:function(h){for(var g=180/Math.PI,w=this.R,C=this.R_MINOR/w,I=Math.sqrt(1-C*C),P=Math.exp(-h.y/w),U=Math.PI/2-2*Math.atan(P),re=0,ae=.1,ve;re<15&&Math.abs(ae)>1e-7;re++)ve=I*Math.sin(U),ve=Math.pow((1-ve)/(1+ve),I/2),ae=Math.PI/2-2*Math.atan(P*ve)-U,U+=ae;return new de(U*g,h.x*g/w)}},oX={__proto__:null,LonLat:Q_,Mercator:J_,SphericalMercator:be},aX=s({},_e,{code:"EPSG:3395",projection:J_,transformation:function(){var h=.5/(Math.PI*J_.R);return le(h,.5,-h,.5)}()}),wO=s({},_e,{code:"EPSG:4326",projection:Q_,transformation:le(1/180,1,-1/180,.5)}),lX=s({},ke,{projection:Q_,transformation:le(1,0,-1,0),scale:function(h){return Math.pow(2,h)},zoom:function(h){return Math.log(h)/Math.LN2},distance:function(h,g){var w=g.lng-h.lng,C=g.lat-h.lat;return Math.sqrt(w*w+C*C)},infinite:!0});ke.Earth=_e,ke.EPSG3395=aX,ke.EPSG3857=Me,ke.EPSG900913=Be,ke.EPSG4326=wO,ke.Simple=lX;var Ai=se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(h){return h.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(h){return h&&h.removeLayer(this),this},getPane:function(h){return this._map.getPane(h?this.options[h]||h:this.options.pane)},addInteractiveTarget:function(h){return this._map._targets[l(h)]=this,this},removeInteractiveTarget:function(h){return delete this._map._targets[l(h)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(h){var g=h.target;if(g.hasLayer(this)){if(this._map=g,this._zoomAnimated=g._zoomAnimated,this.getEvents){var w=this.getEvents();g.on(w,this),this.once("remove",function(){g.off(w,this)},this)}this.onAdd(g),this.fire("add"),g.fire("layeradd",{layer:this})}}});ct.include({addLayer:function(h){if(!h._layerAdd)throw new Error("The provided object is not a Layer.");var g=l(h);return this._layers[g]?this:(this._layers[g]=h,h._mapToAdd=this,h.beforeAdd&&h.beforeAdd(this),this.whenReady(h._layerAdd,h),this)},removeLayer:function(h){var g=l(h);return this._layers[g]?(this._loaded&&h.onRemove(this),delete this._layers[g],this._loaded&&(this.fire("layerremove",{layer:h}),h.fire("remove")),h._map=h._mapToAdd=null,this):this},hasLayer:function(h){return l(h)in this._layers},eachLayer:function(h,g){for(var w in this._layers)h.call(g,this._layers[w]);return this},_addLayers:function(h){h=h?_(h)?h:[h]:[];for(var g=0,w=h.length;g<w;g++)this.addLayer(h[g])},_addZoomLimit:function(h){(!isNaN(h.options.maxZoom)||!isNaN(h.options.minZoom))&&(this._zoomBoundLayers[l(h)]=h,this._updateZoomLevels())},_removeZoomLimit:function(h){var g=l(h);this._zoomBoundLayers[g]&&(delete this._zoomBoundLayers[g],this._updateZoomLevels())},_updateZoomLevels:function(){var h=1/0,g=-1/0,w=this._getZoomSpan();for(var C in this._zoomBoundLayers){var I=this._zoomBoundLayers[C].options;h=I.minZoom===void 0?h:Math.min(h,I.minZoom),g=I.maxZoom===void 0?g:Math.max(g,I.maxZoom)}this._layersMaxZoom=g===-1/0?void 0:g,this._layersMinZoom=h===1/0?void 0:h,w!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Vc=Ai.extend({initialize:function(h,g){y(this,g),this._layers={};var w,C;if(h)for(w=0,C=h.length;w<C;w++)this.addLayer(h[w])},addLayer:function(h){var g=this.getLayerId(h);return this._layers[g]=h,this._map&&this._map.addLayer(h),this},removeLayer:function(h){var g=h in this._layers?h:this.getLayerId(h);return this._map&&this._layers[g]&&this._map.removeLayer(this._layers[g]),delete this._layers[g],this},hasLayer:function(h){var g=typeof h=="number"?h:this.getLayerId(h);return g in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(h){var g=Array.prototype.slice.call(arguments,1),w,C;for(w in this._layers)C=this._layers[w],C[h]&&C[h].apply(C,g);return this},onAdd:function(h){this.eachLayer(h.addLayer,h)},onRemove:function(h){this.eachLayer(h.removeLayer,h)},eachLayer:function(h,g){for(var w in this._layers)h.call(g,this._layers[w]);return this},getLayer:function(h){return this._layers[h]},getLayers:function(){var h=[];return this.eachLayer(h.push,h),h},setZIndex:function(h){return this.invoke("setZIndex",h)},getLayerId:function(h){return l(h)}}),uX=function(h,g){return new Vc(h,g)},Vo=Vc.extend({addLayer:function(h){return this.hasLayer(h)?this:(h.addEventParent(this),Vc.prototype.addLayer.call(this,h),this.fire("layeradd",{layer:h}))},removeLayer:function(h){return this.hasLayer(h)?(h in this._layers&&(h=this._layers[h]),h.removeEventParent(this),Vc.prototype.removeLayer.call(this,h),this.fire("layerremove",{layer:h})):this},setStyle:function(h){return this.invoke("setStyle",h)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var h=new pe;for(var g in this._layers){var w=this._layers[g];h.extend(w.getBounds?w.getBounds():w.getLatLng())}return h}}),cX=function(h,g){return new Vo(h,g)},Wc=K.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(h){y(this,h)},createIcon:function(h){return this._createIcon("icon",h)},createShadow:function(h){return this._createIcon("shadow",h)},_createIcon:function(h,g){var w=this._getIconUrl(h);if(!w){if(h==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var C=this._createImg(w,g&&g.tagName==="IMG"?g:null);return this._setIconStyles(C,h),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),C},_setIconStyles:function(h,g){var w=this.options,C=w[g+"Size"];typeof C=="number"&&(C=[C,C]);var I=Y(C),P=Y(g==="shadow"&&w.shadowAnchor||w.iconAnchor||I&&I.divideBy(2,!0));h.className="leaflet-marker-"+g+" "+(w.className||""),P&&(h.style.marginLeft=-P.x+"px",h.style.marginTop=-P.y+"px"),I&&(h.style.width=I.x+"px",h.style.height=I.y+"px")},_createImg:function(h,g){return g=g||document.createElement("img"),g.src=h,g},_getIconUrl:function(h){return Ve.retina&&this.options[h+"RetinaUrl"]||this.options[h+"Url"]}});function dX(h){return new Wc(h)}var Bf=Wc.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(h){return typeof Bf.imagePath!="string"&&(Bf.imagePath=this._detectIconPath()),(this.options.imagePath||Bf.imagePath)+Wc.prototype._getIconUrl.call(this,h)},_stripUrl:function(h){var g=function(w,C,I){var P=C.exec(w);return P&&P[I]};return h=g(h,/^url\((['"])?(.+)\1\)$/,2),h&&g(h,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var h=pt("div","leaflet-default-icon-path",document.body),g=Pf(h,"background-image")||Pf(h,"backgroundImage");if(document.body.removeChild(h),g=this._stripUrl(g),g)return g;var w=document.querySelector('link[href$="leaflet.css"]');return w?w.href.substring(0,w.href.length-11-1):""}}),_O=ho.extend({initialize:function(h){this._marker=h},addHooks:function(){var h=this._marker._icon;this._draggable||(this._draggable=new za(h,h,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),et(h,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&cn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(h){var g=this._marker,w=g._map,C=this._marker.options.autoPanSpeed,I=this._marker.options.autoPanPadding,P=eu(g._icon),U=w.getPixelBounds(),re=w.getPixelOrigin(),ae=ne(U.min._subtract(re).add(I),U.max._subtract(re).subtract(I));if(!ae.contains(P)){var ve=Y((Math.max(ae.max.x,P.x)-ae.max.x)/(U.max.x-ae.max.x)-(Math.min(ae.min.x,P.x)-ae.min.x)/(U.min.x-ae.min.x),(Math.max(ae.max.y,P.y)-ae.max.y)/(U.max.y-ae.max.y)-(Math.min(ae.min.y,P.y)-ae.min.y)/(U.min.y-ae.min.y)).multiplyBy(C);w.panBy(ve,{animate:!1}),this._draggable._newPos._add(ve),this._draggable._startPos._add(ve),yn(g._icon,this._draggable._newPos),this._onDrag(h),this._panRequest=M(this._adjustPan.bind(this,h))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(h){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=M(this._adjustPan.bind(this,h)))},_onDrag:function(h){var g=this._marker,w=g._shadow,C=eu(g._icon),I=g._map.layerPointToLatLng(C);w&&yn(w,C),g._latlng=I,h.latlng=I,h.oldLatLng=this._oldLatLng,g.fire("move",h).fire("drag",h)},_onDragEnd:function(h){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",h)}}),Hy=Ai.extend({options:{icon:new Bf,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(h,g){y(this,g),this._latlng=fe(h)},onAdd:function(h){this._zoomAnimated=this._zoomAnimated&&h.options.markerZoomAnimation,this._zoomAnimated&&h.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(h){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&h.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(h){var g=this._latlng;return this._latlng=fe(h),this.update(),this.fire("move",{oldLatLng:g,latlng:this._latlng})},setZIndexOffset:function(h){return this.options.zIndexOffset=h,this.update()},getIcon:function(){return this.options.icon},setIcon:function(h){return this.options.icon=h,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var h=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(h)}return this},_initIcon:function(){var h=this.options,g="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),w=h.icon.createIcon(this._icon),C=!1;w!==this._icon&&(this._icon&&this._removeIcon(),C=!0,h.title&&(w.title=h.title),w.tagName==="IMG"&&(w.alt=h.alt||"")),et(w,g),h.keyboard&&(w.tabIndex="0",w.setAttribute("role","button")),this._icon=w,h.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Xe(w,"focus",this._panOnFocus,this);var I=h.icon.createShadow(this._shadow),P=!1;I!==this._shadow&&(this._removeShadow(),P=!0),I&&(et(I,g),I.alt=""),this._shadow=I,h.opacity<1&&this._updateOpacity(),C&&this.getPane().appendChild(this._icon),this._initInteraction(),I&&P&&this.getPane(h.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&At(this._icon,"focus",this._panOnFocus,this),Xt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Xt(this._shadow),this._shadow=null},_setPos:function(h){this._icon&&yn(this._icon,h),this._shadow&&yn(this._shadow,h),this._zIndex=h.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(h){this._icon&&(this._icon.style.zIndex=this._zIndex+h)},_animateZoom:function(h){var g=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center).round();this._setPos(g)},_initInteraction:function(){if(this.options.interactive&&(et(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),_O)){var h=this.options.draggable;this.dragging&&(h=this.dragging.enabled(),this.dragging.disable()),this.dragging=new _O(this),h&&this.dragging.enable()}},setOpacity:function(h){return this.options.opacity=h,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var h=this.options.opacity;this._icon&&Gs(this._icon,h),this._shadow&&Gs(this._shadow,h)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var h=this._map;if(h){var g=this.options.icon.options,w=g.iconSize?Y(g.iconSize):Y(0,0),C=g.iconAnchor?Y(g.iconAnchor):Y(0,0);h.panInside(this._latlng,{paddingTopLeft:C,paddingBottomRight:w.subtract(C)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function hX(h,g){return new Hy(h,g)}var Ba=Ai.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(h){this._renderer=h.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(h){return y(this,h),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&h&&Object.prototype.hasOwnProperty.call(h,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ky=Ba.extend({options:{fill:!0,radius:10},initialize:function(h,g){y(this,g),this._latlng=fe(h),this._radius=this.options.radius},setLatLng:function(h){var g=this._latlng;return this._latlng=fe(h),this.redraw(),this.fire("move",{oldLatLng:g,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(h){return this.options.radius=this._radius=h,this.redraw()},getRadius:function(){return this._radius},setStyle:function(h){var g=h&&h.radius||this._radius;return Ba.prototype.setStyle.call(this,h),this.setRadius(g),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var h=this._radius,g=this._radiusY||h,w=this._clickTolerance(),C=[h+w,g+w];this._pxBounds=new ie(this._point.subtract(C),this._point.add(C))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(h){return h.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function fX(h,g){return new Ky(h,g)}var eS=Ky.extend({initialize:function(h,g,w){if(typeof g=="number"&&(g=s({},w,{radius:g})),y(this,g),this._latlng=fe(h),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(h){return this._mRadius=h,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var h=[this._radius,this._radiusY||this._radius];return new pe(this._map.layerPointToLatLng(this._point.subtract(h)),this._map.layerPointToLatLng(this._point.add(h)))},setStyle:Ba.prototype.setStyle,_project:function(){var h=this._latlng.lng,g=this._latlng.lat,w=this._map,C=w.options.crs;if(C.distance===_e.distance){var I=Math.PI/180,P=this._mRadius/_e.R/I,U=w.project([g+P,h]),re=w.project([g-P,h]),ae=U.add(re).divideBy(2),ve=w.unproject(ae).lat,$e=Math.acos((Math.cos(P*I)-Math.sin(g*I)*Math.sin(ve*I))/(Math.cos(g*I)*Math.cos(ve*I)))/I;(isNaN($e)||$e===0)&&($e=P/Math.cos(Math.PI/180*g)),this._point=ae.subtract(w.getPixelOrigin()),this._radius=isNaN($e)?0:ae.x-w.project([ve,h-$e]).x,this._radiusY=ae.y-U.y}else{var Ue=C.unproject(C.project(this._latlng).subtract([this._mRadius,0]));this._point=w.latLngToLayerPoint(this._latlng),this._radius=this._point.x-w.latLngToLayerPoint(Ue).x}this._updateBounds()}});function pX(h,g,w){return new eS(h,g,w)}var Wo=Ba.extend({options:{smoothFactor:1,noClip:!1},initialize:function(h,g){y(this,g),this._setLatLngs(h)},getLatLngs:function(){return this._latlngs},setLatLngs:function(h){return this._setLatLngs(h),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(h){for(var g=1/0,w=null,C=zf,I,P,U=0,re=this._parts.length;U<re;U++)for(var ae=this._parts[U],ve=1,$e=ae.length;ve<$e;ve++){I=ae[ve-1],P=ae[ve];var Ue=C(h,I,P,!0);Ue<g&&(g=Ue,w=C(h,I,P))}return w&&(w.distance=Math.sqrt(g)),w},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return bO(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(h,g){return g=g||this._defaultShape(),h=fe(h),g.push(h),this._bounds.extend(h),this.redraw()},_setLatLngs:function(h){this._bounds=new pe,this._latlngs=this._convertLatLngs(h)},_defaultShape:function(){return Hs(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(h){for(var g=[],w=Hs(h),C=0,I=h.length;C<I;C++)w?(g[C]=fe(h[C]),this._bounds.extend(g[C])):g[C]=this._convertLatLngs(h[C]);return g},_project:function(){var h=new ie;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,h),this._bounds.isValid()&&h.isValid()&&(this._rawPxBounds=h,this._updateBounds())},_updateBounds:function(){var h=this._clickTolerance(),g=new B(h,h);this._rawPxBounds&&(this._pxBounds=new ie([this._rawPxBounds.min.subtract(g),this._rawPxBounds.max.add(g)]))},_projectLatlngs:function(h,g,w){var C=h[0]instanceof de,I=h.length,P,U;if(C){for(U=[],P=0;P<I;P++)U[P]=this._map.latLngToLayerPoint(h[P]),w.extend(U[P]);g.push(U)}else for(P=0;P<I;P++)this._projectLatlngs(h[P],g,w)},_clipPoints:function(){var h=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(h))){if(this.options.noClip){this._parts=this._rings;return}var g=this._parts,w,C,I,P,U,re,ae;for(w=0,I=0,P=this._rings.length;w<P;w++)for(ae=this._rings[w],C=0,U=ae.length;C<U-1;C++)re=vO(ae[C],ae[C+1],h,C,!0),re&&(g[I]=g[I]||[],g[I].push(re[0]),(re[1]!==ae[C+1]||C===U-2)&&(g[I].push(re[1]),I++))}},_simplifyPoints:function(){for(var h=this._parts,g=this.options.smoothFactor,w=0,C=h.length;w<C;w++)h[w]=mO(h[w],g)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(h,g){var w,C,I,P,U,re,ae=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(h))return!1;for(w=0,P=this._parts.length;w<P;w++)for(re=this._parts[w],C=0,U=re.length,I=U-1;C<U;I=C++)if(!(!g&&C===0)&&gO(h,re[I],re[C])<=ae)return!0;return!1}});function mX(h,g){return new Wo(h,g)}Wo._flat=xO;var Uc=Wo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return pO(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(h){var g=Wo.prototype._convertLatLngs.call(this,h),w=g.length;return w>=2&&g[0]instanceof de&&g[0].equals(g[w-1])&&g.pop(),g},_setLatLngs:function(h){Wo.prototype._setLatLngs.call(this,h),Hs(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Hs(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var h=this._renderer._bounds,g=this.options.weight,w=new B(g,g);if(h=new ie(h.min.subtract(w),h.max.add(w)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(h))){if(this.options.noClip){this._parts=this._rings;return}for(var C=0,I=this._rings.length,P;C<I;C++)P=fO(this._rings[C],h,!0),P.length&&this._parts.push(P)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(h){var g=!1,w,C,I,P,U,re,ae,ve;if(!this._pxBounds||!this._pxBounds.contains(h))return!1;for(P=0,ae=this._parts.length;P<ae;P++)for(w=this._parts[P],U=0,ve=w.length,re=ve-1;U<ve;re=U++)C=w[U],I=w[re],C.y>h.y!=I.y>h.y&&h.x<(I.x-C.x)*(h.y-C.y)/(I.y-C.y)+C.x&&(g=!g);return g||Wo.prototype._containsPoint.call(this,h,!0)}});function gX(h,g){return new Uc(h,g)}var Uo=Vo.extend({initialize:function(h,g){y(this,g),this._layers={},h&&this.addData(h)},addData:function(h){var g=_(h)?h:h.features,w,C,I;if(g){for(w=0,C=g.length;w<C;w++)I=g[w],(I.geometries||I.geometry||I.features||I.coordinates)&&this.addData(I);return this}var P=this.options;if(P.filter&&!P.filter(h))return this;var U=qy(h,P);return U?(U.feature=Yy(h),U.defaultOptions=U.options,this.resetStyle(U),P.onEachFeature&&P.onEachFeature(h,U),this.addLayer(U)):this},resetStyle:function(h){return h===void 0?this.eachLayer(this.resetStyle,this):(h.options=s({},h.defaultOptions),this._setLayerStyle(h,this.options.style),this)},setStyle:function(h){return this.eachLayer(function(g){this._setLayerStyle(g,h)},this)},_setLayerStyle:function(h,g){h.setStyle&&(typeof g=="function"&&(g=g(h.feature)),h.setStyle(g))}});function qy(h,g){var w=h.type==="Feature"?h.geometry:h,C=w?w.coordinates:null,I=[],P=g&&g.pointToLayer,U=g&&g.coordsToLatLng||tS,re,ae,ve,$e;if(!C&&!w)return null;switch(w.type){case"Point":return re=U(C),SO(P,h,re,g);case"MultiPoint":for(ve=0,$e=C.length;ve<$e;ve++)re=U(C[ve]),I.push(SO(P,h,re,g));return new Vo(I);case"LineString":case"MultiLineString":return ae=Xy(C,w.type==="LineString"?0:1,U),new Wo(ae,g);case"Polygon":case"MultiPolygon":return ae=Xy(C,w.type==="Polygon"?1:2,U),new Uc(ae,g);case"GeometryCollection":for(ve=0,$e=w.geometries.length;ve<$e;ve++){var Ue=qy({geometry:w.geometries[ve],type:"Feature",properties:h.properties},g);Ue&&I.push(Ue)}return new Vo(I);case"FeatureCollection":for(ve=0,$e=w.features.length;ve<$e;ve++){var rt=qy(w.features[ve],g);rt&&I.push(rt)}return new Vo(I);default:throw new Error("Invalid GeoJSON object.")}}function SO(h,g,w,C){return h?h(g,w):new Hy(w,C&&C.markersInheritOptions&&C)}function tS(h){return new de(h[1],h[0],h[2])}function Xy(h,g,w){for(var C=[],I=0,P=h.length,U;I<P;I++)U=g?Xy(h[I],g-1,w):(w||tS)(h[I]),C.push(U);return C}function nS(h,g){return h=fe(h),h.alt!==void 0?[f(h.lng,g),f(h.lat,g),f(h.alt,g)]:[f(h.lng,g),f(h.lat,g)]}function Zy(h,g,w,C){for(var I=[],P=0,U=h.length;P<U;P++)I.push(g?Zy(h[P],Hs(h[P])?0:g-1,w,C):nS(h[P],C));return!g&&w&&I.length>0&&I.push(I[0].slice()),I}function Gc(h,g){return h.feature?s({},h.feature,{geometry:g}):Yy(g)}function Yy(h){return h.type==="Feature"||h.type==="FeatureCollection"?h:{type:"Feature",properties:{},geometry:h}}var rS={toGeoJSON:function(h){return Gc(this,{type:"Point",coordinates:nS(this.getLatLng(),h)})}};Hy.include(rS),eS.include(rS),Ky.include(rS),Wo.include({toGeoJSON:function(h){var g=!Hs(this._latlngs),w=Zy(this._latlngs,g?1:0,!1,h);return Gc(this,{type:(g?"Multi":"")+"LineString",coordinates:w})}}),Uc.include({toGeoJSON:function(h){var g=!Hs(this._latlngs),w=g&&!Hs(this._latlngs[0]),C=Zy(this._latlngs,w?2:g?1:0,!0,h);return g||(C=[C]),Gc(this,{type:(w?"Multi":"")+"Polygon",coordinates:C})}}),Vc.include({toMultiPoint:function(h){var g=[];return this.eachLayer(function(w){g.push(w.toGeoJSON(h).geometry.coordinates)}),Gc(this,{type:"MultiPoint",coordinates:g})},toGeoJSON:function(h){var g=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(g==="MultiPoint")return this.toMultiPoint(h);var w=g==="GeometryCollection",C=[];return this.eachLayer(function(I){if(I.toGeoJSON){var P=I.toGeoJSON(h);if(w)C.push(P.geometry);else{var U=Yy(P);U.type==="FeatureCollection"?C.push.apply(C,U.features):C.push(U)}}}),w?Gc(this,{geometries:C,type:"GeometryCollection"}):{type:"FeatureCollection",features:C}}});function kO(h,g){return new Uo(h,g)}var yX=kO,Qy=Ai.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(h,g,w){this._url=h,this._bounds=me(g),y(this,w)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(et(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Xt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(h){return this.options.opacity=h,this._image&&this._updateOpacity(),this},setStyle:function(h){return h.opacity&&this.setOpacity(h.opacity),this},bringToFront:function(){return this._map&&Bc(this._image),this},bringToBack:function(){return this._map&&jc(this._image),this},setUrl:function(h){return this._url=h,this._image&&(this._image.src=h),this},setBounds:function(h){return this._bounds=me(h),this._map&&this._reset(),this},getEvents:function(){var h={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},setZIndex:function(h){return this.options.zIndex=h,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var h=this._url.tagName==="IMG",g=this._image=h?this._url:pt("img");if(et(g,"leaflet-image-layer"),this._zoomAnimated&&et(g,"leaflet-zoom-animated"),this.options.className&&et(g,this.options.className),g.onselectstart=d,g.onmousemove=d,g.onload=o(this.fire,this,"load"),g.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),h){this._url=g.src;return}g.src=this._url,g.alt=this.options.alt},_animateZoom:function(h){var g=this._map.getZoomScale(h.zoom),w=this._map._latLngBoundsToNewLayerBounds(this._bounds,h.zoom,h.center).min;Jl(this._image,w,g)},_reset:function(){var h=this._image,g=new ie(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),w=g.getSize();yn(h,g.min),h.style.width=w.x+"px",h.style.height=w.y+"px"},_updateOpacity:function(){Gs(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var h=this.options.errorOverlayUrl;h&&this._url!==h&&(this._url=h,this._image.src=h)},getCenter:function(){return this._bounds.getCenter()}}),vX=function(h,g,w){return new Qy(h,g,w)},CO=Qy.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var h=this._url.tagName==="VIDEO",g=this._image=h?this._url:pt("video");if(et(g,"leaflet-image-layer"),this._zoomAnimated&&et(g,"leaflet-zoom-animated"),this.options.className&&et(g,this.options.className),g.onselectstart=d,g.onmousemove=d,g.onloadeddata=o(this.fire,this,"load"),h){for(var w=g.getElementsByTagName("source"),C=[],I=0;I<w.length;I++)C.push(w[I].src);this._url=w.length>0?C:[g.src];return}_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(g.style,"objectFit")&&(g.style.objectFit="fill"),g.autoplay=!!this.options.autoplay,g.loop=!!this.options.loop,g.muted=!!this.options.muted,g.playsInline=!!this.options.playsInline;for(var P=0;P<this._url.length;P++){var U=pt("source");U.src=this._url[P],g.appendChild(U)}}});function xX(h,g,w){return new CO(h,g,w)}var TO=Qy.extend({_initImage:function(){var h=this._image=this._url;et(h,"leaflet-image-layer"),this._zoomAnimated&&et(h,"leaflet-zoom-animated"),this.options.className&&et(h,this.options.className),h.onselectstart=d,h.onmousemove=d}});function bX(h,g,w){return new TO(h,g,w)}var fo=Ai.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(h,g){h&&(h instanceof de||_(h))?(this._latlng=fe(h),y(this,g)):(y(this,h),this._source=g),this.options.content&&(this._content=this.options.content)},openOn:function(h){return h=arguments.length?h:this._source._map,h.hasLayer(this)||h.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(h){return this._map?this.close():(arguments.length?this._source=h:h=this._source,this._prepareOpen(),this.openOn(h._map)),this},onAdd:function(h){this._zoomAnimated=h._zoomAnimated,this._container||this._initLayout(),h._fadeAnimated&&Gs(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),h._fadeAnimated&&Gs(this._container,1),this.bringToFront(),this.options.interactive&&(et(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(h){h._fadeAnimated?(Gs(this._container,0),this._removeTimeout=setTimeout(o(Xt,void 0,this._container),200)):Xt(this._container),this.options.interactive&&(cn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(h){return this._latlng=fe(h),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(h){return this._content=h,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var h={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Bc(this._container),this},bringToBack:function(){return this._map&&jc(this._container),this},_prepareOpen:function(h){var g=this._source;if(!g._map)return!1;if(g instanceof Vo){g=null;var w=this._source._layers;for(var C in w)if(w[C]._map){g=w[C];break}if(!g)return!1;this._source=g}if(!h)if(g.getCenter)h=g.getCenter();else if(g.getLatLng)h=g.getLatLng();else if(g.getBounds)h=g.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(h),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var h=this._contentNode,g=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof g=="string")h.innerHTML=g;else{for(;h.hasChildNodes();)h.removeChild(h.firstChild);h.appendChild(g)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var h=this._map.latLngToLayerPoint(this._latlng),g=Y(this.options.offset),w=this._getAnchor();this._zoomAnimated?yn(this._container,h.add(w)):g=g.add(h).add(w);var C=this._containerBottom=-g.y,I=this._containerLeft=-Math.round(this._containerWidth/2)+g.x;this._container.style.bottom=C+"px",this._container.style.left=I+"px"}},_getAnchor:function(){return[0,0]}});ct.include({_initOverlay:function(h,g,w,C){var I=g;return I instanceof h||(I=new h(C).setContent(g)),w&&I.setLatLng(w),I}}),Ai.include({_initOverlay:function(h,g,w,C){var I=w;return I instanceof h?(y(I,C),I._source=this):(I=g&&!C?g:new h(C,this),I.setContent(w)),I}});var Jy=fo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(h){return h=arguments.length?h:this._source._map,!h.hasLayer(this)&&h._popup&&h._popup.options.autoClose&&h.removeLayer(h._popup),h._popup=this,fo.prototype.openOn.call(this,h)},onAdd:function(h){fo.prototype.onAdd.call(this,h),h.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ba||this._source.on("preclick",tu))},onRemove:function(h){fo.prototype.onRemove.call(this,h),h.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ba||this._source.off("preclick",tu))},getEvents:function(){var h=fo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(h.preclick=this.close),this.options.keepInView&&(h.moveend=this._adjustPan),h},_initLayout:function(){var h="leaflet-popup",g=this._container=pt("div",h+" "+(this.options.className||"")+" leaflet-zoom-animated"),w=this._wrapper=pt("div",h+"-content-wrapper",g);if(this._contentNode=pt("div",h+"-content",w),Ff(g),H_(this._contentNode),Xe(g,"contextmenu",tu),this._tipContainer=pt("div",h+"-tip-container",g),this._tip=pt("div",h+"-tip",this._tipContainer),this.options.closeButton){var C=this._closeButton=pt("a",h+"-close-button",g);C.setAttribute("role","button"),C.setAttribute("aria-label","Close popup"),C.href="#close",C.innerHTML='<span aria-hidden="true">&#215;</span>',Xe(C,"click",function(I){sr(I),this.close()},this)}},_updateLayout:function(){var h=this._contentNode,g=h.style;g.width="",g.whiteSpace="nowrap";var w=h.offsetWidth;w=Math.min(w,this.options.maxWidth),w=Math.max(w,this.options.minWidth),g.width=w+1+"px",g.whiteSpace="",g.height="";var C=h.offsetHeight,I=this.options.maxHeight,P="leaflet-popup-scrolled";I&&C>I?(g.height=I+"px",et(h,P)):cn(h,P),this._containerWidth=this._container.offsetWidth},_animateZoom:function(h){var g=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center),w=this._getAnchor();yn(this._container,g.add(w))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var h=this._map,g=parseInt(Pf(this._container,"marginBottom"),10)||0,w=this._container.offsetHeight+g,C=this._containerWidth,I=new B(this._containerLeft,-w-this._containerBottom);I._add(eu(this._container));var P=h.layerPointToContainerPoint(I),U=Y(this.options.autoPanPadding),re=Y(this.options.autoPanPaddingTopLeft||U),ae=Y(this.options.autoPanPaddingBottomRight||U),ve=h.getSize(),$e=0,Ue=0;P.x+C+ae.x>ve.x&&($e=P.x+C-ve.x+ae.x),P.x-$e-re.x<0&&($e=P.x-re.x),P.y+w+ae.y>ve.y&&(Ue=P.y+w-ve.y+ae.y),P.y-Ue-re.y<0&&(Ue=P.y-re.y),($e||Ue)&&(this.options.keepInView&&(this._autopanning=!0),h.fire("autopanstart").panBy([$e,Ue]))}},_getAnchor:function(){return Y(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),wX=function(h,g){return new Jy(h,g)};ct.mergeOptions({closePopupOnClick:!0}),ct.include({openPopup:function(h,g,w){return this._initOverlay(Jy,h,g,w).openOn(this),this},closePopup:function(h){return h=arguments.length?h:this._popup,h&&h.close(),this}}),Ai.include({bindPopup:function(h,g){return this._popup=this._initOverlay(Jy,this._popup,h,g),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(h){return this._popup&&(this instanceof Vo||(this._popup._source=this),this._popup._prepareOpen(h||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(h){return this._popup&&this._popup.setContent(h),this},getPopup:function(){return this._popup},_openPopup:function(h){if(!(!this._popup||!this._map)){nu(h);var g=h.layer||h.target;if(this._popup._source===g&&!(g instanceof Ba)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(h.latlng);return}this._popup._source=g,this.openPopup(h.latlng)}},_movePopup:function(h){this._popup.setLatLng(h.latlng)},_onKeyPress:function(h){h.originalEvent.keyCode===13&&this._openPopup(h)}});var ev=fo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(h){fo.prototype.onAdd.call(this,h),this.setOpacity(this.options.opacity),h.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(h){fo.prototype.onRemove.call(this,h),h.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var h=fo.prototype.getEvents.call(this);return this.options.permanent||(h.preclick=this.close),h},_initLayout:function(){var h="leaflet-tooltip",g=h+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=pt("div",g),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(h){var g,w,C=this._map,I=this._container,P=C.latLngToContainerPoint(C.getCenter()),U=C.layerPointToContainerPoint(h),re=this.options.direction,ae=I.offsetWidth,ve=I.offsetHeight,$e=Y(this.options.offset),Ue=this._getAnchor();re==="top"?(g=ae/2,w=ve):re==="bottom"?(g=ae/2,w=0):re==="center"?(g=ae/2,w=ve/2):re==="right"?(g=0,w=ve/2):re==="left"?(g=ae,w=ve/2):U.x<P.x?(re="right",g=0,w=ve/2):(re="left",g=ae+($e.x+Ue.x)*2,w=ve/2),h=h.subtract(Y(g,w,!0)).add($e).add(Ue),cn(I,"leaflet-tooltip-right"),cn(I,"leaflet-tooltip-left"),cn(I,"leaflet-tooltip-top"),cn(I,"leaflet-tooltip-bottom"),et(I,"leaflet-tooltip-"+re),yn(I,h)},_updatePosition:function(){var h=this._map.latLngToLayerPoint(this._latlng);this._setPosition(h)},setOpacity:function(h){this.options.opacity=h,this._container&&Gs(this._container,h)},_animateZoom:function(h){var g=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center);this._setPosition(g)},_getAnchor:function(){return Y(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),_X=function(h,g){return new ev(h,g)};ct.include({openTooltip:function(h,g,w){return this._initOverlay(ev,h,g,w).openOn(this),this},closeTooltip:function(h){return h.close(),this}}),Ai.include({bindTooltip:function(h,g){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ev,this._tooltip,h,g),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(h){if(!(!h&&this._tooltipHandlersAdded)){var g=h?"off":"on",w={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?w.add=this._openTooltip:(w.mouseover=this._openTooltip,w.mouseout=this.closeTooltip,w.click=this._openTooltip,this._map?this._addFocusListeners():w.add=this._addFocusListeners),this._tooltip.options.sticky&&(w.mousemove=this._moveTooltip),this[g](w),this._tooltipHandlersAdded=!h}},openTooltip:function(h){return this._tooltip&&(this instanceof Vo||(this._tooltip._source=this),this._tooltip._prepareOpen(h)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(h){return this._tooltip&&this._tooltip.setContent(h),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(h){var g=typeof h.getElement=="function"&&h.getElement();g&&(Xe(g,"focus",function(){this._tooltip._source=h,this.openTooltip()},this),Xe(g,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(h){var g=typeof h.getElement=="function"&&h.getElement();g&&g.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(h){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var g=this;this._map.once("moveend",function(){g._openOnceFlag=!1,g._openTooltip(h)});return}this._tooltip._source=h.layer||h.target,this.openTooltip(this._tooltip.options.sticky?h.latlng:void 0)}},_moveTooltip:function(h){var g=h.latlng,w,C;this._tooltip.options.sticky&&h.originalEvent&&(w=this._map.mouseEventToContainerPoint(h.originalEvent),C=this._map.containerPointToLayerPoint(w),g=this._map.layerPointToLatLng(C)),this._tooltip.setLatLng(g)}});var NO=Wc.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(h){var g=h&&h.tagName==="DIV"?h:document.createElement("div"),w=this.options;if(w.html instanceof Element?(By(g),g.appendChild(w.html)):g.innerHTML=w.html!==!1?w.html:"",w.bgPos){var C=Y(w.bgPos);g.style.backgroundPosition=-C.x+"px "+-C.y+"px"}return this._setIconStyles(g,"icon"),g},createShadow:function(){return null}});function SX(h){return new NO(h)}Wc.Default=Bf;var jf=Ai.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ve.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(h){y(this,h)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(h){h._addZoomLimit(this)},onRemove:function(h){this._removeAllTiles(),Xt(this._container),h._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Bc(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(jc(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(h){return this.options.opacity=h,this._updateOpacity(),this},setZIndex:function(h){return this.options.zIndex=h,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var h=this._clampZoom(this._map.getZoom());h!==this._tileZoom&&(this._tileZoom=h,this._updateLevels()),this._update()}return this},getEvents:function(){var h={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),h.move=this._onMove),this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},createTile:function(){return document.createElement("div")},getTileSize:function(){var h=this.options.tileSize;return h instanceof B?h:new B(h,h)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(h){for(var g=this.getPane().children,w=-h(-1/0,1/0),C=0,I=g.length,P;C<I;C++)P=g[C].style.zIndex,g[C]!==this._container&&P&&(w=h(w,+P));isFinite(w)&&(this.options.zIndex=w+h(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ve.ielt9){Gs(this._container,this.options.opacity);var h=+new Date,g=!1,w=!1;for(var C in this._tiles){var I=this._tiles[C];if(!(!I.current||!I.loaded)){var P=Math.min(1,(h-I.loaded)/200);Gs(I.el,P),P<1?g=!0:(I.active?w=!0:this._onOpaqueTile(I),I.active=!0)}}w&&!this._noPrune&&this._pruneTiles(),g&&(j(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this))}},_onOpaqueTile:d,_initContainer:function(){this._container||(this._container=pt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var h=this._tileZoom,g=this.options.maxZoom;if(h!==void 0){for(var w in this._levels)w=Number(w),this._levels[w].el.children.length||w===h?(this._levels[w].el.style.zIndex=g-Math.abs(h-w),this._onUpdateLevel(w)):(Xt(this._levels[w].el),this._removeTilesAtZoom(w),this._onRemoveLevel(w),delete this._levels[w]);var C=this._levels[h],I=this._map;return C||(C=this._levels[h]={},C.el=pt("div","leaflet-tile-container leaflet-zoom-animated",this._container),C.el.style.zIndex=g,C.origin=I.project(I.unproject(I.getPixelOrigin()),h).round(),C.zoom=h,this._setZoomTransform(C,I.getCenter(),I.getZoom()),d(C.el.offsetWidth),this._onCreateLevel(C)),this._level=C,C}},_onUpdateLevel:d,_onRemoveLevel:d,_onCreateLevel:d,_pruneTiles:function(){if(this._map){var h,g,w=this._map.getZoom();if(w>this.options.maxZoom||w<this.options.minZoom){this._removeAllTiles();return}for(h in this._tiles)g=this._tiles[h],g.retain=g.current;for(h in this._tiles)if(g=this._tiles[h],g.current&&!g.active){var C=g.coords;this._retainParent(C.x,C.y,C.z,C.z-5)||this._retainChildren(C.x,C.y,C.z,C.z+2)}for(h in this._tiles)this._tiles[h].retain||this._removeTile(h)}},_removeTilesAtZoom:function(h){for(var g in this._tiles)this._tiles[g].coords.z===h&&this._removeTile(g)},_removeAllTiles:function(){for(var h in this._tiles)this._removeTile(h)},_invalidateAll:function(){for(var h in this._levels)Xt(this._levels[h].el),this._onRemoveLevel(Number(h)),delete this._levels[h];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(h,g,w,C){var I=Math.floor(h/2),P=Math.floor(g/2),U=w-1,re=new B(+I,+P);re.z=+U;var ae=this._tileCoordsToKey(re),ve=this._tiles[ae];return ve&&ve.active?(ve.retain=!0,!0):(ve&&ve.loaded&&(ve.retain=!0),U>C?this._retainParent(I,P,U,C):!1)},_retainChildren:function(h,g,w,C){for(var I=2*h;I<2*h+2;I++)for(var P=2*g;P<2*g+2;P++){var U=new B(I,P);U.z=w+1;var re=this._tileCoordsToKey(U),ae=this._tiles[re];if(ae&&ae.active){ae.retain=!0;continue}else ae&&ae.loaded&&(ae.retain=!0);w+1<C&&this._retainChildren(I,P,w+1,C)}},_resetView:function(h){var g=h&&(h.pinch||h.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),g,g)},_animateZoom:function(h){this._setView(h.center,h.zoom,!0,h.noUpdate)},_clampZoom:function(h){var g=this.options;return g.minNativeZoom!==void 0&&h<g.minNativeZoom?g.minNativeZoom:g.maxNativeZoom!==void 0&&g.maxNativeZoom<h?g.maxNativeZoom:h},_setView:function(h,g,w,C){var I=Math.round(g);this.options.maxZoom!==void 0&&I>this.options.maxZoom||this.options.minZoom!==void 0&&I<this.options.minZoom?I=void 0:I=this._clampZoom(I);var P=this.options.updateWhenZooming&&I!==this._tileZoom;(!C||P)&&(this._tileZoom=I,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),I!==void 0&&this._update(h),w||this._pruneTiles(),this._noPrune=!!w),this._setZoomTransforms(h,g)},_setZoomTransforms:function(h,g){for(var w in this._levels)this._setZoomTransform(this._levels[w],h,g)},_setZoomTransform:function(h,g,w){var C=this._map.getZoomScale(w,h.zoom),I=h.origin.multiplyBy(C).subtract(this._map._getNewPixelOrigin(g,w)).round();Ve.any3d?Jl(h.el,I,C):yn(h.el,I)},_resetGrid:function(){var h=this._map,g=h.options.crs,w=this._tileSize=this.getTileSize(),C=this._tileZoom,I=this._map.getPixelWorldBounds(this._tileZoom);I&&(this._globalTileRange=this._pxBoundsToTileRange(I)),this._wrapX=g.wrapLng&&!this.options.noWrap&&[Math.floor(h.project([0,g.wrapLng[0]],C).x/w.x),Math.ceil(h.project([0,g.wrapLng[1]],C).x/w.y)],this._wrapY=g.wrapLat&&!this.options.noWrap&&[Math.floor(h.project([g.wrapLat[0],0],C).y/w.x),Math.ceil(h.project([g.wrapLat[1],0],C).y/w.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(h){var g=this._map,w=g._animatingZoom?Math.max(g._animateToZoom,g.getZoom()):g.getZoom(),C=g.getZoomScale(w,this._tileZoom),I=g.project(h,this._tileZoom).floor(),P=g.getSize().divideBy(C*2);return new ie(I.subtract(P),I.add(P))},_update:function(h){var g=this._map;if(g){var w=this._clampZoom(g.getZoom());if(h===void 0&&(h=g.getCenter()),this._tileZoom!==void 0){var C=this._getTiledPixelBounds(h),I=this._pxBoundsToTileRange(C),P=I.getCenter(),U=[],re=this.options.keepBuffer,ae=new ie(I.getBottomLeft().subtract([re,-re]),I.getTopRight().add([re,-re]));if(!(isFinite(I.min.x)&&isFinite(I.min.y)&&isFinite(I.max.x)&&isFinite(I.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ve in this._tiles){var $e=this._tiles[ve].coords;($e.z!==this._tileZoom||!ae.contains(new B($e.x,$e.y)))&&(this._tiles[ve].current=!1)}if(Math.abs(w-this._tileZoom)>1){this._setView(h,w);return}for(var Ue=I.min.y;Ue<=I.max.y;Ue++)for(var rt=I.min.x;rt<=I.max.x;rt++){var Ar=new B(rt,Ue);if(Ar.z=this._tileZoom,!!this._isValidTile(Ar)){var jn=this._tiles[this._tileCoordsToKey(Ar)];jn?jn.current=!0:U.push(Ar)}}if(U.sort(function(Xr,Kc){return Xr.distanceTo(P)-Kc.distanceTo(P)}),U.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ks=document.createDocumentFragment();for(rt=0;rt<U.length;rt++)this._addTile(U[rt],Ks);this._level.el.appendChild(Ks)}}}},_isValidTile:function(h){var g=this._map.options.crs;if(!g.infinite){var w=this._globalTileRange;if(!g.wrapLng&&(h.x<w.min.x||h.x>w.max.x)||!g.wrapLat&&(h.y<w.min.y||h.y>w.max.y))return!1}if(!this.options.bounds)return!0;var C=this._tileCoordsToBounds(h);return me(this.options.bounds).overlaps(C)},_keyToBounds:function(h){return this._tileCoordsToBounds(this._keyToTileCoords(h))},_tileCoordsToNwSe:function(h){var g=this._map,w=this.getTileSize(),C=h.scaleBy(w),I=C.add(w),P=g.unproject(C,h.z),U=g.unproject(I,h.z);return[P,U]},_tileCoordsToBounds:function(h){var g=this._tileCoordsToNwSe(h),w=new pe(g[0],g[1]);return this.options.noWrap||(w=this._map.wrapLatLngBounds(w)),w},_tileCoordsToKey:function(h){return h.x+":"+h.y+":"+h.z},_keyToTileCoords:function(h){var g=h.split(":"),w=new B(+g[0],+g[1]);return w.z=+g[2],w},_removeTile:function(h){var g=this._tiles[h];g&&(Xt(g.el),delete this._tiles[h],this.fire("tileunload",{tile:g.el,coords:this._keyToTileCoords(h)}))},_initTile:function(h){et(h,"leaflet-tile");var g=this.getTileSize();h.style.width=g.x+"px",h.style.height=g.y+"px",h.onselectstart=d,h.onmousemove=d,Ve.ielt9&&this.options.opacity<1&&Gs(h,this.options.opacity)},_addTile:function(h,g){var w=this._getTilePos(h),C=this._tileCoordsToKey(h),I=this.createTile(this._wrapCoords(h),o(this._tileReady,this,h));this._initTile(I),this.createTile.length<2&&M(o(this._tileReady,this,h,null,I)),yn(I,w),this._tiles[C]={el:I,coords:h,current:!0},g.appendChild(I),this.fire("tileloadstart",{tile:I,coords:h})},_tileReady:function(h,g,w){g&&this.fire("tileerror",{error:g,tile:w,coords:h});var C=this._tileCoordsToKey(h);w=this._tiles[C],w&&(w.loaded=+new Date,this._map._fadeAnimated?(Gs(w.el,0),j(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this)):(w.active=!0,this._pruneTiles()),g||(et(w.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:w.el,coords:h})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ve.ielt9||!this._map._fadeAnimated?M(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(h){return h.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(h){var g=new B(this._wrapX?c(h.x,this._wrapX):h.x,this._wrapY?c(h.y,this._wrapY):h.y);return g.z=h.z,g},_pxBoundsToTileRange:function(h){var g=this.getTileSize();return new ie(h.min.unscaleBy(g).floor(),h.max.unscaleBy(g).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var h in this._tiles)if(!this._tiles[h].loaded)return!1;return!0}});function kX(h){return new jf(h)}var Hc=jf.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(h,g){this._url=h,g=y(this,g),g.detectRetina&&Ve.retina&&g.maxZoom>0?(g.tileSize=Math.floor(g.tileSize/2),g.zoomReverse?(g.zoomOffset--,g.minZoom=Math.min(g.maxZoom,g.minZoom+1)):(g.zoomOffset++,g.maxZoom=Math.max(g.minZoom,g.maxZoom-1)),g.minZoom=Math.max(0,g.minZoom)):g.zoomReverse?g.minZoom=Math.min(g.maxZoom,g.minZoom):g.maxZoom=Math.max(g.minZoom,g.maxZoom),typeof g.subdomains=="string"&&(g.subdomains=g.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(h,g){return this._url===h&&g===void 0&&(g=!0),this._url=h,g||this.redraw(),this},createTile:function(h,g){var w=document.createElement("img");return Xe(w,"load",o(this._tileOnLoad,this,g,w)),Xe(w,"error",o(this._tileOnError,this,g,w)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(w.referrerPolicy=this.options.referrerPolicy),w.alt="",w.src=this.getTileUrl(h),w},getTileUrl:function(h){var g={r:Ve.retina?"@2x":"",s:this._getSubdomain(h),x:h.x,y:h.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var w=this._globalTileRange.max.y-h.y;this.options.tms&&(g.y=w),g["-y"]=w}return b(this._url,s(g,this.options))},_tileOnLoad:function(h,g){Ve.ielt9?setTimeout(o(h,this,null,g),0):h(null,g)},_tileOnError:function(h,g,w){var C=this.options.errorTileUrl;C&&g.getAttribute("src")!==C&&(g.src=C),h(w,g)},_onTileRemove:function(h){h.tile.onload=null},_getZoomForUrl:function(){var h=this._tileZoom,g=this.options.maxZoom,w=this.options.zoomReverse,C=this.options.zoomOffset;return w&&(h=g-h),h+C},_getSubdomain:function(h){var g=Math.abs(h.x+h.y)%this.options.subdomains.length;return this.options.subdomains[g]},_abortLoading:function(){var h,g;for(h in this._tiles)if(this._tiles[h].coords.z!==this._tileZoom&&(g=this._tiles[h].el,g.onload=d,g.onerror=d,!g.complete)){g.src=k;var w=this._tiles[h].coords;Xt(g),delete this._tiles[h],this.fire("tileabort",{tile:g,coords:w})}},_removeTile:function(h){var g=this._tiles[h];if(g)return g.el.setAttribute("src",k),jf.prototype._removeTile.call(this,h)},_tileReady:function(h,g,w){if(!(!this._map||w&&w.getAttribute("src")===k))return jf.prototype._tileReady.call(this,h,g,w)}});function IO(h,g){return new Hc(h,g)}var $O=Hc.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(h,g){this._url=h;var w=s({},this.defaultWmsParams);for(var C in g)C in this.options||(w[C]=g[C]);g=y(this,g);var I=g.detectRetina&&Ve.retina?2:1,P=this.getTileSize();w.width=P.x*I,w.height=P.y*I,this.wmsParams=w},onAdd:function(h){this._crs=this.options.crs||h.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var g=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[g]=this._crs.code,Hc.prototype.onAdd.call(this,h)},getTileUrl:function(h){var g=this._tileCoordsToNwSe(h),w=this._crs,C=ne(w.project(g[0]),w.project(g[1])),I=C.min,P=C.max,U=(this._wmsVersion>=1.3&&this._crs===wO?[I.y,I.x,P.y,P.x]:[I.x,I.y,P.x,P.y]).join(","),re=Hc.prototype.getTileUrl.call(this,h);return re+v(this.wmsParams,re,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+U},setParams:function(h,g){return s(this.wmsParams,h),g||this.redraw(),this}});function CX(h,g){return new $O(h,g)}Hc.WMS=$O,IO.wms=CX;var Go=Ai.extend({options:{padding:.1},initialize:function(h){y(this,h),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),et(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var h={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(h.zoomanim=this._onAnimZoom),h},_onAnimZoom:function(h){this._updateTransform(h.center,h.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(h,g){var w=this._map.getZoomScale(g,this._zoom),C=this._map.getSize().multiplyBy(.5+this.options.padding),I=this._map.project(this._center,g),P=C.multiplyBy(-w).add(I).subtract(this._map._getNewPixelOrigin(h,g));Ve.any3d?Jl(this._container,P,w):yn(this._container,P)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var h in this._layers)this._layers[h]._reset()},_onZoomEnd:function(){for(var h in this._layers)this._layers[h]._project()},_updatePaths:function(){for(var h in this._layers)this._layers[h]._update()},_update:function(){var h=this.options.padding,g=this._map.getSize(),w=this._map.containerPointToLayerPoint(g.multiplyBy(-h)).round();this._bounds=new ie(w,w.add(g.multiplyBy(1+h*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),EO=Go.extend({options:{tolerance:0},getEvents:function(){var h=Go.prototype.getEvents.call(this);return h.viewprereset=this._onViewPreReset,h},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Go.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var h=this._container=document.createElement("canvas");Xe(h,"mousemove",this._onMouseMove,this),Xe(h,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Xe(h,"mouseout",this._handleMouseOut,this),h._leaflet_disable_events=!0,this._ctx=h.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,Xt(this._container),At(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var h;this._redrawBounds=null;for(var g in this._layers)h=this._layers[g],h._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Go.prototype._update.call(this);var h=this._bounds,g=this._container,w=h.getSize(),C=Ve.retina?2:1;yn(g,h.min),g.width=C*w.x,g.height=C*w.y,g.style.width=w.x+"px",g.style.height=w.y+"px",Ve.retina&&this._ctx.scale(2,2),this._ctx.translate(-h.min.x,-h.min.y),this.fire("update")}},_reset:function(){Go.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(h){this._updateDashArray(h),this._layers[l(h)]=h;var g=h._order={layer:h,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=g),this._drawLast=g,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(h){this._requestRedraw(h)},_removePath:function(h){var g=h._order,w=g.next,C=g.prev;w?w.prev=C:this._drawLast=C,C?C.next=w:this._drawFirst=w,delete h._order,delete this._layers[l(h)],this._requestRedraw(h)},_updatePath:function(h){this._extendRedrawBounds(h),h._project(),h._update(),this._requestRedraw(h)},_updateStyle:function(h){this._updateDashArray(h),this._requestRedraw(h)},_updateDashArray:function(h){if(typeof h.options.dashArray=="string"){var g=h.options.dashArray.split(/[, ]+/),w=[],C,I;for(I=0;I<g.length;I++){if(C=Number(g[I]),isNaN(C))return;w.push(C)}h.options._dashArray=w}else h.options._dashArray=h.options.dashArray},_requestRedraw:function(h){this._map&&(this._extendRedrawBounds(h),this._redrawRequest=this._redrawRequest||M(this._redraw,this))},_extendRedrawBounds:function(h){if(h._pxBounds){var g=(h.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ie,this._redrawBounds.extend(h._pxBounds.min.subtract([g,g])),this._redrawBounds.extend(h._pxBounds.max.add([g,g]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var h=this._redrawBounds;if(h){var g=h.getSize();this._ctx.clearRect(h.min.x,h.min.y,g.x,g.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var h,g=this._redrawBounds;if(this._ctx.save(),g){var w=g.getSize();this._ctx.beginPath(),this._ctx.rect(g.min.x,g.min.y,w.x,w.y),this._ctx.clip()}this._drawing=!0;for(var C=this._drawFirst;C;C=C.next)h=C.layer,(!g||h._pxBounds&&h._pxBounds.intersects(g))&&h._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(h,g){if(this._drawing){var w,C,I,P,U=h._parts,re=U.length,ae=this._ctx;if(re){for(ae.beginPath(),w=0;w<re;w++){for(C=0,I=U[w].length;C<I;C++)P=U[w][C],ae[C?"lineTo":"moveTo"](P.x,P.y);g&&ae.closePath()}this._fillStroke(ae,h)}}},_updateCircle:function(h){if(!(!this._drawing||h._empty())){var g=h._point,w=this._ctx,C=Math.max(Math.round(h._radius),1),I=(Math.max(Math.round(h._radiusY),1)||C)/C;I!==1&&(w.save(),w.scale(1,I)),w.beginPath(),w.arc(g.x,g.y/I,C,0,Math.PI*2,!1),I!==1&&w.restore(),this._fillStroke(w,h)}},_fillStroke:function(h,g){var w=g.options;w.fill&&(h.globalAlpha=w.fillOpacity,h.fillStyle=w.fillColor||w.color,h.fill(w.fillRule||"evenodd")),w.stroke&&w.weight!==0&&(h.setLineDash&&h.setLineDash(g.options&&g.options._dashArray||[]),h.globalAlpha=w.opacity,h.lineWidth=w.weight,h.strokeStyle=w.color,h.lineCap=w.lineCap,h.lineJoin=w.lineJoin,h.stroke())},_onClick:function(h){for(var g=this._map.mouseEventToLayerPoint(h),w,C,I=this._drawFirst;I;I=I.next)w=I.layer,w.options.interactive&&w._containsPoint(g)&&(!(h.type==="click"||h.type==="preclick")||!this._map._draggableMoved(w))&&(C=w);this._fireEvent(C?[C]:!1,h)},_onMouseMove:function(h){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var g=this._map.mouseEventToLayerPoint(h);this._handleMouseHover(h,g)}},_handleMouseOut:function(h){var g=this._hoveredLayer;g&&(cn(this._container,"leaflet-interactive"),this._fireEvent([g],h,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(h,g){if(!this._mouseHoverThrottled){for(var w,C,I=this._drawFirst;I;I=I.next)w=I.layer,w.options.interactive&&w._containsPoint(g)&&(C=w);C!==this._hoveredLayer&&(this._handleMouseOut(h),C&&(et(this._container,"leaflet-interactive"),this._fireEvent([C],h,"mouseover"),this._hoveredLayer=C)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,h),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(h,g,w){this._map._fireDOMEvent(g,w||g.type,h)},_bringToFront:function(h){var g=h._order;if(g){var w=g.next,C=g.prev;if(w)w.prev=C;else return;C?C.next=w:w&&(this._drawFirst=w),g.prev=this._drawLast,this._drawLast.next=g,g.next=null,this._drawLast=g,this._requestRedraw(h)}},_bringToBack:function(h){var g=h._order;if(g){var w=g.next,C=g.prev;if(C)C.next=w;else return;w?w.prev=C:C&&(this._drawLast=C),g.prev=null,g.next=this._drawFirst,this._drawFirst.prev=g,this._drawFirst=g,this._requestRedraw(h)}}});function AO(h){return Ve.canvas?new EO(h):null}var Vf=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(h){return document.createElement("<lvml:"+h+' class="lvml">')}}catch{}return function(h){return document.createElement("<"+h+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),TX={_initContainer:function(){this._container=pt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Go.prototype._update.call(this),this.fire("update"))},_initPath:function(h){var g=h._container=Vf("shape");et(g,"leaflet-vml-shape "+(this.options.className||"")),g.coordsize="1 1",h._path=Vf("path"),g.appendChild(h._path),this._updateStyle(h),this._layers[l(h)]=h},_addPath:function(h){var g=h._container;this._container.appendChild(g),h.options.interactive&&h.addInteractiveTarget(g)},_removePath:function(h){var g=h._container;Xt(g),h.removeInteractiveTarget(g),delete this._layers[l(h)]},_updateStyle:function(h){var g=h._stroke,w=h._fill,C=h.options,I=h._container;I.stroked=!!C.stroke,I.filled=!!C.fill,C.stroke?(g||(g=h._stroke=Vf("stroke")),I.appendChild(g),g.weight=C.weight+"px",g.color=C.color,g.opacity=C.opacity,C.dashArray?g.dashStyle=_(C.dashArray)?C.dashArray.join(" "):C.dashArray.replace(/( *, *)/g," "):g.dashStyle="",g.endcap=C.lineCap.replace("butt","flat"),g.joinstyle=C.lineJoin):g&&(I.removeChild(g),h._stroke=null),C.fill?(w||(w=h._fill=Vf("fill")),I.appendChild(w),w.color=C.fillColor||C.color,w.opacity=C.fillOpacity):w&&(I.removeChild(w),h._fill=null)},_updateCircle:function(h){var g=h._point.round(),w=Math.round(h._radius),C=Math.round(h._radiusY||w);this._setPath(h,h._empty()?"M0 0":"AL "+g.x+","+g.y+" "+w+","+C+" 0,"+65535*360)},_setPath:function(h,g){h._path.v=g},_bringToFront:function(h){Bc(h._container)},_bringToBack:function(h){jc(h._container)}},tv=Ve.vml?Vf:He,Wf=Go.extend({_initContainer:function(){this._container=tv("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=tv("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Xt(this._container),At(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Go.prototype._update.call(this);var h=this._bounds,g=h.getSize(),w=this._container;(!this._svgSize||!this._svgSize.equals(g))&&(this._svgSize=g,w.setAttribute("width",g.x),w.setAttribute("height",g.y)),yn(w,h.min),w.setAttribute("viewBox",[h.min.x,h.min.y,g.x,g.y].join(" ")),this.fire("update")}},_initPath:function(h){var g=h._path=tv("path");h.options.className&&et(g,h.options.className),h.options.interactive&&et(g,"leaflet-interactive"),this._updateStyle(h),this._layers[l(h)]=h},_addPath:function(h){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(h._path),h.addInteractiveTarget(h._path)},_removePath:function(h){Xt(h._path),h.removeInteractiveTarget(h._path),delete this._layers[l(h)]},_updatePath:function(h){h._project(),h._update()},_updateStyle:function(h){var g=h._path,w=h.options;g&&(w.stroke?(g.setAttribute("stroke",w.color),g.setAttribute("stroke-opacity",w.opacity),g.setAttribute("stroke-width",w.weight),g.setAttribute("stroke-linecap",w.lineCap),g.setAttribute("stroke-linejoin",w.lineJoin),w.dashArray?g.setAttribute("stroke-dasharray",w.dashArray):g.removeAttribute("stroke-dasharray"),w.dashOffset?g.setAttribute("stroke-dashoffset",w.dashOffset):g.removeAttribute("stroke-dashoffset")):g.setAttribute("stroke","none"),w.fill?(g.setAttribute("fill",w.fillColor||w.color),g.setAttribute("fill-opacity",w.fillOpacity),g.setAttribute("fill-rule",w.fillRule||"evenodd")):g.setAttribute("fill","none"))},_updatePoly:function(h,g){this._setPath(h,Ge(h._parts,g))},_updateCircle:function(h){var g=h._point,w=Math.max(Math.round(h._radius),1),C=Math.max(Math.round(h._radiusY),1)||w,I="a"+w+","+C+" 0 1,0 ",P=h._empty()?"M0 0":"M"+(g.x-w)+","+g.y+I+w*2+",0 "+I+-w*2+",0 ";this._setPath(h,P)},_setPath:function(h,g){h._path.setAttribute("d",g)},_bringToFront:function(h){Bc(h._path)},_bringToBack:function(h){jc(h._path)}});Ve.vml&&Wf.include(TX);function OO(h){return Ve.svg||Ve.vml?new Wf(h):null}ct.include({getRenderer:function(h){var g=h.options.renderer||this._getPaneRenderer(h.options.pane)||this.options.renderer||this._renderer;return g||(g=this._renderer=this._createRenderer()),this.hasLayer(g)||this.addLayer(g),g},_getPaneRenderer:function(h){if(h==="overlayPane"||h===void 0)return!1;var g=this._paneRenderers[h];return g===void 0&&(g=this._createRenderer({pane:h}),this._paneRenderers[h]=g),g},_createRenderer:function(h){return this.options.preferCanvas&&AO(h)||OO(h)}});var PO=Uc.extend({initialize:function(h,g){Uc.prototype.initialize.call(this,this._boundsToLatLngs(h),g)},setBounds:function(h){return this.setLatLngs(this._boundsToLatLngs(h))},_boundsToLatLngs:function(h){return h=me(h),[h.getSouthWest(),h.getNorthWest(),h.getNorthEast(),h.getSouthEast()]}});function NX(h,g){return new PO(h,g)}Wf.create=tv,Wf.pointsToPath=Ge,Uo.geometryToLayer=qy,Uo.coordsToLatLng=tS,Uo.coordsToLatLngs=Xy,Uo.latLngToCoords=nS,Uo.latLngsToCoords=Zy,Uo.getFeature=Gc,Uo.asFeature=Yy,ct.mergeOptions({boxZoom:!0});var DO=ho.extend({initialize:function(h){this._map=h,this._container=h._container,this._pane=h._panes.overlayPane,this._resetStateTimeout=0,h.on("unload",this._destroy,this)},addHooks:function(){Xe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){At(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Xt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(h){if(!h.shiftKey||h.which!==1&&h.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Df(),M_(),this._startPoint=this._map.mouseEventToContainerPoint(h),Xe(document,{contextmenu:nu,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(h){this._moved||(this._moved=!0,this._box=pt("div","leaflet-zoom-box",this._container),et(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(h);var g=new ie(this._point,this._startPoint),w=g.getSize();yn(this._box,g.min),this._box.style.width=w.x+"px",this._box.style.height=w.y+"px"},_finish:function(){this._moved&&(Xt(this._box),cn(this._container,"leaflet-crosshair")),Rf(),z_(),At(document,{contextmenu:nu,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(h){if(!(h.which!==1&&h.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var g=new pe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(g).fire("boxzoomend",{boxZoomBounds:g})}},_onKeyDown:function(h){h.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ct.addInitHook("addHandler","boxZoom",DO),ct.mergeOptions({doubleClickZoom:!0});var RO=ho.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(h){var g=this._map,w=g.getZoom(),C=g.options.zoomDelta,I=h.originalEvent.shiftKey?w-C:w+C;g.options.doubleClickZoom==="center"?g.setZoom(I):g.setZoomAround(h.containerPoint,I)}});ct.addInitHook("addHandler","doubleClickZoom",RO),ct.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var LO=ho.extend({addHooks:function(){if(!this._draggable){var h=this._map;this._draggable=new za(h._mapPane,h._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),h.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),h.on("zoomend",this._onZoomEnd,this),h.whenReady(this._onZoomEnd,this))}et(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){cn(this._map._container,"leaflet-grab"),cn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var h=this._map;if(h._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var g=me(this._map.options.maxBounds);this._offsetLimit=ne(this._map.latLngToContainerPoint(g.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(g.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;h.fire("movestart").fire("dragstart"),h.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(h){if(this._map.options.inertia){var g=this._lastTime=+new Date,w=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(w),this._times.push(g),this._prunePositions(g)}this._map.fire("move",h).fire("drag",h)},_prunePositions:function(h){for(;this._positions.length>1&&h-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var h=this._map.getSize().divideBy(2),g=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=g.subtract(h).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(h,g){return h-(h-g)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var h=this._draggable._newPos.subtract(this._draggable._startPos),g=this._offsetLimit;h.x<g.min.x&&(h.x=this._viscousLimit(h.x,g.min.x)),h.y<g.min.y&&(h.y=this._viscousLimit(h.y,g.min.y)),h.x>g.max.x&&(h.x=this._viscousLimit(h.x,g.max.x)),h.y>g.max.y&&(h.y=this._viscousLimit(h.y,g.max.y)),this._draggable._newPos=this._draggable._startPos.add(h)}},_onPreDragWrap:function(){var h=this._worldWidth,g=Math.round(h/2),w=this._initialWorldOffset,C=this._draggable._newPos.x,I=(C-g+w)%h+g-w,P=(C+g+w)%h-g-w,U=Math.abs(I+w)<Math.abs(P+w)?I:P;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=U},_onDragEnd:function(h){var g=this._map,w=g.options,C=!w.inertia||h.noInertia||this._times.length<2;if(g.fire("dragend",h),C)g.fire("moveend");else{this._prunePositions(+new Date);var I=this._lastPos.subtract(this._positions[0]),P=(this._lastTime-this._times[0])/1e3,U=w.easeLinearity,re=I.multiplyBy(U/P),ae=re.distanceTo([0,0]),ve=Math.min(w.inertiaMaxSpeed,ae),$e=re.multiplyBy(ve/ae),Ue=ve/(w.inertiaDeceleration*U),rt=$e.multiplyBy(-Ue/2).round();!rt.x&&!rt.y?g.fire("moveend"):(rt=g._limitOffset(rt,g.options.maxBounds),M(function(){g.panBy(rt,{duration:Ue,easeLinearity:U,noMoveStart:!0,animate:!0})}))}}});ct.addInitHook("addHandler","dragging",LO),ct.mergeOptions({keyboard:!0,keyboardPanDelta:80});var FO=ho.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(h){this._map=h,this._setPanDelta(h.options.keyboardPanDelta),this._setZoomDelta(h.options.zoomDelta)},addHooks:function(){var h=this._map._container;h.tabIndex<=0&&(h.tabIndex="0"),Xe(h,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),At(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var h=document.body,g=document.documentElement,w=h.scrollTop||g.scrollTop,C=h.scrollLeft||g.scrollLeft;this._map._container.focus(),window.scrollTo(C,w)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(h){var g=this._panKeys={},w=this.keyCodes,C,I;for(C=0,I=w.left.length;C<I;C++)g[w.left[C]]=[-1*h,0];for(C=0,I=w.right.length;C<I;C++)g[w.right[C]]=[h,0];for(C=0,I=w.down.length;C<I;C++)g[w.down[C]]=[0,h];for(C=0,I=w.up.length;C<I;C++)g[w.up[C]]=[0,-1*h]},_setZoomDelta:function(h){var g=this._zoomKeys={},w=this.keyCodes,C,I;for(C=0,I=w.zoomIn.length;C<I;C++)g[w.zoomIn[C]]=h;for(C=0,I=w.zoomOut.length;C<I;C++)g[w.zoomOut[C]]=-h},_addHooks:function(){Xe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){At(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(h){if(!(h.altKey||h.ctrlKey||h.metaKey)){var g=h.keyCode,w=this._map,C;if(g in this._panKeys){if(!w._panAnim||!w._panAnim._inProgress)if(C=this._panKeys[g],h.shiftKey&&(C=Y(C).multiplyBy(3)),w.options.maxBounds&&(C=w._limitOffset(Y(C),w.options.maxBounds)),w.options.worldCopyJump){var I=w.wrapLatLng(w.unproject(w.project(w.getCenter()).add(C)));w.panTo(I)}else w.panBy(C)}else if(g in this._zoomKeys)w.setZoom(w.getZoom()+(h.shiftKey?3:1)*this._zoomKeys[g]);else if(g===27&&w._popup&&w._popup.options.closeOnEscapeKey)w.closePopup();else return;nu(h)}}});ct.addInitHook("addHandler","keyboard",FO),ct.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var MO=ho.extend({addHooks:function(){Xe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){At(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(h){var g=lO(h),w=this._map.options.wheelDebounceTime;this._delta+=g,this._lastMousePos=this._map.mouseEventToContainerPoint(h),this._startTime||(this._startTime=+new Date);var C=Math.max(w-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),C),nu(h)},_performZoom:function(){var h=this._map,g=h.getZoom(),w=this._map.options.zoomSnap||0;h._stop();var C=this._delta/(this._map.options.wheelPxPerZoomLevel*4),I=4*Math.log(2/(1+Math.exp(-Math.abs(C))))/Math.LN2,P=w?Math.ceil(I/w)*w:I,U=h._limitZoom(g+(this._delta>0?P:-P))-g;this._delta=0,this._startTime=null,U&&(h.options.scrollWheelZoom==="center"?h.setZoom(g+U):h.setZoomAround(this._lastMousePos,g+U))}});ct.addInitHook("addHandler","scrollWheelZoom",MO);var IX=600;ct.mergeOptions({tapHold:Ve.touchNative&&Ve.safari&&Ve.mobile,tapTolerance:15});var zO=ho.extend({addHooks:function(){Xe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){At(this._map._container,"touchstart",this._onDown,this)},_onDown:function(h){if(clearTimeout(this._holdTimeout),h.touches.length===1){var g=h.touches[0];this._startPos=this._newPos=new B(g.clientX,g.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Xe(document,"touchend",sr),Xe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",g))},this),IX),Xe(document,"touchend touchcancel contextmenu",this._cancel,this),Xe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function h(){At(document,"touchend",sr),At(document,"touchend touchcancel",h)},_cancel:function(){clearTimeout(this._holdTimeout),At(document,"touchend touchcancel contextmenu",this._cancel,this),At(document,"touchmove",this._onMove,this)},_onMove:function(h){var g=h.touches[0];this._newPos=new B(g.clientX,g.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(h,g){var w=new MouseEvent(h,{bubbles:!0,cancelable:!0,view:window,screenX:g.screenX,screenY:g.screenY,clientX:g.clientX,clientY:g.clientY});w._simulated=!0,g.target.dispatchEvent(w)}});ct.addInitHook("addHandler","tapHold",zO),ct.mergeOptions({touchZoom:Ve.touch,bounceAtZoomLimits:!0});var BO=ho.extend({addHooks:function(){et(this._map._container,"leaflet-touch-zoom"),Xe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){cn(this._map._container,"leaflet-touch-zoom"),At(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(h){var g=this._map;if(!(!h.touches||h.touches.length!==2||g._animatingZoom||this._zooming)){var w=g.mouseEventToContainerPoint(h.touches[0]),C=g.mouseEventToContainerPoint(h.touches[1]);this._centerPoint=g.getSize()._divideBy(2),this._startLatLng=g.containerPointToLatLng(this._centerPoint),g.options.touchZoom!=="center"&&(this._pinchStartLatLng=g.containerPointToLatLng(w.add(C)._divideBy(2))),this._startDist=w.distanceTo(C),this._startZoom=g.getZoom(),this._moved=!1,this._zooming=!0,g._stop(),Xe(document,"touchmove",this._onTouchMove,this),Xe(document,"touchend touchcancel",this._onTouchEnd,this),sr(h)}},_onTouchMove:function(h){if(!(!h.touches||h.touches.length!==2||!this._zooming)){var g=this._map,w=g.mouseEventToContainerPoint(h.touches[0]),C=g.mouseEventToContainerPoint(h.touches[1]),I=w.distanceTo(C)/this._startDist;if(this._zoom=g.getScaleZoom(I,this._startZoom),!g.options.bounceAtZoomLimits&&(this._zoom<g.getMinZoom()&&I<1||this._zoom>g.getMaxZoom()&&I>1)&&(this._zoom=g._limitZoom(this._zoom)),g.options.touchZoom==="center"){if(this._center=this._startLatLng,I===1)return}else{var P=w._add(C)._divideBy(2)._subtract(this._centerPoint);if(I===1&&P.x===0&&P.y===0)return;this._center=g.unproject(g.project(this._pinchStartLatLng,this._zoom).subtract(P),this._zoom)}this._moved||(g._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var U=o(g._move,g,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=M(U,this,!0),sr(h)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),At(document,"touchmove",this._onTouchMove,this),At(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ct.addInitHook("addHandler","touchZoom",BO),ct.BoxZoom=DO,ct.DoubleClickZoom=RO,ct.Drag=LO,ct.Keyboard=FO,ct.ScrollWheelZoom=MO,ct.TapHold=zO,ct.TouchZoom=BO,n.Bounds=ie,n.Browser=Ve,n.CRS=ke,n.Canvas=EO,n.Circle=eS,n.CircleMarker=Ky,n.Class=K,n.Control=Ei,n.DivIcon=NO,n.DivOverlay=fo,n.DomEvent=Hq,n.DomUtil=Uq,n.Draggable=za,n.Evented=se,n.FeatureGroup=Vo,n.GeoJSON=Uo,n.GridLayer=jf,n.Handler=ho,n.Icon=Wc,n.ImageOverlay=Qy,n.LatLng=de,n.LatLngBounds=pe,n.Layer=Ai,n.LayerGroup=Vc,n.LineUtil=iX,n.Map=ct,n.Marker=Hy,n.Mixin=Jq,n.Path=Ba,n.Point=B,n.PolyUtil=eX,n.Polygon=Uc,n.Polyline=Wo,n.Popup=Jy,n.PosAnimation=uO,n.Projection=oX,n.Rectangle=PO,n.Renderer=Go,n.SVG=Wf,n.SVGOverlay=TO,n.TileLayer=Hc,n.Tooltip=ev,n.Transformation=xe,n.Util=H,n.VideoOverlay=CO,n.bind=o,n.bounds=ne,n.canvas=AO,n.circle=pX,n.circleMarker=fX,n.control=Mf,n.divIcon=SX,n.extend=s,n.featureGroup=cX,n.geoJSON=kO,n.geoJson=yX,n.gridLayer=kX,n.icon=dX,n.imageOverlay=vX,n.latLng=fe,n.latLngBounds=me,n.layerGroup=uX,n.map=Kq,n.marker=hX,n.point=Y,n.polygon=gX,n.polyline=mX,n.popup=wX,n.rectangle=NX,n.setOptions=y,n.stamp=l,n.svg=OO,n.svgOverlay=bX,n.tileLayer=IO,n.tooltip=_X,n.transformation=le,n.version=r,n.videoOverlay=xX;var $X=window.L;n.noConflict=function(){return window.L=$X,this},window.L=n})})(pC,pC.exports);var Fm=pC.exports;const hd=wi(Fm);function rI(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function sI(t,e){return e==null?function(r,s){const i=E.useRef();return i.current||(i.current=t(r,s)),i}:function(r,s){const i=E.useRef();i.current||(i.current=t(r,s));const o=E.useRef(r),{instance:a}=i.current;return E.useEffect(function(){o.current!==r&&(e(a,r,o.current),o.current=r)},[a,r,s]),i}}function x9(t,e){E.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var i;(i=e.layerContainer)==null||i.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function Gz(t){return function(n){const r=Wz(),s=t(nI(n,r),r);return Bz(r.map,n.attribution),Uz(s.current,n.eventHandlers),x9(s.current,r),s}}function b9(t,e){const n=sI(t,e),r=Gz(n);return m9(r)}function w9(t,e){const n=sI(t),r=v9(n,e);return g9(r)}function _9(t,e){const n=sI(t,e),r=Gz(n);return y9(r)}function S9(t,e,n){const{opacity:r,zIndex:s}=e;r!=null&&r!==n.opacity&&t.setOpacity(r),s!=null&&s!==n.zIndex&&t.setZIndex(s)}function mC(){return mC=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mC.apply(this,arguments)}function k9({bounds:t,boundsOptions:e,center:n,children:r,className:s,id:i,placeholder:o,style:a,whenReady:l,zoom:u,...c},d){const[f]=E.useState({className:s,id:i,style:a}),[p,m]=E.useState(null);E.useImperativeHandle(d,()=>(p==null?void 0:p.map)??null,[p]);const y=E.useCallback(x=>{if(x!==null&&p===null){const b=new Fm.Map(x,c);n!=null&&u!=null?b.setView(n,u):t!=null&&b.fitBounds(t,e),l!=null&&b.whenReady(l),m(f9(b))}},[]);E.useEffect(()=>()=>{p==null||p.map.remove()},[p]);const v=p?Rp.createElement(Vz,{value:p},r):o??null;return Rp.createElement("div",mC({},f,{ref:y}),v)}const C9=E.forwardRef(k9),T9=b9(function({position:e,...n},r){const s=new Fm.Marker(e,n);return rI(s,p9(r,{overlayContainer:s}))},function(e,n,r){n.position!==r.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),N9=w9(function(e,n){const r=new Fm.Popup(e,n.overlayContainer);return rI(r,n)},function(e,n,{position:r},s){E.useEffect(function(){const{instance:o}=e;function a(u){u.popup===o&&(o.update(),s(!0))}function l(u){u.popup===o&&s(!1)}return n.map.on({popupopen:a,popupclose:l}),n.overlayContainer==null?(r!=null&&o.setLatLng(r),o.openOn(n.map)):n.overlayContainer.bindPopup(o),function(){var c;n.map.off({popupopen:a,popupclose:l}),(c=n.overlayContainer)==null||c.unbindPopup(),n.map.removeLayer(o)}},[e,n,s,r])}),I9=_9(function({url:e,...n},r){const s=new Fm.TileLayer(e,nI(n,r));return rI(s,r)},function(e,n,r){S9(e,n,r);const{url:s}=n;s!=null&&s!==r.url&&e.setUrl(s)});delete hd.Icon.Default.prototype._getIconUrl;hd.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});const $9=({locations:t,onLocationSelect:e,selectedLocation:n})=>{const r=E.useRef(null);E.useEffect(()=>{n&&r.current&&r.current.flyTo(n.coordinates,16,{duration:1})},[n]),E.useEffect(()=>{if(r.current&&t.length>0&&!n){const a=hd.latLngBounds(t.map(l=>l.coordinates));r.current.fitBounds(a,{padding:[20,20],maxZoom:12})}},[t,n]);const s=()=>{if(r.current&&t.length>0){const a=hd.latLngBounds(t.map(l=>l.coordinates));r.current.flyToBounds(a,{padding:[20,20],maxZoom:12,duration:1})}},i=new hd.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),o=new hd.Icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});return z.jsxs("div",{style:{position:"relative"},children:[z.jsxs(C9,{center:[40.72,-74],zoom:10,style:{height:"500px",width:"100%"},whenReady:a=>{r.current=a.target},children:[z.jsx(I9,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t.map(a=>z.jsx(T9,{position:a.coordinates,icon:(n==null?void 0:n.id)===a.id?i:o,eventHandlers:{click:()=>e(a)},children:z.jsx(N9,{children:z.jsxs("div",{style:{textAlign:"center"},children:[z.jsx("strong",{children:a.name}),z.jsx("br",{}),z.jsx("button",{onClick:()=>e(a),style:{marginTop:"8px",padding:"4px 8px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"View Traffic Data"})]})})},a.id))]}),z.jsx("button",{onClick:s,style:{position:"absolute",top:"10px",right:"10px",zIndex:1e3,padding:"8px 12px",backgroundColor:"#fff",border:"2px solid rgba(0,0,0,0.2)",borderRadius:"6px",boxShadow:"0 1px 5px rgba(0,0,0,0.4)",cursor:"pointer",fontSize:"14px",fontWeight:"bold",color:"#333",display:"flex",alignItems:"center",gap:"4px",transition:"all 0.2s ease"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="#f8f9fa",a.currentTarget.style.transform="scale(1.05)"},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="#fff",a.currentTarget.style.transform="scale(1)"},title:"Zoom to show all locations",children:"🏠 Home"})]})};var gC={exports:{}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E9=1e-7,A9=1e-4;class iI{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class gb{refCount(e){return Zr("refCount")}incRef(e){return Zr("incRef")}timerAvailable(){return!0}time(e){return Zr("time")}read(e){return Zr("read")}readSync(e){return Zr("readSync")}readToGPU(e,n){return Zr("readToGPU")}numDataIds(){return Zr("numDataIds")}disposeData(e,n){return Zr("disposeData")}write(e,n,r){return Zr("write")}move(e,n,r,s,i){return Zr("move")}createTensorFromGPUData(e,n,r){return Zr("createTensorFromGPUData")}memory(){return Zr("memory")}floatPrecision(){return Zr("floatPrecision")}epsilon(){return this.floatPrecision()===32?E9:A9}dispose(){return Zr("dispose")}}function Zr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oI(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Qo(t,e,n)}function O9(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,Qo(t,n,r),Qo(e,n,r)}function yl(t,e,n){return Math.max(t,Math.min(e,n))}function yb(t){return t%2===0?t:t+1}function Qo(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Hz(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function P9(t,e){const n=Math.random();return e*n+(1-n)*t}function D9(t,e){let n=0;for(let r=0;r<t.length;r++){const s=Number(t[r])-Number(e[r]);n+=s*s}return n}function O(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Zn(t,e,n=""){O(nt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function yc(t){O(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function oe(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function R9(t){return t.length===0}function Kz(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function nt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function qu(t){return t%1===0}function L9(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function F0(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function F9(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return oI(e),e}function Du(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function yC(t,e=s=>0,n,r){return new Promise((s,i)=>{let o=0;const a=()=>{if(t()){s();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function aI(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function Je(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),O(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),O(t.every(r=>qu(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Ca(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:Je(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function Dn(t,e){return Yt(t,e)}function Yt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function qz(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function Xz(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function lI(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Jp(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function Zz(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function bo(t){return typeof t=="string"||t instanceof String}function Yz(t){return typeof t=="boolean"}function M0(t){return typeof t=="number"}function vc(t){return Array.isArray(t)?vc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":M0(t)?"float32":bo(t)?"string":Yz(t)?"bool":"float32"}function vl(t){return!!(t&&t.constructor&&t.call&&t.apply)}function z0(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function ze(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function Qz(t,e,n,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)s[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<i;l++)s[l]=Qz(t+l*a,o,n,r)}return s}function $s(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,i)=>s*i)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return Qz(0,t,e,n)}function Jz(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function vb(t,e){const n=Xn(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Xn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function uI(t,e){const n=t.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return $s(t,new Float32Array(n));if(e==="int32")return $s(t,new Int32Array(n));if(e==="bool")return $s(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function ps(t){t.forEach(e=>{O(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function qi(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function xc(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function xl(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JP="tfjsflags";class eB{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=M9,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(te().getBool("IS_TEST")||te().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];te().getBool("IS_TEST")||te().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(xl(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);JP in e&&e[JP].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=B9(s,i)})}}function M9(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(z9(e,r[0],r[1]),r.join("="))),e}function z9(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function B9(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function te(){return cI}let cI=null;function j9(t){cI=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let AS;function tB(){if(AS==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");AS=t}return AS}function V9(){const t=tB();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function dI(t,e){const n=V9();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Mm="Abs",ch="Acos",dh="Acosh",bc="Add",zm="AddN",xb="All",bb="Any",Bm="ArgMax",jm="ArgMin",hh="Asin",fh="Asinh",ph="Atan",mh="Atanh",gh="Atan2",Vm="AvgPool",wb="AvgPoolGrad",Wm="AvgPool3D",_b="AvgPool3DGrad",Um="BatchMatMul",Gm="BatchToSpaceND",Sb="Bincount",Hm="BitwiseAnd",nB="BroadcastTo",kb="BroadcastArgs",yh="Cast",vh="Ceil",xh="ClipByValue",Cb="Complex",Km="ComplexAbs",qm="Concat",Xm="Conv2D",Tb="Conv2DBackpropFilter",Zm="Conv2DBackpropInput",Ym="Conv3D",Nb="Conv3DBackpropFilterV2",Ib="Conv3DBackpropInputV2",bh="Cos",wh="Cosh",$b="Cumprod",Qm="Cumsum",Eb="CropAndResize",Ab="DenseBincount",Ob="DepthToSpace",Jm="DepthwiseConv2dNative",Pb="DepthwiseConv2dNativeBackpropFilter",Db="DepthwiseConv2dNativeBackpropInput",Rb="Diag",eg="Dilation2D",B0="Dilation2DBackpropInput",j0="Dilation2DBackpropFilter",Lb="Draw",_h="RealDiv",Fb="Einsum",Sh="Elu",Mb="EluGrad",kh="Erf",tg="Equal",Ch="Exp",ng="ExpandDims",Th="Expm1",zb="FFT",Bb="Fill",jb="FlipLeftRight",Nh="Floor",Ih="FloorDiv",rg="FusedBatchNorm",sg="GatherV2",Vb="GatherNd",ig="Greater",$h="GreaterEqual",Eh="Identity",Wb="IFFT",Ub="Imag",Ah="IsFinite",Oh="IsInf",Ph="IsNan",og="LeakyRelu",ag="Less",lg="LessEqual",Gb="LinSpace",Dh="Log",Rh="Log1p",ug="LogicalAnd",cg="LogicalNot",dg="LogicalOr",W9="LogicalXor",rB="LogSoftmax",U9="LowerBound",hg="LRN",Hb="LRNGrad",G9="MatrixBandPart",fg="Max",Lh="Maximum",pg="MaxPool",Kb="MaxPoolGrad",mg="MaxPool3D",qb="MaxPool3DGrad",Xb="MaxPoolWithArgmax",gg="Mean",yg="Min",Fh="Minimum",vg="MirrorPad",Mh="Mod",Zb="Multinomial",zh="Multiply",xg="Neg",bg="NotEqual",Yb="NonMaxSuppressionV3",Qb="NonMaxSuppressionV4",Jb="NonMaxSuppressionV5",wg="OnesLike",_g="OneHot",Sg="Pack",kg="PadV2",H9="Pool",Bh="Pow",Cg="Prelu",Tg="Prod",ew="RaggedGather",tw="RaggedRange",nw="RaggedTensorToTensor",rw="Range",sw="Real",jh="Reciprocal",Vh="Relu",Ng="Reshape",Ig="ResizeNearestNeighbor",iw="ResizeNearestNeighborGrad",$g="ResizeBilinear",ow="ResizeBilinearGrad",Wh="Relu6",Eg="Reverse",Uh="Round",Gh="Rsqrt",aw="ScatterNd",lw="TensorScatterUpdate",uw="SearchSorted",Ag="Select",Hh="Selu",Og="Slice",Kh="Sin",qh="Sinh",Xh="Sign",Zh="Sigmoid",Yh="Softplus",Qh="Sqrt",Pg="Sum",Dg="SpaceToBatchND",Rg="SplitV",Lg="Softmax",cw="SparseFillEmptyRows",dw="SparseReshape",hw="SparseSegmentMean",fw="SparseSegmentSum",pw="SparseToDense",Jh="SquaredDifference",mw="Square",Fg="StaticRegexReplace",gw="StridedSlice",yw="StringNGrams",vw="StringSplit",xw="StringToHashBucketFast",ef="Sub",tf="Tan",nf="Tanh",rf="Tile",bw="TopK",ww="Transform",Ru="Transpose",_w="Unique",Mg="Unpack",zg="UnsortedSegmentSum",K9="UpperBound",Bg="ZerosLike",sf="Step",V0="FromPixels",Sw="RotateWithOffset",em="_FusedMatMul",tm="FusedConv2D",nm="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _s(...t){te().getBool("IS_TEST")||te().getBool("PROD")||console.warn(...t)}function q9(...t){te().getBool("IS_TEST")||te().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ld=dI("kernelRegistry",()=>new Map),rm=dI("gradRegistry",()=>new Map);function sm(t,e){const n=hI(t,e);return Ld.get(n)}function vC(t){return rm.get(t)}function W0(t){const e=Ld.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,o]=s,[a]=i.split("_");a===t&&n.push(o)}return n}function kw(t){const{kernelName:e,backendName:n}=t,r=hI(e,n);Ld.has(r)&&_s(`The kernel '${e}' for backend '${n}' is already registered`),Ld.set(r,t)}function sB(t){const{kernelName:e}=t;rm.has(e)&&te().getBool("DEBUG")&&_s(`Overriding the gradient for '${e}'`),rm.set(e,t)}function X9(t,e){const n=hI(t,e);if(!Ld.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);Ld.delete(n)}function Z9(t){if(!rm.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);rm.delete(t)}function Y9(t,e){W0(t).forEach(r=>{const s=Object.assign({},r,{backendName:e});kw(s)})}function hI(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iB(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var oB=Dt,oi=null;try{oi=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Dt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Dt.prototype.__isLong__;Object.defineProperty(Dt.prototype,"__isLong__",{value:!0});function ms(t){return(t&&t.__isLong__)===!0}Dt.isLong=ms;var eD={},tD={};function wc(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=tD[t],r)?r:(n=Rt(t,(t|0)<0?-1:0,!0),s&&(tD[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=eD[t],r)?r:(n=Rt(t,t<0?-1:0,!1),s&&(eD[t]=n),n))}Dt.fromInt=wc;function ai(t,e){if(isNaN(t))return e?ku:li;if(e){if(t<0)return ku;if(t>=aB)return cB}else{if(t<=-rD)return ss;if(t+1>=rD)return uB}return t<0?ai(-t,e).neg():Rt(t%Fd|0,t/Fd|0,e)}Dt.fromNumber=ai;function Rt(t,e,n){return new Dt(t,e,n)}Dt.fromBits=Rt;var U0=Math.pow;function fI(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return li;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return fI(t.substring(1),e,n).neg();for(var s=ai(U0(n,8)),i=li,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var u=ai(U0(n,a));i=i.mul(u).add(ai(l))}else i=i.mul(s),i=i.add(ai(l))}return i.unsigned=e,i}Dt.fromString=fI;function ro(t,e){return typeof t=="number"?ai(t,e):typeof t=="string"?fI(t,e):Rt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Dt.fromValue=ro;var nD=65536,Q9=1<<24,Fd=nD*nD,aB=Fd*Fd,rD=aB/2,sD=wc(Q9),li=wc(0);Dt.ZERO=li;var ku=wc(0,!0);Dt.UZERO=ku;var fd=wc(1);Dt.ONE=fd;var lB=wc(1,!0);Dt.UONE=lB;var xC=wc(-1);Dt.NEG_ONE=xC;var uB=Rt(-1,2147483647,!1);Dt.MAX_VALUE=uB;var cB=Rt(-1,-1,!0);Dt.MAX_UNSIGNED_VALUE=cB;var ss=Rt(0,-2147483648,!1);Dt.MIN_VALUE=ss;var Te=Dt.prototype;Te.toInt=function(){return this.unsigned?this.low>>>0:this.low};Te.toNumber=function(){return this.unsigned?(this.high>>>0)*Fd+(this.low>>>0):this.high*Fd+(this.low>>>0)};Te.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ss)){var n=ai(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=ai(U0(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),u=o.sub(l.mul(i)).toInt()>>>0,c=u.toString(e);if(o=l,o.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};Te.getHighBits=function(){return this.high};Te.getHighBitsUnsigned=function(){return this.high>>>0};Te.getLowBits=function(){return this.low};Te.getLowBitsUnsigned=function(){return this.low>>>0};Te.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ss)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};Te.isZero=function(){return this.high===0&&this.low===0};Te.eqz=Te.isZero;Te.isNegative=function(){return!this.unsigned&&this.high<0};Te.isPositive=function(){return this.unsigned||this.high>=0};Te.isOdd=function(){return(this.low&1)===1};Te.isEven=function(){return(this.low&1)===0};Te.equals=function(e){return ms(e)||(e=ro(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Te.eq=Te.equals;Te.notEquals=function(e){return!this.eq(e)};Te.neq=Te.notEquals;Te.ne=Te.notEquals;Te.lessThan=function(e){return this.comp(e)<0};Te.lt=Te.lessThan;Te.lessThanOrEqual=function(e){return this.comp(e)<=0};Te.lte=Te.lessThanOrEqual;Te.le=Te.lessThanOrEqual;Te.greaterThan=function(e){return this.comp(e)>0};Te.gt=Te.greaterThan;Te.greaterThanOrEqual=function(e){return this.comp(e)>=0};Te.gte=Te.greaterThanOrEqual;Te.ge=Te.greaterThanOrEqual;Te.compare=function(e){if(ms(e)||(e=ro(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Te.comp=Te.compare;Te.negate=function(){return!this.unsigned&&this.eq(ss)?ss:this.not().add(fd)};Te.neg=Te.negate;Te.add=function(e){ms(e)||(e=ro(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,f=0,p=0;return p+=i+u,f+=p>>>16,p&=65535,f+=s+l,d+=f>>>16,f&=65535,d+=r+a,c+=d>>>16,d&=65535,c+=n+o,c&=65535,Rt(f<<16|p,c<<16|d,this.unsigned)};Te.subtract=function(e){return ms(e)||(e=ro(e)),this.add(e.neg())};Te.sub=Te.subtract;Te.multiply=function(e){if(this.isZero())return li;if(ms(e)||(e=ro(e)),oi){var n=oi.mul(this.low,this.high,e.low,e.high);return Rt(n,oi.get_high(),this.unsigned)}if(e.isZero())return li;if(this.eq(ss))return e.isOdd()?ss:li;if(e.eq(ss))return this.isOdd()?ss:li;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(sD)&&e.lt(sD))return ai(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,f=0,p=0,m=0;return m+=o*c,p+=m>>>16,m&=65535,p+=i*c,f+=p>>>16,p&=65535,p+=o*u,f+=p>>>16,p&=65535,f+=s*c,d+=f>>>16,f&=65535,f+=i*u,d+=f>>>16,f&=65535,f+=o*l,d+=f>>>16,f&=65535,d+=r*c+s*u+i*l+o*a,d&=65535,Rt(p<<16|m,d<<16|f,this.unsigned)};Te.mul=Te.multiply;Te.divide=function(e){if(ms(e)||(e=ro(e)),e.isZero())throw Error("division by zero");if(oi){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?oi.div_u:oi.div_s)(this.low,this.high,e.low,e.high);return Rt(n,oi.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?ku:li;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return ku;if(e.gt(this.shru(1)))return lB;i=ku}else{if(this.eq(ss)){if(e.eq(fd)||e.eq(xC))return ss;if(e.eq(ss))return fd;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(li)?e.isNegative()?fd:xC:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(ss))return this.unsigned?ku:li;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=li}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:U0(2,a-48),u=ai(r),c=u.mul(e);c.isNegative()||c.gt(s);)r-=l,u=ai(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=fd),i=i.add(u),s=s.sub(c)}return i};Te.div=Te.divide;Te.modulo=function(e){if(ms(e)||(e=ro(e)),oi){var n=(this.unsigned?oi.rem_u:oi.rem_s)(this.low,this.high,e.low,e.high);return Rt(n,oi.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Te.mod=Te.modulo;Te.rem=Te.modulo;Te.not=function(){return Rt(~this.low,~this.high,this.unsigned)};Te.and=function(e){return ms(e)||(e=ro(e)),Rt(this.low&e.low,this.high&e.high,this.unsigned)};Te.or=function(e){return ms(e)||(e=ro(e)),Rt(this.low|e.low,this.high|e.high,this.unsigned)};Te.xor=function(e){return ms(e)||(e=ro(e)),Rt(this.low^e.low,this.high^e.high,this.unsigned)};Te.shiftLeft=function(e){return ms(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Rt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Rt(0,this.low<<e-32,this.unsigned)};Te.shl=Te.shiftLeft;Te.shiftRight=function(e){return ms(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Rt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Rt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Te.shr=Te.shiftRight;Te.shiftRightUnsigned=function(e){if(ms(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return Rt(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Rt(n,0,this.unsigned):Rt(n>>>e-32,0,this.unsigned)};Te.shru=Te.shiftRightUnsigned;Te.shr_u=Te.shiftRightUnsigned;Te.toSigned=function(){return this.unsigned?Rt(this.low,this.high,!1):this};Te.toUnsigned=function(){return this.unsigned?this:Rt(this.low,this.high,!0)};Te.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Te.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Te.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Dt.fromBytes=function(e,n,r){return r?Dt.fromBytesLE(e,n):Dt.fromBytesBE(e,n)};Dt.fromBytesLE=function(e,n){return new Dt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Dt.fromBytesBE=function(e,n){return new Dt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const dB=wi(oB),J9=TM({__proto__:null,default:dB},[oB]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mu=dB||J9;function jg(t){return mu.fromString(t,!0,16)}const hB=jg("c3a5c85c97cb3127"),uu=jg("b492b66fbe98f273"),_r=jg("9ae16a3b2f90404f");function bC(t){return t.xor(t.shru(47))}function fB(t,e,n){const r=t.slice(e,e+n);return mu.fromBytes(Array.from(r),!0,!0)}function Nt(t,e){return fB(t,e,8)}function iD(t,e){return fB(t,e,4)}function En(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function cl(t,e,n=jg("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function eY(t,e,n,r,s,i){s=s.add(t),i=En(i.add(s).add(r),21);const o=s;return s=s.add(e),s=s.add(n),i=i.add(En(s,44)),[s.add(r),i.add(o)]}function bv(t,e,n,r){return eY(Nt(t,e),Nt(t,e+8),Nt(t,e+16),Nt(t,e+24),n,r)}function tY(t,e=t.length){if(e>=8){const n=_r.add(e*2),r=Nt(t,0).add(_r),s=Nt(t,e-8),i=En(s,37).mul(n).add(r),o=En(r,25).add(s).mul(n);return cl(i,o,n)}if(e>=4){const n=_r.add(e*2),r=iD(t,0);return cl(r.shl(3).add(e),iD(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],i=n+(r<<8),o=e+(s<<2);return bC(_r.mul(i).xor(hB.mul(o))).mul(_r)}return _r}function nY(t,e=t.length){const n=_r.add(e*2),r=Nt(t,0).mul(uu),s=Nt(t,8),i=Nt(t,e-8).mul(n),o=Nt(t,e-16).mul(_r);return cl(En(r.add(s),43).add(En(i,30)).add(o),r.add(En(s.add(_r),18)).add(i),n)}function rY(t,e=t.length){const n=_r.add(e*2),r=Nt(t,0).mul(_r),s=Nt(t,8),i=Nt(t,e-8).mul(n),o=Nt(t,e-16).mul(_r),a=En(r.add(s),43).add(En(i,30)).add(o),l=cl(a,r.add(En(s.add(_r),18)).add(i),n),u=Nt(t,16).mul(n),c=Nt(t,24),d=a.add(Nt(t,e-32)).mul(n),f=l.add(Nt(t,e-24)).mul(n);return cl(En(u.add(c),43).add(En(d,30)).add(f),u.add(En(c.add(r),18)).add(d),n)}function pB(t,e=t.length){const n=mu.fromNumber(81,!0);if(e<=32)return e<=16?tY(t,e):nY(t,e);if(e<=64)return rY(t,e);let r=n,s=n.mul(uu).add(113),i=bC(s.mul(_r).add(113)).mul(_r),o=[mu.UZERO,mu.UZERO],a=[mu.UZERO,mu.UZERO];r=r.mul(_r).add(Nt(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=En(r.add(s).add(o[0]).add(Nt(t,l+8)),37).mul(uu),s=En(s.add(o[1]).add(Nt(t,l+48)),42).mul(uu),r=r.xor(a[1]),s=s.add(o[0]).add(Nt(t,l+40)),i=En(i.add(a[0]),33).mul(uu),o=bv(t,l,o[1].mul(uu),r.add(a[0])),a=bv(t,l+32,i.add(a[1]),s.add(Nt(t,l+16))),[i,r]=[r,i],l+=64;while(l!==u);const d=uu.add(i.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=En(r.add(s).add(o[0]).add(Nt(t,l+8)),37).mul(d),s=En(s.add(o[1]).add(Nt(t,l+48)),42).mul(d),r=r.xor(a[1].mul(9)),s=s.add(o[0].mul(9).add(Nt(t,l+40))),i=En(i.add(a[0]),33).mul(d),o=bv(t,l,o[1].mul(d),r.add(a[0])),a=bv(t,l+32,i.add(a[1]),s.add(Nt(t,l+16))),[i,r]=[r,i],cl(cl(o[0],a[0],d).add(bC(s).mul(hB)).add(i),cl(o[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ta(t,e){return e==="string"?Co(t):Rl([t],e)}function sY(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Rl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Ao(t)),te().getBool("DEBUG")&&qz(t,e),sY(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function xr(){return te().platform.now()}function iY(t,e){return te().platform.fetch(t,e)}function Co(t,e="utf-8"){return e=e||"utf-8",te().platform.encode(t,e)}function pa(t,e="utf-8"){return e=e||"utf-8",te().platform.decode(t,e)}function An(t){return te().platform.isTypedArray!=null?te().platform.isTypedArray(t):iB(t)}function Ao(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||xl(t)||t==null||An(t)&&n)e.push(t);else if(Array.isArray(t)||An(t))for(let r=0;r<t.length;++r)Ao(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)Ao(t[s],e,n)}return e}const oY=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:nt,arraysEqualWithNull:Kz,assert:O,assertNonNegativeIntegerDimensions:ps,assertNonNull:yc,assertShapesMatch:Zn,bytesFromStringArray:Zz,bytesPerElement:Jp,checkConversionForErrors:qz,clamp:yl,computeStrides:ze,convertBackendValuesAndArrayBuffer:Jz,createScalarValue:Ta,createShuffledIndices:F9,decodeString:pa,distSquared:D9,encodeString:Co,fetch:iY,fingerPrint64:pB,flatten:Ao,getArrayFromDType:Yt,getTypedArrayFromDType:Dn,hasEncodingLoss:lI,hexToLong:jg,indexToLoc:xc,inferDtype:vc,inferFromImplicitShape:aI,isBoolean:Yz,isFunction:vl,isInt:qu,isNumber:M0,isPromise:xl,isScalarShape:R9,isString:bo,isTypedArray:An,isValidDtype:Xz,locToIndex:qi,makeOnesTypedArray:vb,makeZerosNestedTypedArray:uI,makeZerosTypedArray:Xn,nearestDivisor:z0,nearestLargerEven:yb,now:xr,parseAxisParam:Je,randUniform:P9,repeatedTry:yC,rightPad:Du,shuffle:oI,shuffleCombo:O9,sizeFromShape:oe,sizeToSquarishShape:F0,squeezeShape:Ca,sum:Hz,swap:Qo,tanh:L9,toNestedArray:$s,toTypedArray:Rl},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aY{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new uY)}profileKernel(e,n,r){let s;const i=()=>{s=r()};let o;const a=xr();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const u of s)u.dataSync();o=Promise.resolve({kernelMs:xr()-a})}if(te().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const c=s[u];c.data().then(d=>{lY(d,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:o.then(u=>u.kernelMs),extraInfo:o.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:i,extraInfo:o}=e;r.forEach(a=>{Promise.all([a.data(),s,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function lY(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class uY{logKernelProfile(e,n,r,s,i,o){const a=typeof s=="number"?Du(`${s}ms`,9):s.error,l=Du(e,25),u=n.rank,c=n.size,d=Du(n.shape.toString(),14);let f="";for(const p in i){const m=i[p];if(m!=null){const y=m.shape||n.shape,v=y.length;f+=`${p}: ${v}D ${v>0?y:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${d}	%c${c}	%c${f}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cY(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const f=c[d];let p=!1;for(let m=0;m<e.length;m++)if(r[f.id]){u.outputs.forEach(y=>r[y.id]=!0),p=!0,s[u.id]=!0;break}if(p)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(i[u.outputs[d].id]){for(const f in c)i[c[f].id]=!0,o[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(s[u.id]&&o[u.id]){const c={};for(const f in u.inputs){const p=u.inputs[f];r[p.id]&&(c[f]=p)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,a.push(d)}}return a}function dY(t,e,n,r){for(let s=e.length-1;s>=0;s--){const i=e[s],o=[];if(i.outputs.forEach(l=>{const u=t[l.id];u!=null?o.push(u):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=i.inputs[l];if(!nt(u.shape,c.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oD=20,Jf=3,OS=7;function hY(t,e,n,r){const s=ze(e),i=fY(t,e,n,s),o=e.length,a=l0(t,e,n,s,i),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function fY(t,e,n,r){const s=oe(e),i=r[r.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?gp(t):t;if(a>1)for(let u=0;u<s/i;u++){const c=u*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],mp(l[c+d],0,n).length)}return o}function mp(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(OS))} + ${parseFloat(t[1].toFixed(OS))}j`:bo(t)?r=`'${t}'`:n==="bool"?r=mB(t):r=parseFloat(t.toFixed(OS)).toString(),Du(r,e)}function mB(t){return t===0?"false":"true"}function l0(t,e,n,r,s,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const y=gp(t);return[mp(y[0],0,n)]}return n==="bool"?[mB(t[0])]:[t[0].toString()]}if(l===1){if(a>oD){const v=Jf*o;let x=Array.from(t.slice(0,v)),b=Array.from(t.slice((a-Jf)*o,a*o));return n==="complex64"&&(x=gp(x),b=gp(b)),["["+x.map((_,S)=>mp(_,s[S],n)).join(", ")+", ..., "+b.map((_,S)=>mp(_,s[a-Jf+S],n)).join(", ")+"]"]}return["["+(n==="complex64"?gp(t):Array.from(t)).map((v,x)=>mp(v,s[x],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*o,f=[];if(a>oD){for(let y=0;y<Jf;y++){const v=y*d,x=v+d;f.push(...l0(t.slice(v,x),u,n,c,s,!1))}f.push("...");for(let y=a-Jf;y<a;y++){const v=y*d,x=v+d;f.push(...l0(t.slice(v,x),u,n,c,s,y===a-1))}}else for(let y=0;y<a;y++){const v=y*d,x=v+d;f.push(...l0(t.slice(v,x),u,n,c,s,y===a-1))}const p=l===2?",":"";f[0]="["+(a>0?f[0]+p:"");for(let y=1;y<f.length-1;y++)f[y]=" "+f[y]+p;let m=`,
`;for(let y=2;y<l;y++)m+=`
`;return f[f.length-1]=" "+f[f.length-1]+"]"+(i?"":m),f}function gp(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pn{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=oe(e),r!=null){const s=r.length;O(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Yt(n,this.size),this.strides=ze(e)}set(e,...n){n.length===0&&(n=[0]),O(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return zi().makeTensor(this.values,this.shape,this.dtype)}}let zi=null,Qc=null;function pY(t){zi=t}function mY(t){Qc=t}class gt{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=oe(e),this.strides=ze(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Qc.buffer(this.shape,this.dtype,e)}bufferSync(){return Qc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return $s(this.shape,e,this.dtype==="complex64")}arraySync(){return $s(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=zi().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>pa(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),zi().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=zi().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>pa(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await zi().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),zi().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Qc.print(this,e)}clone(){return this.throwIfDisposed(),Qc.clone(this)}toString(e=!1){const n=this.dataSync();return hY(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Qc.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),zi().makeVariable(this,e,n,r)}}Object.defineProperty(gt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function ce(){return dI("Tensor",()=>gt)}ce();class im extends gt{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!nt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);zi().disposeTensor(this),this.dataId=e.dataId,zi().incRef(this,null)}dispose(){zi().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(im,Symbol.hasInstance,{value:t=>t instanceof gt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wC;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(wC||(wC={}));var _C;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(_C||(_C={}));var SC;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(SC||(SC={}));var kC;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(kC||(kC={}));var CC;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(CC||(CC={}));const gY={float32:kC,int32:_C,bool:SC,complex64:CC};function Mr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return gY[t][e]}function Cw(t){return Mr(t,"int32")}function gB(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function yB(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kt(t,e){if(t.dtype===e.dtype)return[t,e];const n=Mr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function vB(t,e){O(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function yY(t,e){return e.some(n=>n.id===t.id)}function pI(t){const e=[];return xB(t,e,new Set),e}function xB(t,e,n){if(t==null)return;if(t instanceof gt){e.push(t);return}if(!vY(t))return;const r=t;for(const s in r){const i=r[s];n.has(i)||(n.add(i),xB(i,e,n))}}function vY(t){return Array.isArray(t)||typeof t=="object"}const xY=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:vB,getTensorsInContainer:pI,isTensorInList:yY,makeTypesMatch:Kt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PS(t){return t.kernelName!=null}class aD{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Md{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new aD}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(_s(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new aY(this.backendInstance),!0}setupRegisteredKernels(){W0(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){W0(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof gb)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(o=>s<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,_s(`Initialization of backend ${e} failed`),_s(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return _s(`Initialization of backend ${e} failed`),_s(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,i=this.readSync(n),o=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return Md.nextTensorId++}nextVariableId(){return Md.nextVariableId++}clone(e){const n=V.runKernel(Eh,{x:e}),r={x:e},s=o=>({x:()=>{const a="float32",l={x:o},u={dtype:a};return V.runKernel(yh,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,i,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(sm(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=PS(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(PS(e)){const{kernelName:m,inputs:y,attrs:v}=e;this.backendName==null&&this.backend;const x=sm(m,this.backendName);O(x!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),a=()=>{const b=this.backend.numDataIds();l=x.kernelFunc({inputs:y,attrs:v,backend:this.backend});const _=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,b,_);const S=_.map(k=>k.rank!=null?k:this.makeTensorFromTensorInfo(k));if(s){const k=this.getTensorsForGradient(m,y,S);r=this.saveTensorsForBackwardMode(k)}return S}}else{const{forwardFunc:m}=e,y=v=>{s&&(r=v.map(x=>this.keep(this.clone(x))))};a=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>m(this.backend,y));const x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,v,x),x}}const{inputs:c,attrs:d}=e,f=PS(e)?null:e.backwardsFunc;let p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(p=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),n=p.outputs)}),s&&this.addTapeNode(u,c,n,f,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(m=>c[m]!=null?c[m].shape:null),outputShapes:n.map(m=>m.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=vC(e);if(s!=null){const i=s.inputsToSave||[],o=s.outputsToSave||[];let a;s.saveAllInputs?(O(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=i.map(u=>n[u]);const l=r.filter((u,c)=>o[c]);return a.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&bo(e[0])&&(i=e.map(l=>Co(l)));const o=s.write(i,n,r),a=new gt(n,r,o,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(o),u=Zz(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const i={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:i}=e,o=new gt(s,i,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new im(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Jp(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof im||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Jp(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},l=vC(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=u=>(u=u.map((c,d)=>{if(c==null){const f=r[d],p=Xn(f.size,f.dtype);return this.makeTensor(p,f.shape,f.dtype)}return c}),s(u.length>1?u:u[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=pI(e),r=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,n,r,s=!1){if(O(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));O(i instanceof gt,()=>"The result y returned by f() must be a tensor.");const o=cY(this.state.activeTape,n,i);if(!s&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=r??bY(i.shape),dY(a,o,u=>this.tidy(u),wY);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return O(vl(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{O(n.every(a=>a instanceof gt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,l)=>{s[l]=a});const i=(a,l)=>(r=e(...n,l),O(r.value instanceof gt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),O(vl(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,l)=>{const u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];O(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),O(c.every(f=>f instanceof gt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((f,p)=>{d[p]=()=>f}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=xr(),r=await this.backend.time(e);return r.wallMs=xr()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new aD;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Md.nextTensorId=0;Md.nextVariableId=0;function bY(t){const e=vb(oe(t),"float32");return V.makeTensor(e,t,"float32")}function bB(){const t=tB();if(t._tfengine==null){const e=new eB(t);t._tfengine=new Md(e)}return j9(t._tfengine.ENV),pY(()=>t._tfengine),t._tfengine}const V=bB();function wY(t,e){const n={a:t,b:e};return V.runKernel(bc,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Y(){return typeof navigator<"u"&&navigator!=null}let TC;function SY(t){TC=t}function mI(t){if(TC!==void 0)return TC;if(t||_Y()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function gI(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const kY=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:gI,isMobile:mI,mockIsMobile:SY},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zr=te();zr.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});zr.registerFlag("IS_BROWSER",()=>gI());zr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");zr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));zr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));zr.registerFlag("PROD",()=>!1);zr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>zr.getBool("DEBUG"));zr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);zr.registerFlag("IS_TEST",()=>!1);zr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>zr.getBool("DEBUG"));zr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);zr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);zr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oo(t,e){let n=t;if(An(t))return e==="string"?[]:[t.length];if(gB(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(yB(t))return[t.buffer.size/(e==null?4:Jp(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||An(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&te().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&wB(t,r,[]),r}function wB(t,e,n){if(n=n||[],!Array.isArray(t)&&!An(t)){O(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}O(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),O(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)wB(t[s],r,n.concat(s))}function lD(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function R(t,e,n,r="numeric"){if(t instanceof ce())return lD(r,t.dtype,e,n),t;let s=vc(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),lD(r,s,e,n),t==null||!An(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Oo(t,s);!An(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?Rl(t,s):Ao(t,[],!0);return V.makeTensor(a,i,s)}function om(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>R(i,`${e}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yI="__op";function W(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+yI;const s=(...i)=>{V.startScope(n);try{const o=r(...i);return xl(o)&&console.error("Cannot return a Promise inside of tidy."),V.endScope(o),o}catch(o){throw V.endScope(null),o}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CY(t,e){const n=R(t,"real","complex"),r=R(e,"imag","complex");Zn(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return V.runKernel(Cb,s)}const ma=W({complex_:CY});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ll(t,e,n,r){if(r==null)r=vc(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(yB(t)||gB(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return V.backend.createTensorFromGPUData(t,e||n,r)}if(!An(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ps(e);const s=oe(e),i=oe(n);O(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==oe(e.slice(o)):!0;O(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!An(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Rl(t,r):Ao(t,[],!0),V.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fi(t,e,n){const r=Oo(t,n);return Ll(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xu={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class so{static join(e){return new so(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>An(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+s.byteLength;this.shards.push({buffer:s,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,i=new ArrayBuffer(s),o=new Uint8Array(i);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],d=e+a-u.start,f=a,m=Math.min(n,u.end)-u.start,y=new Uint8Array(u.buffer,d,m-d);if(o.set(y,f),a+=y.length,n<u.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=TY(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function TY(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,i=e(t[s]);if(i===0)return s;i<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NY(){te().set("PROD",!0)}function IY(){te().set("DEBUG",!0)}function $Y(){te().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function EY(t){te().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function AY(){V.disposeVariables()}function Li(){return V}function NC(){return V.memory()}function OY(t){return V.profile(t)}function ee(t,e){return V.tidy(t,e)}function Qe(t){pI(t).forEach(n=>n.dispose())}function bn(t){return V.keep(t)}function PY(t){return V.time(t)}function DY(t){return V.setBackend(t)}function RY(){return V.ready()}function _B(){return V.backendName}function LY(t){V.removeBackend(t)}function FY(t){return V.findBackend(t)}function MY(t){return V.findBackendFactory(t)}function vI(t,e,n=1){return V.registerBackend(t,e,n)}function xI(){return V.backend}function zY(t,e){te().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bl=4;async function IC(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<s.length;++o){const a=s[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const f=await l.bytes(),p=f.reduce((v,x)=>v+x.length,0)+bl*f.length,m=new Uint8Array(p);let y=0;for(let v=0;v<f.length;v++){const x=f[v],b=new Uint8Array(new Uint32Array([x.length]).buffer);m.set(b,y),y+=bl,m.set(x,y),y+=x.length}d(m)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const i=await Promise.all(r);return{data:VY(i),specs:n}}function SB(t,e){const n=new so(t),r={};let s=0;for(const i of e){const o=BY(i,(a,l)=>n.slice(s+a,s+l));r[i.name]=kB(i,n.slice(s,s+o)),s+=o}return r}function BY(t,e){const n=oe(t.shape);let r;if("quantization"in t){const s=t.quantization;r=Xu[s.dtype]}else if(t.dtype==="string"){let s=0;for(let i=0;i<n;i++)s+=bl+new Uint32Array(e(s,s+bl))[0];return s}else r=Xu[t.dtype];return n*r}async function jY(t,e){const n=oe(t.shape);let r;if("quantization"in t){const s=t.quantization;r=Xu[s.dtype]}else if(t.dtype==="string"){let s=0;for(let i=0;i<n;i++)s+=bl+new Uint32Array(await e(s,s+bl))[0];return s}else r=Xu[t.dtype];return n*r}function kB(t,e){const n=t.name,r=t.dtype,s=t.shape,i=oe(s);let o,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=Xu[l.dtype],c=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(c.length);for(let d=0;d<c.length;d++){const f=c[d];o[d]=f*l.scale+l.min}}else if(l.dtype==="float16")o=qY()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(c.length);for(let d=0;d<c.length;d++){const f=c[d];o[d]=Math.round(f*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=i*u}else if(r==="string"){const l=oe(t.shape);o=[];for(let u=0;u<l;u++){const c=new Uint32Array(e.slice(a,a+bl))[0];a+=bl;const d=new Uint8Array(e.slice(a,a+c));o.push(d),a+=c}}else{const l=Xu[r];if(r==="float32")o=new Float32Array(e);else if(r==="int32")o=new Int32Array(e);else if(r==="bool")o=new Uint8Array(e);else if(r==="complex64"){o=new Float32Array(e);const u=new Float32Array(o.length/2),c=new Float32Array(o.length/2);for(let m=0;m<u.length;m++)u[m]=o[m*2],c[m]=o[m*2+1];const d=fi(u,s,"float32"),f=fi(c,s,"float32"),p=ma(d,f);return d.dispose(),f.dispose(),p}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=i*l}return fi(o,s,r)}async function uD(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:s,value:i}=await t.read();if(s&&i==null){const a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(r.length+i.byteLength);o.set(r,0),o.set(new Uint8Array(i),r.length),r=o}return r.buffer}async function CB(t,e){const n={},r=t.getReader();let s=new ArrayBuffer(0);for(const i of e){const o=await jY(i,async(u,c)=>(s=await uD(r,s,c),s.slice(u,c)));s=await uD(r,s,o);const a=s.slice(0,o);s=s.slice(o);const l=kB(i,a);if(n[i.name]=l,_B()==="webgpu"){const u=xI();"uploadToGPU"in u&&oe(l.shape)>=te().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function VY(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const bI=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function cD(t){return bI?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function WY(t){if(bI)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function UY(t){if(bI){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function TB(t){return so.join(t)}function dD(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function NB(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function wI(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function _I(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),wI(t,n,r)}function Vg(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:cD(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:cD(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new so(t.weightData).byteLength}}function G0(t){const e=[];for(const n of t)e.push(...n.weights);return e}function GY(){const t=n=>{let r=n<<13,s=0;for(;!(r&8388608);)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function HY(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function KY(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function qY(){const t=GY(),e=HY(),n=KY();return r=>{const s=new ArrayBuffer(4*r.length),i=new Uint32Array(s);for(let o=0;o<r.length;o++){const a=r[o],l=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Vt.instance==null&&(Vt.instance=new Vt),Vt.instance}static registerSaveRouter(e){Vt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Vt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Vt.getHandlers(e,"save")}static getLoadHandlers(e,n){return Vt.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?Vt.getInstance().loadRouters:Vt.getInstance().saveRouters).forEach(o=>{const a=o(e,r);a!==null&&s.push(a)}),s}}const XY=t=>Vt.registerSaveRouter(t),ZY=t=>Vt.registerLoadRouter(t),IB=t=>Vt.getSaveHandlers(t),YY=(t,e)=>Vt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $C="tensorflowjs",EC=1,Cu="models_store",Ja="model_info_store";function $B(){if(!te().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function AC(t){const e=t.result;e.createObjectStore(Cu,{keyPath:"modelPath"}),e.createObjectStore(Ja,{keyPath:"modelPath"})}class Zu{constructor(e){if(this.indexedDB=$B(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const i=this.indexedDB.open($C,EC);i.onupgradeneeded=()=>AC(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(Cu,"readonly"),u=a.objectStore(Cu).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return o.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(o.close(),s(u.error)),a.oncomplete=()=>o.close()}else{n.weightData=so.join(n.weightData);const a=Vg(n),l=o.transaction(Ja,"readwrite");let u=l.objectStore(Ja),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(f){return s(f)}let d;c.onsuccess=()=>{d=o.transaction(Cu,"readwrite");const f=d.objectStore(Cu);let p;try{p=f.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(m){return s(m)}p.onsuccess=()=>r({modelArtifactsInfo:a}),p.onerror=m=>{u=l.objectStore(Ja);const y=u.delete(this.modelPath);y.onsuccess=()=>(o.close(),s(p.error)),y.onerror=v=>(o.close(),s(p.error))}},c.onerror=f=>(o.close(),s(c.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>s(i.error)})}}Zu.URL_SCHEME="indexeddb://";const EB=t=>te().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Zu.URL_SCHEME)?QY(t.slice(Zu.URL_SCHEME.length)):null;Vt.registerSaveRouter(EB);Vt.registerLoadRouter(EB);function QY(t){return new Zu(t)}function JY(t){return t.startsWith(Zu.URL_SCHEME)?t.slice(Zu.URL_SCHEME.length):t}class eQ{constructor(){this.indexedDB=$B()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open($C,EC);r.onupgradeneeded=()=>AC(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(Ja,"readonly"),a=i.objectStore(Ja).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),n(a.error)),i.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=JY(e),new Promise((n,r)=>{const s=this.indexedDB.open($C,EC);s.onupgradeneeded=()=>AC(s),s.onsuccess=()=>{const i=s.result,o=i.transaction(Ja,"readwrite"),a=o.objectStore(Ja),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),d=()=>{u=i.transaction(Cu,"readwrite");const p=u.objectStore(Cu).delete(e);p.onsuccess=()=>n(l.result.modelArtifactsInfo),p.onerror=m=>r(l.error)};c.onsuccess=d,c.onerror=f=>(d(),i.close(),r(l.error))}},l.onerror=c=>(i.close(),r(l.error)),o.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jo="/",Jc="tensorflowjs_models",AB="info",tQ="model_topology",nQ="weight_specs",rQ="weight_data",sQ="model_metadata";function OB(t){return{info:[Jc,t,AB].join(Jo),topology:[Jc,t,tQ].join(Jo),weightSpecs:[Jc,t,nQ].join(Jo),weightData:[Jc,t,rQ].join(Jo),modelMetadata:[Jc,t,sQ].join(Jo)}}function PB(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function iQ(t){const e=t.split(Jo);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Jo)}function oQ(t){return t.startsWith(Yu.URL_SCHEME)?t.slice(Yu.URL_SCHEME.length):t}class Yu{constructor(e){if(!te().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=OB(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=Vg(e),i=so.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,WY(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw PB(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=UY(o),n}}Yu.URL_SCHEME="localstorage://";const DB=t=>te().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Yu.URL_SCHEME)?aQ(t.slice(Yu.URL_SCHEME.length)):null;Vt.registerSaveRouter(DB);Vt.registerLoadRouter(DB);function aQ(t){return new Yu(t)}class lQ{constructor(){O(te().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),O(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Jc+Jo,r=Jo+AB;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(n)&&i.endsWith(r)){const o=iQ(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=oQ(e);const n=OB(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return PB(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _d="://";class br{constructor(){this.managers={}}static getInstance(){return br.instance==null&&(br.instance=new br),br.instance}static registerManager(e,n){O(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(_d)&&(e=e.slice(0,e.indexOf(_d))),O(e.length>0,()=>"scheme must not be an empty string.");const r=br.getInstance();O(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=br.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(br.getInstance().managers)}}function u0(t){if(t.indexOf(_d)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${br.getSchemes().join(",")}`);return{scheme:t.split(_d)[0],path:t.split(_d)[1]}}async function RB(t,e,n=!1){O(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=Vt.getLoadHandlers(t);O(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),O(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],i=Vt.getSaveHandlers(e);O(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),O(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=i[0],a=u0(t).scheme,l=u0(t).path,u=a===u0(t).scheme,c=await s.load();n&&u&&await br.getManager(a).removeModel(l);const d=await o.save(c);return n&&!u&&await br.getManager(a).removeModel(l),d.modelArtifactsInfo}async function uQ(){const t=br.getSchemes(),e={};for(const n of t){const r=await br.getManager(n).listModels();for(const s in r){const i=n+_d+s;e[i]=r[s]}}return e}async function cQ(t){const e=u0(t);return br.getManager(e.scheme).removeModel(e.path)}async function dQ(t,e){return RB(t,e,!1)}async function hQ(t,e){return RB(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fQ{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!te().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return iB(e)}}if(te().get("IS_BROWSER")){te().setPlatform("browser",new fQ);try{br.registerManager(Yu.URL_SCHEME,new lQ)}catch{}try{br.registerManager(Zu.URL_SCHEME,new eQ)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pQ={importFetch:()=>require("node-fetch")};let DS;class mQ{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return te().global.fetch!=null?te().global.fetch(e,n):(DS==null&&(DS=pQ.importFetch()),DS(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}te().get("IS_NODE")&&!te().get("IS_BROWSER")&&te().setPlatform("node",new mQ);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(t,e="float32",n){return e=e||"float32",ps(t),new pn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(t,e){const n=R(t,"x","cast");if(!Xz(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return V.runKernel(yh,r,s)}const Se=W({cast_:gQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yQ(t){const n={x:R(t,"x","clone","string_or_numeric")};return V.runKernel(Eh,n)}const To=W({clone_:yQ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SI(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */bB();const vQ={buffer:qe,cast:Se,clone:To,print:SI};mY(vQ);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xQ(t,e){let n=R(t,"a","add"),r=R(e,"b","add");[n,r]=Kt(n,r);const s={a:n,b:r};return V.runKernel(bc,s)}const ge=W({add_:xQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bQ(t,e){let n=R(t,"a","floorDiv"),r=R(e,"b","floorDiv");[n,r]=Kt(n,r);const s={a:n,b:r};return V.runKernel(Ih,s)}const Tw=W({floorDiv_:bQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wQ(t,e){let n=R(t,"a","div"),r=R(e,"b","div");if([n,r]=Kt(n,r),n.dtype==="int32"&&r.dtype==="int32")return Tw(n,r);const s={a:n,b:r},i={};return V.runKernel(_h,s,i)}const Le=W({div_:wQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(t,e){let n=R(t,"a","mul"),r=R(e,"b","mul");[n,r]=Kt(n,r);const s={a:n,b:r};return V.runKernel(zh,s)}const G=W({mul_:_Q});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SQ(t){const e=R(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return V.runKernel(Km,n)}else{const n={x:e};return V.runKernel(Mm,n)}}const dn=W({abs_:SQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kQ(t){const n={x:R(t,"x","acos")};return V.runKernel(ch,n)}const kI=W({acos_:kQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CQ(t){const n={x:R(t,"x","acosh")};return V.runKernel(dh,n)}const CI=W({acosh_:CQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TQ(t){O(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),O(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((s,i)=>R(s,`tensors${i}`,"addN")),n=e[0];e.forEach(s=>{if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!nt(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return V.runKernel(zm,r)}const LB=W({addN_:TQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NQ(t,e=null,n=!1){const s={x:R(t,"x","all","bool")},i={axis:e,keepDims:n};return V.runKernel(xb,s,i)}const Nw=W({all_:NQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IQ(t,e=null,n=!1){const s={x:R(t,"x","any","bool")},i={axis:e,keepDims:n};return V.runKernel(bb,s,i)}const am=W({any_:IQ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(t,e=0){const r={x:R(t,"x","argMax")},s={axis:e};return V.runKernel(Bm,r,s)}const Qu=W({argMax_:$Q});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EQ(t,e=0){const r={x:R(t,"x","argMin")},s={axis:e};return V.runKernel(jm,r,s)}const TI=W({argMin_:EQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AQ(t){const n={x:R(t,"x","asin")};return V.runKernel(hh,n)}const NI=W({asin_:AQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OQ(t){const n={x:R(t,"x","asinh")};return V.runKernel(fh,n)}const II=W({asinh_:OQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PQ(t){const n={x:R(t,"x","atan")};return V.runKernel(ph,n)}const $I=W({atan_:PQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DQ(t,e){let n=R(t,"a","atan2"),r=R(e,"b","atan2");[n,r]=Kt(n,r);const s={a:n,b:r};return V.runKernel(gh,s)}const EI=W({atan2_:DQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RQ(t){const n={x:R(t,"x","atanh")};return V.runKernel(mh,n)}const AI=W({atanh_:RQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wg(t,e,n,r,s="NHWC",i){const o=t[3],a=[...e,o],l=Ia(s);return Ln(t,a,n,i,r,null,null,l)}function _i(t,e,n,r,s,i,o="channelsLast"){const[a,l]=lm(e);let u;if(o==="channelsLast")u=[a,l,t[3],t[3]];else if(o==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Ln(t,u,n,r,s,i,!1,o)}function Na(t,e,n,r,s,i,o="NDHWC"){const[a,l,u]=OC(e);let c,d;if(o==="NDHWC")d="channelsLast",c=[a,l,u,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Fl(t,c,n,r,s,!1,d,i)}function Ln(t,e,n,r,s,i,o=!1,a="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,d]=t;else if(a==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[f,p,,m]=e,[y,v]=lm(n),[x,b]=lm(r),_=Sd(f,x),S=Sd(p,b),{padInfo:k,outHeight:T,outWidth:$}=MQ(s,u,c,y,v,_,S,i,a),A=o?m*d:m;let D;return a==="channelsFirst"?D=[l,A,T,$]:a==="channelsLast"&&(D=[l,T,$,A]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:d,outHeight:T,outWidth:$,outChannels:A,padInfo:k,strideHeight:y,strideWidth:v,filterHeight:f,filterWidth:p,effectiveFilterHeight:_,effectiveFilterWidth:S,dilationHeight:x,dilationWidth:b,inShape:t,outShape:D,filterShape:e}}function Fl(t,e,n,r,s,i=!1,o="channelsLast",a){let[l,u,c,d,f]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,d,f]=t;else if(o==="channelsFirst")[l,f,u,c,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[p,m,y,,v]=e,[x,b,_]=OC(n),[S,k,T]=OC(r),$=Sd(p,S),A=Sd(m,k),D=Sd(y,T),{padInfo:F,outDepth:M,outHeight:j,outWidth:H}=zQ(s,u,c,d,x,b,_,$,A,D,a),K=i?v*f:v;let Q;return o==="channelsFirst"?Q=[l,K,M,j,H]:o==="channelsLast"&&(Q=[l,M,j,H,K]),{batchSize:l,dataFormat:o,inDepth:u,inHeight:c,inWidth:d,inChannels:f,outDepth:M,outHeight:j,outWidth:H,outChannels:K,padInfo:F,strideDepth:x,strideHeight:b,strideWidth:_,filterDepth:p,filterHeight:m,filterWidth:y,effectiveFilterDepth:$,effectiveFilterHeight:A,effectiveFilterWidth:D,dilationDepth:S,dilationHeight:k,dilationWidth:T,inShape:t,outShape:Q,filterShape:e}}function LQ(t,e,n,r,s){r==null&&(r=OI(t,e,n));const i=t[0],o=t[1],a=um((i-e+2*r)/n+1,s),l=um((o-e+2*r)/n+1,s);return[a,l]}function FQ(t,e,n,r,s,i){s==null&&(s=OI(t,e[0],r[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(o[a]=um((t[a]-e[a]+2*s)/r[a]+1,i));return o}function OI(t,e,n,r=1){const s=Sd(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function lm(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function OC(t){return typeof t=="number"?[t,t,t]:t}function Sd(t,e){return e<=1?t:t+(t-1)*(e-1)}function MQ(t,e,n,r,s,i,o,a,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const p=LQ([e,n],i,r,t,a);c=p[0],d=p[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/s);const f=Math.max(0,(c-1)*r+i-e),p=Math.max(0,(d-1)*s+o-n),m=Math.floor(f/2),y=f-m,v=Math.floor(p/2),x=p-v;u={top:m,bottom:y,left:v,right:x,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),d=Math.ceil((n-o+1)/s);else if(typeof t=="object"){const f=l==="channelsLast"?t[1][0]:t[2][0],p=l==="channelsLast"?t[1][1]:t[2][1],m=l==="channelsLast"?t[2][0]:t[3][0],y=l==="channelsLast"?t[2][1]:t[3][1];u={top:f,bottom:p,left:m,right:y,type:f===0&&p===0&&m===0&&y===0?"VALID":"EXPLICIT"},c=um((e-i+f+p)/r+1,a),d=um((n-o+m+y)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function zQ(t,e,n,r,s,i,o,a,l,u,c){let d,f,p,m;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const v=FQ([e,n,r,1],[a,l,u],1,[s,i,o],t,c);f=v[0],p=v[1],m=v[2]}else if(t==="same"){f=Math.ceil(e/s),p=Math.ceil(n/i),m=Math.ceil(r/o);const y=(f-1)*s+a-e,v=(p-1)*i+l-n,x=(m-1)*o+u-r,b=Math.floor(y/2),_=y-b,S=Math.floor(v/2),k=v-S,T=Math.floor(x/2),$=x-T;d={top:S,bottom:k,left:T,right:$,front:b,back:_,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:f,outHeight:p,outWidth:m}}function um(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function wl(t){const[e,n,r]=lm(t);return e===1&&n===1&&r===1}function Yn(t,e){return wl(t)||wl(e)}function Ju(t){return lm(t).every(e=>e>0)}function Ia(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function $r(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")O(qu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{O(qu(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQ(t,e){const r={x:R(t,"x","reshape","string_or_numeric")},s={shape:e};return V.runKernel(Ng,r,s)}const q=W({reshape_:BQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jQ(t,e,n,r,s){const i=R(t,"x","avgPool","float32"),o=1;O(Yn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=q(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),$r("avgPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=V.runKernel(Vm,u,c);return d=Se(d,i.dtype),l?q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Ug=W({avgPool_:jQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VQ(t,e,n,r,s,i="NDHWC"){const o=R(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),O(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),O(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),$r("avgPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i};let d=V.runKernel(Wm,u,c);return d=Se(d,a.dtype),l?q(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const PI=W({avgPool3d_:VQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WQ(t,e=0){O(t.length>=1,()=>"Pass at least one tensor to concat");const n=om(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return To(n[0]);const r=n,s={axis:e};return V.runKernel(qm,r,s)}const rn=W({concat_:WQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UQ(t,e,n=!1,r=!1){let s=R(t,"a","matMul"),i=R(e,"b","matMul");[s,i]=Kt(s,i);const o={a:s,b:i},a={transposeA:n,transposeB:r};return V.runKernel(Um,o,a)}const Ye=W({matMul_:UQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQ(t){const n={x:R(t,"x","sigmoid","float32")};return V.runKernel(Zh,n)}const Xi=W({sigmoid_:GQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HQ(t,e,n){const r=R(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:n};return V.runKernel(Og,s,i)}const it=W({slice_:HQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KQ(t){const n={x:R(t,"x","tanh","float32")};return V.runKernel(nf,n)}const _l=W({tanh_:KQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qQ(t,e,n,r,s,i){const o=R(t,"forgetBias","basicLSTMCell"),a=R(e,"lstmKernel","basicLSTMCell"),l=R(n,"lstmBias","basicLSTMCell"),u=R(r,"data","basicLSTMCell"),c=R(s,"c","basicLSTMCell"),d=R(i,"h","basicLSTMCell"),f=rn([u,d],1),p=Ye(f,a),m=ge(p,l),y=m.shape[0],v=m.shape[1]/4,x=[y,v],b=it(m,[0,0],x),_=it(m,[0,v],x),S=it(m,[0,v*2],x),k=it(m,[0,v*3],x),T=ge(G(Xi(b),_l(_)),G(c,Xi(ge(o,S)))),$=G(_l(T),Xi(k));return[T,$]}const FB=W({basicLSTMCell_:qQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XQ(t,e,n){const r=R(t,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);O(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),O(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),O(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},o={blockShape:e,crops:n};return V.runKernel(Gm,i,o)}const Gg=W({batchToSpaceND_:XQ});function ZQ(t){let e;return t.rank===0||t.rank===1?e=q(t,[1,1,1,t.size]):t.rank===2?e=q(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=q(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YQ(t,e,n,r,s,i){i==null&&(i=.001);const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let u;s!=null&&(u=R(s,"scale","batchNorm"));let c;r!=null&&(c=R(r,"offset","batchNorm")),O(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const f={x:ZQ(o),scale:u,offset:c,mean:a,variance:l},p={varianceEpsilon:i},m=V.runKernel(rg,f,p);return q(m,o.shape)}const of=W({batchNorm_:YQ});function QQ(t,e,n,r,s,i){const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let u;s!=null&&(u=R(s,"scale","batchNorm"));let c;return r!=null&&(c=R(r,"offset","batchNorm")),O(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),O(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),O(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&O(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&O(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),of(o,a,l,c,u,i)}const DI=W({batchNorm2d_:QQ});function JQ(t,e,n,r,s,i){const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let u;s!=null&&(u=R(s,"scale","batchNorm"));let c;return r!=null&&(c=R(r,"offset","batchNorm")),O(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),O(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),O(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&O(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&O(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),of(o,a,l,c,u,i)}const RI=W({batchNorm3d_:JQ});function eJ(t,e,n,r,s,i){const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let u;s!=null&&(u=R(s,"scale","batchNorm"));let c;return r!=null&&(c=R(r,"offset","batchNorm")),O(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),O(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),O(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&O(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&O(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),of(o,a,l,c,u,i)}const LI=W({batchNorm4d_:eJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tJ(t,e,n){const r=R(t,"x","bincount"),s=R(e,"weights","bincount");O(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),O(n>=0,()=>`size must be non-negative, but got ${n}.`),O(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},o={size:n};return V.runKernel(Sb,i,o)}const FI=W({bincount_:tJ});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nJ(t,e){const n=R(t,"x","bitwiseAnd"),r=R(e,"y","bitwiseAnd");if(!nt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const s={a:n,b:r};return V.runKernel(Hm,s)}const MB=W({bitwiseAnd_:nJ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rJ(t,e){const n=R(t,"s0","broadcastArgs","int32"),r=R(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return V.runKernel(kb,s)}const zB=W({broadcastArgs_:rJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sJ(t,e){let n=R(t,"broadcastTo","x");const r=n.shape;if(ps(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=q(n,u)}const s=n.shape,i=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])i[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return To(n);const a={x:n},l={reps:i};return V.runKernel(rf,a,l)}const Lu=W({broadcastTo_:sJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iJ(t){const n={x:R(t,"x","ceil","float32")};return V.runKernel(vh,n)}const MI=W({ceil_:iJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _c(t,e,n){ps(t),n=n||vc(e);const r={shape:t,value:e,dtype:n};return V.runKernel(Bb,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oJ(t,e,n){const r=R(t,"x","clipByValue");if(O(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return _c(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:n};return V.runKernel(xh,s,i)}const Br=W({clipByValue_:oJ});function aJ(t){return rn(t,0)}const zI=W({concat1d_:aJ});function lJ(t,e){return rn(t,e)}const BI=W({concat2d_:lJ});function uJ(t,e){return rn(t,e)}const jI=W({concat3d_:uJ});function cJ(t,e){return rn(t,e)}const VI=W({concat4d_:cJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dJ(t,e,n,r,s="NHWC",i=[1,1],o){const a=R(t,"x","conv2d","float32"),l=R(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),O(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),$r("conv2d",r,o);const d=s==="NHWC"?u.shape[3]:u.shape[1];O(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),O(Yn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),O(Ju(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),O(Ju(n),()=>"Error in conv2D: Strides should be larger than 0.");const f={x:u,filter:l},p={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},m=V.runKernel(Xm,f,p);return c?q(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const ga=W({conv2d_:dJ});function hJ(t,e,n,r,s="NWC",i=1,o){const a=R(t,"x","conv1d"),l=R(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=q(a,[1,a.shape[0],a.shape[1]])),O(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),O(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),$r("conv1d",r,o),O(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),O(Yn(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),O(Ju(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),O(Ju(n),()=>"Error in conv1D: Stride should be larger than 0."),O(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=q(l,[1,l.shape[0],l.shape[1],l.shape[2]]),f=q(u,[u.shape[0],1,u.shape[1],u.shape[2]]),v=ga(f,d,[1,n],r,"NHWC",[1,i],o);return c?q(v,[v.shape[2],v.shape[3]]):q(v,[v.shape[0],v.shape[2],v.shape[3]])}const Iw=W({conv1d_:hJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fJ(t,e,n,r,s,i="NHWC",o){O(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=q(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),O(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),O(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),O(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?l.shape[3]:l.shape[1];O(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),O(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),$r("conv2dDerInput",s,o);const f={dy:l,filter:n},p={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,inputShape:a},m=V.runKernel(Zm,f,p);return u?q(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const WI=W({conv2DBackpropInput_:fJ});function pJ(t,e,n,r,s,i){const o=R(t,"x","conv2dTranspose"),a=R(e,"filter","conv2dTranspose");return WI(n,o,a,r,s,"NHWC",i)}const $w=W({conv2dTranspose_:pJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mJ(t,e,n,r,s="NDHWC",i=[1,1,1]){const o=R(t,"x","conv3d"),a=R(e,"filter","conv3d");let l=o,u=!1;o.rank===4&&(u=!0,l=q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),O(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),O(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),O(Yn(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),O(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),O(Ju(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),O(Ju(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},d={strides:n,pad:r,dataFormat:s,dilations:i},f=V.runKernel(Ym,c,d);return u?q(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const UI=W({conv3d_:mJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gJ(t,e,n,r,s){O(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=q(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],u=o.shape[4];O(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),O(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),O(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),O(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),O(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:o,filter:n},d={pad:s,strides:r,inputShape:i},f=V.runKernel(Ib,c,d);return a?q(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const BB=W({conv3DBackpropInput_:gJ});function yJ(t,e,n,r,s){const i=R(t,"x","conv3dTranspose"),o=R(e,"filter","conv3dTranspose");return BB(n,i,o,r,s)}const GI=W({conv3dTranspose_:yJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vJ(t){const n={x:R(t,"x","cos","float32")};return V.runKernel(bh,n)}const Hg=W({cos_:vJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xJ(t){const n={x:R(t,"x","cosh","float32")};return V.runKernel(wh,n)}const Ew=W({cosh_:xJ});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bJ(t,e=0,n=!1,r=!1){const i={x:R(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:r};return V.runKernel($b,i,o)}const cm=W({cumprod_:bJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wJ(t,e=0,n=!1,r=!1){const i={x:R(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:r};return V.runKernel(Qm,i,o)}const Aw=W({cumsum_:wJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _J(t,e,n,r=!1){const s=R(t,"x","denseBincount"),i=R(e,"weights","denseBincount");O(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),O(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),O(n>=0,()=>`size must be non-negative, but got ${n}.`),O(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const o={x:s,weights:i},a={size:n,binaryOutput:r};return V.runKernel(Ab,o,a)}const H0=W({denseBincount_:_J});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SJ(t,e,n="NHWC"){const r=R(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];O(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),O(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),O(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),O(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return V.runKernel(Ob,a,l)}const HI=W({depthToSpace_:SJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kJ(t,e,n,r,s="NHWC",i=[1,1],o){const a=R(t,"x","depthwiseConv2d","float32"),l=R(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),O(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?u.shape[3]:u.shape[1];O(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),$r("depthwiseConv2d",r,o);const f={x:u,filter:l},p={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},m=V.runKernel(Jm,f,p);return c?q(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const af=W({depthwiseConv2d_:kJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CJ(t){const n={x:R(t,"x","diag")};return V.runKernel(Rb,n)}const jB=W({diag_:CJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TJ(t,e,n,r,s=[1,1],i="NHWC"){const o=R(t,"x","dilation2d"),a=R(e,"filter","dilation2d");O(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),O(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),O(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,u=!1;o.rank===3&&(l=q(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),O(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},d={strides:n,pad:r,dilations:s},f=V.runKernel(eg,c,d);return u?q(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const KI=W({dilation2d_:TJ});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ec(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const i=n-1-s,o=t[i]||1;(e[e.length-1-s]||1)>1&&o===1&&r.unshift(i)}return r}function mn(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],i=e.length-r-1,o=e[i];(s==null||s===1&&o>1)&&n.unshift(i)}return n}function Ke(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let i=t[t.length-s-1];i==null&&(i=1);let o=e[e.length-s-1];if(o==null&&(o=1),i===1)r[n-s-1]=o;else if(o===1)r[n-s-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=i}return r}const NJ=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Ke,getBroadcastDims:ec,getReductionAxes:mn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(t,e){let n=R(t,"a","equal","string_or_numeric"),r=R(e,"b","equal","string_or_numeric");[n,r]=Kt(n,r),Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(tg,s)}const gi=W({equal_:IJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $J(t,e,n){const r=R(e,"a","where"),s=R(n,"b","where"),i=R(t,"condition","where","bool"),o=Ke(Ke(i.shape,r.shape),s.shape),a=Lu(i,o),l=Lu(r,o),u=Lu(s,o),c={condition:a,t:l,e:u};return V.runKernel(Ag,c)}const Kn=W({where_:$J});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EJ(t){const n={x:R(t,"x","zerosLike")};return V.runKernel(Bg,n)}const ot=W({zerosLike_:EJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AJ(t,e){let n=R(t,"a","div"),r=R(e,"b","div");[n,r]=Kt(n,r);const s=Le(n,r),i=ot(s),o=gi(r,i);return Kn(o,i,s)}const qI=W({divNoNan_:AJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OJ(t,e){const n=R(t,"t1","dot"),r=R(e,"t2","dot");O((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(O(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),n.rank===1&&r.rank===1){const o=q(n,[1,-1]),a=q(r,[-1,1]),l=Ye(o,a);return q(l,[])}else if(n.rank===1&&r.rank===2){const o=q(n,[1,-1]),a=q(r,[r.shape[0],r.shape[1]]),l=Ye(o,a);return q(l,[l.size])}else if(n.rank===2&&r.rank===1){const o=q(r,[-1,1]),a=Ye(n,o);return q(a,[a.size])}else{const o=q(r,[r.shape[0],r.shape[1]]);return Ye(n,o)}}const XI=W({dot_:OJ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PJ(t,...e){const n=e.map((s,i)=>R(s,`tensors${i}`,"einsum")),r={equation:t};return V.runKernel(Fb,n,r)}const gu=W({einsum_:PJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DJ(t){const n={x:R(t,"x","elu","float32")};return V.runKernel(Sh,n)}const lf=W({elu_:DJ});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RJ(t,e){const n=R(t,"x","ensureShape","string_or_numeric");if(!Kz(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const VB=W({ensureShape_:RJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LJ(t){let e=R(t,"x","erf");O(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Se(e,"float32"));const n={x:e};return V.runKernel(kh,n)}const Ow=W({erf_:LJ});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZI(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function WB(t,e,n){const r=t.length+e.length,s=[];let i=0,o=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[i++]):s.push(e[o++]);return s}function Fn(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&n.push(t[i]);const s=e.map(i=>t[i]);return[n,s]}function sn(t,e){const n=e.map(r=>1);return WB(t,n,e)}function Qn(t,e,n){O(ZI(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function qt(t,e){if(ZI(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function Ml(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function on(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FJ(t,e=null,n=!1){const s={x:R(t,"x","max")},i={reductionIndices:e,keepDims:n};return V.runKernel(fg,s,i)}const Es=W({max_:FJ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MJ(t,e=null,n=!1){const s={x:R(t,"x","min")},i={axis:e,keepDims:n};return V.runKernel(yg,s,i)}const zd=W({min_:MJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zJ(t,e){let n=R(t,"base","pow"),r=R(e,"exp","pow");[n,r]=Kt(n,r);const s={a:n,b:r};return V.runKernel(Bh,s)}const Po=W({pow_:zJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function je(t,e){if((An(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&An(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ll(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BJ(t){const n={x:R(t,"x","sqrt","float32")};return V.runKernel(Qh,n)}const Rn=W({sqrt_:BJ});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jJ(t){const e=R(t,"x","square"),n={};return V.runKernel("Square",{x:e},n)}const _t=W({square_:jJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VJ(t,e=null,n=!1){let r=R(t,"x","sum");r.dtype==="bool"&&(r=Se(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return V.runKernel(Pg,s,i)}const Ae=W({sum_:VJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WJ(t,e="euclidean",n=null,r=!1){t=R(t,"x","norm");const s=UB(t,e,n);let i=s.shape;if(r){const o=Je(n,t.shape);i=sn(s.shape,o)}return q(s,i)}function UB(t,e,n=null){if(t.rank===0)return dn(t);if(t.rank!==1&&n===null)return UB(q(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Ae(dn(t),n);if(e===1/0)return Es(dn(t),n);if(e===-1/0)return zd(dn(t),n);if(e==="euclidean"||e===2)return Rn(Ae(Po(dn(t),je(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Es(Ae(dn(t),n[0]),n[1]-1);if(e===1/0)return Es(Ae(dn(t),n[1]),n[0]);if(e===-1/0)return zd(Ae(dn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Rn(Ae(_t(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const uf=W({norm_:WJ});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UJ(t,e=null,n=!1){return uf(t,"euclidean",e,n)}const YI=W({euclideanNorm_:UJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GJ(t){const n={x:R(t,"x","exp")};return V.runKernel(Ch,n)}const jr=W({exp_:GJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HJ(t,e=0){const n=R(t,"x","expandDims","string_or_numeric");O(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return V.runKernel(ng,r,s)}const lr=W({expandDims_:HJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KJ(t){const n={x:R(t,"x","expm1")};return V.runKernel(Th,n)}const QI=W({expm1_:KJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qJ(t,e){const n=R(t,"x","tile","string_or_numeric");O(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return V.runKernel(rf,r,s)}const Ts=W({tile_:qJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XJ(t,e,n,r="float32"){e==null&&(e=t);const s=qe([t,e],r),i=t<=e?t:e;for(let a=0;a<i;++a)s.set(1,a,a);const o=q(s.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Ts(lr(o,0),[n[0],1,1]);if(n.length===2)return Ts(lr(lr(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ts(lr(lr(lr(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Pw=W({eye_:XJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(t){const n={x:R(t,"x","floor","float32")};return V.runKernel(Nh,n)}const cf=W({floor_:ZJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YJ(t,e,n=0,r=0){const s=R(t,"x","gather"),i=R(e,"indices","gather","int32"),o={x:s,indices:i},a={axis:n,batchDims:r};return V.runKernel(sg,o,a)}const df=W({gather_:YJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QJ(t,e){let n=R(t,"a","greater","string_or_numeric"),r=R(e,"b","greater","string_or_numeric");[n,r]=Kt(n,r),Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(ig,s)}const Kr=W({greater_:QJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JJ(t,e){let n=R(t,"a","greaterEqual","string_or_numeric"),r=R(e,"b","greaterEqual","string_or_numeric");[n,r]=Kt(n,r),Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel($h,s)}const $a=W({greaterEqual_:JJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eee(t){const n={input:R(t,"input","imag")};return V.runKernel(Ub,n)}const Kg=W({imag_:eee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tee(t){const n={x:R(t,"x","isFinite")};return V.runKernel(Ah,n)}const JI=W({isFinite_:tee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nee(t){const n={x:R(t,"x","isInf")};return V.runKernel(Oh,n)}const e$=W({isInf_:nee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ree(t){const n={x:R(t,"x","isNaN")};return V.runKernel(Ph,n)}const t$=W({isNaN_:ree});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function see(t,e=.2){const r={x:R(t,"x","leakyRelu")},s={alpha:e};return V.runKernel(og,r,s)}const qg=W({leakyRelu_:see});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iee(t,e){let n=R(t,"a","less","string_or_numeric"),r=R(e,"b","less","string_or_numeric");[n,r]=Kt(n,r),Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(ag,s)}const Bd=W({less_:iee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(t,e){let n=R(t,"a","lessEqual","string_or_numeric"),r=R(e,"b","lessEqual","string_or_numeric");[n,r]=Kt(n,r),Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(lg,s)}const zl=W({lessEqual_:oee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GB(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return V.runKernel(Gb,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aee(t,e=5,n=1,r=1,s=.5){const i=R(t,"x","localResponseNormalization");O(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),O(qu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=q(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},u={depthRadius:e,bias:n,alpha:r,beta:s},c=V.runKernel(hg,l,u);return a?q(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const n$=W({localResponseNormalization_:aee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lee(t){const n={x:R(t,"x","log","float32")};return V.runKernel(Dh,n)}const cs=W({log_:lee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uee(t){const n={x:R(t,"x","log1p")};return V.runKernel(Rh,n)}const Xg=W({log1p_:uee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cee(t){return O(vl(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const r=R(e,"x","tf.grad","string_or_numeric"),s=n!=null?R(n,"dy","tf.grad"):null;return V.tidy(()=>{const{value:i,grads:o}=V.gradients(()=>t(r),[r],s);return s!=null&&Zn(i.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Dw(o),o[0]})}}function dee(t){return O(vl(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{O(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=om(e,"args","tf.grads","string_or_numeric"),s=n!=null?R(n,"dy","tf.grads"):null;return V.tidy(()=>{const{value:i,grads:o}=V.gradients(()=>t(...r),r,s);return s!=null&&Zn(i.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Dw(o),o})}}function hee(t){return O(vl(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{O(e instanceof gt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),O(n==null||n instanceof gt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:s}=V.gradients(()=>t(e),[e],n);return Dw(r),{grad:r[0],value:s}}}function fee(t){return O(vl(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{O(Array.isArray(e)&&e.every(s=>s instanceof gt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),O(n==null||n instanceof gt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=V.gradients(()=>t(...e),e,n);return n!=null&&Zn(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Dw(r.grads),r}}function HB(t,e){O(vl(t),()=>"The f passed in variableGrads(f) must be a function"),O(e==null||Array.isArray(e)&&e.every(u=>u instanceof im),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in V.registeredVariables)e.push(V.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),O(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:o,grads:a}=V.gradients(t,e,null,i);O(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),O(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:o,grads:l}}function Do(t){return V.customGrad(t)}function Dw(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pee(t){const n={x:R(t,"x","neg")};return V.runKernel(xg,n)}const $t=W({neg_:pee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mee(t){const n={x:R(t,"x","softplus")};return V.runKernel(Yh,n)}const Sc=W({softplus_:mee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gee(t){const e=R(t,"x","logSigmoid");return Do(r=>({value:$t(Sc($t(r))),gradFunc:o=>G(o,Xi($t(r)))}))(e)}const r$=W({logSigmoid_:gee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(t,e){let n=R(t,"a","sub"),r=R(e,"b","sub");[n,r]=Kt(n,r);const s={a:n,b:r};return V.runKernel(ef,s)}const Ie=W({sub_:yee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vee(t,e=-1){const n=R(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Do((s,i)=>{const a=Es(s,e,!0),l=Ie(s,a),u=Ie(Se(l,"float32"),cs(Ae(jr(l),e,!0)));return i([u]),{value:u,gradFunc:(d,f)=>{const[p]=f,m=!0,y=jr(p);return Ie(d,G(Ae(d,e,m),y))}}})(n)}const Rw=W({logSoftmax_:vee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(t,e=null,n=!1){const r=R(t,"x","logSumExp"),s=Je(e,r.shape),i=Es(r,s,!0),o=Ie(r,i),a=jr(o),l=Ae(a,s),u=cs(l),c=ge(q(i,u.shape),u);if(n){const d=sn(c.shape,s);return q(c,d)}return c}const Zg=W({logSumExp_:xee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bee(t,e){const n=R(t,"a","logicalAnd","bool"),r=R(e,"b","logicalAnd","bool");Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(ug,s)}const Qi=W({logicalAnd_:bee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wee(t){const n={x:R(t,"x","logicalNot","bool")};return V.runKernel(cg,n)}const Yg=W({logicalNot_:wee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ee(t,e){const n=R(t,"a","logicalOr","bool"),r=R(e,"b","logicalOr","bool");Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(dg,s)}const Lw=W({logicalOr_:_ee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(t,e){const n=R(t,"a","logicalXor","bool"),r=R(e,"b","logicalXor","bool");return Ke(n.shape,r.shape),Qi(Lw(t,e),Yg(Qi(t,e)))}const s$=W({logicalXor_:See});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wv=2147483648;function kee(t,e,n="left"){const r=R(t,"sortedSequence","searchSorted"),s=R(e,"values","searchSorted"),i=r.shape[r.shape.length-1],o=s.shape[s.shape.length-1],a=q(r,[-1,i]),l=q(s,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(oe(l.shape)>=wv)throw new Error(`values tensor size must less than ${wv}`);if(a.shape[1]>=wv)throw new Error(`trailing dim_size must less than ${wv} for int32 output type, was ${a.shape[1]}`);const u={sortedSequence:a,values:l},c={side:n};return V.runKernel(uw,u,c)}const Fw=W({searchSorted_:kee});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KB(t,e){return Fw(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(t,e,n,r,s){const i=R(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=q(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),O(Yn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),$r("maxPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=V.runKernel(pg,u,c);return l?q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Qg=W({maxPool_:Cee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tee(t,e=[1,1,1],n,r,s,i="NDHWC"){const o=R(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),O(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),$r("maxPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i},d=V.runKernel(mg,u,c);return l?q(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const i$=W({maxPool3d_:Tee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nee(t,e,n,r,s=!1){const o={x:R(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:r,includeBatchInIndex:s},l=V.runKernel(Xb,o,a);return{result:l[0],indexes:l[1]}}const qB=W({maxPoolWithArgmax_:Nee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iee(t,e){let n=R(t,"a","maximum"),r=R(e,"b","maximum");[n,r]=Kt(n,r),n.dtype==="bool"&&(n=Se(n,"int32"),r=Se(r,"int32")),Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(Lh,s)}const Mo=W({maximum_:Iee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(t,e=null,n=!1){const s={x:R(t,"x","mean")},i={axis:e,keepDims:n};return V.runKernel(gg,s,i)}const Ut=W({mean_:$ee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fn(t,e="float32"){if(ps(t),e==="complex64"){const r=fn(t,"float32"),s=fn(t,"float32");return ma(r,s)}const n=Xn(oe(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dr(t,e="float32"){if(ps(t),e==="complex64"){const r=Dr(t,"float32"),s=fn(t,"float32");return ma(r,s)}const n=vb(oe(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XB(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=R(t,"x","meshgrid",t instanceof gt?t.dtype:"float32");if(e===void 0)return[r];let s=R(e,"y","meshgrid",e instanceof gt?e.dtype:"float32");const i=oe(r.shape),o=oe(s.shape);return n==="xy"?(r=q(r,[1,-1]),s=q(s,[-1,1]),[Ye(Dr([o,1],r.dtype),r),Ye(s,Dr([1,i],s.dtype))]):(r=q(r,[-1,1]),s=q(s,[1,-1]),[Ye(r,Dr([1,o],r.dtype)),Ye(Dr([i,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eee(t,e){let n=R(t,"a","minimum"),r=R(e,"b","minimum");[n,r]=Kt(n,r),n.dtype==="bool"&&(n=Se(n,"int32"),r=Se(r,"int32")),Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(Fh,s)}const Sl=W({minimum_:Eee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aee(t,e,n){O(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=R(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");O(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)O(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),O(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:n},o={x:r};return V.runKernel(vg,o,i)}const o$=W({mirrorPad_:Aee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oee(t,e){let n=R(t,"a","mod"),r=R(e,"b","mod");[n,r]=Kt(n,r);const s={a:n,b:r};return V.runKernel(Mh,s)}const a$=W({mod_:Oee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t,e=null,n=!1){t=R(t,"x","moments");const r=Je(e,t.shape),s=Ut(t,r,n);let i=s.shape;n||(i=sn(s.shape,r));const o=_t(Ie(Se(t,"float32"),q(s,i))),a=Ut(o,r,n);return{mean:s,variance:a}}const Jg=W({moments_:Pee});function Dee(t,e,n,r){const s=R(e,"data","multiRNNCell"),i=om(n,"c","multiRNNCell"),o=om(r,"h","multiRNNCell");let a=s;const l=[];for(let d=0;d<t.length;d++){const f=t[d](a,i[d],o[d]);l.push(f[0]),l.push(f[1]),a=f[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const ZB=W({multiRNNCell_:Dee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ree(t,e,n,r=!1){const s=R(t,"logits","multinomial"),i=s.size,o=s.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const l={logits:o===1?q(s,[1,-1]):s},u={numSamples:e,seed:n,normalized:r},c=V.runKernel(Zb,l,u);return o===1?q(c,[c.size]):c}const YB=W({multinomial_:Ree});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lee(t,e){let n=R(t,"a","notEqual","string_or_numeric"),r=R(e,"b","notEqual","string_or_numeric");[n,r]=Kt(n,r),Ke(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(bg,s)}const tc=W({notEqual_:Lee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fee(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:R(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return V.runKernel(_g,o,a)}const jd=W({oneHot_:Fee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(t){const n={x:R(t,"x","onesLike")};return V.runKernel(wg,n)}const ds=W({onesLike_:Mee});function zee(t,e){const n=R(t,"v1","outerProduct"),r=R(e,"v2","outerProduct");O(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const s=q(n,[-1,1]),i=q(r,[1,-1]);return Ye(s,i)}const QB=W({outerProduct_:zee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bee(t,e,n=0){const r=R(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},i={x:r};return V.runKernel(kg,i,s)}const Ea=W({pad_:Bee});function jee(t,e,n=0){return O(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Ea(t,[e],n)}const JB=W({pad1d_:jee});function Vee(t,e,n=0){return O(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ea(t,e,n)}const ej=W({pad2d_:Vee});function Wee(t,e,n=0){return O(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ea(t,e,n)}const tj=W({pad3d_:Wee});function Uee(t,e,n=0){return O(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ea(t,e,n)}const nj=W({pad4d_:Uee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gee(t,e,n){const r=R(t,"x","spaceToBatchND");O(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),O(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),O(r.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:n};return V.runKernel(Dg,s,i)}const ey=W({spaceToBatchND_:Gee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hee(t,e,n,r,s,i,o){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const a=R(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O(Yn(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const c=_i(l.shape,e,i,s,r),d=[c.dilationHeight,c.dilationWidth];let f;r==="same"?f=qee([c.filterHeight,c.filterWidth],d):f=[[0,0],[0,0]];const p=d[0]===1&&d[1]===1,[m,y]=Kee([c.inHeight,c.inWidth],d,f),v=p?r:"valid",x=p?l:ey(l,d,m),_=(n==="avg"?()=>Ug(x,e,i,v,o):()=>Qg(x,e,i,v,o))(),S=p?_:Gg(_,d,y);return u?q(S,[S.shape[1],S.shape[2],S.shape[3]]):S}function Kee(t,e,n){const r=n.map(c=>c[0]),s=n.map(c=>c[1]),i=t.concat(r,s),o=e.map((c,d)=>(c-i[d]%c)%c),a=s.map((c,d)=>c+o[d]),l=e.map((c,d)=>[r[d],a[d]]),u=e.map((c,d)=>[0,o[d]]);return[l,u]}function qee(t,e){const r=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),s=r.map(o=>Math.floor(o/2)),i=r.map((o,a)=>o-s[a]);return r.map((o,a)=>[s[a],i[a]])}const l$=W({pool_:Hee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(t,e){const n=R(t,"x","prelu"),r=R(e,"alpha","prelu"),s={x:n,alpha:r};return V.runKernel(Cg,s)}const ty=W({prelu_:Xee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t,e=null,n=!1){let r=R(t,"x","prod");r.dtype==="bool"&&(r=Se(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return V.runKernel(Tg,s,i)}const u$=W({prod_:Zee});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yee(t,e,n,r){const s=t.map((c,d)=>R(c,`tensors${d}`,"raggedGather","int32")),i=R(e,"paramsDenseValues","raggedGather"),o=R(n,"indices","raggedGather","int32"),a={paramsNestedSplits:s,paramsDenseValues:i,indices:o},l={outputRaggedRank:r},u=V.runKernel(ew,a,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const rj=W({raggedGather_:Yee});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t,e,n){const r=R(t,"starts","raggedRange"),s=R(e,"limits","raggedRange",r.dtype),i=R(n,"deltas","raggedRange",r.dtype),o={starts:r,limits:s,deltas:i},a=V.runKernel(tw,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const sj=W({raggedRange_:Qee});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(t,e,n,r,s){const i=R(t,"shape","raggedTensorToTensor","int32"),o=R(e,"values","raggedTensorToTensor"),a=R(n,"defaultValue","raggedTensorToTensor",o.dtype),l=r.map((d,f)=>R(d,`tensors${f}`,"raggedTensorToTensor","int32")),u={shape:i,values:o,defaultValue:a,rowPartitionTensors:l},c={rowPartitionTypes:s};return V.runKernel(nw,u,c)}const ij=W({raggedTensorToTensor_:Jee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(t,e,n){ps(t);const r=oe(t);let s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else if(n==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<r;i++)s[i]=e();return V.makeTensor(s,t,n)}const oj=W({rand_:ete});var c$={exports:{}};c$.exports;(function(t){(function(e,n,r){function s(l){var u=this,c=a();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function i(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function o(l,u){var c=new s(l),d=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,d&&(typeof d=="object"&&i(d,c),f.state=function(){return i(c,{})}),f}function a(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=o:this.alea=o})(Sa,t)})(c$);var tte=c$.exports,d$={exports:{}};d$.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(f+p)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(Sa,t)})(d$);var nte=d$.exports,h$={exports:{}};h$.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(f+p)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(Sa,t)})(h$);var rte=h$.exports,f$={exports:{}};f$.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.x,d=l.i,f,p;return f=c[d],f^=f>>>7,p=f^f<<24,f=c[d+1&7],p^=f^f>>>10,f=c[d+3&7],p^=f^f>>>3,f=c[d+4&7],p^=f^f<<7,f=c[d+7&7],f=f^f<<13,p^=f^f<<9,c[d]=p,l.i=d+1&7,p};function u(c,d){var f,p=[];if(d===(d|0))p[0]=d;else for(d=""+d,f=0;f<d.length;++f)p[f&7]=p[f&7]<<15^d.charCodeAt(f)+p[f+1&7]<<13;for(;p.length<8;)p.push(0);for(f=0;f<8&&p[f]===0;++f);for(f==8?p[7]=-1:p[f],c.x=p,c.i=0,f=256;f>0;--f)c.next()}u(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(f+p)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(c.x&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(Sa,t)})(f$);var ste=f$.exports,p$={exports:{}};p$.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.w,d=l.X,f=l.i,p,m;return l.w=c=c+1640531527|0,m=d[f+34&127],p=d[f=f+1&127],m^=m<<13,p^=p<<17,m^=m>>>15,p^=p>>>12,m=d[f]=m^p,l.i=f,m+(c^c>>>16)|0};function u(c,d){var f,p,m,y,v,x=[],b=128;for(d===(d|0)?(p=d,d=null):(d=d+"\0",p=0,b=Math.max(b,d.length)),m=0,y=-32;y<b;++y)d&&(p^=d.charCodeAt((y+32)%d.length)),y===0&&(v=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,y>=0&&(v=v+1640531527|0,f=x[y&127]^=p+v,m=f==0?m+1:0);for(m>=128&&(x[(d&&d.length||0)&127]=-1),m=127,y=4*128;y>0;--y)p=x[m+34&127],f=x[m=m+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,x[m]=p^f;c.w=v,c.X=x,c.i=m}u(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(f+p)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(c.X&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(Sa,t)})(p$);var ite=p$.exports,m$={exports:{}};m$.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.b,f=l.c,p=l.d,m=l.a;return d=d<<25^d>>>7^f,f=f-p|0,p=p<<24^p>>>8^m,m=m-d|0,l.b=d=d<<20^d>>>12^f,l.c=f=f-p|0,l.d=p<<16^f>>>16^m,l.a=m-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(f+p)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(Sa,t)})(m$);var ote=m$.exports,aj={exports:{}};const ate={},lte=Object.freeze(Object.defineProperty({__proto__:null,default:ate},Symbol.toStringTag,{value:"Module"})),ute=aN(lte);(function(t){(function(e,n,r){var s=256,i=6,o=52,a="random",l=r.pow(s,i),u=r.pow(2,o),c=u*2,d=s-1,f;function p(S,k,T){var $=[];k=k==!0?{entropy:!0}:k||{};var A=x(v(k.entropy?[S,_(n)]:S??b(),3),$),D=new m($),F=function(){for(var M=D.g(i),j=l,H=0;M<u;)M=(M+H)*s,j*=s,H=D.g(1);for(;M>=c;)M/=2,j/=2,H>>>=1;return(M+H)/j};return F.int32=function(){return D.g(4)|0},F.quick=function(){return D.g(4)/4294967296},F.double=F,x(_(D.S),n),(k.pass||T||function(M,j,H,K){return K&&(K.S&&y(K,D),M.state=function(){return y(D,{})}),H?(r[a]=M,j):M})(F,A,"global"in k?k.global:this==r,k.state)}function m(S){var k,T=S.length,$=this,A=0,D=$.i=$.j=0,F=$.S=[];for(T||(S=[T++]);A<s;)F[A]=A++;for(A=0;A<s;A++)F[A]=F[D=d&D+S[A%T]+(k=F[A])],F[D]=k;($.g=function(M){for(var j,H=0,K=$.i,Q=$.j,Z=$.S;M--;)j=Z[K=d&K+1],H=H*s+Z[d&(Z[K]=Z[Q=d&Q+j])+(Z[Q]=j)];return $.i=K,$.j=Q,H})(s)}function y(S,k){return k.i=S.i,k.j=S.j,k.S=S.S.slice(),k}function v(S,k){var T=[],$=typeof S,A;if(k&&$=="object")for(A in S)try{T.push(v(S[A],k-1))}catch{}return T.length?T:$=="string"?S:S+"\0"}function x(S,k){for(var T=S+"",$,A=0;A<T.length;)k[d&A]=d&($^=k[d&A]*19)+T.charCodeAt(A++);return _(k)}function b(){try{var S;return f&&(S=f.randomBytes)?S=S(s):(S=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(S)),_(S)}catch{var k=e.navigator,T=k&&k.plugins;return[+new Date,e,T,e.screen,_(n)]}}function _(S){return String.fromCharCode.apply(0,S)}if(x(r.random(),n),t.exports){t.exports=p;try{f=ute}catch{}}else r["seed"+a]=p})(typeof self<"u"?self:Sa,[],Math)})(aj);var cte=aj.exports,dte=tte,hte=nte,fte=rte,pte=ste,mte=ite,gte=ote,kc=cte;kc.alea=dte;kc.xor128=hte;kc.xorwow=fte;kc.xorshift7=pte;kc.xor4096=mte;kc.tychei=gte;var Mw=kc;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yte=.001,lj=.1;function vte(t,e,n){return n==null&&(n=g$()),PC(t,e,(r,s)=>y$(r,s,n))}function g$(){return V.backend.floatPrecision()===32?yte:lj}function PC(t,e,n){let r=!0;if((An(t)||An(e))&&(r=!1),An(t)&&An(e)&&(r=!0),r){const o=t.constructor.name,a=e.constructor.name;if(o!==a)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${a}`)}if(Array.isArray(t)&&Array.isArray(e)){const o=Oo(t),a=Oo(e);if(!nt(o,a))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${a}]`)}const s=An(t)?t:Ao(t),i=An(e)?e:Ao(e);if(s.length!==i.length)throw new Error(`Arrays have different lengths actual: ${s.length} vs expected: ${i.length}.
Actual:   ${s}.
Expected: ${i}.`);for(let o=0;o<i.length;++o){const a=s[o],l=i[o];if(!n(a,l))throw new Error(`Arrays differ: actual[${o}] = ${a}, expected[${o}] = ${l}.
Actual:   ${s}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function xte(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function bte(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return bo(t)||bo(t[0])||bo(e)||bo(e[0])?PC(t,n,(r,s)=>r==s):PC(t,e,(r,s)=>y$(r,s,0))}function wte(t,e,n){if(n==null&&(n=g$()),!y$(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function y$(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function _te(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error(`Value out of range:${t[r]} low: ${e}, high: ${n}`)}function Ste(t,e){const n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let s=0;s<r.length;s++)if(n[s]!==r[s])throw new Error(`Expected ArrayBuffer value at ${s} to be ${r[s]} but got ${n[s]} instead`)}function uj(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?uj(n):t[e]=Co(n)}return t}function kte(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",r=>n(e)),e.load()})}async function Cte(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const Tte=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:lj,createVideoElement:kte,encodeStrings:uj,expectArrayBuffersEqual:Ste,expectArraysClose:vte,expectArraysEqual:bte,expectNumbersClose:wte,expectPromiseToFail:xte,expectValuesInRange:_te,play:Cte,testEpsilon:g$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v${constructor(e,n,r,s,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=Mw.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,i,o;do s=2*this.random()-1,i=2*this.random()-1,o=s*s+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Nte{constructor(e,n,r,s){this.alpha=e,this.beta=1/n,this.dtype=r;const i=s||Math.random();this.randu=Mw.alea(i.toString()),this.randn=new v$(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,s,i,o;for(;;){do s=this.randn.nextValue(),o=1+this.c*s;while(o<=0);if(o*=o*o,e=s*s,n=1-.331*e*e,r=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Ite{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=Mw.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $te(t,e,n=1,r="float32",s){if(ps(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const i=new Nte(e,n,r,s),o=qe(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const cj=W({randomGamma_:$te});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ete(t,e=0,n=1,r,s){if(ps(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new v$(e,n,r,!1,s),o=qe(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const zw=W({randomNormal_:Ete});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return zw(t,0,1,e,n)}const dj=W({randomStandardNormal_:Ate});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(t,e=0,n=1,r="float32",s){ps(t);const i=qe(t,r),o=new Ite(e,n,null,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Bl=W({randomUniform_:Ote});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pte(t,e,n,r){return Bl(t,e,n,"int32",r)}const hj=W({randomUniformInt_:Pte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nc(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return V.runKernel(rw,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dte(t){const n={input:R(t,"input","real")};return V.runKernel(sw,n)}const Vd=W({real_:Dte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rte(t){const n={x:R(t,"x","reciprocal")};return V.runKernel(jh,n)}const x$=W({reciprocal_:Rte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(t){const n={x:R(t,"x","relu")};return V.runKernel(Vh,n)}const io=W({relu_:Lte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(t){const n={x:R(t,"x","relu6")};return V.runKernel(Wh,n)}const Bw=W({relu6_:Fte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mte(t,e){const r={x:R(t,"x","reverse")},s={dims:e};return V.runKernel(Eg,r,s)}const Ps=W({reverse_:Mte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(t){const e=R(t,"x","reverse");return O(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Ps(e,0)}const fj=W({reverse1d_:zte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bte(t,e){const n=R(t,"x","reverse");return O(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Ps(n,e)}const pj=W({reverse2d_:Bte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jte(t,e){const n=R(t,"x","reverse");return O(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Ps(n,e)}const mj=W({reverse3d_:jte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t,e){const n=R(t,"x","reverse");return O(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Ps(n,e)}const gj=W({reverse4d_:Vte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wte(t){const n={x:R(t,"x","round")};return V.runKernel(Uh,n)}const jw=W({round_:Wte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ute(t){const n={x:R(t,"x","rsqrt","float32")};return V.runKernel(Gh,n)}const Vw=W({rsqrt_:Ute});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gte(t){const n={x:R(t,"x","selu")};return V.runKernel(Hh,n)}const Ww=W({selu_:Gte});function Hte(t,e,n,r,s,i=[1,1],o="NHWC"){const a=R(t,"x","separableConv2d"),l=R(e,"depthwiseFilter","separableConv2d"),u=R(n,"pointwiseFilter","separableConv2d");let c=a,d=!1;if(a.rank===3&&(d=!0,c=q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");O(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),O(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),O(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),O(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),O(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const f=l.shape[2],p=l.shape[3];O(u.shape[2]===f*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${f*p}, but got ${u.shape[2]}.`);const m=af(c,l,r,s,o,i),v=ga(m,u,1,"valid",o);return d?q(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const Uw=W({separableConv2d_:Hte});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Kte(t,e){const n=R(t,"x","setdiff1d"),r=R(e,"y","setdiff1d");O(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),O(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),O(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),i=await r.data(),o=new Set(i);let a=0;for(let c=0;c<s.length;c++)o.has(s[c])||a++;const l=new pn([a],n.dtype),u=new pn([a],"int32");for(let c=0,d=0;c<s.length;c++)o.has(s[c])||(l.values[d]=s[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const yj=Kte;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qte(t){const n={x:R(t,"x","sign")};return V.runKernel(Xh,n)}const b$=W({sign_:qte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xte(t){const n={x:R(t,"x","sin","float32")};return V.runKernel(Kh,n)}const Gw=W({sin_:Xte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(t){const n={x:R(t,"x","sinh")};return V.runKernel(qh,n)}const Hw=W({sinh_:Zte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(t,e,n){const r=R(t,"x","slice1d");return O(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),it(r,[e],[n])}const ny=W({slice1d_:Yte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qte(t,e,n){const r=R(t,"x","slice2d");return O(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),it(r,e,n)}const Kw=W({slice2d_:Qte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jte(t,e,n){const r=R(t,"x","slice3d");return O(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),it(r,e,n)}const ry=W({slice3d_:Jte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t,e,n){const r=R(t,"x","slice4d");return O(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),it(r,e,n)}const Wd=W({slice4d_:ene});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tne(t,e=-1){const n=R(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return V.runKernel(Lg,r,s)}const sy=W({softmax_:tne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(t){O(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(zb,e)}const iy=W({fft_:nne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rne(t){O(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(Wb,e)}const Ud=W({ifft_:rne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sne(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=q(t,[n,e]);r=Ud(s)}else{const s=[n,2*(e-1)],i=q(Vd(t),[n,e]),o=q(Kg(t),[n,e]),a=Ps(it(i,[0,1],[n,e-2]),1),l=G(Ps(it(o,[0,1],[n,e-2]),1),je(-1)),u=rn([i,a],1),c=rn([o,l],1),d=q(ma(u,c),[s[0],s[1]]);r=Ud(d)}if(r=Vd(r),t.rank===3&&t.shape[0]!==0){const s=r,i=t.shape[0];r=q(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const qw=W({irfft_:sne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t,e,n=0){const s={x:R(t,"x","split")},i={numOrSizeSplits:e,axis:n};return V.runKernel(Rg,s,i)}const Fr=W({split_:ine});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t,e){O(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const m=t.shape.map(v=>0),y=t.shape.map(v=>v);y[t.shape.length-1]=e,s=it(t,m,y),n=e}else if(e!=null&&e>n){const m=t.shape.map(y=>y);m[t.shape.length-1]=e-n,s=rn([t,fn(m)],t.shape.length-1),n=e}else s=t;const i=ot(s),o=q(ma(s,i),[r,n]),a=iy(o),l=Math.floor(n/2)+1,u=Vd(a),c=Kg(a),d=Fr(u,[l,n-l],u.shape.length-1),f=Fr(c,[l,n-l],c.shape.length-1),p=s.shape.slice();return p[s.shape.length-1]=l,q(ma(d[0],f[0]),p)}const oy=W({rfft_:one});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(t,e){let n=R(t,"a","squaredDifference"),r=R(e,"b","squaredDifference");[n,r]=Kt(n,r),Ke(n.shape,r.shape);const s={a:n,b:r},i={};return V.runKernel(Jh,s,i)}const Xw=W({squaredDifference_:ane});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lne(t,e){const n=R(t,"x","squeeze","string_or_numeric");return q(n,Ca(n.shape,e).newShape)}const jl=W({squeeze_:lne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(t,e=0){const n=om(t,"tensors","stack","string_or_numeric");O(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&O(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return V.runKernel(Sg,r,s)}const Vr=W({stack_:une});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(t,e=0){const r={x:R(t,"x","step")},s={alpha:e};return V.runKernel(sf,r,s)}const Cc=W({step_:cne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t,e,n,r,s=0,i=0,o=0,a=0,l=0){const c={x:R(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return V.runKernel(gw,c,d)}const w$=W({stridedSlice_:dne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hne(t){const n={x:R(t,"x","tan","float32")};return V.runKernel(tf,n)}const _$=W({tan_:hne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ur(t,e){yc(t);const n=Oo(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ll(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kd(t,e,n){if(yc(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Oo(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ll(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S$(t,e,n){if(yc(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Oo(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ll(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vj(t,e,n){if(yc(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Oo(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ll(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xj(t,e,n){if(yc(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Oo(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ll(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bj(t,e,n){if(yc(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Oo(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Ll(t,e,r,n)}function k$(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(i+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(i+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(i+` update.rank != ${s+t.length-r}`);for(let o=0;o<s;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-s;++o)if(n.shape[o+s]!==t[o+r])throw new Error(i+` updates.shape[${o+s}] (${n.shape[o+s]}) != shape[${o+s}] (${t[o+s]})`)}function Zw(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}k$(n,e,t)}function Vl(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=n.length;let o=1;for(let d=s;d<i;++d)o*=n[d];const a=s<1?1:s,l=oe(e.shape)/a,u=[...ze(n.slice(0,s)),1],c=oe(n);return{sliceRank:s,numUpdates:l,sliceSize:o,strides:u,outputSize:c}}const fne=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:Vl,validateInput:Zw,validateUpdateShape:k$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pne(t,e,n){const r=R(t,"tensor","tensorScatterupdate"),s=R(e,"indices","tensorScatterupdate","int32"),i=R(n,"updates","tensorScatterupdate");if(Zw(i,s,r.shape),r.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${i.dtype}.`);const o={tensor:r,indices:s,updates:i},a={};return V.runKernel(lw,o,a)}const wj=W({tensorScatterUpdate_:pne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(t,e=1,n=!0){const r=R(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},o={k:e,sorted:n},[a,l]=V.runKernel(bw,i,o);return{values:a,indices:l}}const C$=W({topk_:mne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(t,e=0,n=1,r,s){if(ps(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new v$(e,n,r,!0,s),o=qe(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const Yw=W({truncatedNormal_:gne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yne(t,e=0){const n=R(t,"x","unique","string_or_numeric");O(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[i,o]=V.runKernel(_w,r,s);return{values:i,indices:o}}const T$=W({unique_:yne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vne(t,e,n){const r=R(t,"x","unsortedSegmentSum"),s=R(e,"segmentIds","unsortedSegmentSum","int32");O(qu(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},o={numSegments:n};return V.runKernel(zg,i,o)}const Qw=W({unsortedSegmentSum_:vne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(t,e=0){const n=R(t,"x","unstack","string_or_numeric");O(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return V.runKernel(Mg,r,s)}const Ds=W({unstack_:xne});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _j(t,e){return Fw(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N$(t,e=!0,n,r){return V.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jw(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=qe(t,"int32"),s=qe([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=r.indexToLoc(n[i]),a=i*t.length;s.values.set(o,a)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function bne(t){const e=R(t,"condition","whereAsync","bool"),n=await e.data(),r=Jw(e.shape,n);return t!==e&&e.dispose(),r}const I$=bne;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function wne(t,e,n){const r=R(t,"tensor","boolMask"),s=R(e,"mask","boolMask","bool"),i=n??0,o=s.rank,a=r.shape;O(o>0,()=>"mask cannot be scalar"),Zn(a.slice(i,i+o),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let y=i;y<i+o;y++)l*=a[y];const u=a.slice(0,i).concat([l],a.slice(i+o)),c=q(r,u),d=q(s,[-1]),f=await I$(d),p=jl(f,[1]),m=df(c,p,i);return t!==r&&r.dispose(),e!==s&&s.dispose(),p.dispose(),c.dispose(),d.dispose(),f.dispose(),m}const Sj=wne;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ne(t,e,n){const r=R(t,"x","transpose");if(e==null&&(e=r.shape.map((o,a)=>a).reverse()),O(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{O(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?ee(()=>{let o=Vd(r),a=Kg(r);return o=V.runKernel(Ru,{x:o},i),a=V.runKernel(Ru,{x:a},i),n&&(a=$t(a)),ma(o,a)}):V.runKernel(Ru,s,i)}const st=W({transpose_:_ne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sne(t,e,n,r,s=!0){const i=R(t,"v","movingAverage"),o=R(e,"x","movingAverage"),a=R(n,"decay","movingAverage");vB(i,o),O(nt(i.shape,o.shape),()=>"Shape mismatch in v and x");const l=je(1),u=Ie(l,a);let c=G(Ie(o,i),u);if(s){O(r!=null,()=>"When using zeroDebias: true, step is required.");const d=R(r,"step","movingAverage");c=Le(c,Ie(l,Po(a,d)))}return ge(i,c)}const kj=W({movingAverage_:Sne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kne(t,e,n){ps(n);const r=R(t,"indices","scatterND","int32"),s=R(e,"updates","scatterND");Zw(s,r,n);const i={indices:r,updates:s},o={shape:n};return V.runKernel(aw,i,o)}const Cj=W({scatterND_:kne});function Cne(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t,e,n,r=0){ps(n);const s=R(t,"sparseIndices","sparseToDense","int32"),i=R(e,"sparseValues","sparseToDense","string_or_numeric"),o=R(r,"defaultValue","sparseToDense",i.dtype);Cne(s,i,n,o);const a={sparseIndices:s,sparseValues:i,defaultValue:o},l={outputShape:n};return V.runKernel(pw,a,l)}const Tj=W({sparseToDense_:Tne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nne(t,e){const n=R(e,"indices","gatherND","int32"),s={params:R(t,"x","gatherND","string_or_numeric"),indices:n};return V.runKernel(Vb,s)}const Nj=W({gatherND_:Nne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t,e){if(e==null)return t.shape.slice();if(nt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ne(t,e,n,r){const s=R(t,"x","dropout");if(O(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),O(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof gt?s.clone():s;const i=Ine(s,n),o=1-e,a=Le(cf(ge(Bl(i,0,1,"float32",r),o)),o);return G(s,a)}const $$=W({dropout_:$ne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E$(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function e1(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+r-1);s[i]=e-n*Math.cos(o)}return ur(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ene(t,e,n=1){const r=R(t,"predictions","inTopK"),s=R(e,"targets","inTopK");O(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),O(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),Zn(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];O(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await r.data(),a=await s.data(),[l,u]=[o.length/i,i],c=Dn("bool",l);for(let d=0;d<l;d++){const f=d*u,p=o.subarray(f,f+u),m=[];for(let y=0;y<p.length;y++)m.push({value:p[y],index:y});m.sort((y,v)=>v.value-y.value),c[d]=0;for(let y=0;y<n;y++)if(m[y].index===a[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==s&&s.dispose(),fi(c,s.shape,"bool")}const Ij=Ene;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(t,e,n,r,s,i="NHWC",o){let a=t;t.rank===3&&(a=q(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=q(e,[1,e.shape[0],e.shape[1],e.shape[2]])),O(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),O(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),O(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=i==="NHWC"?a.shape[3]:a.shape[1],c=i==="NHWC"?l.shape[3]:l.shape[1];O(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),O(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),$r("conv2dDerFilter",s,o);const d={x:a,dy:l},f={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,filterShape:n};return V.runKernel(Tb,d,f)}const A$=W({conv2DBackpropFilter_:Ane});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t1(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return G(t,Cc(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function n1(t,e){let n=e;const r=mn(t.shape,e.shape);return r.length>0&&(n=Ae(n,r)),q(n,t.shape)}function r1(t,e,n,r){if(e==="linear")return t;if(e==="relu")return io(t);if(e==="elu")return lf(t);if(e==="relu6")return Bw(t);if(e==="prelu")return ty(t,n);if(e==="leakyrelu")return qg(t,r);if(e==="sigmoid")return Xi(t);throw new Error(`Unknown fused activation ${e}.`)}const s1=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function One({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",s1(V.state.gradientDepth,l)===!1){O(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let T=ga(t,e,n,r,s,i,o);return a!=null&&(T=ge(T,a)),r1(T,l,u,c)}const d=R(t,"x","conv2d","float32"),f=R(e,"filter","conv2d","float32");let p=d,m=!1;d.rank===3&&(m=!0,p=q(d,[1,d.shape[0],d.shape[1],d.shape[2]])),O(p.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`),O(f.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${f.rank}.`),$r("fused conv2d",r,o);const y=s==="NHWC"?p.shape[3]:p.shape[1];O(f.shape[2]===y,()=>`Error in conv2d: depth of input (${y}) must match input depth for filter ${f.shape[2]}.`),O(Yn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const v=Ln(p.shape,f.shape,n,i,r,o);let x;a!=null&&(x=R(a,"bias","fused conv2d"),[x]=Kt(x,d),s==="NHWC"?Ke(v.outShape,x.shape):(O(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),O(x.shape.length===0||x.shape[0]===v.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let b;if(u!=null){const T=u.shape;if(O(T.length<=1||T.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${T.length}.`),T.length===1)O(T[0]===1||T[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the number of output channels (${v.outChannels}).`);else if(T.length===3)try{Ke(T,v.outShape)}catch{const A=`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(A)}b=R(u,"prelu weights","fused conv2d")}const _=(T,$)=>{O(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[A,D,F,M]=$,j=t1(T,F,l);O(wl(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const H=WI(D.shape,j,A,n,r),K=A$(D,j,A.shape,n,r),Q=[H,K];if(M!=null){const Z=n1(M,j);Q.push(Z)}return Q},S={x:p,filter:f,bias:x,preluActivationWeights:b},k={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return a==null?Do(($,A,D)=>{let F=V.runKernel(tm,S,k);return D([A,$,F]),m&&(F=q(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:_}})(p,f):Do(($,A,D,F)=>{let M=V.runKernel(tm,S,k);return F([A,$,M,D]),m&&(M=q(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:_}})(p,f,x)}const $j=W({fusedConv2d_:One});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pne(t,e,n,r,s,i=[1,1],o){let a=t;t.rank===3&&(a=q(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=q(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,filterShape:n};return V.runKernel(Pb,u,c)}const Ej=W({depthwiseConv2dNativeBackpropFilter_:Pne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dne(t,e,n,r,s,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=q(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,inputShape:t},d=V.runKernel(Db,u,c);return l?q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Aj=W({depthwiseConv2dNativeBackpropInput_:Dne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rne({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(s1(V.state.gradientDepth,l)===!1){let k=af(t,e,n,r,s,i,o);return a!=null&&(k=ge(k,a)),r1(k,l,u,c)}const d=R(t,"x","depthwiseConv2d","float32"),f=R(e,"filter","depthwiseConv2d","float32");let p=d,m=!1;d.rank===3&&(m=!0,p=q(d,[1,d.shape[0],d.shape[1],d.shape[2]])),O(p.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),O(f.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${f.rank}.`),O(p.shape[3]===f.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${f.shape[2]}.`),i==null&&(i=[1,1]),O(Yn(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),$r("fused depthwiseConv2d",r,o);const y=Ln(p.shape,f.shape,n,i,r,o,!0);let v;a!=null&&(v=R(a,"bias","fused conv2d"),[v]=Kt(v,d),Ke(y.outShape,v.shape));let x;u!=null&&(x=R(u,"prelu weights","fused depthwiseConv2d"));const b=(k,T)=>{O(wl(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[$,A,D,F]=T,M=t1(k,D,l),j=Aj(A.shape,M,$,n,r,i,o),H=Ej(A,M,$.shape,n,r,i,o);if(F!=null){const K=n1(v,M);return[j,H,K]}return[j,H]},_={x:p,filter:f,bias:v,preluActivationWeights:x},S={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return a==null?Do((T,$,A)=>{let D=V.runKernel(nm,_,S);return A([$,T,D]),m&&(D=q(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:b}})(p,f):Do((T,$,A,D)=>{let F=V.runKernel(nm,_,S);return D([$,T,F,A]),m&&(F=q(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:b}})(p,f,v)}const Lne=W({fusedDepthwiseConv2d_:Rne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fne({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(s1(V.state.gradientDepth,i)===!1){let M=Ye(t,e,n,r);return s!=null&&(M=ge(M,s)),r1(M,i,o,a)}let l=R(t,"a","fused matMul"),u=R(e,"b","fused matMul");[l,u]=Kt(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=n?l.shape[l.rank-1]:l.shape[l.rank-2],p=r?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),y=u.shape.slice(0,-2),v=oe(m),x=oe(y);O(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const _=Ke(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([f,p]),S=n?q(l,[v,c,f]):q(l,[v,f,c]),k=r?q(u,[x,p,d]):q(u,[x,d,p]);let T;s!=null&&(T=R(s,"bias","fused matMul"),[T]=Kt(T,l),Ke(_,T.shape));let $;o!=null&&($=R(o,"prelu weights","fused matMul"));const A=(M,j)=>{const[H,K,Q,Z]=j,se=t1(q(M,Q.shape),Q,i);let B,J;if(!n&&!r?(B=Ye(se,K,!1,!0),J=Ye(H,se,!0,!1)):!n&&r?(B=Ye(se,K,!1,!1),J=Ye(se,H,!0,!1)):n&&!r?(B=Ye(K,se,!1,!0),J=Ye(H,se,!1,!1)):(B=Ye(K,se,!0,!0),J=Ye(se,H,!0,!0)),s!=null){const Y=n1(Z,se);return[B,J,Y]}else return[B,J]},D={a:S,b:k,bias:T,preluActivationWeights:$},F={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:a};return s==null?Do((j,H,K)=>{const Q=V.runKernel(em,D,F);return K([j,H,Q]),{value:q(Q,_),gradFunc:A}})(S,k):Do((j,H,K,Q)=>{const Z=V.runKernel(em,D,F);return Q([j,H,Z,K]),{value:q(Z,_),gradFunc:A}})(S,k,T)}const DC=W({fusedMatMul_:Fne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oj=Object.freeze(Object.defineProperty({__proto__:null,conv2d:$j,depthwiseConv2d:Lne,matMul:DC},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mne(t){return e1(t,.54,.46)}const zne=W({hammingWindow_:Mne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bne(t){return e1(t,.5,.5)}const Pj=W({hannWindow_:Bne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(t,e,n,r=!1,s=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(it(t,i,e)),i+=n;if(r)for(;i<t.size;){const a=i+e-t.size,l=rn([it(t,i,e-a),_c([a],s)]);o.push(l),i+=n}return o.length===0?kd([],[0,e]):q(rn(o),[o.length,e])}const Dj=W({frame_:jne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t,e,n,r,s=Pj){r==null&&(r=E$(e));const i=Dj(t,e,n),o=G(i,s(e));return oy(o,r)}const Wne=W({stft_:Vne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une(t,e,n,r,s="bilinear",i=0){const o=R(t,"image","cropAndResize"),a=R(e,"boxes","cropAndResize","float32"),l=R(n,"boxInd","cropAndResize","int32"),u=a.shape[0];O(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),O(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),O(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),O(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),O(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),O(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:o,boxes:a,boxInd:l},d={method:s,extrapolationValue:i,cropSize:r};return V.runKernel(Eb,c,d)}const Gne=W({cropAndResize_:Une});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(t){const e=R(t,"image","flipLeftRight","float32");O(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return V.runKernel(jb,n,{})}const Kne=W({flipLeftRight_:Hne});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(t){const e=R(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];O(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),O(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,Ts(e,s)}const Xne=W({grayscaleToRGB_:qne});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zne(t){const e=R(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];O(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),O(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,i=Se(e,"float32"),o=ur([.2989,.587,.114]);let a;switch(e.rank){case 2:a=gu("ij,j->i",i,o);break;case 3:a=gu("ijk,k->ij",i,o);break;case 4:a=gu("ijkl,l->ijk",i,o);break;case 5:a=gu("ijklm,m->ijkl",i,o);break;case 6:a=gu("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=lr(a,-1),Se(a,s)}const Yne=W({rgbToGrayscale_:Zne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t,e,n=0,r=.5){const s=R(t,"image","rotateWithOffset","float32");O(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},o={radians:e,fillValue:n,center:r};return V.runKernel(Sw,i,o)}const Jne=W({rotateWithOffset_:Qne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hf(t,e,n,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),O(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),O(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),O(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),O(e.rank===1,()=>"scores must be a 1D tensor"),O(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),O(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=R(t,"boxes","nonMaxSuppression","float32"),o=R(e,"scores","nonMaxSuppression","float32"),a=hf(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return V.runKernel(Yb,{boxes:i,scores:o},l)}const tre=W({nonMaxSuppression_:ere});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nre(t,e,n){const r=rre(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function rre(t,e,n){return ire(t,e,n||sre)}function sre(t,e){return t>e?1:t<e?-1:0}function ire(t,e,n){let r=0,s=t.length,i=0,o=!1;for(;r<s;){i=r+(s-r>>>1);const a=n(e,t[i]);a>0?r=i+1:(s=i,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i1(t,e,n,r,s){return O$(t,e,n,r,s,0)}function o1(t,e,n,r,s,i){return O$(t,e,n,r,s,0,!1,i,!0)}function a1(t,e,n,r,s,i){return O$(t,e,n,r,s,i,!0)}function O$(t,e,n,r,s,i,o=!1,a=!1,l=!1){const u=[];for(let v=0;v<e.length;v++)e[v]>s&&u.push({score:e[v],boxIndex:v,suppressBeginIndex:0});u.sort(hD);const c=i>0?-.5/i:0,d=[],f=[];for(;d.length<n&&u.length>0;){const v=u.pop(),{score:x,boxIndex:b,suppressBeginIndex:_}=v;if(x<s)break;let S=!1;for(let k=d.length-1;k>=_;--k){const T=ore(t,b,d[k]);if(T>=r){S=!0;break}if(v.score=v.score*are(r,c,T),v.score<=s)break}v.suppressBeginIndex=d.length,S||(v.score===x?(d.push(b),f.push(v.score)):v.score>s&&nre(u,v,hD))}const p=d.length,m=n-p;a&&m>0&&(d.push(...new Array(m).fill(0)),f.push(...new Array(m).fill(0)));const y={selectedIndices:d};return o&&(y.selectedScores=f),l&&(y.validOutputs=p),y}function ore(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),f=Math.max(s[1],s[3]),p=(a-i)*(l-o),m=(d-u)*(f-c);if(p<=0||m<=0)return 0;const y=Math.max(i,u),v=Math.max(o,c),x=Math.min(a,d),b=Math.min(l,f),_=Math.max(x-y,0)*Math.max(b-v,0);return _/(p+m-_)}function are(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function hD(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function lre(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=R(t,"boxes","nonMaxSuppressionAsync"),o=R(e,"scores","nonMaxSuppressionAsync"),a=hf(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),u=l[0],c=l[1],{selectedIndices:d}=i1(u,c,n,r,s);return i!==t&&i.dispose(),o!==e&&o.dispose(),ur(d,"int32")}const ure=lre;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=R(t,"boxes","nonMaxSuppression"),a=R(e,"scores","nonMaxSuppression"),l=hf(o,a,n,r,s,i);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:o,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},d=V.runKernel(Jb,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const dre=W({nonMaxSuppressionWithScore_:cre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hre(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=R(t,"boxes","nonMaxSuppressionAsync"),a=R(e,"scores","nonMaxSuppressionAsync"),l=hf(o,a,n,r,s,i);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([o.data(),a.data()]),c=u[0],d=u[1],{selectedIndices:f,selectedScores:p}=a1(c,d,n,r,s,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:ur(f,"int32"),selectedScores:ur(p)}}const fre=hre;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pre(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=R(t,"boxes","nonMaxSuppression"),a=R(e,"scores","nonMaxSuppression"),l=hf(o,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,f={boxes:o,scores:a},p={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:i},m=V.runKernel(Qb,f,p);return{selectedIndices:m[0],validOutputs:m[1]}}const mre=W({nonMaxSuppressionPadded_:pre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function gre(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=R(t,"boxes","nonMaxSuppressionAsync"),a=R(e,"scores","nonMaxSuppressionAsync"),l=hf(o,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[f,p]=await Promise.all([o.data(),a.data()]),{selectedIndices:m,validOutputs:y}=o1(f,p,u,c,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:ur(m,"int32"),validOutputs:je(y,"int32")}}const yre=gre;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(t,e,n=!1,r=!1){const s=R(t,"images","resizeBilinear");O(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),O(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),O(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=q(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=V.runKernel($g,a,l);return o?q(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Rj=W({resizeBilinear_:vre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xre(t,e,n=!1,r=!1){const s=R(t,"images","resizeNearestNeighbor");O(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),O(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),O(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),O(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=q(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=V.runKernel(Ig,a,l);return o?q(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Lj=W({resizeNearestNeighbor_:xre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bre(t,e="binary",n=!1,r=.5){const s=R(t,"image","threshold"),i=.2989,o=.587,a=.114,l=s.shape[0]*s.shape[1];let u=G(ur([r]),255),c,d,f,p;if(O(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),O(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),O(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),O(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,d,f]=Fr(s,[1,1,1],-1);const v=G(c,i),x=G(d,o),b=G(f,a);p=ge(ge(v,x),b)}else p=t;if(e==="otsu"){const v=FI(Se(jw(p),"int32"),fi([]),256);u=wre(v,l)}const m=n?zl(p,u):Kr(p,u);return Se(G(m,255),"int32")}function wre(t,e){let n=ur([-1]),r=ur([0]),s=ur([0]),i,o,a,l,u,c;for(let d=0;d<t.size-1;d++){i=it(t,0,d+1),o=it(t,d+1),u=Le(Ae(i),e),c=Le(Ae(o),e);const f=Ae(G(i,nc(0,i.size)));a=Le(f,Ae(i));const p=_c(o.shape,i.size),m=ge(nc(0,o.size),p),y=G(o,m);l=Le(Ae(y),Ae(o));const v=Ie(a,l),x=Ie(a,l),b=G(u,c);s=G(G(b,v),x);const _=Kr(s,r);r=Kn(_,s,r),n=Kn(_,ur([d]),n)}return n}const _re=W({threshold_:bre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(t,e,n="nearest",r="constant",s=0,i){const o=R(t,"image","transform","float32"),a=R(e,"transforms","transform","float32");O(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),O(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),O(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},u={interpolation:n,fillMode:r,fillValue:s,outputShape:i};return V.runKernel(ww,l,u)}const kre=W({transform_:Sre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cre(t,e,n){const r=R(t,"a","bandPart");O(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,o]=r.shape.slice(-2);let a,l;typeof e=="number"?(O(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),O(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=R(e<0?i:e,"numLower","bandPart")):(O(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Kn(Bd(e,0),i,Sl(e,i))),typeof n=="number"?(O(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),O(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=R(n<0?o:n,"numUpper","bandPart")):(O(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Kn(Bd(n,0),o,Sl(n,o)));const u=q(nc(0,i,1,"int32"),[-1,1]),c=nc(0,o,1,"int32"),d=Ie(u,c),f=Qi(zl(d,a),$a(d,$t(l))),p=fn([i,o],r.dtype);return q(Vr(Ds(q(r,[-1,i,o])).map(m=>Kn(f,m,p))),s)}const Tre=W({bandPart_:Cre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nre(t){let e;if(Array.isArray(t)){e=!1,O(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let i=1;i<t.length;++i)O(t[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${s})`)}else e=!0,t=Fr(t,t.shape[0],0).map(s=>jl(s,[0]));O(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(V.tidy(()=>{let i=r[s];if(s>0)for(let o=0;o<s;++o){const a=G(Ae(G(n[o],i)),n[o]);i=Ie(i,a)}return Le(i,uf(i,"euclidean"))}));return e?Vr(n,0):n}const Ire=W({gramSchmidt_:Nre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(t,e=!1){if(O(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return fD(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=Ds(q(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],i=[];r.forEach(l=>{const[u,c]=fD(l,e);s.push(u),i.push(c)});const o=q(Vr(s,0),t.shape),a=q(Vr(i,0),t.shape);return[o,a]}}function fD(t,e=!1){return V.tidy(()=>{O(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=Pw(n),i=To(t);const o=kd([[1]],[1,1]);let a=To(o);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=i,d=a,f=s;[a,i,s]=V.tidy(()=>{const p=it(i,[u,u],[n-u,1]),m=uf(p),y=it(i,[u,u],[1,1]),v=Kn(Kr(y,0),kd([[-1]]),kd([[1]])),x=Ie(y,G(v,m)),b=Le(p,x);b.shape[0]===1?a=To(o):a=rn([o,it(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const _=$t(Le(Ye(v,x),m)),S=it(i,[u,0],[n-u,r]),k=G(_,a),T=st(a);if(u===0)i=Ie(S,Ye(k,Ye(T,S)));else{const D=Ie(S,Ye(k,Ye(T,S)));i=rn([it(i,[0,0],[u,r]),D],0)}const $=st(k),A=it(s,[0,u],[n,s.shape[1]-u]);if(u===0)s=Ie(A,Ye(Ye(A,a),$));else{const D=Ie(A,Ye(Ye(A,a),$));s=rn([it(s,[0,0],[n,u]),D],1)}return[a,i,s]}),Qe([c,d,f])}return!e&&n>r&&(s=it(s,[0,0],[n,r]),i=it(i,[0,0],[r,r])),[s,i]})}const Ere=W({qr_:$re});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Cr;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Cr||(Cr={}));function Are(t,e,n=Cr.SUM_BY_NONZERO_WEIGHTS){const r=R(t,"losses","computeWeightedLoss");let s=null;e!=null&&(s=R(e,"weights","computeWeightedLoss"));const i=s==null?r:G(r,s);if(n===Cr.NONE)return i;if(n===Cr.SUM)return Ae(i);if(n===Cr.MEAN){if(s==null)return Ut(i);{const o=r.size/s.size,a=Le(Ae(i),Ae(s));return o>1?Le(a,je(o)):a}}if(n===Cr.SUM_BY_NONZERO_WEIGHTS){if(s==null)return Le(Ae(i),je(r.size));{const o=G(s,Dr(r.shape)),a=Se(Ae(tc(o,je(0))),"float32");return Le(Ae(i),a)}}throw Error(`Unknown reduction: ${n}`)}const Aa=W({computeWeightedLoss_:Are});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(t,e,n,r=Cr.SUM_BY_NONZERO_WEIGHTS){const s=R(t,"labels","absoluteDifference"),i=R(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=R(n,"weights","absoluteDifference")),Zn(s.shape,i.shape,"Error in absoluteDifference: ");const a=dn(Ie(s,i));return Aa(a,o,r)}const Pre=W({absoluteDifference_:Ore});function Dre(t,e,n,r,s=Cr.SUM_BY_NONZERO_WEIGHTS){const i=R(t,"labels","cosineDistance"),o=R(e,"predictions","cosineDistance");let a=null;r!=null&&(a=R(r,"weights","cosineDistance")),Zn(i.shape,o.shape,"Error in cosineDistance: ");const l=je(1),u=Ie(l,Ae(G(i,o),n,!0));return Aa(u,a,s)}const Rre=W({cosineDistance_:Dre});function Lre(t,e,n,r=Cr.SUM_BY_NONZERO_WEIGHTS){let s=R(t,"labels","hingeLoss");const i=R(e,"predictions","hingeLoss");let o=null;n!=null&&(o=R(n,"weights","hingeLoss")),Zn(s.shape,i.shape,"Error in hingeLoss: ");const a=je(1);s=Ie(G(je(2),s),a);const l=io(Ie(a,G(s,i)));return Aa(l,o,r)}const Fre=W({hingeLoss_:Lre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mre(t,e,n,r=1,s=Cr.SUM_BY_NONZERO_WEIGHTS){const i=R(t,"labels","huberLoss"),o=R(e,"predictions","huberLoss");let a=null;n!=null&&(a=R(n,"weights","huberLoss")),Zn(i.shape,o.shape,"Error in huberLoss: ");const l=je(r),u=dn(Ie(o,i)),c=Sl(u,l),d=Ie(u,c),f=ge(G(je(.5),_t(c)),G(l,d));return Aa(f,a,s)}const zre=W({huberLoss_:Mre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bre(t,e,n,r=1e-7,s=Cr.SUM_BY_NONZERO_WEIGHTS){const i=R(t,"labels","logLoss"),o=R(e,"predictions","logLoss");let a=null;n!=null&&(a=R(n,"weights","logLoss")),Zn(i.shape,o.shape,"Error in logLoss: ");const l=je(1),u=je(r),c=$t(G(i,cs(ge(o,u)))),d=G(Ie(l,i),cs(ge(Ie(l,o),u))),f=Ie(c,d);return Aa(f,a,s)}const jre=W({logLoss_:Bre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(t,e,n,r=Cr.SUM_BY_NONZERO_WEIGHTS){const s=R(t,"labels","meanSquaredError"),i=R(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=R(n,"weights","meanSquaredError")),Zn(s.shape,i.shape,"Error in meanSquaredError: ");const a=Xw(s,i);return Aa(a,o,r)}const Wre=W({meanSquaredError_:Vre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ure(t,e){const n=R(t,"labels","sigmoidCrossEntropyWithLogits"),r=R(e,"logits","sigmoidCrossEntropyWithLogits");Zn(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=io(r),i=G(r,n),o=Xg(jr($t(dn(r))));return ge(Ie(s,i),o)}function Gre(t,e,n,r=0,s=Cr.SUM_BY_NONZERO_WEIGHTS){let i=R(t,"multiClassLabels","sigmoidCrossEntropy");const o=R(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=R(n,"weights","sigmoidCrossEntropy")),Zn(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=je(r),c=je(1),d=je(.5);i=ge(G(i,Ie(c,u)),G(d,u))}const l=Ure(i,o);return Aa(l,a,s)}const Hre=W({sigmoidCrossEntropy_:Gre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Do((s,i,o)=>{const l=Zg(i,[n],!0),u=Ie(Se(i,"float32"),l);o([s,u]);const c=$t(G(u,s));return{value:Ae(c,[n]),gradFunc:(p,m)=>{const[y,v]=m,x=sn(p.shape,[n]);return[G(q(p,x),Ie(Se(y,"float32"),jr(v))),G(q(p,x),Ie(jr(v),Se(y,"float32")))]}}})(t,e)}function qre(t,e,n,r=0,s=Cr.SUM_BY_NONZERO_WEIGHTS){let i=R(t,"onehotLabels","softmaxCrossEntropy");const o=R(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=R(n,"weights","softmaxCrossEntropy")),Zn(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const u=je(r),c=je(1),d=je(i.shape[1]);i=ge(G(i,Ie(c,u)),Le(u,d))}const l=Kre(i,o);return Aa(l,a,s)}const Xre=W({softmaxCrossEntropy_:qre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zre(t,e,n,r){const s=R(t,"indices","sparseFillEmptyRows","int32"),i=R(e,"values","sparseFillEmptyRows"),o=R(n,"denseShape","sparseFillEmptyRows","int32"),a=R(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:s,values:i,denseShape:o,defaultValue:a},u=V.runKernel(cw,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const Yre=W({sparseFillEmptyRows_:Zre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(t,e,n){const r=R(t,"inputIndices","sparseReshape","int32"),s=R(e,"inputShape","sparseReshape","int32"),i=R(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:r,inputShape:s,newShape:i},a=V.runKernel(dw,o);return{outputIndices:a[0],outputShape:a[1]}}const Jre=W({sparseReshape_:Qre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t,e,n){const r=R(t,"data","sparseSegmentMean"),s=R(e,"indices","sparseSegmentMean","int32"),i=R(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:r,indices:s,segmentIds:i};return V.runKernel(hw,o)}const tse=W({sparseSegmentMean_:ese});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nse(t,e,n){const r=R(t,"data","sparseSegmentSum"),s=R(e,"indices","sparseSegmentSum","int32"),i=R(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:r,indices:s,segmentIds:i};return V.runKernel(fw,o)}const rse=W({sparseSegmentSum_:nse});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sse(t,e,n,r,s,i,o,a){const l=R(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=R(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:s,rightPad:i,padWidth:o,preserveShortSequences:a},d={data:l,dataSplits:u},f=V.runKernel(yw,d,c);return{nGrams:f[0],nGramsSplits:f[1]}}const ise=W({stringNGrams_:sse});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t,e,n=!0){const r=R(t,"input","stringSplit","string"),s=R(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const i={skipEmpty:n},o={input:r,delimiter:s},a=V.runKernel(vw,o,i);return{indices:a[0],values:a[1],shape:a[2]}}const ase=W({stringSplit_:ose});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(t,e){const n=R(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return V.runKernel(xw,s,r)}const use=W({stringToHashBucketFast_:lse});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cse(t,e,n,r=!0){const s=R(t,"input","staticRegexReplace","string"),i={pattern:e,rewrite:n,replaceGlobal:r};return V.runKernel(Fg,{x:s},i)}const dse=W({staticRegexReplace_:cse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fj={fft:iy,ifft:Ud,rfft:oy,irfft:qw},Mj={hammingWindow:zne,hannWindow:Pj,frame:Dj,stft:Wne},Gi={flipLeftRight:Kne,grayscaleToRGB:Xne,resizeNearestNeighbor:Lj,resizeBilinear:Rj,rgbToGrayscale:Yne,rotateWithOffset:Jne,cropAndResize:Gne,nonMaxSuppression:tre,nonMaxSuppressionAsync:ure,nonMaxSuppressionWithScore:dre,nonMaxSuppressionWithScoreAsync:fre,nonMaxSuppressionPadded:mre,nonMaxSuppressionPaddedAsync:yre,threshold:_re,transform:kre},P$={bandPart:Tre,gramSchmidt:Ire,qr:Ere},zj={absoluteDifference:Pre,computeWeightedLoss:Aa,cosineDistance:Rre,hingeLoss:Fre,huberLoss:zre,logLoss:jre,meanSquaredError:Wre,sigmoidCrossEntropy:Hre,softmaxCrossEntropy:Xre},Bj={sparseFillEmptyRows:Yre,sparseReshape:Jre,sparseSegmentMean:tse,sparseSegmentSum:rse},jj={stringNGrams:ise,stringSplit:ase,stringToHashBucketFast:use,staticRegexReplace:dse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hse=new Map,RC=new Map;class Tc{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Ss{constructor(){this.classNameMap={}}static getMap(){return Ss.instance==null&&(Ss.instance=new Ss),Ss.instance}static register(e){Ss.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ye(t,e,n){O(t.className!=null,()=>"Class being registered does not have the static className property defined."),O(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),O(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return Ss.register(t),hse.set(s,t),RC.set(t,s),t}function fse(t){return RC.has(t)?RC.get(t):t.className}const pse=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Tc,SerializationMap:Ss,getRegisteredName:fse,registerClass:ye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oa extends Tc{minimize(e,n=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Qe(i),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return HB(e,n)}dispose(){this.iterations_!=null&&Qe(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:je(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Oa,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D$ extends Oa{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=V.registeredVariables[r],o=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:ee(()=>ot(i).variable(o))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:ee(()=>ot(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;ee(()=>{const c=ge(G(l,this.rho),G(_t(a),1-this.rho)),d=G(Le(Rn(ge(u,this.epsilon)),Rn(ge(l,this.epsilon))),a),f=ge(G(u,this.rho),G(_t(d),1-this.rho));l.assign(c),u.assign(f);const p=ge(G(d,-this.learningRate),i);i.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Qe(this.accumulatedGrads.map(e=>e.variable)),Qe(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R$ extends Oa{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=V.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:ee(()=>_c(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const a=this.accumulatedGrads[s].variable;ee(()=>{const l=ge(a,_t(o));a.assign(l);const u=ge(G(Le(o,Rn(ge(l,V.backend.epsilon()))),-this.learningRate),i);i.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Qe(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L$ extends Oa{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ee(()=>{this.accBeta1=je(n).variable(),this.accBeta2=je(r).variable()}),s==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ee(()=>{const r=Ie(1,this.accBeta1),s=Ie(1,this.accBeta2);n.forEach((i,o)=>{const a=V.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:ee(()=>ot(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:ee(()=>ot(a).variable(l))});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,f=ge(G(c,this.beta1),G(u,1-this.beta1)),p=ge(G(d,this.beta2),G(_t(u),1-this.beta2)),m=Le(f,r),y=Le(p,s);c.assign(f),d.assign(p);const v=ge(G(Le(m,ge(Rn(y),this.epsilon)),-this.learningRate),a);a.assign(v)}),this.accBeta1.assign(G(this.accBeta1,this.beta1)),this.accBeta2.assign(G(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Qe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Qe(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),ee(()=>{this.accBeta1.assign(Po(this.beta1,this.iterations_+1)),this.accBeta2.assign(Po(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F$ extends Oa{static get className(){return"Adamax"}constructor(e,n,r,s=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ee(()=>{this.iteration=je(0).variable(),this.accBeta1=je(n).variable()}),s==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ee(()=>{const r=Ie(1,this.accBeta1),s=Le(-this.learningRate,ge(G(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=V.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:ot(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:ot(a).variable(l)});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,f=ge(G(c,this.beta1),G(u,1-this.beta1)),p=G(d,this.beta2),m=dn(u),y=Mo(p,m);c.assign(f),d.assign(y);const v=ge(G(Le(s,r),Le(f,ge(y,this.epsilon))),a);a.assign(v)}),this.iteration.assign(ge(this.iteration,1)),this.accBeta1.assign(G(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Qe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Qe(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l1 extends Oa{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const o=V.registeredVariables[r];ee(()=>{const a=ge(G(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=bn(je(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M$ extends l1{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=je(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=V.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:ee(()=>ot(i).variable(!1))});const o=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&ee(()=>{let l;const u=ge(G(this.m,o),a);this.useNesterov?l=ge(G(this.c,ge(a,G(u,this.m))),i):l=ge(G(this.c,u),i),o.assign(u),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Qe(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z$ extends Oa{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=V.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=V.registeredVariables[r],o=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:ee(()=>ot(i).variable(o))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:ee(()=>ot(i).variable(o))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:ee(()=>ot(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;ee(()=>{const c=ge(G(l,this.decay),G(_t(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,f=ge(G(d,this.decay),G(a,1-this.decay)),p=Le(G(a,this.learningRate),Rn(Ie(c,ge(_t(f),this.epsilon)))),m=ge(G(u,this.momentum),p);l.assign(c),d.assign(f),u.assign(m);const y=Ie(i,m);i.assign(y)}else{const d=ge(G(l,this.decay),G(_t(a),1-this.decay)),f=ge(G(u,this.momentum),Le(G(a,this.learningRate),Rn(ge(d,this.epsilon))));l.assign(d),u.assign(f);const p=Ie(i,f);i.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Qe(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Qe(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Qe(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mse=[D$,R$,L$,F$,M$,z$,l1];function gse(){for(const t of mse)ye(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yse="model",vse=".json",xse=".weights.bin";function pD(t){return new Promise(e=>setTimeout(e)).then(t)}class rc{constructor(e){if(!te().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(rc.URL_SCHEME)&&(e=e.slice(rc.URL_SCHEME.length)),(e==null||e.length===0)&&(e=yse),this.modelJsonFileName=e+vse,this.weightDataFileName=e+xse}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=so.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=NB(e,s),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await pD(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await pD(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Vg(e)}}}}rc.URL_SCHEME="downloads://";class bse{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=s=>{const i=JSON.parse(s.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const l=_I(i,u=>this.loadWeights(u));e(l)},r.onerror=s=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const o of e)n.push(...o.weights),r.push(...o.paths);const s=this.checkManifestAndWeightFiles(e),i=r.map(o=>this.loadWeightsFile(o,s[o]));return Promise.all(i).then(o=>[n,o])}loadWeightsFile(e,n){return new Promise((r,s)=>{const i=new FileReader;i.onload=o=>{const a=o.target.result;r(a)},i.onerror=o=>s(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(i=>dD(i.name)),s={};for(const i of e)i.paths.forEach(o=>{const a=dD(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);s[o]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const wse=t=>te().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(rc.URL_SCHEME)?_se(t.slice(rc.URL_SCHEME.length)):null;Vt.registerSaveRouter(wse);function _se(t="model"){return new rc(t)}function Sse(t){return new bse(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mD(t,e,n,r){o(t),n=n??0,r=r??1,a(n,r);let s=0;const i=l=>(l.then(u=>{const c=n+ ++s/t.length*(r-n);return e(c),u}),l);function o(l){O(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){O(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),O(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),O(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Vj(t,e){e==null&&(e={});const n=e.fetchFunc==null?te().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(r):await mD(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await mD(a,e.onProgress,.5,1)}function kse(t,e){var n;const r=e.fetchFunc==null?te().platform.fetch:e.fetchFunc;let s=0,i;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var a;s<t.length;){i||(i=(await r(t[s],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await i.read();if(l){s++,i=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,s/t.length);continue}o.enqueue(u);return}o.close()}})}async function Cse(t,e="",n,r){return Wj(o=>Vj(o,{requestInit:r}))(t,e,n)}function Wj(t){return async(e,n="",r)=>{const s=e.map(()=>!1),i={},o=r!=null?r.map(()=>!1):[],a=[];if(e.forEach((p,m)=>{let y=0;p.weights.forEach(v=>{const x="quantization"in v?v.quantization.dtype:v.dtype,b=Xu[x]*oe(v.shape),_=()=>{s[m]=!0,i[m]==null&&(i[m]=[]),i[m].push({manifestEntry:v,groupOffset:y,sizeBytes:b})};r!=null?r.forEach((S,k)=>{S===v.name&&(_(),o[k]=!0)}):_(),a.push(v.name),y+=b})}),!o.every(p=>p)){const p=r.filter((m,y)=>!o[y]);throw new Error(`Could not find weights in manifest with names: ${p.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=s.reduce((p,m,y)=>(m&&p.push(y),p),[]),u=[];l.forEach(p=>{e[p].paths.forEach(m=>{const y=n+(n.endsWith("/")?"":"/")+m;u.push(y)})});const c=await t(u),d={};let f=0;return l.forEach(p=>{const m=e[p].paths.length,y=new so(c.slice(f,f+m));i[p].forEach(x=>{const b=y.slice(x.groupOffset,x.groupOffset+x.sizeBytes),_=SB(b,[x.manifestEntry]);for(const S in _)d[S]=_[S]}),f+=m}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tse="application/octet-stream",Nse="application/json";class B${constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(O(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=te().platform.fetch,O(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&O(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=NB(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(s)],{type:Nse}),"model.json"),e.weightData!=null){const o=so.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:Tse}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:Vg(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return _I(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=G0(e.weightsManifest),s=()=>kse(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:s})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=Ise(n),i=this.weightPathPrefix||r,o=[],a=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(u)):o.push(i+u+s);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const n=await this.getWeightUrls(e),r=G0(e),s=await Vj(n,this.loadOptions);return[r,s]}}B$.URL_SCHEME_REGEX=/^https?:\/\//;function Ise(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function LC(t){return t.match(B$.URL_SCHEME_REGEX)!=null}const Uj=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>LC(r)):n=LC(t),n)return j$(t,e)}return null};Vt.registerSaveRouter(Uj);Vt.registerLoadRouter(Uj);function j$(t,e){return new B$(t,e)}function $se(t,e){return j$(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RS{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class Gj{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Ese{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Ase(t,e,n,r){const s=arguments;return new Ese(K0(...s))}function K0(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new RS(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new RS({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new RS({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function Ose(t){return new Gj(t)}function Pse(t){return new Gj(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V$=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:so,browserFiles:Sse,browserHTTPRequest:$se,concatenateArrayBuffers:TB,copyModel:dQ,decodeWeights:SB,decodeWeightsStream:CB,encodeWeights:IC,fromMemory:Ase,fromMemorySync:K0,getLoadHandlers:YY,getModelArtifactsForJSON:_I,getModelArtifactsForJSONSync:wI,getModelArtifactsInfoForJSON:Vg,getSaveHandlers:IB,getWeightSpecs:G0,http:j$,isHTTPScheme:LC,listModels:uQ,loadWeights:Cse,moveModel:hQ,registerLoadRouter:ZY,registerSaveRouter:XY,removeModel:cQ,weightsLoaderFactory:Wj,withSaveHandler:Ose,withSaveHandlerSync:Pse},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dse(t,e,n){const r=R(t,"labels","confusionMatrix"),s=R(e,"predictions","confusionMatrix");O(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),O(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),O(s.rank===1,()=>`Expected the rank of predictions to be 1, but got ${s.rank}`),O(r.shape[0]===s.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${s.shape[0]}. Labels and predictions should have the same number of elements.`),O(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const i=jd(Se(r,"int32"),n),o=jd(Se(s,"int32"),n),a=st(i),l=Ye(a,o);return Se(l,"int32")}const Rse=W({confusionMatrix_:Dse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lse=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:Rse},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let su,gD=!1;function Hj(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,i=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(sm(V0,V.backendName)!=null){const m={pixels:t},y={numChannels:e};return V.runKernel(V0,m,y)}const[u,c]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(o)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)d=t.data;else if(i||s||a){if(su==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")su=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else su=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});su.canvas.width=u,su.canvas.height=c,su.drawImage(t,0,0,u,c),d=su.getImageData(0,0,u,c).data}let f;if(e===4)f=new Int32Array(d);else{const m=u*c;f=new Int32Array(m*e);for(let y=0;y<m;y++)for(let v=0;v<e;++v)f[y*e+v]=d[y*4+v]}return S$(f,[c,u,e],"int32")}function Fse(t){return t!=null&&t.data instanceof Uint8Array}function Mse(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function zse(t){return t!=null&&t.width!==0&&t.height!==0}function Bse(t){return Mse()&&!(t instanceof ImageBitmap)&&zse(t)&&!Fse(t)}async function jse(t,e=3){let n=null;if(te().getBool("WRAP_TO_IMAGEBITMAP")&&Bse(t)){let r;try{r=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===t.width&&r.height===t.height?n=r:n=t}else n=t;return Hj(n,e)}function Kj(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function Vse(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function Wse(t,e){let n=R(t,"img","toPixels");if(!(t instanceof gt)){const u=n;n=Se(u,"int32"),u.dispose()}Kj(n);const[r,s]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2],o=await n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(s*r*4);for(let u=0;u<r*s;++u){const c=[0,0,0,255];for(let f=0;f<i;f++){const p=o[u*i+f];if(n.dtype==="float32"){if(p<0||p>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${p}.`)}else if(n.dtype==="int32"&&(p<0||p>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${p}.`);i===1?(c[0]=p*a,c[1]=p*a,c[2]=p*a):c[f]=p*a}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){gD||sm(Lb,V.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),gD=!0),e.width=s,e.height=r;const u=e.getContext("2d"),c=new ImageData(l,s,r);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}function Use(t,e,n){let r=R(t,"img","draw");if(!(t instanceof gt)){const o=r;r=Se(o,"int32"),o.dispose()}Kj(r),Vse(n==null?void 0:n.imageOptions);const s={image:r},i={canvas:e,options:n};V.runKernel(Lb,s,i)}const Gse=W({fromPixels_:Hj}),Hse=Object.freeze(Object.defineProperty({__proto__:null,draw:Use,fromPixels:Gse,fromPixelsAsync:jse,toPixels:Wse},Symbol.toStringTag,{value:"Module"}));function u1(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(oe(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,i=s[s.length-1];let o=1;for(let d=0;d<s.length-1;++d)o*=s[d];const a=t.shape,l=s.slice();l.pop();let u=1;for(let d=i;d<n;++d)u*=a[d],l.push(a[d]);const c=[...ze(t.shape).map(d=>d/u),1].slice(0,i);return[l,o,u,c]}const Kse=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:u1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FC=-2,qse=-1;function W$(t,e,n){const r=t.shape.length;O(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),O(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)O(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function Xse(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function U$(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function qj(t,e,n,r){const s=[...t];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<n;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function Xj(t,e,n){return n<=t?n:n-(e-1)}function Zj(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function Zse(t,e,n,r,s,i,o,a,l){const u=t.length;let c=new Array(u),d=new Array(u),f=new Array(u);if(e.length&&n>0){const p=e[0],m=n+1;c=Yj(o,p,m,r,t),d=Qj(a,p,m,s,t),f=qj(i,p,m,t)}else for(let p=0;p<u;p++)c[p]=e4(o,r,i,t,p,l),d[p]=t4(a,s,i,t,p,l),f[p]=Jj(i,p,l);return{begin:c,end:d,strides:f}}function Yj(t,e,n,r,s){const i=[...s],o=Zj(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=Xj(e,n,a);let u=r[l];t&1<<l&&(u=0),i[a]=u}return i}function Qj(t,e,n,r,s){const i=[...s],o=Zj(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=Xj(e,n,a);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),i[a]=u}for(let a=0;a<i.length;a++){const l=s[a];i[a]<0&&(i[a]+=l),i[a]=yl(0,i[a],s[a])}return i}function Jj(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function e4(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),o=yl(0,o,l-1),o}function t4(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),a>0?o=yl(0,o,l):o=yl(-1,o,l-1),o}function G$(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function H$(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function c1(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(o=>{O(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(s).fill(-1):typeof n=="number"?i=[n,...new Array(s-1).fill(-1)]:n.length<s?i=n.concat(new Array(s-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(O(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,i]}function K$(t,e,n,r,s,i,o,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let _=0;_<d.dims;_++)c&&1<<_&a&&d.numAddAxisAfterEllipsis++,1<<_&o&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const f={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Yse(d,f);let p=!0,m=!0,y=!0;const v=[],x=[];for(let _=0;_<t.length;++_){if(f.strides[_]===0)throw Error(`strides[${_}] must be non-zero`);const S=!!(f.shrinkAxisMask&1<<_),k=t[_];if(k===-1){v.push(S?1:-1);continue}const T=[f.beginMask&1<<_,f.endMask&1<<_],$=[f.strides[_]>0?0:-1,f.strides[_]>0?k:k-1];if(S&&f.strides[_]<=0)throw Error("only stride 1 allowed on non-range indexing.");y=y&&f.strides[_]===1;const A=!!(f.beginMask&1<<_&&f.endMask&1<<_);if(f.beginValid&&f.endValid){if(S){const j=f.begin[_]<0?k+f.begin[_]:f.begin[_];if(f.begin[_]=j,f.end[_]=f.begin[_]+1,j<0||j>=k)throw Error(`slice index ${f.begin[_]} of dimension ${_} out of bounds.`)}else f.begin[_]=yD(f.begin[_],0,f.strides[_],k,T,$),f.end[_]=yD(f.end[_],1,f.strides[_],k,T,$);const M=f.strides[_]===1&&f.begin[_]===0&&f.end[_]===k;p=p&&M,m=m&&(_===0&&f.strides[_]===1||M)}else p=p&&f.strides[_]===1&&A,m=m&&(_===0&&f.strides[_]===1||A);let D,F=!1;if(f.beginValid&&f.endValid?(D=f.end[_]-f.begin[_],F=!0):S?(D=1,F=!0):A&&k>=0&&(f.strides[_]<0?D=-k:D=k,F=!0),F){let M;D===0||D<0!=f.strides[_]<0?M=0:M=Math.trunc(D/f.strides[_])+(D%f.strides[_]!==0?1:0),v.push(M)}else v.push(-1)}for(let _=0;_<f.finalShapeGatherIndices.length;++_){const S=f.finalShapeGatherIndices[_];S>=0?x.push(v[S]):S===FC&&x.push(1)}return{finalShapeSparse:x.filter((_,S)=>f.finalShapeGatherIndices[S]!==FC),finalShape:x,isIdentity:p,sliceDim0:m,isSimpleSlice:y,begin:f.begin,end:f.end,strides:f.strides}}function Yse(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(FC),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(qse),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function yD(t,e,n,r,s,i){if(s[e])return n>0?i[e]:i[e+1&1];{const o=t<0?r+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const n4=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:W$,computeFlatOffset:H$,computeOutShape:U$,getNormalizedAxes:Zse,isSliceContinous:G$,maskToAxes:Xse,parseSliceParams:c1,sliceInfo:K$,startForAxis:e4,startIndicesWithElidedDims:Yj,stopForAxis:t4,stopIndicesWithElidedDims:Qj,stridesForAxis:Jj,stridesWithElidedDims:qj},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const Qse="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r4{static sgd(e){return new l1(e)}static momentum(e,n,r=!1){return new M$(e,n,r)}static rmsprop(e,n=.9,r=0,s=null,i=!1){return new z$(e,n,r,s,i)}static adam(e=.001,n=.9,r=.999,s=null){return new L$(e,n,r,s)}static adadelta(e=.001,n=.95,r=null){return new D$(e,n,r)}static adamax(e=.002,n=.9,r=.999,s=null,i=0){return new F$(e,n,r,s,i)}static adagrad(e,n=.1){return new R$(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cu=r4;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jse=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function q$(){return new Promise(t=>Jse(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X$(t,e){const n=t[0].length;t.forEach((s,i)=>{O(s.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),O(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,i)=>{for(let o=0;o<n;o++)O(o===e||s[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function No(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Bi;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Bi||(Bi={}));function s4(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const i=n[s],o=r[r.length-n.length+s],a=r[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${i} but shape[${s+t}] = ${a}`)}else r[o]=i}return r}function i4(t){const e={FIRST_DIM_SIZE:Bi.FIRST_DIM_SIZE,VALUE_ROWIDS:Bi.VALUE_ROWIDS,ROW_LENGTHS:Bi.ROW_LENGTHS,ROW_SPLITS:Bi.ROW_SPLITS,ROW_LIMITS:Bi.ROW_LIMITS,ROW_STARTS:Bi.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function o4(t){return t.length===0?0:t[0]===Bi.FIRST_DIM_SIZE?t.length-1:t.length}function a4(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const i=t[s],o=e[s+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${i} but ragged tensor input.flatValues.shape[${s-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z$=30;function d1(t){return t<=Z$?t:z0(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ay(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)s=s.concat([t[o+1]/e[o],e[o]]);s=s.concat(t.slice(i+1))}return s}function ly(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):s.push(o);r.push(...s),r.push(0),r.push(...i)}return r}function uy(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?s.push(e[i-1]*t[i]):s.push(t[i]/e[i-1]):s.push(t[i]);return s}function Q$(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function J$(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h1=1.7580993408473768,f1=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e2=.3275911,t2=.254829592,n2=-.284496736,r2=1.421413741,s2=-1.453152027,i2=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ya(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function l4(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function u4(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function c4(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function o2(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function d4(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function h4(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const i=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:n,imag:r}}function f4(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LS="->",eie=/->/g,vD=",",xD="...";function a2(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(eie,"").length)/LS.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${LS}").`);const[r,s]=t.split(LS);O(r.indexOf(xD)===-1,()=>`The ellipsis notation ("${xD}") is not supported yet.`);const i=r.split(vD),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let f=0;f<s.length;++f){const p=s[f];if(!i.some(m=>m.indexOf(p)!==-1))throw new Error(`Output subscripts contain the label ${p} not present in the input subscripts.`);a.indexOf(p)===-1&&a.push(p)}for(let f=0;f<r.length;++f){const p=r[f];a.indexOf(p)===-1&&p!==vD&&a.push(p)}const l=new Array(i.length);for(let f=0;f<o;++f){if(new Set(i[f].split("")).size!==i[f].length)throw new Error(`Found duplicate axes in input component ${i[f]}. Support for duplicate axes in input is not implemented yet.`);l[f]=[];for(let p=0;p<i[f].length;++p)l[f].push(a.indexOf(i[f][p]))}const u=a.length,c=s.length,d=[];for(let f=c;f<u;++f)d.push(f);return{allDims:a,summedDims:d,idDims:l}}function l2(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function u2(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const i=n[s].shape;for(let o=0;o<e[s].length;++o)r[e[s][o]]===void 0?r[e[s][o]]=i[o]:O(r[e[s][o]]===i[o],()=>`Expected dimension ${r[e[s][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function c2(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let o=0;o<s;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=tie(e,a);for(const u of l)i.indexOf(u)===-1&&(r[o].push(u),i.push(u))}return{path:n,steps:r}}function d2(t){return t.every((e,n)=>e===n)}function tie(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function h2(t,e,n=0){let r=[];if(typeof e=="number")O(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);O(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}O(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p4(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function m4(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function g4(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function v4(t,e){return`size ${t} must be non-negative, not ${e}`}function x4(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function b4(t,e){const n=oe(t),r=oe(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function w4(t,e){const n=oe(t),r=oe(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MC(){return"segment ids must be >= 0"}function _4(){return"segment ids are not increasing"}function S4(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function k4(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4(t,e){let n=!1,r;for(t<=Z$?(r=t,n=!0):r=z0(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=z0(t,r+1);return r}function T4(t,e,n){const r=[],s=t.length;for(let i=0;i<s;i++)i!==e?r.push(t[i]):r.push(n);return r}function f2(t,e,n,r){const s=e.shape.length,i=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<s;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:o,outputShape:a}}const nie=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:f2,computeOutShape:T4,segOpComputeOptimalWindowSize:C4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function va(t){try{return t.map(e=>pa(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function N4(t){return t.map(e=>Co(e))}const I4=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:t2,ERF_A2:n2,ERF_A3:r2,ERF_A4:s2,ERF_A5:i2,ERF_P:e2,PARALLELIZE_THRESHOLD:Z$,get RowPartitionType(){return Bi},SELU_SCALE:f1,SELU_SCALEALPHA:h1,applyActivation:r1,assertAndGetBroadcastShape:Ke,assertAxesAreInnerMostDims:Qn,assertParamsConsistent:X$,assignToTypedArray:d4,axesAreInnerMostDims:ZI,calculateShapes:Vl,checkEinsumDimSizes:u2,checkPadOnDimRoundingMode:$r,combineLocations:WB,combineRaggedTensorToTensorShapes:s4,complexWithEvenIndex:u4,complexWithOddIndex:c4,computeConv2DInfo:Ln,computeConv3DInfo:Fl,computeDefaultPad:OI,computeDilation2DInfo:Wg,computeOptimalWindowSize:d1,computeOutAndReduceShapes:Fn,computeOutShape:No,computePool2DInfo:_i,computePool3DInfo:Na,convertConv2DDataFormat:Ia,decodeEinsumEquation:a2,eitherStridesOrDilationsAreOne:Yn,expandShapeToKeepDim:sn,exponent:f4,exponents:h4,fromStringArrayToUint8:N4,fromUint8ToStringArray:va,getAxesPermutation:qt,getBroadcastDims:ec,getComplexWithIndex:o2,getEinsumComputePath:c2,getEinsumPermutation:l2,getFusedBiasGradient:n1,getFusedDyActivation:t1,getImageCenter:Y$,getInnerMostAxes:on,getPermuted:ly,getRaggedRank:o4,getReductionAxes:mn,getReshaped:ay,getReshapedPermuted:uy,getRowPartitionTypesHelper:i4,getSliceBeginCoords:Q$,getSliceSize:J$,getSparseFillEmptyRowsIndicesDenseShapeMismatch:p4,getSparseFillEmptyRowsNegativeIndexErrorMessage:m4,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:g4,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:x4,getSparseReshapeInputOutputMismatchErrorMessage:w4,getSparseReshapeInputOutputMultipleErrorMessage:b4,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:y4,getSparseReshapeNegativeOutputDimErrorMessage:v4,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:k4,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:MC,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:_4,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:S4,getUndoAxesPermutation:Ml,isIdentityPermutation:d2,log:q9,mergeRealAndImagArrays:ya,prepareAndValidate:u1,prepareSplitSize:h2,segment_util:nie,shouldFuse:s1,slice_util:n4,splitRealAndImagArrays:l4,stridesOrDilationsArePositive:Ju,tupleValuesAreOne:wl,upcastType:Mr,validateDefaultValueShape:a4,validateInput:Zw,validateUpdateShape:k$,warn:_s},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rie=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:i1,nonMaxSuppressionV4Impl:o1,nonMaxSuppressionV5Impl:a1,whereImpl:Jw},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gse();const sie=Object.freeze(Object.defineProperty({__proto__:null,Abs:Mm,Acos:ch,Acosh:dh,AdadeltaOptimizer:D$,AdagradOptimizer:R$,AdamOptimizer:L$,AdamaxOptimizer:F$,Add:bc,AddN:zm,All:xb,Any:bb,ArgMax:Bm,ArgMin:jm,Asin:hh,Asinh:fh,Atan:ph,Atan2:gh,Atanh:mh,AvgPool:Vm,AvgPool3D:Wm,AvgPool3DGrad:_b,AvgPoolGrad:wb,BatchMatMul:Um,BatchToSpaceND:Gm,Bincount:Sb,BitwiseAnd:Hm,BroadcastArgs:kb,BroadcastTo:nB,Cast:yh,Ceil:vh,ClipByValue:xh,Complex:Cb,ComplexAbs:Km,Concat:qm,Conv2D:Xm,Conv2DBackpropFilter:Tb,Conv2DBackpropInput:Zm,Conv3D:Ym,Conv3DBackpropFilterV2:Nb,Conv3DBackpropInputV2:Ib,Cos:bh,Cosh:wh,CropAndResize:Eb,Cumprod:$b,Cumsum:Qm,DataStorage:iI,DenseBincount:Ab,DepthToSpace:Ob,DepthwiseConv2dNative:Jm,DepthwiseConv2dNativeBackpropFilter:Pb,DepthwiseConv2dNativeBackpropInput:Db,Diag:Rb,Dilation2D:eg,Dilation2DBackpropFilter:j0,Dilation2DBackpropInput:B0,Draw:Lb,get ENV(){return cI},Einsum:Fb,Elu:Sh,EluGrad:Mb,Environment:eB,Equal:tg,Erf:kh,Exp:Ch,ExpandDims:ng,Expm1:Th,FFT:zb,Fill:Bb,FlipLeftRight:jb,Floor:Nh,FloorDiv:Ih,FromPixels:V0,FusedBatchNorm:rg,FusedConv2D:tm,FusedDepthwiseConv2D:nm,GatherNd:Vb,GatherV2:sg,Greater:ig,GreaterEqual:$h,IFFT:Wb,Identity:Eh,Imag:Ub,IsFinite:Ah,IsInf:Oh,IsNan:Ph,KernelBackend:gb,LRN:hg,LRNGrad:Hb,LeakyRelu:og,Less:ag,LessEqual:lg,LinSpace:Gb,Log:Dh,Log1p:Rh,LogSoftmax:rB,LogicalAnd:ug,LogicalNot:cg,LogicalOr:dg,LogicalXor:W9,LowerBound:U9,MatrixBandPart:G9,Max:fg,MaxPool:pg,MaxPool3D:mg,MaxPool3DGrad:qb,MaxPoolGrad:Kb,MaxPoolWithArgmax:Xb,Maximum:Lh,Mean:gg,Min:yg,Minimum:Fh,MirrorPad:vg,Mod:Mh,MomentumOptimizer:M$,Multinomial:Zb,Multiply:zh,Neg:xg,NonMaxSuppressionV3:Yb,NonMaxSuppressionV4:Qb,NonMaxSuppressionV5:Jb,NotEqual:bg,OP_SCOPE_SUFFIX:yI,OneHot:_g,OnesLike:wg,Optimizer:Oa,OptimizerConstructors:r4,Pack:Sg,PadV2:kg,Pool:H9,Pow:Bh,Prelu:Cg,Prod:Tg,RMSPropOptimizer:z$,RaggedGather:ew,RaggedRange:tw,RaggedTensorToTensor:nw,Range:rw,get Rank(){return wC},Real:sw,RealDiv:_h,Reciprocal:jh,get Reduction(){return Cr},Relu:Vh,Relu6:Wh,Reshape:Ng,ResizeBilinear:$g,ResizeBilinearGrad:ow,ResizeNearestNeighbor:Ig,ResizeNearestNeighborGrad:iw,Reverse:Eg,RotateWithOffset:Sw,Round:Uh,Rsqrt:Gh,SGDOptimizer:l1,ScatterNd:aw,SearchSorted:uw,Select:Ag,Selu:Hh,Sigmoid:Zh,Sign:Xh,Sin:Kh,Sinh:qh,Slice:Og,Softmax:Lg,Softplus:Yh,SpaceToBatchND:Dg,SparseFillEmptyRows:cw,SparseReshape:dw,SparseSegmentMean:hw,SparseSegmentSum:fw,SparseToDense:pw,SplitV:Rg,Sqrt:Qh,Square:mw,SquaredDifference:Jh,StaticRegexReplace:Fg,Step:sf,StridedSlice:gw,StringNGrams:yw,StringSplit:vw,StringToHashBucketFast:xw,Sub:ef,Sum:Pg,Tan:tf,Tanh:nf,Tensor:gt,TensorBuffer:pn,TensorScatterUpdate:lw,Tile:rf,TopK:bw,Transform:ww,Transpose:Ru,Unique:_w,Unpack:Mg,UnsortedSegmentSum:zg,UpperBound:K9,Variable:im,ZerosLike:Bg,_FusedMatMul:em,abs:dn,acos:kI,acosh:CI,add:ge,addN:LB,all:Nw,any:am,argMax:Qu,argMin:TI,asin:NI,asinh:II,atan:$I,atan2:EI,atanh:AI,avgPool:Ug,avgPool3d:PI,backend:xI,backend_util:I4,basicLSTMCell:FB,batchNorm:of,batchNorm2d:DI,batchNorm3d:RI,batchNorm4d:LI,batchToSpaceND:Gg,bincount:FI,bitwiseAnd:MB,booleanMaskAsync:Sj,broadcastArgs:zB,broadcastTo:Lu,broadcast_util:NJ,browser:Hse,buffer:qe,cast:Se,ceil:MI,clipByValue:Br,clone:To,complex:ma,concat:rn,concat1d:zI,concat2d:BI,concat3d:jI,concat4d:VI,conv1d:Iw,conv2d:ga,conv2dTranspose:$w,conv3d:UI,conv3dTranspose:GI,copyRegisteredKernels:Y9,cos:Hg,cosh:Ew,cosineWindow:e1,cumprod:cm,cumsum:Aw,customGrad:Do,denseBincount:H0,deprecationWarn:EY,depthToSpace:HI,depthwiseConv2d:af,device_util:kY,diag:jB,dilation2d:KI,disableDeprecationWarnings:$Y,dispose:Qe,disposeVariables:AY,div:Le,divNoNan:qI,dot:XI,dropout:$$,einsum:gu,elu:lf,enableDebugMode:IY,enableProdMode:NY,enclosingPowerOfTwo:E$,engine:Li,ensureShape:VB,env:te,equal:gi,erf:Ow,euclideanNorm:YI,exp:jr,expandDims:lr,expm1:QI,eye:Pw,fft:iy,fill:_c,findBackend:FY,findBackendFactory:MY,floor:cf,floorDiv:Tw,fused:Oj,gather:df,gatherND:Nj,gather_util:Kse,getBackend:_B,getGradient:vC,getKernel:sm,getKernelsForBackend:W0,grad:cee,grads:dee,greater:Kr,greaterEqual:$a,ifft:Ud,imag:Kg,image:Gi,inTopKAsync:Ij,io:V$,irfft:qw,isFinite:JI,isInf:e$,isNaN:t$,keep:bn,kernel_impls:rie,leakyRelu:qg,less:Bd,lessEqual:zl,linalg:P$,linspace:GB,localResponseNormalization:n$,log:cs,log1p:Xg,logSigmoid:r$,logSoftmax:Rw,logSumExp:Zg,logicalAnd:Qi,logicalNot:Yg,logicalOr:Lw,logicalXor:s$,losses:zj,lowerBound:KB,matMul:Ye,math:Lse,max:Es,maxPool:Qg,maxPool3d:i$,maxPoolWithArgmax:qB,maximum:Mo,mean:Ut,memory:NC,meshgrid:XB,min:zd,minimum:Sl,mirrorPad:o$,mod:a$,moments:Jg,movingAverage:kj,mul:G,multiRNNCell:ZB,multinomial:YB,neg:$t,nextFrame:q$,norm:uf,notEqual:tc,oneHot:jd,ones:Dr,onesLike:ds,op:W,outerProduct:QB,pad:Ea,pad1d:JB,pad2d:ej,pad3d:tj,pad4d:nj,pool:l$,pow:Po,prelu:ty,print:SI,prod:u$,profile:OY,raggedGather:rj,raggedRange:sj,raggedTensorToTensor:ij,rand:oj,randomGamma:cj,randomNormal:zw,randomStandardNormal:dj,randomUniform:Bl,randomUniformInt:hj,range:nc,ready:RY,real:Vd,reciprocal:x$,registerBackend:vI,registerGradient:sB,registerKernel:kw,relu:io,relu6:Bw,removeBackend:LY,reshape:q,reverse:Ps,reverse1d:fj,reverse2d:pj,reverse3d:mj,reverse4d:gj,rfft:oy,round:jw,rsqrt:Vw,scalar:je,scatterND:Cj,scatter_util:fne,searchSorted:Fw,selu:Ww,separableConv2d:Uw,serialization:pse,setBackend:DY,setPlatform:zY,setdiff1dAsync:yj,sigmoid:Xi,sign:b$,signal:Mj,sin:Gw,sinh:Hw,slice:it,slice1d:ny,slice2d:Kw,slice3d:ry,slice4d:Wd,slice_util:n4,softmax:sy,softplus:Sc,spaceToBatchND:ey,sparse:Bj,sparseToDense:Tj,spectral:Fj,split:Fr,sqrt:Rn,square:_t,squaredDifference:Xw,squeeze:jl,stack:Vr,step:Cc,stridedSlice:w$,string:jj,sub:Ie,sum:Ae,sumOutType:Cw,tan:_$,tanh:_l,tensor:fi,tensor1d:ur,tensor2d:kd,tensor3d:S$,tensor4d:vj,tensor5d:xj,tensor6d:bj,tensorScatterUpdate:wj,tensor_util:xY,test_util:Tte,tidy:ee,tile:Ts,time:PY,topk:C$,train:cu,transpose:st,truncatedNormal:Yw,unique:T$,unregisterGradient:Z9,unregisterKernel:X9,unsortedSegmentSum:Qw,unstack:Ds,upcastType:Mr,upperBound:_j,util:oY,valueAndGrad:hee,valueAndGrads:fee,variable:N$,variableGrads:HB,version_core:Qse,where:Kn,whereAsync:I$,zeros:fn,zerosLike:ot},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iie=te();iie.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Yr;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Yr||(Yr={}));var bD;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(bD||(bD={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p2={};function oie(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};p2[t]=n}function $4(t){return p2[t]}function aie(t){delete p2[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N(t,e,n,r,s){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const a=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd,u=a<0?e.inputNames.length+a:a;if(i.type==="tensor")return Un(e.inputNames[u],n,r,s);if(i.type==="tensors"){const f=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((m,y)=>{var v;return((v=f[y])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(m=>Un(m,n,r,s))}const c=Un(e.inputNames[u],n,r,s),d=c.dataSync();return i.type==="number"?d[0]:$s(c.shape,d)}const o=e.attrParams[t];return o&&o.value}function Un(t,e,n,r){const[s,i]=Qr(t,n);if(r!=null){const a=r.getHashTableHandleByName(s);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!e[q0(s,a)]);return o!==void 0?e[q0(s,o)][i]:void 0}function wD(t,e,n){return e[q0(t,n.currentContextId)]}function qo(t,e){const[n,r,s]=Qr(t,e);return[q0(n,e&&e.currentContextId),r,s]}function q0(t,e){return e?`${t}-${e}`:t}function Qr(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const i=e.parseNodeNameCache.get(t);if(i!=null)return i}const r=t.split(":");let s;if(r.length===1)s=[t,0,void 0];else{const i=r[0],o=r.length===3?r[1]:void 0,a=Number(r[r.length-1]);s=[i,a,o]}return n&&e.parseNodeNameCache.set(t,s),s}function c0(t,e,n){let r=N("pad",t,e,n);if(r==="explicit"){r=N("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)s[i][0]=r[i*2],s[i][1]=r[i*2+1];return s}return r}function Xo(t){return t.kept?t:To(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lie=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],uie=Object.freeze(Object.defineProperty({__proto__:null,json:lie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cie=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],die=Object.freeze(Object.defineProperty({__proto__:null,json:cie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hie=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],fie=Object.freeze(Object.defineProperty({__proto__:null,json:hie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pie=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],mie=Object.freeze(Object.defineProperty({__proto__:null,json:pie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gie=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],yie=Object.freeze(Object.defineProperty({__proto__:null,json:gie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vie=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],xie=Object.freeze(Object.defineProperty({__proto__:null,json:vie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bie=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],wie=Object.freeze(Object.defineProperty({__proto__:null,json:bie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ie=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Sie=Object.freeze(Object.defineProperty({__proto__:null,json:_ie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kie=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Cie=Object.freeze(Object.defineProperty({__proto__:null,json:kie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tie=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Nie=Object.freeze(Object.defineProperty({__proto__:null,json:Tie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iie=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],$ie=Object.freeze(Object.defineProperty({__proto__:null,json:Iie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eie=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Aie=Object.freeze(Object.defineProperty({__proto__:null,json:Eie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oie=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Pie=Object.freeze(Object.defineProperty({__proto__:null,json:Oie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Die=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Rie=Object.freeze(Object.defineProperty({__proto__:null,json:Die},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lie=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Fie=Object.freeze(Object.defineProperty({__proto__:null,json:Lie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mie=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],zie=Object.freeze(Object.defineProperty({__proto__:null,json:Mie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bie=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],jie=Object.freeze(Object.defineProperty({__proto__:null,json:Bie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vie=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Wie=Object.freeze(Object.defineProperty({__proto__:null,json:Vie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uie=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Gie=Object.freeze(Object.defineProperty({__proto__:null,json:Uie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _D{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[uie,die,fie,mie,yie,xie,wie,Sie,Cie,Nie,$ie,Aie,Pie,Rie,Fie,zie,jie,Wie,Gie],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,n={}){const r=e.node,s=[],i=[],o=[],a=r.reduce((y,v)=>(y[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?s.push(y[v.name]):v.op==="Const"?i.push(y[v.name]):(v.input==null||v.input.length===0)&&o.push(y[v.name]),y),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const f=Object.keys(a);f.forEach(y=>{const v=a[y];v.inputNames.forEach((x,b)=>{const[_,,S]=qo(x),k=a[_];if(k.outputs!=null){const T=k.outputs.indexOf(S);if(T!==-1){const $=`${_}:${T}`;v.inputNames[b]=$}}v.inputs.push(k),k.children.push(v)})}),Object.keys(d).length===0?f.forEach(y=>{const v=a[y];v.children.length===0&&u.push(v)}):Object.keys(d).forEach(y=>{const[v]=qo(y),x=a[v];x!=null&&(x.signatureKey=d[y],u.push(x))}),Object.keys(c).length>0?Object.keys(c).forEach(y=>{const[v]=qo(y),x=a[v];x&&(x.signatureKey=c[y],l.push(x))}):l=s;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((y,v)=>(y[v.signature.name]=this.mapFunction(v),y),{}));const m={nodes:a,inputs:l,outputs:u,weights:i,placeholders:s,signature:n,functions:p};return o.length>0&&(m.initNodes=o),m}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=$4(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((s,i)=>(s[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},s),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((s,i)=>{const o=i.type;let a;switch(i.type){case"string":a=zC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=zC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":a=HC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=HC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":a=jC(e.attr,i.tfName,i.defaultValue||0),a===void 0&&i.tfDeprecatedName&&(a=jC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":a=GC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=GC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":a=BC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=BC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":a=qC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=qC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":a=UC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=UC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":a=KC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=KC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":a=VC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=VC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":a=WC(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=WC(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":a=SD(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=SD(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return s[i.name]={value:a,type:o},s},{})),r}mapFunction(e){const n=e.nodeDef,r=[],s=[];let i={};n!=null&&(i=n.reduce((d,f)=>(d[f.name]=this.mapNode(f),f.op==="Const"&&s.push(d[f.name]),d),{}));const o=[],a=[];e.signature.inputArg.forEach(d=>{const[f]=qo(d.name),p={name:f,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:m2(d.type),type:"dtype"}},children:[]};p.signatureKey=d.name,o.push(p),i[f]=p}),Object.keys(i).forEach(d=>{const f=i[d];f.inputNames.forEach((p,m)=>{const[y,,v]=qo(p),x=i[y];if(x.outputs!=null){const b=x.outputs.indexOf(v);if(b!==-1){const _=`${y}:${b}`;f.inputNames[m]=_}}f.inputs.push(x),x.children.push(f)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[f,p]=qo(u[d.name]),m=i[f];m!=null&&(m.defaultOutput=p,a.push(m))});const c=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:a,weights:s,placeholders:r,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function Hie(t){const e=te().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function E4(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):Hie(t);return e?n:n.toLowerCase()}function zC(t,e,n,r=!1){const s=t[e];return s!=null?E4(s.s,r):n}function BC(t,e,n){const r=t[e];return r?r.b:n}function jC(t,e,n){const r=t[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:n;return typeof s=="number"?s:parseInt(s,10)}function m2(t){switch(typeof t=="string"&&(t=Yr[t]),t){case Yr.DT_FLOAT:case Yr.DT_HALF:return"float32";case Yr.DT_INT32:case Yr.DT_INT64:case Yr.DT_INT8:case Yr.DT_UINT8:return"int32";case Yr.DT_BOOL:return"bool";case Yr.DT_DOUBLE:return"float32";case Yr.DT_STRING:return"string";case Yr.DT_COMPLEX64:case Yr.DT_COMPLEX128:return"complex64";default:return null}}function SD(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function VC(t,e,n){const r=t[e];return r&&r.type?m2(r.type):n}function WC(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(s=>m2(s)):n}function A4(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function UC(t,e,n){const r=t[e];return r&&r.shape?A4(r.shape):n}function GC(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):n}function HC(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(i=>E4(i,r)):n}function KC(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>A4(s)):n}function qC(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kie{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,i)=>(s[i]=this.getAttr(i),s),{}))}getInput(e){return Un(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Un(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return jC(this.node.rawAttrs,e,n);if(r.s!=null)return zC(this.node.rawAttrs,e,n);if(r.b!=null)return BC(this.node.rawAttrs,e,n);if(r.shape!=null)return UC(this.node.rawAttrs,e,n);if(r.type!=null)return VC(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return GC(this.node.rawAttrs,e,n);if(r.list.s!=null)return HC(this.node.rawAttrs,e,n);if(r.list.shape!=null)return KC(this.node.rawAttrs,e,n);if(r.list.b!=null)return qC(this.node.rawAttrs,e,n);if(r.list.type!=null)return WC(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:yI,abs:dn,acos:kI,acosh:CI,add:ge,addN:LB,all:Nw,any:am,argMax:Qu,argMin:TI,asin:NI,asinh:II,atan:$I,atan2:EI,atanh:AI,avgPool:Ug,avgPool3d:PI,basicLSTMCell:FB,batchNorm:of,batchNorm2d:DI,batchNorm3d:RI,batchNorm4d:LI,batchToSpaceND:Gg,bincount:FI,bitwiseAnd:MB,booleanMaskAsync:Sj,broadcastArgs:zB,broadcastTo:Lu,buffer:qe,cast:Se,ceil:MI,clipByValue:Br,clone:To,complex:ma,concat:rn,concat1d:zI,concat2d:BI,concat3d:jI,concat4d:VI,conv1d:Iw,conv2d:ga,conv2dTranspose:$w,conv3d:UI,conv3dTranspose:GI,cos:Hg,cosh:Ew,cosineWindow:e1,cumprod:cm,cumsum:Aw,denseBincount:H0,depthToSpace:HI,depthwiseConv2d:af,diag:jB,dilation2d:KI,div:Le,divNoNan:qI,dot:XI,dropout:$$,einsum:gu,elu:lf,enclosingPowerOfTwo:E$,ensureShape:VB,equal:gi,erf:Ow,euclideanNorm:YI,exp:jr,expandDims:lr,expm1:QI,eye:Pw,fft:iy,fill:_c,floor:cf,floorDiv:Tw,fused:Oj,gather:df,gatherND:Nj,greater:Kr,greaterEqual:$a,ifft:Ud,imag:Kg,image:Gi,inTopKAsync:Ij,irfft:qw,isFinite:JI,isInf:e$,isNaN:t$,leakyRelu:qg,less:Bd,lessEqual:zl,linalg:P$,linspace:GB,localResponseNormalization:n$,log:cs,log1p:Xg,logSigmoid:r$,logSoftmax:Rw,logSumExp:Zg,logicalAnd:Qi,logicalNot:Yg,logicalOr:Lw,logicalXor:s$,losses:zj,lowerBound:KB,matMul:Ye,max:Es,maxPool:Qg,maxPool3d:i$,maxPoolWithArgmax:qB,maximum:Mo,mean:Ut,meshgrid:XB,min:zd,minimum:Sl,mirrorPad:o$,mod:a$,moments:Jg,movingAverage:kj,mul:G,multiRNNCell:ZB,multinomial:YB,neg:$t,norm:uf,notEqual:tc,oneHot:jd,ones:Dr,onesLike:ds,op:W,outerProduct:QB,pad:Ea,pad1d:JB,pad2d:ej,pad3d:tj,pad4d:nj,pool:l$,pow:Po,prelu:ty,print:SI,prod:u$,raggedGather:rj,raggedRange:sj,raggedTensorToTensor:ij,rand:oj,randomGamma:cj,randomNormal:zw,randomStandardNormal:dj,randomUniform:Bl,randomUniformInt:hj,range:nc,real:Vd,reciprocal:x$,relu:io,relu6:Bw,reshape:q,reverse:Ps,reverse1d:fj,reverse2d:pj,reverse3d:mj,reverse4d:gj,rfft:oy,round:jw,rsqrt:Vw,scalar:je,scatterND:Cj,searchSorted:Fw,selu:Ww,separableConv2d:Uw,setdiff1dAsync:yj,sigmoid:Xi,sign:b$,signal:Mj,sin:Gw,sinh:Hw,slice:it,slice1d:ny,slice2d:Kw,slice3d:ry,slice4d:Wd,softmax:sy,softplus:Sc,spaceToBatchND:ey,sparse:Bj,sparseToDense:Tj,spectral:Fj,split:Fr,sqrt:Rn,square:_t,squaredDifference:Xw,squeeze:jl,stack:Vr,step:Cc,stridedSlice:w$,string:jj,sub:Ie,sum:Ae,tan:_$,tanh:_l,tensor:fi,tensor1d:ur,tensor2d:kd,tensor3d:S$,tensor4d:vj,tensor5d:xj,tensor6d:bj,tensorScatterUpdate:wj,tile:Ts,topk:C$,transpose:st,truncatedNormal:Yw,unique:T$,unsortedSegmentSum:Qw,unstack:Ds,upperBound:_j,variable:N$,where:Kn,whereAsync:I$,zeros:fn,zerosLike:ot},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qie=(t,e,n,r=Jn)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(N("a",t,e,n),N("b",t,e,n))];case"AddN":return[r.addN(N("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(N("a",t,e,n),N("b",t,e,n))];case"Mul":return[r.mul(N("a",t,e,n),N("b",t,e,n))];case"RealDiv":case"Div":return[r.div(N("a",t,e,n),N("b",t,e,n))];case"DivNoNan":return[r.divNoNan(N("a",t,e,n),N("b",t,e,n))];case"FloorDiv":return[r.floorDiv(N("a",t,e,n),N("b",t,e,n))];case"Sub":return[r.sub(N("a",t,e,n),N("b",t,e,n))];case"Minimum":return[r.minimum(N("a",t,e,n),N("b",t,e,n))];case"Maximum":return[r.maximum(N("a",t,e,n),N("b",t,e,n))];case"Pow":return[r.pow(N("a",t,e,n),N("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(N("a",t,e,n),N("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xie=(t,e,n,r=Jn)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(N("x",t,e,n))];case"Acos":return[r.acos(N("x",t,e,n))];case"Acosh":return[r.acosh(N("x",t,e,n))];case"Asin":return[r.asin(N("x",t,e,n))];case"Asinh":return[r.asinh(N("x",t,e,n))];case"Atan":return[r.atan(N("x",t,e,n))];case"Atan2":return[r.atan2(N("x",t,e,n),N("y",t,e,n))];case"Atanh":return[r.atanh(N("x",t,e,n))];case"Ceil":return[r.ceil(N("x",t,e,n))];case"Complex":return[r.complex(N("real",t,e,n),N("imag",t,e,n))];case"Cos":return[r.cos(N("x",t,e,n))];case"Cosh":return[r.cosh(N("x",t,e,n))];case"Elu":return[r.elu(N("x",t,e,n))];case"Erf":return[r.erf(N("x",t,e,n))];case"Exp":return[r.exp(N("x",t,e,n))];case"Expm1":return[r.expm1(N("x",t,e,n))];case"Floor":return[r.floor(N("x",t,e,n))];case"Log":return[r.log(N("x",t,e,n))];case"Log1p":return[r.log1p(N("x",t,e,n))];case"Imag":return[r.imag(N("x",t,e,n))];case"Neg":return[r.neg(N("x",t,e,n))];case"Reciprocal":return[r.reciprocal(N("x",t,e,n))];case"Real":return[r.real(N("x",t,e,n))];case"Relu":return[r.relu(N("x",t,e,n))];case"Round":return[r.round(N("x",t,e,n))];case"Selu":return[r.selu(N("x",t,e,n))];case"Sigmoid":return[r.sigmoid(N("x",t,e,n))];case"Sin":return[r.sin(N("x",t,e,n))];case"Sign":return[r.sign(N("x",t,e,n))];case"Sinh":return[r.sinh(N("x",t,e,n))];case"Softplus":return[r.softplus(N("x",t,e,n))];case"Sqrt":return[r.sqrt(N("x",t,e,n))];case"Square":return[r.square(N("x",t,e,n))];case"Tanh":return[r.tanh(N("x",t,e,n))];case"Tan":return[r.tan(N("x",t,e,n))];case"ClipByValue":return[r.clipByValue(N("x",t,e,n),N("clipValueMin",t,e,n),N("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(N("x",t,e,n))];case"Rsqrt":return[r.rsqrt(Un(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu(N("x",t,e,n),N("alpha",t,e,n))];case"Prelu":return[r.prelu(N("x",t,e,n),N("alpha",t,e,n))];case"IsNan":return[r.isNaN(Un(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(Un(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(Un(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){O(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const s=t[r],i=e[r];O(s<0||i<0||s===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function kD(t){return!(typeof t=="number"||t.some(e=>e<0))}function ep(t,e,n){let r=XC(t,n);const s=!kD(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(i=>{r=XC(i.shape,r)}),!kD(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function XC(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const s=t[r],i=e[r];if(s>=0&&i>=0&&s!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=s>=0?s:i}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zie{constructor(e,n,r,s,i,o,a){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=je(0),bn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),ti(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,bn(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,s)=>this.write(r,n[s]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return fi([],[0].concat(this.elementShape));const r=this.readMany(e);return ti(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Vr(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return fi([],[0].concat(this.elementShape));const n=[];for(let s=0;s<this.size();s++)n.push(s);const r=this.readMany(n);return ti(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),rn(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Ds(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const s=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=r===0?0:n.size/r,o=[];ee(()=>{n=q(n,[1,r,i]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:s[l-1],0],d=[1,e[l],i];o[l]=q(it(n,c,d),this.elementShape)}return o});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sc{get id(){return this.idTensor.id}constructor(e,n,r,s=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(i=>{if(r!==i.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${i.dtype}`);ti(n,i.shape,"TensorList shape mismatch: "),bn(i)}),this.idTensor=je(0),this.maxNumElements=s,bn(this.idTensor)}copy(){return new sc([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);ti(e,this.elementShape,"TensorList shape mismatch: ");const s=ep(this.elementShape,this.tensors,e);return ee(()=>{const i=this.tensors.map(o=>q(o,s));return Vr(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=ep(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,ti(s.shape,e,"TensorList shape mismatch: "),q(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(ti(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");bn(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new sc([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);ti(this.tensors[e].shape,n,"TensorList shape mismatch: ");const s=ep(this.elementShape,this.tensors,n);return q(this.tensors[e],s)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);ti(this.elementShape,n.shape,"TensorList shape mismatch: "),bn(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);ti(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=ep(this.elementShape,this.tensors,r);return e.length===0?fi([],[0].concat(s)):ee(()=>{const i=e.map(o=>q(this.tensors[o],s));return Vr(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);ti(this.elementShape,n,"TensorList shape mismatch: ");const r=ep(this.elementShape,this.tensors,n);return this.size()===0?fi([],[0].concat(r)):ee(()=>{const s=this.tensors.map(i=>q(i,r));return rn(s,0)})}}function Yie(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const s=t.shape.slice(1);ti(s,e,"TensorList shape mismatch: ");const i=Ds(t);return new sc(i,e,r)}function Qie(t,e,n,r){return new sc([],t,e,r)}function Jie(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const i=new sc([],n,t.dtype,r),o=Ds(t,0);return e.forEach((a,l)=>{i.setItem(a,o[l])}),i}function eoe(t,e,n){let r=0;const s=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=XC(i,n),a=r===0?0:t.size/r,l=ee(()=>{const c=[];t=q(t,[1,r,a]);for(let d=0;d<e.length;++d){const p=[0,d===0?0:s[d-1],0],m=[1,e[d],a];c[d]=q(it(t,p,m),o)}return t.dispose(),c}),u=new sc([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const toe=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=N("thenBranch",t,e,n),s=N("elseBranch",t,e,n),i=N("cond",t,e,n),o=N("args",t,e,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=N("body",t,e,n),s=N("cond",t,e,n),i=N("args",t,e,n),o=await n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),a=i.map(c=>c.id);let l=await o[0].data();o.forEach(c=>{!c.kept&&a.indexOf(c.id)===-1&&c.dispose()});let u=i;for(;l[0];){const c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(p=>p.id);c.forEach(p=>{!p.kept&&a.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()});const f=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await f[0].data(),f.forEach(p=>{!p.kept&&a.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()})}return u}case"LoopCond":{const r=N("pred",t,e,n);return[Xo(r)]}case"Switch":{const r=N("pred",t,e,n);let s=N("data",t,e,n);return s.kept||(s=Xo(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(s=>Un(s,e,n)!==void 0);if(r){const s=Un(r,e,n);return[Xo(s)]}return}case"Enter":{const r=N("frameName",t,e,n),s=N("tensor",t,e,n);return n.enterFrame(r),[Xo(s)]}case"Exit":{const r=N("tensor",t,e,n);return n.exitFrame(),[Xo(r)]}case"NextIteration":{const r=N("tensor",t,e,n);return n.nextIteration(),[Xo(r)]}case"TensorArrayV3":{const r=N("size",t,e,n),s=N("dtype",t,e,n),i=N("elementShape",t,e,n),o=N("dynamicSize",t,e,n),a=N("clearAfterRead",t,e,n),l=N("identicalElementShapes",t,e,n),u=N("name",t,e,n),c=new Zie(u,s,r,i,l,o,a);return n.addTensorArray(c),[c.idTensor,je(1)]}case"TensorArrayWriteV3":{const r=N("tensorArrayId",t,e,n),s=N("index",t,e,n),i=N("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(s,i),[o.idTensor]}case"TensorArrayReadV3":{const r=N("tensorArrayId",t,e,n),s=N("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=N("tensorArrayId",t,e,n),s=N("indices",t,e,n),i=N("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,i)]}case"TensorArrayScatterV3":{const r=N("tensorArrayId",t,e,n),s=N("indices",t,e,n),i=N("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(s,i),[o.idTensor]}case"TensorArrayConcatV3":{const r=N("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),i=N("dtype",t,e,n);return[s.concat(i)]}case"TensorArraySplitV3":{const r=N("tensorArrayId",t,e,n),s=N("tensor",t,e,n),i=N("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(i,s),[o.idTensor]}case"TensorArraySizeV3":{const r=N("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return[je(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=N("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=N("tensorListId",t,e,n),s=N("index",t,e,n),i=N("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(s,i),[o.idTensor]}case"TensorListGetItem":{const r=N("tensorListId",t,e,n),s=N("index",t,e,n),i=N("elementShape",t,e,n),o=N("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=N("indices",t,e,n),s=N("tensor",t,e,n),i=N("elementShape",t,e,n),o=N("numElements",t,e,n),a=Jie(s,r,i,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=N("elementShape",t,e,n),s=N("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=N(i,t,e,n),a=t.op==="TensorListReserve"?-1:o,l=Qie(r,s,o,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=N("tensorListId",t,e,n),s=N("indices",t,e,n),i=N("elementShape",t,e,n),o=N("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,o,i)]}case"TensorListStack":{const r=N("tensorListId",t,e,n),s=N("elementShape",t,e,n),i=N("elementDType",t,e,n),o=N("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,i,o)]}case"TensorListFromTensor":{const r=N("tensor",t,e,n),s=N("elementShape",t,e,n),i=N("elementDType",t,e,n),o=Yie(r,s,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=N("tensorListId",t,e,n),s=n.getTensorList(r.id),i=N("dtype",t,e,n),o=N("elementShape",t,e,n);return[s.concat(i,o)]}case"TensorListPushBack":{const r=N("tensorListId",t,e,n),s=N("tensor",t,e,n),i=n.getTensorList(r.id);return i.pushBack(s),[i.idTensor]}case"TensorListPopBack":{const r=N("tensorListId",t,e,n),s=N("elementShape",t,e,n),i=N("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,i)]}case"TensorListSplit":{const r=N("tensor",t,e,n),s=N("elementShape",t,e,n),i=N("lengths",t,e,n),o=eoe(r,i,s);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=N("tensorListId",t,e,n),s=n.getTensorList(r.id);return[je(s.size(),"int32")]}case"TensorListResize":{const r=N("tensorListId",t,e,n),s=N("size",t,e,n),o=n.getTensorList(r.id).resize(s);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CD(t,e,n){const[r,s]=N("fusedOps",t,e,n),i=r==="biasadd",o=!i,a=s==="prelu",l=r==="fusedbatchnorm",u=N("numArgs",t,e,n);if(i){if(a&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=N("strides",t,e,n),d=c0(t,e,n),f=N("dataFormat",t,e,n).toUpperCase(),p=N("dilations",t,e,n);let[m,y]=N("args",t,e,n);o&&(y=m,m=void 0);const v=N("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:f,dilations:p,biasArg:m,preluArg:y,activationFunc:s,leakyreluAlpha:v}}const noe=(t,e,n,r=Jn)=>{switch(t.op){case"Conv1D":{const s=N("stride",t,e,n),i=N("pad",t,e,n),o=N("dataFormat",t,e,n).toUpperCase(),a=N("dilation",t,e,n);return[r.conv1d(N("x",t,e,n),N("filter",t,e,n),s,i,o,a)]}case"Conv2D":{const s=N("strides",t,e,n),i=c0(t,e,n),o=N("dataFormat",t,e,n).toUpperCase(),a=N("dilations",t,e,n);return[r.conv2d(N("x",t,e,n),N("filter",t,e,n),[s[1],s[2]],i,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:s,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=CD(t,e,n);return[r.fused.conv2d({x:N("x",t,e,n),filter:N("filter",t,e,n),strides:[s[1],s[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=CD(t,e,n);return[r.fused.depthwiseConv2d({x:N("x",t,e,n),filter:N("filter",t,e,n),strides:[s[1],s[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=N("outputShape",t,e,n),i=N("strides",t,e,n),o=c0(t,e,n);return[r.conv2dTranspose(N("x",t,e,n),N("filter",t,e,n),s,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=N("strides",t,e,n),i=c0(t,e,n),o=N("dilations",t,e,n),a=N("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(N("input",t,e,n),N("filter",t,e,n),[s[1],s[2]],i,a,[o[1],o[2]])]}case"Conv3D":{const s=N("strides",t,e,n),i=N("pad",t,e,n),o=N("dataFormat",t,e,n).toUpperCase(),a=N("dilations",t,e,n);return[r.conv3d(N("x",t,e,n),N("filter",t,e,n),[s[1],s[2],s[3]],i,o,[a[1],a[2],a[3]])]}case"AvgPool":{const s=N("strides",t,e,n),i=N("pad",t,e,n),o=N("kernelSize",t,e,n);return[r.avgPool(N("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i)]}case"MaxPool":{const s=N("strides",t,e,n),i=N("pad",t,e,n),o=N("kernelSize",t,e,n);return[r.maxPool(N("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i)]}case"MaxPoolWithArgmax":{const s=N("strides",t,e,n),i=N("pad",t,e,n),o=N("kernelSize",t,e,n),a=N("includeBatchInIndex",t,e,n),{result:l,indexes:u}=r.maxPoolWithArgmax(N("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i,a);return[l,u]}case"AvgPool3D":{const s=N("strides",t,e,n),i=N("pad",t,e,n),o=N("kernelSize",t,e,n);return[r.avgPool3d(N("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],i)]}case"MaxPool3D":{const s=N("strides",t,e,n),i=N("pad",t,e,n),o=N("kernelSize",t,e,n);return[r.maxPool3d(N("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],i)]}case"Dilation2D":{const s=N("strides",t,e,n),i=N("pad",t,e,n),o=N("dilations",t,e,n),a=s[1],l=s[2],u=o[1],c=o[2];return[r.dilation2d(N("x",t,e,n),N("filter",t,e,n),[a,l],i,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const roe=(t,e,n,r=Jn)=>{switch(t.op){case"Fill":{const s=N("shape",t,e,n),i=N("dtype",t,e,n),o=N("value",t,e,n);return[r.fill(s,o,i)]}case"LinSpace":{const s=N("start",t,e,n),i=N("stop",t,e,n),o=N("num",t,e,n);return[r.linspace(s,i,o)]}case"Multinomial":{const s=N("logits",t,e,n),i=N("numSamples",t,e,n),o=N("seed",t,e,n);return[r.multinomial(s,i,o)]}case"OneHot":{const s=N("indices",t,e,n),i=N("depth",t,e,n),o=N("onValue",t,e,n),a=N("offValue",t,e,n),l=N("dtype",t,e,n);return[r.oneHot(s,i,o,a,l)]}case"Ones":return[r.ones(N("shape",t,e,n),N("dtype",t,e,n))];case"OnesLike":return[r.onesLike(N("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(N("shape",t,e,n),N("dtype",t,e,n),N("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(N("shape",t,e,n),N("minval",t,e,n),N("maxval",t,e,n),N("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt(N("shape",t,e,n),N("minval",t,e,n),N("maxval",t,e,n),N("seed",t,e,n))];case"Range":{const s=N("start",t,e,n),i=N("stop",t,e,n),o=N("step",t,e,n);return[r.range(s,i,o,N("dtype",t,e,n))]}case"TruncatedNormal":{const s=N("shape",t,e,n),i=N("mean",t,e,n),o=N("stdDev",t,e,n),a=N("seed",t,e,n);return[r.truncatedNormal(s,i,o,N("dtype",t,e,n),a)]}case"Zeros":return[r.zeros(N("shape",t,e,n),N("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(N("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FS(t,e,n){const r=N("boxes",t,e,n),s=N("scores",t,e,n),i=N("maxOutputSize",t,e,n),o=N("iouThreshold",t,e,n),a=N("scoreThreshold",t,e,n),l=N("softNmsSigma",t,e,n);return{boxes:r,scores:s,maxOutputSize:i,iouThreshold:o,scoreThreshold:a,softNmsSigma:l}}const soe=async(t,e,n,r,s=Jn)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=FS(t,e,n),d=await s.image.nonMaxSuppressionWithScoreAsync(i,o,a,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=FS(t,e,n),c=N("padToMaxOutputSize",t,e,n),d=await s.image.nonMaxSuppressionPaddedAsync(i,o,a,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=FS(t,e,n);return[await s.image.nonMaxSuppressionAsync(i,o,a,l,u)]}case"Where":{const i=s.cast(N("condition",t,e,n),"bool"),o=[await s.whereAsync(i)];return i.dispose(),o}case"ListDiff":return s.setdiff1dAsync(N("x",t,e,n),N("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ioe=(t,e,n,r=Jn)=>{switch(t.op){case"LowerBound":{const s=N("sortedSequence",t,e,n),i=N("values",t,e,n);return[r.lowerBound(s,i)]}case"TopKV2":{const s=N("x",t,e,n),i=N("k",t,e,n),o=N("sorted",t,e,n),a=r.topk(s,i,o);return[a.values,a.indices]}case"UpperBound":{const s=N("sortedSequence",t,e,n),i=N("values",t,e,n);return[r.upperBound(s,i)]}case"Unique":{const s=N("x",t,e,n),i=r.unique(s);return[i.values,i.indices]}case"UniqueV2":{const s=N("x",t,e,n),i=N("axis",t,e,n),o=r.unique(s,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ooe=(t,e,n,r=Jn)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const s=N("default",t,e,n);return[Un(t.name,e,n)||s];case"Placeholder":return[Un(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=N("x",t,e,n);return[Xo(c)]}case"IdentityN":return N("x",t,e,n).map(c=>Xo(c));case"Snapshot":const i=N("x",t,e,n);return[Xo(i)];case"Shape":return[r.tensor1d(N("x",t,e,n).shape,"int32")];case"ShapeN":return N("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(N("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(N("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=N("x",t,e,n),a=N("data",t,e,n),l=N("message",t,e,n),u=N("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<a.length;c++)console.log(Array.prototype.slice.call(a[c].dataSync()).slice(0,u));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aoe{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=je(0),this.tensorMap=new Map,bn(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return je(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),ee(()=>{const s=Ds(n),i=r.length,o=s.length;O(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let a=0;a<i;a++){const l=r[a],u=s[a];bn(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return ee(()=>{const s=[];for(let i=0;i<r.length;i++){const o=r[i],a=this.findWithDefault(o,n);s.push(a)}return Vr(s)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const loe=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(t.name);if(s!=null)return[s];{const i=N("keyDType",t,e,n),o=N("valueDType",t,e,n),a=new aoe(i,o);return r.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=N("tableHandle",t,e,n,r),i=N("keys",t,e,n),o=N("values",t,e,n);return[await r.getHashTableById(s.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const s=N("tableHandle",t,e,n,r),i=N("keys",t,e,n),o=N("defaultValue",t,e,n);return[await r.getHashTableById(s.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=N("tableHandle",t,e,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uoe=(t,e,n,r=Jn)=>{switch(t.op){case"ResizeBilinear":{const s=N("images",t,e,n),i=N("size",t,e,n),o=N("alignCorners",t,e,n),a=N("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(s,[i[0],i[1]],o,a)]}case"ResizeNearestNeighbor":{const s=N("images",t,e,n),i=N("size",t,e,n),o=N("alignCorners",t,e,n),a=N("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(s,[i[0],i[1]],o,a)]}case"CropAndResize":{const s=N("image",t,e,n),i=N("boxes",t,e,n),o=N("boxInd",t,e,n),a=N("cropSize",t,e,n),l=N("method",t,e,n),u=N("extrapolationValue",t,e,n);return[r.image.cropAndResize(s,i,o,a,l,u)]}case"ImageProjectiveTransformV3":{const s=N("images",t,e,n),i=N("transforms",t,e,n),o=N("outputShape",t,e,n),a=N("fillValue",t,e,n),l=N("interpolation",t,e,n),u=N("fillMode",t,e,n);return[r.image.transform(s,i,l.toLowerCase(),u.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const coe=(t,e,n,r=Jn)=>{switch(t.op){case"Equal":return[r.equal(N("a",t,e,n),N("b",t,e,n))];case"NotEqual":return[r.notEqual(N("a",t,e,n),N("b",t,e,n))];case"Greater":return[r.greater(N("a",t,e,n),N("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(N("a",t,e,n),N("b",t,e,n))];case"Less":return[r.less(N("a",t,e,n),N("b",t,e,n))];case"LessEqual":return[r.lessEqual(N("a",t,e,n),N("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(N("a",t,e,n),N("b",t,e,n))];case"LogicalNot":return[r.logicalNot(N("a",t,e,n))];case"LogicalOr":return[r.logicalOr(N("a",t,e,n),N("b",t,e,n))];case"Select":case"SelectV2":return[r.where(N("condition",t,e,n),N("a",t,e,n),N("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd(N("a",t,e,n),N("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const doe=(t,e,n,r=Jn)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(N("a",t,e,n),N("b",t,e,n),N("transposeA",t,e,n),N("transposeB",t,e,n))];case"Einsum":return[r.einsum(N("equation",t,e,n),...N("tensors",t,e,n))];case"Transpose":return[r.transpose(N("x",t,e,n),N("perm",t,e,n))];case"_FusedMatMul":const[s,i]=N("fusedOps",t,e,n),o=s==="biasadd",a=i==="prelu",l=N("numArgs",t,e,n),u=N("leakyreluAlpha",t,e,n);if(o){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=N("args",t,e,n);return[r.fused.matMul({a:N("a",t,e,n),b:N("b",t,e,n),transposeA:N("transposeA",t,e,n),transposeB:N("transposeB",t,e,n),bias:c,activation:i,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart(N("a",t,e,n),N("numLower",t,e,n),N("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hoe=(t,e,n,r=Jn)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(N("x",t,e,n),N("axis",t,e,n),N("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(N("x",t,e,n),N("mean",t,e,n),N("variance",t,e,n),N("offset",t,e,n),N("scale",t,e,n),N("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(N("x",t,e,n),N("mean",t,e,n),N("variance",t,e,n),N("offset",t,e,n),N("scale",t,e,n),N("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(N("x",t,e,n),N("radius",t,e,n),N("bias",t,e,n),N("alpha",t,e,n),N("beta",t,e,n))];case"Softmax":return[r.softmax(N("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(N("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const foe=(t,e,n,r=Jn)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:i}=r.raggedGather(N("paramsNestedSplits",t,e,n),N("paramsDenseValues",t,e,n),N("indices",t,e,n),N("outputRaggedRank",t,e,n));return s.concat(i)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:i}=r.raggedRange(N("starts",t,e,n),N("limits",t,e,n),N("splits",t,e,n));return[s,i]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(N("shape",t,e,n),N("values",t,e,n),N("defaultValue",t,e,n),N("rowPartitionTensors",t,e,n),N("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const poe=(t,e,n,r=Jn)=>{switch(t.op){case"Max":{const a=N("axis",t,e,n),l=N("keepDims",t,e,n);return[r.max(N("x",t,e,n),a,l)]}case"Mean":{const a=N("axis",t,e,n),l=N("keepDims",t,e,n);return[r.mean(N("x",t,e,n),a,l)]}case"Min":{const a=N("axis",t,e,n),l=N("keepDims",t,e,n);return[r.min(N("x",t,e,n),a,l)]}case"Sum":{const a=N("axis",t,e,n),l=N("keepDims",t,e,n);return[r.sum(N("x",t,e,n),a,l)]}case"All":{const a=N("axis",t,e,n),l=N("keepDims",t,e,n);return[r.all(N("x",t,e,n),a,l)]}case"Any":{const a=N("axis",t,e,n),l=N("keepDims",t,e,n);return[r.any(N("x",t,e,n),a,l)]}case"ArgMax":{const a=N("axis",t,e,n);return[r.argMax(N("x",t,e,n),a)]}case"ArgMin":{const a=N("axis",t,e,n);return[r.argMin(N("x",t,e,n),a)]}case"Prod":{const a=N("axis",t,e,n),l=N("keepDims",t,e,n);return[r.prod(N("x",t,e,n),a,l)]}case"Cumprod":{const a=N("axis",t,e,n),l=N("exclusive",t,e,n),u=N("reverse",t,e,n);return[r.cumprod(N("x",t,e,n),a,l,u)]}case"Cumsum":{const a=N("axis",t,e,n),l=N("exclusive",t,e,n),u=N("reverse",t,e,n);return[r.cumsum(N("x",t,e,n),a,l,u)]}case"Bincount":const s=N("x",t,e,n),i=N("weights",t,e,n),o=N("size",t,e,n);return[r.bincount(s,i,o)];case"DenseBincount":{const a=N("x",t,e,n),l=N("weights",t,e,n),u=N("size",t,e,n),c=N("binaryOutput",t,e,n);return[r.denseBincount(a,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const moe=(t,e,n,r=Jn)=>{switch(t.op){case"ConcatV2":case"Concat":{const s=N("n",t,e,n),i=N("axis",t,e,n);let o=N("tensors",t,e,n);return o=o.slice(0,s),[r.concat(o,i)]}case"Gather":{const s=N("x",t,e,n),i=N("indices",t,e,n);return[r.gather(s,r.cast(i,"int32"),0)]}case"GatherV2":{const s=N("axis",t,e,n),i=N("batchDims",t,e,n),o=N("x",t,e,n),a=N("indices",t,e,n);return[r.gather(o,r.cast(a,"int32"),s,i)]}case"Reverse":{const s=N("dims",t,e,n),i=[];for(let a=0;a<s.length;a++)s[a]&&i.push(a);const o=N("x",t,e,n);return[r.reverse(o,i)]}case"ReverseV2":{const s=N("axis",t,e,n),i=N("x",t,e,n);return[r.reverse(i,s)]}case"Slice":{const s=N("begin",t,e,n),i=N("size",t,e,n);return[r.slice(N("x",t,e,n),s,i)]}case"StridedSlice":{const s=N("begin",t,e,n),i=N("end",t,e,n),o=N("strides",t,e,n),a=N("beginMask",t,e,n),l=N("endMask",t,e,n),u=N("ellipsisMask",t,e,n),c=N("newAxisMask",t,e,n),d=N("shrinkAxisMask",t,e,n),f=N("x",t,e,n);return[r.stridedSlice(f,s,i,o,a,l,u,c,d)]}case"Pack":return ee(()=>{const s=N("axis",t,e,n),i=N("tensors",t,e,n),o=i[0].shape,a=r.squeeze(i[0]).shape,l=i.map(u=>{const c=nt(u.shape,o);if(!c&&!nt(r.squeeze(u).shape,a))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,o)});return[r.stack(l,s)]});case"Unpack":{const s=N("axis",t,e,n),i=N("tensor",t,e,n);return r.unstack(i,s)}case"Tile":{const s=N("reps",t,e,n);return[r.tile(N("x",t,e,n),s)]}case"Split":case"SplitV":{const s=N("axis",t,e,n),i=N("numOrSizeSplits",t,e,n),o=N("x",t,e,n);return r.split(o,i,s)}case"ScatterNd":{const s=N("indices",t,e,n),i=N("values",t,e,n),o=N("shape",t,e,n);return[r.scatterND(s,i,o)]}case"GatherNd":{const s=N("x",t,e,n),i=N("indices",t,e,n);return[r.gatherND(s,i)]}case"SparseToDense":{const s=N("sparseIndices",t,e,n),i=N("outputShape",t,e,n),o=N("sparseValues",t,e,n),a=N("defaultValue",t,e,n);return[r.sparseToDense(s,o,i,o.dtype===a.dtype?a:r.cast(a,o.dtype))]}case"TensorScatterUpdate":{const s=N("indices",t,e,n),i=N("values",t,e,n),o=N("tensor",t,e,n);return[r.tensorScatterUpdate(o,s,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const goe=(t,e,n,r=Jn)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:i,emptyRowIndicator:o,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows(N("indices",t,e,n),N("values",t,e,n),N("denseShape",t,e,n),N("defaultValue",t,e,n));return[s,i,o,a]}case"SparseReshape":{const{outputIndices:s,outputShape:i}=r.sparse.sparseReshape(N("inputIndices",t,e,n),N("inputShape",t,e,n),N("newShape",t,e,n));return[s,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(N("data",t,e,n),N("indices",t,e,n),N("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(N("data",t,e,n),N("indices",t,e,n),N("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yoe=(t,e,n,r=Jn)=>{switch(t.op){case"FFT":return[r.fft(N("x",t,e,n))];case"IFFT":return[r.ifft(N("x",t,e,n))];case"RFFT":return[r.rfft(N("x",t,e,n))];case"IRFFT":return[r.irfft(N("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const voe=(t,e,n,r=Jn)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(N("input",t,e,n),N("pattern",t,e,n),N("rewrite",t,e,n),N("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:i}=r.string.stringNGrams(N("data",t,e,n),N("dataSplits",t,e,n),N("separator",t,e,n),N("nGramWidths",t,e,n),N("leftPad",t,e,n),N("rightPad",t,e,n),N("padWidth",t,e,n),N("preserveShortSequences",t,e,n));return[s,i]}case"StringSplit":{const{indices:s,values:i,shape:o}=r.string.stringSplit(N("input",t,e,n),N("delimiter",t,e,n),N("skipEmpty",t,e,n));return[s,i,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(N("input",t,e,n),N("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xoe=(t,e,n,r=Jn)=>{switch(t.op){case"Cast":return[r.cast(N("x",t,e,n),N("dtype",t,e,n))];case"ExpandDims":{const s=N("axis",t,e,n);return[r.expandDims(N("x",t,e,n),s)]}case"Squeeze":{const s=N("axis",t,e,n);return[r.squeeze(N("x",t,e,n),s)]}case"Reshape":return[r.reshape(N("x",t,e,n),N("shape",t,e,n))];case"EnsureShape":return[r.ensureShape(N("x",t,e,n),N("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(N("x",t,e,n),N("padding",t,e,n),N("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(N("x",t,e,n),N("padding",t,e,n),N("constantValue",t,e,n))];case"SpaceToBatchND":{const s=N("blockShape",t,e,n),i=N("paddings",t,e,n);return[r.spaceToBatchND(N("x",t,e,n),s,i)]}case"BatchToSpaceND":{const s=N("blockShape",t,e,n),i=N("crops",t,e,n);return[r.batchToSpaceND(N("x",t,e,n),s,i)]}case"DepthToSpace":{const s=N("blockSize",t,e,n),i=N("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(N("x",t,e,n),s,i)]}case"BroadcastTo":return[r.broadcastTo(N("x",t,e,n),N("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(N("s0",t,e,n),N("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TD(t,e,n,r,s=ee){const i=((o,a,l)=>{switch(o.category){case"arithmetic":return s(()=>qie(o,a,l));case"basic_math":return s(()=>Xie(o,a,l));case"control":return toe(o,a,l);case"convolution":return s(()=>noe(o,a,l));case"creation":return s(()=>roe(o,a,l));case"dynamic":return soe(o,a,l);case"evaluation":return s(()=>ioe(o,a,l));case"image":return s(()=>uoe(o,a,l));case"graph":return s(()=>ooe(o,a,l));case"logical":return s(()=>coe(o,a,l));case"matrices":return s(()=>doe(o,a,l));case"normalization":return s(()=>hoe(o,a,l));case"ragged":return s(()=>foe(o,a,l));case"reduction":return s(()=>poe(o,a,l));case"slice_join":return s(()=>moe(o,a,l));case"sparse":return s(()=>goe(o,a,l));case"spectral":return s(()=>yoe(o,a,l));case"string":return s(()=>voe(o,a,l));case"transformation":return s(()=>xoe(o,a,l));case"hash_table":return loe(o,a,l,r);case"custom":const u=$4(o.op);if(u&&u.customExecutor)return u.customExecutor(new Kie(o,a,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return xl(i)?i.then(o=>[].concat(o)):[].concat(i)}class ND{constructor(e={},n={},r={},s={},i){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=s,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ID(t,e,n,r){const s=new Set,i=[];let o=null,a=null;const l=new Set,u=new Set(Object.keys(t).map(f=>Qr(f)[0]));r=r||[];const c=new Set(r.map(f=>Qr(f.name)[0])),d=[...e];for(;d.length>0;){const f=d.pop();if((yu(f)||Noe(f)||Ioe(f))&&o==null&&(o=f,a=o.children.map(p=>p.name).filter(p=>s.has(p))),s.add(f.name),n[f.name]==null&&!u.has(f.name)&&!c.has(f.name)){if(f.inputs.length===0){i.push(f.name);continue}f.inputs.forEach(p=>{l.has(p.name)||(l.add(p.name),d.push(p))})}}return{inputs:t,outputs:e,usedNodes:s,missingInputs:i,dynamicNode:o,syncInputs:a}}function boe(t,e){const{usedNodes:n,inputs:r}=e,s=Object.keys(r).map(v=>Qr(v)[0]).map(v=>t.nodes[v]),i=t.initNodes||[],o=v=>n.has(typeof v=="string"?v:v.name);function a(v){return[...new Map(v.map(x=>[x.name,x])).values()]}const l=a([...s,...t.weights,...i]).filter(o),u=a([...l,...Object.values(t.nodes)]).filter(o),c=new Map(u.map(v=>[v.name,v])),d={};for(const v of u){d[v.name]=d[v.name]||0;for(const x of v.children)o(x)||(d[x.name]=Number.POSITIVE_INFINITY),d[x.name]=(d[x.name]||0)+1}const f=Object.entries(d).filter(([,v])=>v===0).map(([v])=>v),p=[...f];for(;f.length>0;){const v=f.pop(),x=c.get(v);for(const b of x.children.filter(o))--d[b.name]===0&&(p.push(b.name),f.push(b.name))}const m=p.map(v=>c.get(v)),y=woe(m,l);return _oe(y,l),y}function woe(t,e){const n=new Map(t.map(o=>[o.name,o])),r=e.map(o=>o.name),s=new Set(r);for(;r.length>0;){const o=r.pop(),a=n.get(o);for(const l of a.children)!n.has(l.name)||s.has(l.name)||(s.add(l.name),r.push(l.name))}return t.filter(o=>s.has(o.name))}class _v extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function _oe(t,e){const n=new Map(t.map((a,l)=>[a.name,l])),r=new Set(e.map(a=>a.name)),s=a=>r.has(typeof a=="string"?a:a.name),i=new Set(t.map(a=>a.name)),o=a=>i.has(typeof a=="string"?a:a.name);for(const a of t){for(const l of a.children.filter(o)){if(!n.has(l.name))throw new _v(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new _v(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!s(a))for(const l of a.inputs){if(!n.has(l.name))throw new _v(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new _v(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function Soe(t){const e=new Map(t.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,r=t.map((a,l)=>yu(a)?n:l),s=a=>{const l=r[e.get(a.name)];return l??-1},i=t.map((a,l)=>a.children.map(s).reduce((u,c)=>Math.max(u,c),r[l])),o=new Map;for(let a=0;a<t.length;++a){const l=i[a];if(l===n)continue;const u=t[a],c=t[l];o.has(c.name)||o.set(c.name,[]),o.get(c.name).push(u)}return o}const koe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Coe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),Toe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function yu(t){return koe.has(t.op)}function Noe(t){return Coe.has(t.op)}function Ioe(t){return Toe.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X0{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new X0(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(i=>i.name).sort(),s=n.map(i=>i.name).sort();return r.join(this.SEPARATOR)+"--"+s.join(this.SEPARATOR)}compile(e,n){const r=ID(e,n,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:i,syncInputs:o}=r;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(s.length>0){const u=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${s}]`)}const a=boe(this.graph,r),l=Soe(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return bn(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const s=r.map(f=>this.graph.nodes[Qr(f)[0]]),i=n.map(f=>Qr(f)[0]),o=new Set(i);let a=i.map(f=>this.graph.nodes[f]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(s,a);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,a),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=te().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const c={},d={};return ee(()=>{const f=new ND(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),p=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(x=>{const[b,_]=Qr(x,f),S=[];S[_]=e[x],p[b]=S,this.keepIntermediateTensors&&(this.clonedTensorsMap[b]=this.cloneTensorList(S))});const m=this.getFrozenTensorIds(p),{orderedNodes:y,nodeLiveUntilMap:v}=u;for(const x of y){if(p[x.name])continue;const b=TD(x,p,f,this._resourceManager);if(xl(b))throw new Error(`The execution of the op '${x.op}' returned a promise. Please use model.executeAsync() instead.`);p[x.name]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[x.name]=this.cloneTensorList(b)),this.checkTensorForDisposalWithNodeLiveUntilInfo(x,p,f,m,o,v.get(x.name))}return this.parent==null&&f.dispose(m),n.map(x=>Un(x,p,f))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(n)}checkTensorForDisposal(e,n,r,s,i,o,a){if(!(yu(n)||o.has(e))){for(const l of r[e])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(yu(l))continue;const u=wD(l.name,r,s);if(u!=null)for(const c of u){if(!c||c.kept||i.has(c.id))continue;const d=a[c.id];d===1?(c.dispose(),delete a[c.id]):d!=null&&a[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,s,i,o){function a(l){return yu(l)||i.has(l.name)}if(!(yu(e)||o==null))for(const l of o){if(a(l))continue;const u=wD(l.name,n,r);for(const c of u)!c||c.kept||s.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,s={},i={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=te().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const o=new ND(this.weightMap,s,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,n,r),l=n.map(f=>Un(f,a,o)),u=l.map(f=>f.id),c=Object.keys(e).map(f=>e[f].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(a).forEach(f=>{f.forEach(p=>{p&&!p.isDisposed&&!d.has(p.id)&&p.dispose()})}),this.parent==null&&o.dispose(d),l}async executeFunctionAsync(e,n,r){const s=e.reduce((i,o,a)=>(i[this.inputs[a].name]=o,i),{});return this._executeAsync(s,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,s){const i=Object.keys(e),o=i.map(S=>this.graph.nodes[Qr(S)[0]]),a=r.map(S=>Qr(S)[0]),l=new Set(a);let u=a.map(S=>this.graph.nodes[S]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:f,syncInputs:p}=ID(e,u,this.weightMap,this._initNodes),m=[...o,...this.graph.weights,...this._initNodes||[]].map(S=>({node:S,contexts:n.currentContext})),y=Object.assign({},this.weightMap);Object.keys(e).forEach(S=>{const[k,T]=Qr(S),$=[];$[T]=e[S],y[k]=$});const v={},x=this.getFrozenTensorIds(y),b={};for(;m.length>0;){const S=this.processStack(o,m,n,y,b,x,l,v,c);await Promise.all(S)}f==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const _=u.filter(S=>!yu(S)&&!Un(S.name,y,n)).map(S=>S.name);if(_.length>0){let S="";throw f!=null&&(S=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${_}] from the provided inputs [${i}]. Consider providing the following inputs: [${d}]. ${S}`)}return y}processStack(e,n,r,s,i,o,a,l,u){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let f="";if(d.node.op==="Enter"&&N("isConstant",d.node,s,r)&&([f]=qo(d.node.name,r)),s[d.node.name]==null){const p=TD(d.node,s,r,this._resourceManager);f||([f]=qo(d.node.name,r));const m=r.currentContext;xl(p)?c.push(p.then(y=>(s[f]=y,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(y)),r.currentContext=m,this.checkTensorForDisposal(f,d.node,s,r,o,a,l),this.processChildNodes(d.node,n,r,s,i,u),y))):(s[f]=p,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(p)),this.checkTensorForDisposal(f,d.node,s,r,o,a,l),this.processChildNodes(d.node,n,r,s,i,u))}else this.processChildNodes(d.node,n,r,s,i,u)}return c}processChildNodes(e,n,r,s,i,o){e.children.forEach(a=>{const[l]=qo(a.name,r);i[l]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(u=>!!Un(u,s,r))&&(i[l]=!0,n.push({contexts:r.currentContext,node:a})):a.inputNames.every(u=>!!Un(u,s,r))&&(i[l]=!0,n.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[s]=Qr(n),i=this.graph.nodes[s];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,a=o.length===r.shape.length&&r.shape.every((l,u)=>o[u]===-1||o[u]===l);O(a,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&O(r.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const s={};for(const i in e){const o=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[i];o!=null?s[o.name]=e[i]:s[i]=e[i]}return s}checkInputs(e){const n=Object.keys(e).filter(r=>{const[s]=Qr(r);return this.graph.nodes[s]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,s;const i=(s=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||s===void 0?void 0:s[n];return i!=null?i.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=Qr(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class $oe{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eoe="?tfjs-format=file",Aoe="model.json";class g2{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=V$){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new $oe}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return xl(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await CB(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(s=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=s,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new X0(_D.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=_D.Instance.transformGraph(e.modelInitializer);this.initializer=new X0(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof gt?[e]:e,r={};return n.forEach((s,i)=>r[this.structuredOutputKeys[i]]=s),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof gt)&&!Array.isArray(e)){const i=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(i!=null)for(const o in i){const a=i[o];a.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let s=0;return this.inputNodes.reduce((i,o)=>{var a,l,u;const c=(u=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[o])===null||u===void 0?void 0:u.resourceId;return c!=null?i[o]=this.resourceIdToCapturedInput[c]:i[o]=e[s++],i},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let s=0;s<r.length;s++){const i=r[s],o=n[i];this.resourceIdToCapturedInput[o.resourceId]=e[s]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Qe(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Ooe(t,e={},n=V$){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Doe(t));const r=new g2(t,e,n);return await r.load(),r}function Poe(t){if(t==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(t instanceof Array){const[r,s]=t;if(!r)throw new Error("modelJSON must be the first element of the array");if(!s||!(s instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in r))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in r))throw new Error("Model JSON is missing 'weightsManifest'");const i=G0(r.weightsManifest),o=wI(r,i,s);e=K0(o)}else if("load"in t)e=t;else if("modelTopology"in t&&"weightSpecs"in t&&"weightData"in t)e=K0(t);else throw new Error("Unknown model format");const n=new g2(e);return n.load(),n}function Doe(t){return t.endsWith("/")||(t=t+"/"),`${t}${Aoe}${Eoe}`}/** @license See the LICENSE file. */const Roe="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Loe=Object.freeze(Object.defineProperty({__proto__:null,GraphModel:g2,deregisterOp:aie,loadGraphModel:Ooe,loadGraphModelSync:Poe,registerOp:oie,version_converter:Roe},Symbol.toStringTag,{value:"Module"})),Foe=aN(Loe),Moe=aN(sie);/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(function(t,e){(function(n,r){r(e,Foe,Moe)})(Sa,function(n,r,s){const i={1:{name:"/m/01g317",id:1,displayName:"person"},2:{name:"/m/0199g",id:2,displayName:"bicycle"},3:{name:"/m/0k4j",id:3,displayName:"car"},4:{name:"/m/04_sv",id:4,displayName:"motorcycle"},5:{name:"/m/05czz6l",id:5,displayName:"airplane"},6:{name:"/m/01bjv",id:6,displayName:"bus"},7:{name:"/m/07jdr",id:7,displayName:"train"},8:{name:"/m/07r04",id:8,displayName:"truck"},9:{name:"/m/019jd",id:9,displayName:"boat"},10:{name:"/m/015qff",id:10,displayName:"traffic light"},11:{name:"/m/01pns0",id:11,displayName:"fire hydrant"},13:{name:"/m/02pv19",id:13,displayName:"stop sign"},14:{name:"/m/015qbp",id:14,displayName:"parking meter"},15:{name:"/m/0cvnqh",id:15,displayName:"bench"},16:{name:"/m/015p6",id:16,displayName:"bird"},17:{name:"/m/01yrx",id:17,displayName:"cat"},18:{name:"/m/0bt9lr",id:18,displayName:"dog"},19:{name:"/m/03k3r",id:19,displayName:"horse"},20:{name:"/m/07bgp",id:20,displayName:"sheep"},21:{name:"/m/01xq0k1",id:21,displayName:"cow"},22:{name:"/m/0bwd_0j",id:22,displayName:"elephant"},23:{name:"/m/01dws",id:23,displayName:"bear"},24:{name:"/m/0898b",id:24,displayName:"zebra"},25:{name:"/m/03bk1",id:25,displayName:"giraffe"},27:{name:"/m/01940j",id:27,displayName:"backpack"},28:{name:"/m/0hnnb",id:28,displayName:"umbrella"},31:{name:"/m/080hkjn",id:31,displayName:"handbag"},32:{name:"/m/01rkbr",id:32,displayName:"tie"},33:{name:"/m/01s55n",id:33,displayName:"suitcase"},34:{name:"/m/02wmf",id:34,displayName:"frisbee"},35:{name:"/m/071p9",id:35,displayName:"skis"},36:{name:"/m/06__v",id:36,displayName:"snowboard"},37:{name:"/m/018xm",id:37,displayName:"sports ball"},38:{name:"/m/02zt3",id:38,displayName:"kite"},39:{name:"/m/03g8mr",id:39,displayName:"baseball bat"},40:{name:"/m/03grzl",id:40,displayName:"baseball glove"},41:{name:"/m/06_fw",id:41,displayName:"skateboard"},42:{name:"/m/019w40",id:42,displayName:"surfboard"},43:{name:"/m/0dv9c",id:43,displayName:"tennis racket"},44:{name:"/m/04dr76w",id:44,displayName:"bottle"},46:{name:"/m/09tvcd",id:46,displayName:"wine glass"},47:{name:"/m/08gqpm",id:47,displayName:"cup"},48:{name:"/m/0dt3t",id:48,displayName:"fork"},49:{name:"/m/04ctx",id:49,displayName:"knife"},50:{name:"/m/0cmx8",id:50,displayName:"spoon"},51:{name:"/m/04kkgm",id:51,displayName:"bowl"},52:{name:"/m/09qck",id:52,displayName:"banana"},53:{name:"/m/014j1m",id:53,displayName:"apple"},54:{name:"/m/0l515",id:54,displayName:"sandwich"},55:{name:"/m/0cyhj_",id:55,displayName:"orange"},56:{name:"/m/0hkxq",id:56,displayName:"broccoli"},57:{name:"/m/0fj52s",id:57,displayName:"carrot"},58:{name:"/m/01b9xk",id:58,displayName:"hot dog"},59:{name:"/m/0663v",id:59,displayName:"pizza"},60:{name:"/m/0jy4k",id:60,displayName:"donut"},61:{name:"/m/0fszt",id:61,displayName:"cake"},62:{name:"/m/01mzpv",id:62,displayName:"chair"},63:{name:"/m/02crq1",id:63,displayName:"couch"},64:{name:"/m/03fp41",id:64,displayName:"potted plant"},65:{name:"/m/03ssj5",id:65,displayName:"bed"},67:{name:"/m/04bcr3",id:67,displayName:"dining table"},70:{name:"/m/09g1w",id:70,displayName:"toilet"},72:{name:"/m/07c52",id:72,displayName:"tv"},73:{name:"/m/01c648",id:73,displayName:"laptop"},74:{name:"/m/020lf",id:74,displayName:"mouse"},75:{name:"/m/0qjjc",id:75,displayName:"remote"},76:{name:"/m/01m2v",id:76,displayName:"keyboard"},77:{name:"/m/050k8",id:77,displayName:"cell phone"},78:{name:"/m/0fx9l",id:78,displayName:"microwave"},79:{name:"/m/029bxz",id:79,displayName:"oven"},80:{name:"/m/01k6s3",id:80,displayName:"toaster"},81:{name:"/m/0130jx",id:81,displayName:"sink"},82:{name:"/m/040b_t",id:82,displayName:"refrigerator"},84:{name:"/m/0bt_c3",id:84,displayName:"book"},85:{name:"/m/01x3z",id:85,displayName:"clock"},86:{name:"/m/02s195",id:86,displayName:"vase"},87:{name:"/m/01lsmm",id:87,displayName:"scissors"},88:{name:"/m/0kmg4",id:88,displayName:"teddy bear"},89:{name:"/m/03wvsk",id:89,displayName:"hair drier"},90:{name:"/m/012xff",id:90,displayName:"toothbrush"}};class o{constructor(l,u){this.modelPath=u||`https://storage.googleapis.com/tfjs-models/savedmodel/${this.getPrefix(l)}/model.json`}getPrefix(l){return l==="lite_mobilenet_v2"?`ssd${l}`:`ssd_${l}`}async load(){this.model=await r.loadGraphModel(this.modelPath);const l=s.zeros([1,300,300,3],"int32"),u=await this.model.executeAsync(l);await Promise.all(u.map(c=>c.data())),u.map(c=>c.dispose()),l.dispose()}async infer(l,u,c){const d=s.tidy(()=>(l instanceof s.Tensor||(l=s.browser.fromPixels(l)),s.expandDims(l))),f=d.shape[1],p=d.shape[2],m=await this.model.executeAsync(d),y=m[0].dataSync(),v=m[1].dataSync();d.dispose(),s.dispose(m);const[x,b]=this.calculateMaxScores(y,m[0].shape[1],m[0].shape[2]),_=s.getBackend();s.getBackend()==="webgl"&&s.setBackend("cpu");const S=s.tidy(()=>{const T=s.tensor2d(v,[m[1].shape[1],m[1].shape[3]]);return s.image.nonMaxSuppression(T,x,u,c,c)}),k=S.dataSync();return S.dispose(),_!==s.getBackend()&&s.setBackend(_),this.buildDetectedObjects(p,f,v,x,k,b)}buildDetectedObjects(l,u,c,d,f,p){const m=f.length,y=[];for(let v=0;v<m;v++){const x=[];for(let T=0;T<4;T++)x[T]=c[4*f[v]+T];const b=x[0]*u,_=x[1]*l,S=x[2]*u,k=x[3]*l;x[0]=_,x[1]=b,x[2]=k-_,x[3]=S-b,y.push({bbox:x,class:i[p[f[v]]+1].displayName,score:d[f[v]]})}return y}calculateMaxScores(l,u,c){const d=[],f=[];for(let p=0;p<u;p++){let m=Number.MIN_VALUE,y=-1;for(let v=0;v<c;v++)l[p*c+v]>m&&(m=l[p*c+v],y=v);d[p]=m,f[p]=y}return[d,f]}async detect(l,u=20,c=.5){return this.infer(l,u,c)}dispose(){this.model!=null&&this.model.dispose()}}n.ObjectDetection=o,n.load=async function(a={}){if(s==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");const l=a.base||"lite_mobilenet_v2",u=a.modelUrl;if(["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(l)===-1)throw new Error(`ObjectDetection constructed with invalid base model ${l}. Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.`);const c=new o(l,u);return await c.load(),c},n.version="2.2.3",Object.defineProperty(n,"__esModule",{value:!0})})})(gC,gC.exports);var zoe=gC.exports;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O4={kernelName:Mm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,Cc(Se(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Boe={kernelName:ch,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=_t(Se(n,"float32")),s=Rn(Ie(je(1),r));return $t(Le(t,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const joe={kernelName:dh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Rn(Ie(_t(Se(n,"float32")),1));return Le(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Voe={kernelName:bc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ke(n.shape,r.shape);return{a:()=>{let a=t;const l=mn(n.shape,s);return l.length>0&&(a=Ae(a,l)),q(a,n.shape)},b:()=>{let a=t;const l=mn(r.shape,s);return l.length>0&&(a=Ae(a,l)),q(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Woe={kernelName:zm,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,s)=>{n[s]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uoe={kernelName:Bm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ot(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Goe={kernelName:jm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ot(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hoe={kernelName:hh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,Rn(Ie(je(1),_t(Se(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Koe={kernelName:fh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Rn(ge(je(1),_t(Se(n,"float32"))));return Le(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qoe={kernelName:gh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ke(n.shape,r.shape);return{a:()=>{const a=ge(_t(n),_t(r));let l=G(t,Le(r,a));const u=mn(n.shape,s);return u.length>0&&(l=Ae(l,u)),q(l,n.shape)},b:()=>{const a=ge(_t(n),_t(r));let l=$t(G(t,Le(n,a)));const u=mn(r.shape,s);return u.length>0&&(l=Ae(l,u)),q(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xoe={kernelName:ph,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,ge(_t(Se(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zoe={kernelName:mh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,Ie(je(1),_t(Se(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yoe(t,e,n,r,s,i){const o=R(t,"dy","avgPool3dGrad"),a=R(e,"input","avgPool3dGrad");let l=o,u=a,c=!1;a.rank===4&&(c=!0,l=q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),u=q(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),O(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),O(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),$r("avgPool3dGrad",s,i);const d={dy:l,input:u},f={filterSize:n,strides:r,pad:s,dimRoundingMode:i},p=V.runKernel(_b,d,f);return c?q(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const Qoe=W({avgPool3dGrad_:Yoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Joe={kernelName:Wm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>Qoe(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eae(t,e,n,r,s){const i=R(t,"dy","avgPoolGrad"),o=R(e,"input","avgPoolGrad");O(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,u=!1;o.rank===3&&(u=!0,a=q(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=q(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),O(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:l,input:a},d={filterSize:n,strides:r,pad:s},f=V.runKernel(wb,c,d);return u?q(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const tae=W({avgPoolGrad_:eae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nae={kernelName:Vm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o}=n;return{x:()=>tae(t,r,s,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rae={kernelName:Um,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,s]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>Ye(t,s,!1,!0),b:()=>Ye(r,t,!0,!1)}:!i&&o?{a:()=>Ye(t,s,!1,!1),b:()=>Ye(t,r,!0,!1)}:i&&!o?{a:()=>Ye(s,t,!1,!0),b:()=>Ye(r,t,!1,!1)}:{a:()=>Ye(s,t,!0,!0),b:()=>Ye(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sae={kernelName:Gm,gradFunc:(t,e,n)=>{const{blockShape:r,crops:s}=n;return{x:()=>ey(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iae={kernelName:nB,gradFunc:(t,e,n)=>{const r=n,s=r.inputShape,i=r.shape,o=Array.from(i);for(let l=s.length-1;l>=0;l--)if(s[l]===i[l])o[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>Ae(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oae={kernelName:yh,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aae={kernelName:vh,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lae={kernelName:xh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=n;return{x:()=>Kn(Qi($a(r,s),zl(r,i)),t,ot(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uae={kernelName:Km,inputsToSave:["x"],gradFunc:O4.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cae={kernelName:qm,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(l=>l.shape),{axis:s}=n,i=Je(s,e[0].shape)[0],o=r.map(l=>l[i]);return Fr(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dae={kernelName:Xm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return O(wl(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>WI(r.shape,t,s,o,a,l),filter:()=>A$(r,t,s.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hae={kernelName:Zm,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>ga(t,s,i,o,a,1,l),filter:()=>A$(t,r,s.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fae(t,e,n,r,s){let i=t;t.rank===4&&(i=q(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=q(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),O(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),O(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),O(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),O(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),O(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:r,pad:s,filterShape:n};return V.runKernel(Nb,a,l)}const pae=W({conv3DBackpropFilter_:fae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mae={kernelName:Ym,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i}=n;O(wl(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=e;return{x:()=>BB(o.shape,t,a,s,i),filter:()=>pae(o,t,a.shape,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gae={kernelName:bh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G($t(Gw(Se(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yae={kernelName:wh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(Hw(Se(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vae={kernelName:Qm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s,exclusive:i,reverse:o}=n;return{x:()=>{const a=qt([s],r.rank);let l=Aw(t,s,i,!o);return a!=null&&(l=st(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xae={kernelName:Jm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:o}=n,a=r??[1,1];O(wl(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return O(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),O(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),O(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),O(Yn(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),$r("depthwiseConv2d",i,o),{x:()=>Aj(l.shape,t,u,s,i,a,o),filter:()=>Ej(l,t,u.shape,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bae={kernelName:eg,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,i={x:r,filter:s,dy:t},o={x:r,filter:s,dy:t};return{x:()=>V.runKernel(B0,i,n),filter:()=>V.runKernel(j0,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wae={kernelName:Sh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>V.runKernel(Mb,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ae={kernelName:kh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=G(jr($t(_t(n))),2/Math.sqrt(Math.PI));return{x:()=>G(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sae={kernelName:Ch,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kae={kernelName:ng,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>q(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cae={kernelName:Th,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,jr(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tae={kernelName:Nh,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nae={kernelName:Ih,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ke(n.shape,r.shape);return{a:()=>{const a=Le(t,Se(r,"float32")),l=mn(n.shape,s);return l.length>0?q(Ae(a,l),n.shape):a},b:()=>{let a=G(t,Se(n,"float32"));const l=mn(r.shape,s);l.length>0&&(a=q(Ae(a,l),r.shape));const u=_t(r);return $t(Le(a,Se(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iae={kernelName:rg,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[s,i,o,a]=e,l=a??je(1),u=mn(i.shape,s.shape),c=[];if(i.rank===1){for(let S=0;S<s.shape.length-1;++S)c.push(s.shape[S]);c.push(1)}const d=Ie(s,i),f=G(t,l),p=Vw(ge(o,je(r))),m=G(G(G(p,p),p),je(-.5));return{x:()=>i.rank===1?q(G(G(t,Ts(q(p,[1,1,1,i.shape[0]]),c)),l),s.shape):q(G(G(t,p),l),s.shape),mean:()=>{let S=G(G(p,je(-1)),f);return i.rank===1&&(S=Ae(S,u)),q(S,i.shape)},variance:()=>{let S=G(G(m,d),f);return i.rank===1&&(S=Ae(S,u)),q(S,i.shape)},scale:()=>{const S=G(d,p);let k=G(t,S);return i.rank===1&&(k=Ae(k,u)),q(k,i.shape)},offset:()=>{let S=t;return i.rank===1&&(S=Ae(S,u)),q(S,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ae={kernelName:sg,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,s]=e,{axis:i,batchDims:o}=n,a=Je(i,r.shape)[0],l=(u,c,d)=>()=>{const f=u.shape,p=c.size,m=f.slice(0,a),y=m.length,v=f.slice(i,f.length).slice(1),x=v.length,b=$D(0,y),_=$D(y+1,y+1+x),S=ED([m,[p],v]),k=q(d,S),T=q(c,[p]),$=ED([[y],b,_]),A=st(k,$);let D=Qw(A,T,u.shape[a]);const F=Ml($);return D=st(D,F),D};if(o===1){const u=r.shape[0],c=r.split(u,0);return{x:()=>Vr(c.map((p,m)=>l(p,s.slice(m,1),t.slice(m,1))())).reshape(r.shape),indices:()=>s}}else return{x:l(r,s,t),indices:()=>s}}};function $D(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function ED(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eae={kernelName:$h,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>ot(n),b:()=>ot(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aae={kernelName:Eh,gradFunc:t=>({x:()=>Se(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oae={kernelName:Ah,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pae={kernelName:Oh,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dae={kernelName:Ph,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rae={kernelName:og,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:s}=n,i=Kr(r,0);return{x:()=>Kn(i,t,G(t,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lae={kernelName:Rh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,ge(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fae={kernelName:Dh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,Se(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mae={kernelName:rB,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;return{logits:()=>{const o=jr(r);return Ie(t,G(Ae(t,s,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zae(t,e,n,r=5,s=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:r,bias:s,alpha:i,beta:o};return V.runKernel(Hb,a,l)}const Bae=W({localResponseNormalizationBackprop_:zae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jae={kernelName:hg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>Bae(r,s,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4(t,e,n,r){return e.rank<n.rank&&(e=q(e,sn(e.shape,r))),t.rank<n.rank&&(t=q(t,sn(t.shape,r))),{x:()=>G(t,Se(gi(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AD={kernelName:fg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:s}=r,i=e[0],o=e[1],a=Je(s,i.shape),l=P4(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vae={kernelName:Lh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>G(t,Se($a(n,r),"float32")),b:()=>G(t,Se(Bd(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wae(t,e,n,r,s,i,o){const a=R(t,"dy","maxPool3dGrad"),l=R(e,"input","maxPool3dGrad"),u=R(n,"output","maxPool3dGrad");let c=a,d=l,f=u,p=!1;l.rank===4&&(p=!0,c=q(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=q(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),f=q(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),O(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),O(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),O(f.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${f.rank}.`),$r("maxPool3dGrad",i,o);const m={dy:c,input:d,output:f},y={filterSize:r,strides:s,pad:i,dimRoundingMode:o},v=V.runKernel(qb,m,y);return p?q(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const Uae=W({maxPool3dGrad_:Wae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gae={kernelName:mg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>Uae(t,r,s,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hae(t,e,n,r,s,i,o){const a=R(t,"dy","maxPoolGrad"),l=R(e,"input","maxPoolGrad"),u=R(n,"output","maxPoolGrad");O(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),O(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),O(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),$r("maxPoolGrad",i,o);const c={dy:a,input:l,output:u},d={filterSize:r,strides:s,pad:i,dimRoundingMode:o};return V.runKernel(Kb,c,d)}const Kae=W({maxPoolGrad_:Hae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qae={kernelName:pg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>Kae(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xae={kernelName:gg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n,i=Je(s,r.shape),a=Fn(r.shape,i)[1],l=oe(a);return{x:()=>{const c=r.shape.slice();i.forEach(p=>{c[p]=1});const d=q(t,c);return Le(G(d,Dr(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zae={kernelName:yg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:s}=r,[i,o]=e,a=Je(s,i.shape),l=P4(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yae={kernelName:Fh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>G(t,Se(zl(n,r),"float32")),b:()=>G(t,Se(Kr(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qae={kernelName:vg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>it(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jae={kernelName:Mh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ke(n.shape,r.shape);return{a:()=>{const a=mn(n.shape,s);return a.length>0?q(Ae(t,a),n.shape):t},b:()=>{const a=G(t,$t(cf(Le(n,r)))),l=mn(r.shape,s);return l.length>0?q(Ae(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ele={kernelName:zh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ke(n.shape,r.shape);return{a:()=>{const a=G(t,Se(r,"float32")),l=mn(n.shape,s);return l.length>0?q(Ae(a,l),n.shape):a},b:()=>{const a=G(t,Se(n,"float32")),l=mn(r.shape,s);return l.length>0?q(Ae(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tle={kernelName:xg,gradFunc:t=>({x:()=>$t(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nle={kernelName:_g,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>fn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rle={kernelName:wg,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sle={kernelName:Sg,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return Ds(t,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OD={kernelName:kg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>it(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ile={kernelName:Bh,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,s]=e,i=n,o=r,a=Ke(i.shape,o.shape);return{a:()=>{const c=Se(o,"float32");let d=G(t,G(c,Po(i,Ie(c,je(1)))));const f=mn(i.shape,a);return f.length>0&&(d=Ae(d,f)),q(d,i.shape)},b:()=>{const c=Kr(i,0),d=Kn(c,cs(i),ot(i));let f=G(t,G(s,d));const p=mn(o.shape,a);return p.length>0&&(f=Ae(f,p)),q(f,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ole={kernelName:Cg,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,s=Kr(n,0);return{x:()=>Kn(s,t,G(t,r)),alpha:()=>{let i=Kn(s,ot(t),G(t,n));const o=mn(r.shape,t.shape);return o.length>0&&(i=Ae(i,o)),q(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ale(t,e,n){const r=t.shape.slice();r[n]=1;const s=q(e,r),i=cm(t,n,!0,!1),o=cm(t,n,!0,!0),a=G(i,o);return G(s,a)}function lle(t,e,n){const r=t.shape.length,s=r-n.length,i=qt(n,r);let o=t;i!=null&&(o=st(t,i));const a=o.shape.slice(),u=a.splice(r-n.length,n.length).reduce((f,p)=>f*p,1);a.push(u);const c=o.reshape(a);let d=ale(c,e,s);if(d=d.reshape(o.shape),i!=null){const f=Ml(i);d=st(d,f)}return d}const ule={kernelName:Tg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;let i=[];return s==null?i=r.shape.map((o,a)=>a):typeof s=="number"?i=[s]:i=s,{x:()=>lle(r,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cle={kernelName:_h,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ke(n.shape,r.shape);return{a:()=>{const a=Le(t,Se(r,"float32")),l=mn(n.shape,s);return l.length>0?q(Ae(a,l),n.shape):a},b:()=>{let a=G(t,Se(n,"float32"));const l=mn(r.shape,s);l.length>0&&(a=q(Ae(a,l),r.shape));const u=_t(r);return $t(Le(a,Se(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dle={kernelName:jh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,$t(_t(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hle={kernelName:Wh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=G(zl(n,6),Cc(n));return{x:()=>G(t,Se(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fle={kernelName:Vh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,Se(Cc(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ple={kernelName:Ng,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mle={kernelName:$g,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>V.runKernel(ow,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gle={kernelName:Ig,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>V.runKernel(iw,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yle={kernelName:Eg,gradFunc:(t,e,n)=>{const{dims:r}=n,s=Je(r,t.shape);return{x:()=>Ps(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vle={kernelName:Uh,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xle={kernelName:Gh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$t(Le(t,G(Po(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ble={kernelName:Ag,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Se(ot(n),"float32"),t:()=>G(t,Se(n,t.dtype)),e:()=>G(t,Se(Yg(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wle={kernelName:Hh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Kr(n,je(0)),s=je(h1),i=je(f1),o=G(t,i),a=G(G(t,s),jr(Se(n,"float32")));return Kn(r,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _le={kernelName:Zh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,G(n,Ie(je(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sle={kernelName:Xh,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle={kernelName:Kh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(Hg(Se(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cle={kernelName:qh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(Ew(Se(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tle={kernelName:Og,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:s,size:i}=n,o=r.shape,[a,l]=c1(r,s,i),u=[];for(let c=0;c<t.rank;c++)u.push([a[c],o[c]-a[c]-l[c]]);return{x:()=>Ea(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nle={kernelName:Lg,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:s}=n,i=!0,o=G(t,r);return{logits:()=>Ie(o,G(Ae(o,[s],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile={kernelName:Yh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,Xi(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PD={kernelName:Dg,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:s}=n;return{x:()=>Gg(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DD={kernelName:Rg,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>rn(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $le={kernelName:Qh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,G(Rn(Se(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ele={kernelName:mw,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,G(Se(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ale={kernelName:Jh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=je(2);return{a:()=>G(t,G(s,Ie(n,r))),b:()=>G(t,G(s,Ie(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole={kernelName:sf,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ple={kernelName:ef,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ke(n.shape,r.shape);return{a:()=>{let a=t;const l=mn(n.shape,s);return l.length>0&&(a=Ae(a,l)),q(a,n.shape)},b:()=>{let a=t;const l=mn(r.shape,s);return l.length>0&&(a=Ae(a,l)),q($t(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dle={kernelName:Pg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,s=r.shape.slice(),{axis:i}=n;Je(i,r.shape).forEach(u=>{s[u]=1});const a=q(t,s),l=G(a,Dr(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rle={kernelName:tf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,_t(Hg(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lle={kernelName:nf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(Ie(je(1),_t(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fle={kernelName:rf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:s}=n;return{x:()=>{let o=ot(r);if(r.rank===1)for(let a=0;a<s[0];++a)o=ge(o,it(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)o=ge(o,it(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)o=ge(o,it(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)for(let c=0;c<s[3];++c)o=ge(o,it(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mle={kernelName:Ru,gradFunc:(t,e,n)=>{const r=n,{perm:s}=r,i=Ml(s);return{x:()=>st(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zle={kernelName:Mg,gradFunc:(t,e,n)=>{const r=n,{axis:s}=r;return{value:()=>Vr(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ble={kernelName:zg,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>jle(t,n)}}};function jle(t,e){const n=Mo(e,ot(e)),r=df(t,n);let s=$a(e,je(0,"int32"));const i=r.rank-s.rank;for(let a=0;a<i;++a)s=lr(s,a+1);s=Qi(s,Dr(r.shape,"bool"));const o=ot(r);return Kn(s,r,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vle={kernelName:Bg,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wle=[O4,Boe,joe,Voe,Woe,Uoe,Goe,Hoe,Koe,qoe,Xoe,Zoe,Joe,nae,rae,sae,iae,oae,aae,lae,uae,cae,hae,dae,mae,gae,yae,vae,xae,bae,cle,wae,_ae,Sae,kae,Cae,Nae,Tae,Iae,$ae,Eae,Aae,Oae,Pae,Dae,Rae,Lae,Fae,Mae,jae,AD,AD,Vae,Gae,qae,Xae,Zae,Yae,Qae,Jae,ele,tle,nle,rle,sle,OD,OD,ile,ole,ule,dle,hle,fle,ple,mle,gle,yle,vle,xle,ble,wle,_le,Sle,kle,Cle,Tle,Nle,Ile,PD,PD,DD,DD,$le,Ale,Ele,Ole,Ple,Dle,Rle,Lle,Fle,Mle,zle,Ble,Vle];for(const t of Wle)sB(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.abs=function(){return this.throwIfDisposed(),dn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.acos=function(){return this.throwIfDisposed(),kI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.acosh=function(){return this.throwIfDisposed(),CI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.add=function(t){return this.throwIfDisposed(),ge(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.all=function(t,e){return this.throwIfDisposed(),Nw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.any=function(t,e){return this.throwIfDisposed(),am(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.argMax=function(t){return this.throwIfDisposed(),Qu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.argMin=function(t){return this.throwIfDisposed(),TI(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asScalar=function(){return this.throwIfDisposed(),O(this.size===1,()=>"The array must have only 1 element."),q(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asType=function(t){return this.throwIfDisposed(),Se(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as1D=function(){return this.throwIfDisposed(),q(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as2D=function(t,e){return this.throwIfDisposed(),q(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),q(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),q(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as5D=function(t,e,n,r,s){return this.throwIfDisposed(),q(this,[t,e,n,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asin=function(){return this.throwIfDisposed(),NI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asinh=function(){return this.throwIfDisposed(),II(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atan=function(){return this.throwIfDisposed(),$I(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atan2=function(t){return this.throwIfDisposed(),EI(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atanh=function(){return this.throwIfDisposed(),AI(this)};ce().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),Ug(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Gg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.batchNorm=function(t,e,n,r,s){return this.throwIfDisposed(),of(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Lu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cast=function(t){return this.throwIfDisposed(),Se(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.ceil=function(){return this.throwIfDisposed(),MI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Br(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof gt&&(t=[t]),rn([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv1d=function(t,e,n,r,s,i){return this.throwIfDisposed(),Iw(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv2dTranspose=function(t,e,n,r,s){return this.throwIfDisposed(),$w(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),ga(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cos=function(){return this.throwIfDisposed(),Hg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cosh=function(){return this.throwIfDisposed(),Ew(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),cm(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Aw(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),HI(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.depthwiseConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),af(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.dilation2d=function(t,e,n,r,s){return this.throwIfDisposed(),KI(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.divNoNan=function(t){return this.throwIfDisposed(),qI(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.div=function(t){return this.throwIfDisposed(),Le(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.dot=function(t){return this.throwIfDisposed(),XI(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.elu=function(){return this.throwIfDisposed(),lf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.equal=function(t){return this.throwIfDisposed(),gi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.erf=function(){return this.throwIfDisposed(),Ow(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),YI(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.exp=function(){return this.throwIfDisposed(),jr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.expandDims=function(t){return this.throwIfDisposed(),lr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.expm1=function(){return this.throwIfDisposed(),QI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.fft=function(){return this.throwIfDisposed(),iy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.flatten=function(){return this.throwIfDisposed(),q(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.floor=function(){return this.throwIfDisposed(),cf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.floorDiv=function(t){return this.throwIfDisposed(),Tw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.gather=function(t,e,n){return this.throwIfDisposed(),df(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.greaterEqual=function(t){return this.throwIfDisposed(),$a(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.greater=function(t){return this.throwIfDisposed(),Kr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.ifft=function(){return this.throwIfDisposed(),Ud(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.irfft=function(){return this.throwIfDisposed(),qw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isFinite=function(){return this.throwIfDisposed(),JI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isInf=function(){return this.throwIfDisposed(),e$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isNaN=function(){return this.throwIfDisposed(),t$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.leakyRelu=function(t){return this.throwIfDisposed(),qg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.lessEqual=function(t){return this.throwIfDisposed(),zl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.less=function(t){return this.throwIfDisposed(),Bd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),n$(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSigmoid=function(){return this.throwIfDisposed(),r$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSoftmax=function(t){return this.throwIfDisposed(),Rw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Zg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.log=function(){return this.throwIfDisposed(),cs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.log1p=function(){return this.throwIfDisposed(),Xg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Qi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalNot=function(){return this.throwIfDisposed(),Yg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalOr=function(t){return this.throwIfDisposed(),Lw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalXor=function(t){return this.throwIfDisposed(),s$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Ye(this,t,e,n)};ce().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),Qg(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.max=function(t,e){return this.throwIfDisposed(),Es(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.maximum=function(t){return this.throwIfDisposed(),Mo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mean=function(t,e){return this.throwIfDisposed(),Ut(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.min=function(t,e){return this.throwIfDisposed(),zd(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.minimum=function(t){return this.throwIfDisposed(),Sl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),o$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mod=function(t){return this.throwIfDisposed(),a$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mul=function(t){return this.throwIfDisposed(),G(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.neg=function(){return this.throwIfDisposed(),$t(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.norm=function(t,e,n){return this.throwIfDisposed(),uf(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.notEqual=function(t){return this.throwIfDisposed(),tc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),jd(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.onesLike=function(){return this.throwIfDisposed(),ds(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.pad=function(t,e){return this.throwIfDisposed(),Ea(this,t,e)};ce().prototype.pool=function(t,e,n,r,s,i){return this.throwIfDisposed(),l$(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.pow=function(t){return this.throwIfDisposed(),Po(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.prelu=function(t){return this.throwIfDisposed(),ty(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.prod=function(t,e){return this.throwIfDisposed(),u$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reciprocal=function(){return this.throwIfDisposed(),x$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.relu=function(){return this.throwIfDisposed(),io(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.relu6=function(){return this.throwIfDisposed(),Bw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reshapeAs=function(t){return this.throwIfDisposed(),q(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reshape=function(t){return this.throwIfDisposed(),q(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),Rj(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),Lj(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reverse=function(t){return this.throwIfDisposed(),Ps(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.rfft=function(){return this.throwIfDisposed(),oy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.round=function(){return this.throwIfDisposed(),jw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.rsqrt=function(){return this.throwIfDisposed(),Vw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.selu=function(){return this.throwIfDisposed(),Ww(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.separableConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),Uw(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sigmoid=function(){return this.throwIfDisposed(),Xi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sign=function(){return this.throwIfDisposed(),b$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sin=function(){return this.throwIfDisposed(),Gw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sinh=function(){return this.throwIfDisposed(),Hw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.slice=function(t,e){return this.throwIfDisposed(),it(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.softmax=function(t){return this.throwIfDisposed(),sy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.softplus=function(){return this.throwIfDisposed(),Sc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ey(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.split=function(t,e){return this.throwIfDisposed(),Fr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sqrt=function(){return this.throwIfDisposed(),Rn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.square=function(){return this.throwIfDisposed(),_t(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Xw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.squeeze=function(t){return this.throwIfDisposed(),jl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof gt?[this,t]:[this,...t];return Vr(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.step=function(t){return this.throwIfDisposed(),Cc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.stridedSlice=function(t,e,n,r,s,i,o,a){return this.throwIfDisposed(),w$(this,t,e,n,r,s,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sub=function(t){return this.throwIfDisposed(),Ie(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sum=function(t,e){return this.throwIfDisposed(),Ae(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tan=function(){return this.throwIfDisposed(),_$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tanh=function(){return this.throwIfDisposed(),_l(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tile=function(t){return this.throwIfDisposed(),Ts(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toBool=function(){return this.throwIfDisposed(),Se(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toFloat=function(){return this.throwIfDisposed(),Se(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toInt=function(){return this.throwIfDisposed(),Se(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.topk=function(t,e){return this.throwIfDisposed(),C$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.transpose=function(t){return this.throwIfDisposed(),st(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unique=function(t){return this.throwIfDisposed(),T$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Qw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unstack=function(t){return this.throwIfDisposed(),Ds(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.where=function(t,e){return this.throwIfDisposed(),Kn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.zerosLike=function(){return this.throwIfDisposed(),ot(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class go extends Error{constructor(e){super(e),Object.setPrototypeOf(this,go.prototype)}}class ui extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ui.prototype)}}class X extends Error{constructor(e){super(e),Object.setPrototypeOf(this,X.prototype)}}class Ze extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ze.prototype)}}class y2 extends Error{constructor(e){super(e),Object.setPrototypeOf(this,y2.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class D4{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ic(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function yo(t,e){if(!t)throw new y2(e)}function RD(t,e){let n=0;for(const r of t)r===e&&n++;return n}function Pr(t){return t.length===1?t[0]:t}function vt(t){return Array.isArray(t)?t:[t]}function Zo(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function vu(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let qs={};function v2(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function ZC(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>ZC(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:ZC(r))}}}function cy(t,e={},n={},r="object",s=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in qs)o=qs[i];else if(o=e[i],o==null)throw new X(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new X(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in qs?[a,l]=qs.className:o in e&&([a,l]=e[o]),a==null)throw new X(`Unknown ${r}: ${o}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const p of Object.keys(qs))u[p]=qs[p];for(const p of Object.keys(n))u[p]=n[p];const c=i.config;c.customObjects=u;const d=Object.assign({},qs);for(const p of Object.keys(n))qs[p]=n[p];ZC(i.config);const f=l(a,i.config,n,s);return qs=Object.assign({},d),f}else{const u=Object.assign({},qs);for(const d of Object.keys(n))qs[d]=n[d];const c=new a(i.config);return qs=Object.assign({},u),c}}}function Ule(t,e){return t<e?-1:t>e?1:0}function Sv(t,e){return-1*Ule(t,e)}function dl(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function Gle(t){if(t==null)throw new X(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Nc(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new X(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function x2(t,e,n=0,r=1/0){return yo(n>=0),yo(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(s=>typeof s===e)}function Pn(t,e){Array.isArray(t)?(O(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>Pn(n,`element ${r+1} of ${e}`))):O(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${R4(t)}.`)}function R4(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>R4(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function Hle(t,e,n){let r=n!=null?n():xr(),s;return(...o)=>{const a=n!=null?n():xr();return a-r<e||(r=a,s=t(...o)),s}}function L4(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Kle=0;function F4(){return Kle++}const kv={};function p1(t=""){return t in kv||(kv[t]=0),kv[t]+=1,t+kv[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const qle=["channelsFirst","channelsLast"],Xle=["nearest","bilinear"],Zle=["valid","same","causal"],Yle=["max","avg"],Qle=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Xc=new Map;function an(t){Nc(qle,"DataFormat",t)}function Jle(t){Nc(Xle,"InterpolationFormat",t)}function Bs(t){Nc(Zle,"PaddingMode",t)}function M4(t){Nc(Yle,"PoolMode",t)}const Op=[],LD="/";function Fu(t,e){Op.push(t);try{const n=e();return Op.pop(),n}catch(n){throw Op.pop(),n}}function eue(){return Op.length===0?"":Op.join(LD)+LD}function z4(t){if(!j4(t))throw new Error("Not a valid tensor name: '"+t+"'");return eue()+t}function B4(t){if(!j4(t))throw new Error("Not a valid tensor name: '"+t+"'");Xc.has(t)||Xc.set(t,0);const e=Xc.get(t);if(Xc.set(t,Xc.get(t)+1),e>0){const n=`${t}_${e}`;return Xc.set(n,1),n}else return t}const tue=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function j4(t){return!!t.match(tue)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nue(t){return t===parseInt(t.toString(),10)}function hl(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let s=e;s<n;++s)r*=t[s];return r}function Gd(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function kl(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function Ji(t,e){if(e<t)throw new X(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let MS;function wn(){return MS==null&&(MS=xI().epsilon()),MS}function eo(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Io(t,e){return Se(t,e)}function dy(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),q(t,n)}function rue(t,e){return ee(()=>{if(t.shape.length!==2)throw new X(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=dy(t,1);return YC(n,[1,e,1])})}function sue(t){const e=[hl(t.shape)];return q(t,e)}function iue(t){if(t.rank<=1)throw new X(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],hl(t.shape,1)];return q(t,e)}function Mu(t,e,n){return ee(()=>{switch(t.rank){case 1:return ny(t,e,n);case 2:return Kw(t,[e,0],[n,t.shape[1]]);case 3:return ry(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Wd(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return it(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return it(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new X(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function zS(t,e,n){return ee(()=>{switch(t.rank){case 1:return ny(t,e,n);case 2:return Kw(t,[0,e],[t.shape[0],n]);case 3:return ry(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Wd(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new X(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Cv(t,e,n,r){return ee(()=>{switch(t.rank){case 1:return ny(t,e,n);case 2:switch(r){case 1:return Mu(t,e,n);case 2:return zS(t,e,n);default:throw new X(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Mu(t,e,n);case 2:return ry(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return zS(t,e,n);default:throw new X(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Mu(t,e,n);case 2:return Wd(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Wd(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return zS(t,e,n);default:throw new X(`The axis is not within the rank of the tensor ${r}`)}default:throw new X(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function b2(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),rn(t,e)}function FD(t,e){switch(t.rank){case 1:return zI([t,e]);case 2:return BI([t,e],0);case 3:return jI([t,e],0);case 4:return VI([t,e],0);default:throw new X(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function YC(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new X(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Ts(t,e)}function m1(t,e=0,n=1,r,s){return zw(t,e,n,r,s)}function $o(t,e,n,r){if(t.rank<2||e.rank<2)throw new Ze(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(s!==i)throw new Ze(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return DC({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?QC(t.rank,r,eo()):null,activation:n});{const s=t.shape.slice(),i=s.pop();t=q(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),u=[...o,a],c=Array.from({length:e.rank},(m,y)=>y===0?e.rank-2:y<=e.rank-2?y-1:y);e=q(st(e,c),[l,-1]);const d=[...s,...u];return q(DC({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?QC(t.rank,r,eo()):null,activation:n}),d)}}function V4(t,e,n){return ee(()=>(Array.isArray(e)?e=ur(e,"int32"):e=Se(e,"int32"),df(t,e,n)))}function hy(t){return G(t,t)}function QC(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new X(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?q(e,[1,r[0],1,1,1]):q(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?q(e,[1,1,1,1,r[0]]):q(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?q(e,[1,r[0],1,1]):q(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?q(e,[1,1,1,r[0]]):q(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?q(e,[1,r[0],1]):q(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?q(e,[1,1,r[0]]):q(e,[1].concat(r))}else if(t<3)return e;throw new X(`Unsupported input rank by biasAdd: ${e.rank}`)}function oo(t,e,n){return ee(()=>(n==null&&(n=eo()),an(n),ge(t,QC(t.rank,e,n))))}function oue(t,e=1){if(e!==1)throw new Ze(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return lf(t)}function aue(t){return ee(()=>Le(t,ge(dn(t),1)))}function W4(t,e,n,r){return ee(()=>$$(t,e,n,r))}function lue(t){return ee(()=>{const e=ge(.5,G(.2,t));return Br(e,0,1)})}function fy(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const uue=["fanIn","fanOut","fanAvg"],cue=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function due(t){Nc(uue,"FanMode",t)}function hue(t){Nc(cue,"Distribution",t)}class Si extends Tc{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class U4 extends Si{apply(e,n){return fn(e,n)}}U4.className="Zeros";ye(U4);class w2 extends Si{apply(e,n){return Dr(e,n)}}w2.className="Ones";ye(w2);class G4 extends Si{constructor(e){if(super(),typeof e!="object")throw new X(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new X(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return ee(()=>G(je(this.value),Dr(e,n)))}getConfig(){return{value:this.value}}}G4.className="Constant";ye(G4);class H4 extends Si{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Bl(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}H4.className="RandomUniform";ye(H4);class K4 extends Si{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ze(`randomNormal does not support dType ${n}.`);return m1(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}K4.className="RandomNormal";ye(K4);class q4 extends Si{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ze(`truncatedNormal does not support dType ${n}.`);return Yw(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}q4.className="TruncatedNormal";ye(q4);class X4 extends Si{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return ee(()=>{if(e.length!==2||e[0]!==e[1])throw new X("Identity matrix initializer can only be used for 2D square matrices.");return G(this.gain,Pw(e[0]))})}getConfig(){return{gain:this.gain}}}X4.className="Identity";ye(X4);function fue(t,e="channelsLast"){let n,r;if(an(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const s=hl(t,2);n=t[1]*s,r=t[0]*s}else if(e==="channelsLast"){const s=hl(t,0,t.length-2);n=t[t.length-2]*s,r=t[t.length-1]*s}}else{const s=hl(t);n=Math.sqrt(s),r=Math.sqrt(s)}return[n,r]}class hs extends Si{constructor(e){if(super(),e.scale<0)throw new X(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,due(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,hue(this.distribution),this.seed=e.seed}apply(e,n){const r=fue(e),s=r[0],i=r[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,s):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(s+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ze(`${this.getClassName()} does not support dType ${n}.`);return Yw(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Bl(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}hs.className="VarianceScaling";ye(hs);class _2 extends hs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return hs.className}}_2.className="GlorotUniform";ye(_2);class S2 extends hs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return hs.className}}S2.className="GlorotNormal";ye(S2);class k2 extends hs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return hs.className}}k2.className="HeNormal";ye(k2);class C2 extends hs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return hs.className}}C2.className="HeUniform";ye(C2);class T2 extends hs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return hs.className}}T2.className="LeCunNormal";ye(T2);class N2 extends hs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return hs.className}}N2.className="LeCunUniform";ye(N2);class Z4 extends Si{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return ee(()=>{if(e.length<2)throw new Ze("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=oe(e.slice(0,-1)),s=e[e.length-1],i=r*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(s,r),Math.min(s,r)],a=m1(o,0,1,n,this.seed),l=P$.qr(a,!1);let u=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return u=G(u,d.sign()),r<s&&(u=u.transpose()),G(je(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}Z4.className="Orthogonal";ye(Z4);const MD={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function zD(t,e={}){return cy(t,Ss.getMap().classNameMap,e,"initializer")}function Gt(t){return v2(t)}function zt(t){if(typeof t=="string"){const e=t in MD?MD[t]:t;if(e==="GlorotNormal")return new S2;if(e==="GlorotUniform")return new _2;if(e==="HeNormal")return new k2;if(e==="HeUniform")return new C2;if(e==="LeCunNormal")return new T2;if(e==="LeCunUniform")return new N2;{const n={};return n.className=e,n.config={},zD(n)}}else return t instanceof Si?t:zD(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JC(t){return Array.isArray(t)&&Array.isArray(t[0])}function Z0(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function We(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new X(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function dt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new X(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Y0(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const BD="Variable";class pue{constructor(e,n="float32",r=BD,s=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=F4(),r=r??BD,this.originalName=z4(r),this.name=B4(this.originalName),this.trainable_=s,this.constraint=i,this.val=N$(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),mue(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function mue(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function eT(t){return t.map(e=>e.read())}function I2(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _n{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Ro{constructor(e,n,r,s,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=s,this.callArgs=i,this.outputTensorIndex=a,this.id=F4(),o!=null&&(this.originalName=z4(o),this.name=B4(this.originalName)),this.rank=n.length}}let gue=0;class g1{constructor(e,n){this.callArgs=n,this.id=gue++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let yue=0,tt=class extends Tc{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=yue++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=Zo(r)+"_"+p1(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new ui(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new X(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Pr(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Pr(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new go(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new go(`Layer ${this.name} is not connected, no input to return.`);return Pr(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new go(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new go(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Pr(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=vt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=vt(this.inputSpec);if(n.length!==r.length)throw new X(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let s=0;s<n.length;s++){const i=n[s],o=r[s];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new X(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new X(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new X(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new X(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const u in o.axes){const c=Number(u),d=o.axes[u],f=c>=0?l[c]:l[l.length+c];if(d!=null&&[d,null].indexOf(f)===-1)throw new X(`Input ${s} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${d} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const u=o.shape[l],c=i.shape[l];if(u!=null&&c!=null&&u!==c)throw new X(`Input ${s} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=vt(e),s=bue(e),i=wue(e);if(s===i)throw new X("Arguments to apply() must be all SymbolicTensors or all Tensors");return Fu(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of vt(e))o.push(a.shape);this.build(Pr(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=vt(o),l=[];for(let u of a)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(o=Pr(l),this.activityRegularizer!=null)throw new Ze("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=vue(e),a=this.computeOutputShape(o);let l;const u=xue(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((c,d)=>new Ro(u,c,this,vt(e),n,this.name,d)):l=new Ro(u,a,this,vt(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new Ze("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new go(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new go(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new ui(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Y0(this.weights)}build(e){this.built=!0}getWeights(e=!1){return eT(e?this.trainableWeights:this.weights)}setWeights(e){ee(()=>{const n=this.weights;if(n.length!==e.length)throw new X(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],s=eT(n);for(let i=0;i<s.length;++i){const o=s[i],a=n[i],l=e[i];if(!nt(o.shape,l.shape))throw new X(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}I2(r)})}addWeight(e,n,r,s,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new X(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():zt("zeros"));const u=s.apply(n,r),c=new pue(u,r,e,o,a);return u.dispose(),i!=null&&this.addLoss(()=>i.apply(c.read())),o==null&&(o=!0),o?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=vt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,r){if(!this.supportsMasking)return;const s=this.computeMask(e,r),i=vt(n),o=vt(s);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,r,s,i,o,a=null){const l=vt(e);n=vt(n),r=vt(r),s=vt(s),i=Z0(i),o=Z0(o);const u=[],c=[],d=[];for(const f of l)u.push(f.sourceLayer),c.push(f.nodeIndex),d.push(f.tensorIndex);new g1({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:s,inputShapes:i,outputShapes:o},a);for(let f=0;f<n.length;f++)n[f].sourceLayer=this,n[f].nodeIndex=this.inboundNodes.length-1,n[f].tensorIndex=f}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function vue(t){t=vt(t);const e=[];for(const n of t)e.push(n.shape);return Pr(e)}function xue(t){return"float32"}function Y4(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let i=0;i<r.inboundLayers.length;i++){const o=r.inputTensors[i],a=r.inboundLayers[i],l=r.nodeIndices[i],u=Y4(o,a,l);for(const c of u)s.indexOf(c)===-1&&s.push(c)}return s}}}function bue(t){let e=!0;for(const n of vt(t))if(!(n instanceof Ro)){e=!1;break}return e}function wue(t){let e=!0;for(const n of vt(t))if(n instanceof Ro){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class py extends tt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:p1("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new X("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new X("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new X("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const s=new Ro(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new g1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new X(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}py.className="InputLayer";ye(py);function _ue(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new X("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new py({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sue(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Se(e,t.dtype)}catch{throw new X(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class el{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof el)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=Sue(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new X(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Ro){if(this.id2Value[e.id]==null)throw new X(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new X(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Ro){if(this.id2Value[e.id]==null)throw new X(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new X(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Qe(this.id2Mask)}}const Q0=new D4,J0=new D4;function kue(t){Q0!=null&&Q0.setMaxEntries(t),J0!=null&&J0.setMaxEntries(t)}function yp(t,e,n,r){const s=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(m=>m.name),l=[],u=e.names();for(const m of a)u.indexOf(m)!==-1?l.push(e.getValue(m)):l.push(null);const c=a.join(",")+"|"+e.names().sort().join(",");let d=Q0.get(c),f;if(d==null){const m=Cue(o,e);d=m.sorted,f=m.recipientCounts,Q0.put(c,d),J0.put(c,f)}f={},s||Object.assign(f,J0.get(c));const p=new el(e);for(let m=0;m<d.length;++m){const y=d[m],v=y.sourceLayer;if(v instanceof py)continue;const x=[],b=[],_=[];let S=!1;for(const D of y.inputs){const F=p.getValue(D),M=p.getMask(D);x.push(F),b.push(M),M!=null&&(S=!0),s||(f[D.name]--,f[D.name]===0&&!e.hasKey(D)&&a.indexOf(D.name)===-1&&!F.isDisposed&&D.sourceLayer.stateful!==!0&&_.push(F))}S&&(n=n||{},n.mask=b[0]);const k=vt(v.apply(x,n));let T=null;v.supportsMasking&&(T=v.computeMask(x,b));const $=Nue(y),A=Array.isArray($)?$:[$];for(let D=0;D<A.length;++D){p.hasKey(A[D])||p.add(A[D],k[D],Array.isArray(T)?T[0]:T);const F=a.indexOf(A[D].name);F!==-1&&(l[F]=k[D])}s||Qe(_)}return p.disposeMasks(),i?l:l[0]}function Cue(t,e){O(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const s=jD(t[0],e);n=s.sorted,r=s.recipientMap}else{const s=new Set;for(const i of t){const{sorted:o,recipientMap:a}=jD(i,e);for(const l of o)s.has(l.name)||(n.push(l),s.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(u=>r[l].add(u))}}return{sorted:n,recipientCounts:Tue(r)}}function Tue(t){const e={};for(const n in t)e[n]=t[n].size;return e}function jD(t,e){const n=new Set,r=[],s={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),r.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const u of a.inputs)s[u.name]==null&&(s[u.name]=new Set),s[u.name].add(a.name),!n.has(u.name)&&i.push(u)}}return{sorted:r,recipientMap:s}}function Nue(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const s of t.sourceLayer.inboundNodes[r].outputTensors)if(s.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iue=te();Iue.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,kue);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $2(t,e){return ee(()=>Rn(Ae(G(t,t),e,!0)))}class my extends Tc{getConfig(){return{}}}class Q4 extends my{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ee(()=>{const n=$2(e,this.axis),r=Br(n,0,this.maxValue);return G(e,Le(r,ge(wn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}Q4.className="MaxNorm";ye(Q4);class J4 extends my{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ee(()=>Le(e,ge(wn(),$2(e,this.axis))))}getConfig(){return{axis:this.axis}}}J4.className="UnitNorm";ye(J4);class eV extends my{apply(e){return io(e)}}eV.className="NonNeg";ye(eV);class tV extends my{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ee(()=>{const n=$2(e,this.axis),r=ge(G(this.rate,Br(n,this.minValue,this.maxValue)),G(1-this.rate,n));return G(e,Le(r,ge(wn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}tV.className="MinMaxNorm";ye(tV);const VD={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Sn(t){return v2(t)}function WD(t,e={}){return cy(t,Ss.getMap().classNameMap,e,"constraint")}function kn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in VD?VD[t]:t,config:{}};return WD(n)}else return t instanceof my?t:WD(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function iu(t){if(t==null)return;const e=[],n=[],r=[];for(const s in t){const i=t[s];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(s),r.push(o)}}if(e.length>0){const s=await Promise.all(e);for(let i=0;i<s.length;++i)t[n[i]]=s[i][0];Qe(r)}}function nV(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var UD;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(UD||(UD={}));const $ue=125;class dm{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Eue{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class Aue extends dm{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const s in n){const i=n[s];if(typeof i=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+i*r;else{let o;s in this.totals?o=this.totals[s]:this.totals[s]=0;const a=ee(()=>ge(this.totals[s],G(i,r)));this.totals[s]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:ee(()=>{const s=G(Le(1,this.seen),this.totals[r]);n[r]=s,this.totals[r].dispose(),bn(n[r])}))}}class Oue extends dm{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),r.push(a)}}const s=await Promise.all(e);for(let i=0;i<s.length;++i)this.history[n[i]][r[i]].dispose(),this.history[n[i]][r[i]]=s[i][0]}}class Pue extends dm{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||q$,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=$ue),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");M0(this.yieldEvery)&&(this.maybeWait=Hle(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const s=[];this.yield!=null&&(await iu(r),s.push(this.yield(e,n,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await iu(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await iu(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await iu(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await iu(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):M0(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await iu(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await iu(e),await this.trainEnd(e))}}function rV(t,e){return t==null&&(t={}),t instanceof dm?[t]:Array.isArray(t)&&t[0]instanceof dm?t:vt(t).map(r=>new Pue(r,e))}class ei{constructor(){}static registerCallbackConstructor(e,n){O(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),ei.checkForDuplicate(n),ei.constructors[e]==null&&(ei.constructors[e]=[]),ei.constructors[e].push(n)}static checkForDuplicate(e){for(const n in ei.constructors)ei.constructors[+n].forEach(s=>{if(s===e)throw new X("Duplicate callback constructor.")})}static clear(){ei.constructors={}}static createCallbacks(e){const n=[];for(const r in ei.constructors){const s=+r;e>=s&&n.push(...ei.constructors[s])}return n.map(r=>new r)}}ei.constructors={};function sV(t,e,n,r,s,i,o,a,l){const u=new Oue,c=[new Aue,...ei.createCallbacks(e)];t!=null&&c.push(...t),c.push(u);const d=new Eue(c);return d.setParams({epochs:n,initialEpoch:r,samples:s,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aa(t,e={},n=!1){return cy(t,Ss.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ex(t,e){return ee(()=>{t.dtype!=="float32"&&(t=Se(t,"float32"));const n=Ae(hy(t),e,!0),r=_c(n.shape,wn()),s=Rn(Mo(n,r));return Le(t,s)})}function y1(t,e){return ee(()=>Ut(hy(Ie(e,t)),-1))}function E2(t,e){return ee(()=>Ut(dn(Ie(e,t)),-1))}function A2(t,e){return ee(()=>{const n=Ie(t,e),r=Br(dn(t),wn(),Number.MAX_VALUE),s=dn(Le(n,r));return G(100,Ut(s,-1))})}function Due(t,e){return ee(()=>{const n=Br(e,wn(),Number.MAX_VALUE),r=cs(ge(1,n)),s=Br(t,wn(),Number.MAX_VALUE),i=cs(ge(1,s));return Ut(hy(Ie(r,i)),-1)})}function Rue(t,e){return ee(()=>{const n=Mo(0,Ie(1,G(t,e)));return Ut(hy(n),-1)})}function Lue(t,e){return ee(()=>{const n=Mo(0,Ie(1,G(t,e)));return Ut(n,-1)})}function Fue(t,e){return ee(()=>{const n=Ae(G(t,e),-1),r=Es(G(Ie(1,t),e),-1);return Mo(0,ge(1,Ie(r,n)))})}function Mue(t,e){return ee(()=>{const n=Math.log(2),r=Ie(e,t),s=Ie(ge(r,Sc(G(-2,r))),n);return Ut(s,-1)})}function hm(t,e,n=!1){return ee(()=>{if(n)e=sy(e);else{const r=Ae(e,e.shape.length-1,!0);e=Le(e,r)}return e=Br(e,wn(),1-wn()),$t(Ae(G(Se(t,"float32"),cs(e)),e.shape.length-1))})}function tx(t,e,n=!1){return ee(()=>{const r=Se(cf(sue(t)),"int32");e=Br(e,wn(),1-wn());const s=e.shape,i=q(jd(r,s[s.length-1]),s);return hm(i,e,n)})}function zue(t,e){if(!nt(t.shape,e.shape))throw new X(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return ee(()=>{const n=io(e),r=$t(dn(e));return ge(Ie(n,G(e,t)),Xg(jr(r)))})}function v1(t,e){return ee(()=>{let n;return n=Br(e,wn(),1-wn()),n=cs(Le(n,Ie(1,n))),Ut(zue(t,n),-1)})}function Bue(t,e){return ee(()=>{const n=Br(t,wn(),1),r=Br(e,wn(),1);return Ae(G(t,cs(Le(n,r))),-1)})}function jue(t,e){return ee(()=>{const n=cs(ge(wn(),e));return Ut(Ie(e,G(t,n)),-1)})}function iV(t,e){return ee(()=>{const n=ex(t,-1),r=ex(e,-1),s=G(n,r);return $t(Ae(s,-1))})}const nx={meanSquaredError:y1,meanAbsoluteError:E2,meanAbsolutePercentageError:A2,meanSquaredLogarithmicError:Due,squaredHinge:Rue,hinge:Lue,categoricalHinge:Fue,logcosh:Mue,categoricalCrossentropy:hm,sparseCategoricalCrossentropy:tx,binaryCrossentropy:v1,kullbackLeiblerDivergence:Bue,poisson:jue,cosineProximity:iV};function BS(t){if(typeof t=="string"){if(t in nx)return nx[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new X(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oV(t,e){return ee(()=>{const n=G(.5,ds(e)),r=Io(Kr(e,n),t.dtype);return Ut(gi(t,r),-1)})}function aV(t,e){return ee(()=>Io(gi(Qu(t,-1),Qu(e,-1)),"float32"))}function Vue(t,e){return ee(()=>Se(Ae(Qi(gi(t,1),gi(e,1))),"float32"))}function Wue(t,e){return ee(()=>Se(Ae(Qi(gi(t,0),gi(e,1))),"float32"))}function Uue(t,e){return ee(()=>{const n=Vue(t,e),r=Wue(t,e),s=ge(n,r);return Se(Kn(Kr(s,0),Le(n,s),0),"float32")})}function Gue(t,e){return v1(t,e)}function Hue(t,e){return t.rank===e.rank&&(t=jl(t,[t.rank-1])),e=Qu(e,-1),e.dtype!==t.dtype&&(e=Se(e,t.dtype)),Se(gi(t,e),"float32")}const Kue=y1,que=y1,Xue=E2,Zue=E2,Yue=A2,Que=A2,lV=hm,Jue=iV,uV=tx,rx={binaryAccuracy:oV,categoricalAccuracy:aV,precision:Uue,categoricalCrossentropy:lV,sparseCategoricalCrossentropy:uV,mse:Kue,MSE:que,mae:Xue,MAE:Zue,mape:Yue,MAPE:Que,cosine:Jue};function ece(t){if(typeof t=="string"&&t in rx)return rx[t];if(typeof t!="string"&&t!=null)return t;throw new X(`Unknown metric ${t}`)}function Tv(t){if(yo(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(nx))if(nx[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(rx))if(rx[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tce(t){const e={Adagrad:()=>cu.adagrad(.01),Adadelta:()=>cu.adadelta(1,.95,wn()),Adam:()=>cu.adam(.001,.9,.999,wn()),Adamax:()=>cu.adamax(.002,.9,.999,wn(),0),RMSProp:()=>cu.rmsprop(.001,.9,0,wn()),SGD:()=>cu.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new X(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const GD=1*1024*1024;function HD(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!tT(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>GD&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${GD}.`)}}function tT(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!tT(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!tT(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nce(t,e,n,r=console.log){const s=sce(t),i=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(e*c)));let o;if(!s){i.push("Receives inputs"),o=[];for(const c in t.nodesByDepth)o.push(...t.nodesByDepth[c])}r("_".repeat(e)),sx(i,n,r),r("=".repeat(e));const a=t.layers;for(let c=0;c<a.length;++c)s?ice(a[c],n,r):oce(a[c],n,o,r),r((c===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=rce(t),u=Y0(t.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}function rce(t){let e;return t.collectedTrainableWeights!=null?e=Y0(t.collectedTrainableWeights):e=Y0(t.trainableWeights),e}function sce(t){let e=!0;const n=[],r=[];for(const s in t.nodesByDepth)n.push(t.nodesByDepth[s]);for(const s of n){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of t.layers){let i=!1;for(const o of s.inboundNodes)if(r.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function sx(t,e,n=console.log){let r="";for(let s=0;s<t.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=t[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);n(r)}function ice(t,e,n){let r,s;try{s=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,s,r,t.countParams().toString()];sx(a,e,n)}function oce(t,e,n,r){let s,i;try{i=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const o=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let f=0;f<d.inboundLayers.length;++f){const p=d.inboundLayers[f].name,m=d.nodeIndices[f],y=d.tensorIndices[f];o.push(`${p}[${m}][${y}]`)}const a=t.name,l=t.getClassName(),u=o.length===0?"":o[0],c=[`${a} (${l})`,i,s,t.countParams().toString(),u];sx(c,e,r);for(let d=1;d<o.length;++d)sx(["","","","",o[d]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cV(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function nT(t,e){if(t===null)return null;if(typeof t=="string")return vu(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];cV(e,s,i)?n.push(i):n.push(nT(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r];if(r==="name"&&typeof s=="string")n[r]=s;else{const i=vu(r);n[i]=nT(s,i)}}return n}}function rT(t,e){if(t==null)return null;if(typeof t=="string")return Zo(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];cV(e,s,i)?n.push(i):n.push(rT(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r],i=Zo(r);(r==="name"||r==="className")&&typeof s=="string"?n[i]=s:n[i]=rT(s,r)}return n}}/** @license See the LICENSE file. */const dV="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ace=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Di extends tt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const b=this.getClassName().toLowerCase();this.name=p1(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],dl(this.inputs).length!==this.inputs.length)throw new X(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);dl(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const b of this.outputs){const _=b.sourceLayer,S=b.nodeIndex,k=b.tensorIndex;this.outputLayers.push(_),this.outputLayersNodeIndices.push(S),this.outputLayersTensorIndices.push(k)}for(const b of this.inputs){const _=b.sourceLayer,S=b.nodeIndex,k=b.tensorIndex;yo(S===0,"input layer has >1 nodes"),yo(k===0,"input layer has >1 tensors"),this.inputLayers.push(_),this.inputLayersNodeIndices.push(S),this.inputLayersTensorIndices.push(k)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){const _=this.inputLayers[b];if(!(_ instanceof py))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${b} (0-based) originates from layer type ${_.getClassName()}.`);this.inputNames.push(_.name),this.feedInputShapes.push(_.batchInputShape),this.feedInputNames.push(_.name)}for(const b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);const n={},r={},s={},i={},o={},a=[],l=(b,_,S,k,T,$)=>{(k==null||T==null||$==null)&&(k=b.sourceLayer,T=b.nodeIndex,$=b.tensorIndex);const A=k.inboundNodes[T];if(S.indexOf(A)!==-1)throw new ui(`The tensor ${b.name} at layer "${k.name}" is part of a cycle.`);if(_.indexOf(A)!==-1)return;this.containerNodes.add(Di.nodeKey(k,T)),k.id in o||(o[k.id]=Object.keys(o).length),S.indexOf(A)===-1&&S.push(A);const D=A.inboundLayers.length;for(let F=0;F<D;F++){const M=A.inputTensors[F],j=A.inboundLayers[F],H=A.nodeIndices[F],K=A.tensorIndices[F];l(M,_,S,j,H,K)}for(_.push(A);S.indexOf(A)>=0;)S.splice(S.indexOf(A),1);a.push(A)},u=[],c=[];for(const b of this.outputs)l(b,u,c);const d=a.slice().reverse();for(const b of d){r[b.id]=b,b.id in n||(n[b.id]=0);let _=n[b.id];const S=s[b.outboundLayer.id]==null?0:s[b.outboundLayer.id];_=Math.max(_,S),s[b.outboundLayer.id]=_,i[b.outboundLayer.id]=b.outboundLayer,n[b.id]=_;for(let k=0;k<b.inboundLayers.length;k++){const T=b.inboundLayers[k],$=b.nodeIndices[k],A=T.inboundNodes[$],D=n[A.id]==null?0:n[A.id];n[A.id]=Math.max(_+1,D),r[A.id]=A}}const f={};for(const b in n){const _=n[b];_ in f||(f[_]=[]),f[_].push(r[b])}const p={};for(const b in s){const _=s[b];_ in p||(p[_]=[]),p[_].push(i[b])}let m=Object.keys(p).map(b=>parseInt(b,10)).sort(Sv);this.layers=[];for(const b of m){const _=p[b];_.sort((S,k)=>{const T=o[S.id],$=o[k.id];return T<$?-1:T>$?1:0});for(const S of _)S instanceof Di&&this.internalContainerRefs.push(S),this.layers.push(S)}this.layersByDepth=p,m=Object.keys(f).map(b=>parseInt(b,10)).sort(Sv);const y=this.inputs.slice(),v=[];for(const b of m)for(const _ of f[b]){const S=_.outboundLayer;if(S!=null){for(const k of _.inputTensors)if(y.indexOf(k)===-1)throw new ui(`Graph disconnected: cannot obtain value for tensor ${k} at layer "${S.name}". The following previous layers were accessed without issue: ${v}`);for(const k of _.outputTensors)y.push(k);v.push(S.name)}}this.nodesByDepth=f;const x=this.layers.map(b=>b.name);for(const b of x){const _=x.filter(S=>S===b).length;if(_!==1)throw new ui(`The name "${b}" is used ${_} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new g1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new X("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let s=0;const i=ace(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,u]of a.weights.entries()){const c=i?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(r[c]!=null)throw new X(`Duplicate weight name: ${c}`);r[c]=u,s++}const o=[];for(const a in e){let l=a;if(r[a]==null){const u=a.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(r[l]!=null)o.push([r[l],e[a]]);else if(n)throw new X(`Provided weight data has no target variable: ${a}`);delete r[l]}if(n){const a=[];for(const l in r)a.push(l);if(a.length>0)throw new X(`${a.length} of ${s} weights are not set: ${a}`)}I2(o)}parseWeights(e){for(const n in Object.keys(e)){const r=n.split("/"),s=["vars","layer_checkpoint_dependencies"],i=r.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!s.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${dV}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=rT(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return ee(()=>{e=vt(e);const r=new el;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return yp(this.outputs,r,n)})}computeMask(e,n){return ee(()=>{e=vt(e);let r;return n==null?r=ic(null,e.length):r=vt(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=Z0(e);if(n.length!==this.inputLayers.length)throw new X(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],u=n[a],c=l.name+"_0_0";r[c]=u}const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Sv);if(s.length>1)for(const a of s){const l=this.nodesByDepth[a];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(y=>y.id).indexOf(c.id)!==-1)continue;const d=[];for(let y=0;y<u.inboundLayers.length;y++){const v=u.inboundLayers[y],x=u.nodeIndices[y],b=u.tensorIndices[y],_=`${v.name}_${x}_${b}`,S=r[_];d.push(S)}const f=c.computeOutputShape(Pr(d)),p=Z0(f),m=c.inboundNodes.indexOf(u);for(let y=0;y<p.length;y++){const v=`${c.name}_${m}_${y}`;r[v]=p[y]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],d=`${l.name}_${u}_${c}`;o.push(d)}for(let a=0;a<o.length;a++){const l=o[a];yo(l in r),i.push(r[l])}return Pr(i)}runInternalGraph(e,n){n==null&&(n=ic(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],d=n[l];r[u.id]=[c,d]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Sv);for(const l of s){const u=this.nodesByDepth[l];for(const c of u){const d=c.outboundLayer,f=c.inputTensors,p=c.outputTensors,m=new Array;for(const y of f)y.id in r&&m.push(r[y.id]);if(m.length===f.length){let y={},v,x,b,_;if(c.callArgs!=null&&(y=c.callArgs),m.length===1){const[S,k]=m[0];y.mask==null&&(y.mask=k),b=vt(d.call(S,y)),_=vt(d.computeMask(S,k)),v=[S],x=[k]}else v=m.map(S=>S[0]),x=m.map(S=>S[1]),y.mask==null&&(y.mask=x),b=vt(d.call(v,y)),_=vt(d.computeMask(v,x));if(d.activityRegularizer)throw new Ze("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let S=0;S<p.length;++S){const k=p[S],T=b[S],$=_[S];r[k.id]=[T,$]}}}}const i=[],o=[],a=[];for(const l of this.outputs){yo(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=r[l.id];a.push(u.shape),i.push(u),o.push(c)}return[i,o,a]}buildNodeConversionMap(e){const n={};let r;for(const s of this.layers){r=s instanceof Di?1:0;for(let i=0;i<s.inboundNodes.length;i++){const o=Di.nodeKey(s,i);this.containerNodes.has(o)&&(n[o]=r,r+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new X("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new X(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new X(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return ee(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const s=Di.nodeKey(n,r);this.containerNodes.has(s)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),u=[];for(let d=0;d<o.inboundNodes.length;d++){const f=o.inboundNodes[d],p=Di.nodeKey(o,d);let m={};if(this.containerNodes.has(p)){if(f.callArgs)try{JSON.stringify(f.callArgs),m=f.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${f.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),m={}}if(f.inboundLayers.length>0){const y=[];for(let v=0;v<f.inboundLayers.length;v++){const x=f.inboundLayers[v],b=f.nodeIndices[v],_=f.tensorIndices[v],S=Di.nodeKey(x,b);let k=n[S];k==null&&(k=0),y.push([x.name,k,_,m])}u.push(y)}}}const c={};c.name=o.name,c.className=a,c.config=l,c.inboundNodes=u,r.push(c)}e.layers=r;const s=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],u=Di.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.inputLayersTensorIndices[o];s.push([a.name,c,d])}e.inputLayers=s;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],u=Di.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.outputLayersTensorIndices[o];i.push([a.name,c,d])}return e.outputLayers=i,e}static fromConfig(e,n,r={},s=!1){const i={},o={};function a(v,x){v.name in o?o[v.name].push(x):o[v.name]=[x]}function l(v,x){const b=[];let _;for(const S of x){const k=S[0],T=S[1],$=S[2];if(_=S[3]==null?{}:S[3],!(k in i)){a(v,x);return}const A=i[k];if(A.inboundNodes.length<=T){a(v,x);return}const D=A.inboundNodes[T];b.push(D.outputTensors[$])}b.length>0&&v.apply(Pr(b),_)}function u(v){const x=v.name,b=aa(v,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(s),i[x]=b,v.inboundNodes.forEach(S=>{if(!(S instanceof Array))throw new X(`Corrupted configuration, expected array for nodeData: ${S}`);a(b,S)})}const c=n.name,d=n.layers;for(const v of d)u(v);for(;!Gle(o);)for(const v of d){const x=i[v.name];if(x.name in o){const b=o[x.name];delete o[x.name];for(const _ of b)l(x,_)}}const f=[],p=[],m=n.inputLayers;for(const v of m){const x=v[0],b=v[1],_=v[2];yo(x in i);const k=i[x].inboundNodes[b].outputTensors;f.push(k[_])}const y=n.outputLayers;for(const v of y){const x=v[0],b=v[1],_=v[2];yo(x in i);const k=i[x].inboundNodes[b].outputTensors;p.push(k[_])}return new e({inputs:f,outputs:p,name:c})}get stateful(){if(this._stateful)throw new X("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){ee(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lce(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const s=[];return e.forEach(i=>{i in t?s.push(t[i]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function hV(t,e){return lce(t,e,"classWeight")}async function fV(t,e,n,r){if(n!=null){const s=ee(()=>{if(t.shape.length===1)return To(t);if(t.shape.length===2){if(t.shape[1]>1)return Qu(t,1);if(t.shape[1]===1)return q(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await s.data());Qe(s);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),ur(o,"float32")}else return null}function uce(t,e){return G(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cce=32;function pV(t,e){let n,r;const s=e;n=s.xs,r=s.ys,O(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=KD("input",t.inputNames,n),o=KD("output",t.outputNames,r),a=i[0].shape[0];O(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),O(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)O(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)O(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function KD(t,e,n){if(n instanceof gt)return[n];if(Array.isArray(n))return O(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const s of e){if(n[s]==null)throw new X(`The feature data generated by the dataset lacks the required ${t} key '${s}'.`);r.push(n[s])}return r}}function dce(t){if(t.length===3)throw new Ze("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function hce(t,e,n){const r=n.batchesPerEpoch!=null;if(O(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),O(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),O(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),O(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),O(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const s=n.validationData!=null;let i,o;if(s)if(qD(n.validationData))O(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const v=dce(n.validationData);i=v.xs,o=v.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;s?u=l.slice().concat(l.map(v=>"val_"+v)):u=l.slice();const c=rV(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:f,history:p}=sV(c,d,n.epochs,null,null,fce(e,n),null,s,u);f.setModel(t),t.history=p,await f.onTrainBegin(),t.stopTraining_=!1;let m=n.initialEpoch==null?0:n.initialEpoch,y=await e.iterator();for(;m<n.epochs;){const v={};await f.onEpochBegin(m);let x=0,b=0;for(r||(y=await e.iterator());!r||x<n.batchesPerEpoch;){const _=await y.next();if(r&&_.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(_.value!=null){const{xs:S,ys:k}=pV(t,_.value),T={};T.batch=b,T.size=S[0].shape[0],await f.onBatchBegin(b,T);const $=[];if(n.classWeight!=null){const F=hV(n.classWeight,t.outputNames);for(let M=0;M<F.length;++M)$.push(await fV(k[M],null,F[M]))}const A=S.concat(k).concat($),D=a(A);Qe(A);for(let F=0;F<l.length;++F){const M=l[F],j=D[F];T[M]=j,bn(j)}await f.onBatchEnd(b,T),nV(T),b++,x++}if(r?x>=n.batchesPerEpoch:_.done){if(s){let S;qD(n.validationData)?S=vt(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):S=vt(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?cce:n.validationBatchSize,verbose:0}));for(let k=0;k<t.metricsNames.length;++k)v[`val_${t.metricsNames[k]}`]=S[k]}break}if(t.stopTraining_)break}if(await f.onEpochEnd(m,v),m++,t.stopTraining_)break}return await f.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function fce(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function qD(t){return typeof t.iterator=="function"}function pce(t){return typeof t.next=="function"}async function mce(t,e,n){n=n||{};const r=n.batches!=null,s=t.testFunction;let i=[];if(n.verbose>0)throw new Ze("Verbose mode is not implemented yet.");O(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=pce(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<n.batches;){const u=await o.next();if(i=ee(()=>{if(u.value){const{xs:c,ys:d}=pV(t,u.value),f=c.concat(d),p=ee(()=>s(f));if(Qe(f),l===0)for(let y=0;y<p.length;++y)i.push(je(0));const m=f[0].shape[0];for(let y=0;y<p.length;++y){const v=p[y],x=i[y];i[y]=ee(()=>ge(i[y],G(m,v))),l>0&&Qe(x)}Qe(p),a+=m,++l}return i}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<i.length;++u){const c=i[u];i[u]=Le(i[u],a),Qe(c)}return Pr(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jS(t){O(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function tp(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>Mu(r,e,n-e)):Mu(t,e,n-e)}function sT(t,e){return ee(()=>t==null?null:Array.isArray(t)?t.map(n=>sT(n,e)):V4(t,e.dtype==="int32"?e:Se(e,"int32")))}function VS(t,e){const n=[];let r=0,s=null;for(;r<t;)s=r+e,s>=t&&(s=t),n.push([r,s]),r=s;return n}function mV(t){const e=[];t instanceof gt&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(dy(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function Pi(t,e){if(t==null)return;const n=[];if(e instanceof gt)n.push(e.id);else if(Array.isArray(e))e.forEach(s=>n.push(s.id));else if(e!=null)for(const s in e){const i=e[s];n.push(i.id)}const r=[];if(t instanceof gt)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(s=>{n.indexOf(s.id)===-1&&r.push(s)});else if(t!=null)for(const s in t){const i=t[s];n.indexOf(i.id)===-1&&r.push(i)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gce(t){return t instanceof gt}function iT(t){return Array.isArray(t)}function XD(t){return!gce(t)&&!iT(t)}function ZD(t,e,n,r=!0,s=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(iT(t)&&t.length>0)o=!0;else if(XD(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new X(`Error when checking model ${s} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(XD(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new X(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(iT(t)){if(t=t,t.length!==e.length)throw new X(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new X(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=mV(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new X(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[o][l];if(c!=null&&c>=0&&u!==c)throw new X(`${s} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function yce(t,e,n){const r=dl(t.map(i=>i.shape[0]));r.sort();const s=dl(e.map(i=>i.shape[0]));if(s.sort(),r.length>1)throw new X(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(s.length>1)throw new X(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&s.length>0&&!nt(r,s))throw new X(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function vce(t,e,n){const r=[y1,v1,hm];for(let s=0;s<t.length;++s){const i=t[s],o=e[s],a=n[s];if(o!=null){if(o===hm&&i.shape[i.shape.length-1]===1)throw new X(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){const l=i.shape.slice(1),u=a.slice(1);for(let c=0;c<l.length;++c){const d=l[c],f=u[c];if(f!=null&&d!==f)throw new X(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function YD(t,e,n,r=!0,s=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new X(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new X(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new X(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[o][l];if(c!=null&&c!==u)throw new X(`Error when checking ${s}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function xce(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const s of e){let i=n.hasOwnProperty(s)?n[s]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const bce="layers-model";class Cd extends Di{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new X("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");nce(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=tce(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Oa))throw new X("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new X(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(BS(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new X(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>BS(a))}else{const o=BS(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Fu("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const s=xce(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};Fu("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=s[o];(u=>{const c="";let d,f,p;for(const m of u){if(typeof m=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(m)!==-1){const v=this.internalOutputShapes[o];v[v.length-1]===1||this.lossFunctions[o]===v1?["accuracy","acc"].indexOf(m)!==-1?f=oV:["crossentropy","ce"].indexOf(m)!==-1&&(f=Gue):this.lossFunctions[o]===tx?["accuracy","acc"].indexOf(m)!==-1?f=Hue:["crossentropy","ce"].indexOf(m)!==-1&&(f=uV):["accuracy","acc"].indexOf(m)!==-1?f=aV:["crossentropy","ce"].indexOf(m)!==-1&&(f=lV);let x;["accuracy","acc"].indexOf(m)!==-1?x="acc":["crossentropy","ce"].indexOf(m)!==-1&&(x="ce"),p=f,d=c+x}else p=ece(m),d=c+Tv(m);let y;Fu(d,()=>{y=p}),i(o,d,y)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const s=r.batchSize==null?32:r.batchSize;jS(s);const o=this.standardizeUserDataXY(e,n,!0,s);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,s,r.verbose,r.steps);return Pr(u)}finally{Pi(o[0],e),Pi(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),mce(this,e,n)}checkNumSamples(e,n,r,s="steps"){let i;if(r!=null){if(i=null,n!=null)throw new X(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new X(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new X("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),s=r?n:[n],i=this.retrieveSymbolicTensors(s),o=new el;if(e instanceof gt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new X(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new X(`No value is provided for the model's input ${l.name}`);o.add(l,u)}const a=yp(i,o);return r?a:a[0]}retrieveSymbolicTensors(e){const n=ic(null,e.length);let r=e.length;for(const s of this.layers){const i=Array.isArray(s.output)?s.output:[s.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw n.forEach((i,o)=>{i==null&&s.push(e[o])}),new X(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return n}predictLoop(e,n=32,r=!1){return ee(()=>{const s=this.checkNumSamples(e);if(r)throw new Ze("Verbose predictLoop() is not implemented yet.");const i=VS(s,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)ee(()=>{const u=i[a][0],c=i[a][1],d=tp(e,u,c),f=[];if(Array.isArray(d))for(let m=0;m<d.length;++m)f.push({key:this.inputs[m],value:d[m]});else f.push({key:this.inputs[0],value:d});const p=new el(f);return yp(this.outputs,p)}).forEach((u,c)=>o[c].push(u));return Pr(o.map(a=>rn(a,0)))})}predict(e,n={}){const r=mV(e);YD(r,this.inputNames,this.feedInputShapes,!1);try{const s=n.batchSize==null?32:n.batchSize;return jS(s),this.predictLoop(r,s)}finally{Pi(r,e)}}predictOnBatch(e){YD(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,s){if(this.optimizer_==null)throw new ui("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===tx?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=ZD(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=ZD(n,this.feedOutputNames,i,!1,"target"),yce(e,n),vce(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new X(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,s,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(s!=null){const c=hV(s,this.outputNames);u=[];for(let d=0;d<c.length;++d)u.push(await fV(l[d],null,c[d]))}return[a,l,u]}testLoop(e,n,r,s=0,i){return ee(()=>{const o=this.checkNumSamples(n,r,i,"steps"),a=[];if(s>0)throw new Ze("Verbose mode is not implemented yet.");if(i!=null)throw new Ze("steps mode in testLoop() is not implemented yet");{const l=VS(o,r),u=ur(Ji(0,o));for(let c=0;c<l.length;++c){const d=l[c][0],f=l[c][1],p=Mu(u,d,f-d),m=sT(n,p),y=e(m);if(c===0)for(let v=0;v<y.length;++v)a.push(je(0));for(let v=0;v<y.length;++v){const x=y[v];a[v]=ge(a[v],G(f-d,x))}}for(let c=0;c<a.length;++c)a[c]=Le(a[c],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const s=e[r];let i=s;if(RD(e,s)>1){const o=RD(e.slice(0,r),s);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const d=[];for(let y=0;y<this.inputs.length;++y)d.push({key:this.inputs[y],value:r[y]});const f=new el(d),p=yp(this.outputs,f,{training:!0});let m;for(let y=0;y<this.lossFunctions.length;++y){const v=this.lossFunctions[y];let x=v(s[y],p[y]);i[y]!=null&&(x=uce(x,i[y]));const b=Ut(x);n.push(b),y===0?m=x:m=ge(m,x)}for(let y=0;y<this.metricsTensors.length;++y){let v;if(this.outputs.length>1&&y<this.outputs.length)v=n[y];else{const x=this.metricsTensors[y][0],b=this.metricsTensors[y][1];v=Ut(x(s[b],p[b]))}bn(v),o.push(v)}return m=Ut(m),this.calculateLosses().forEach(y=>{m=ge(m,y)}),m},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>ee(()=>{const n=[];let r;const s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let u=0;u<this.inputs.length;++u)o.push({key:this.inputs[u],value:s[u]});const a=new el(o),l=yp(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],d=Ut(c(i[u],l[u]));u===0?r=d:r=ge(r,d),n.push(r)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],d=this.metricsTensors[u][1],f=Ut(c(i[d],l[d]));n.push(f)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,i,o,a,l,u,c,d,f;try{const p=r.batchSize==null?32:r.batchSize;jS(p);const y=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,p);s=y[0],i=y[1],f=y[2];let v=!1,x;if(r.validationData!=null&&r.validationData.length>0){if(v=!0,r.validationData.length===2)l=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new Ze("validationData including sample weights is not supported yet."):new X(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const F=await this.standardizeUserData(l,u,null,null,!0,p);c=F[0],d=F[1],x=c.concat(d)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){v=!0;const D=Math.floor(s[0].shape[0]*(1-r.validationSplit)),F=s[0].shape[0];c=tp(s,D,F),o=s,s=tp(s,0,D),d=tp(i,D,F),a=i,i=tp(i,0,D),x=c.concat(d)}else r.validationSteps!=null&&(v=!0);const b=s.concat(i).concat(f);this.checkTrainableWeightsConsistency();const _=this.makeTrainFunction(),S=this.getDedupedMetricsNames();let k,T;v?(this.makeTestFunction(),k=this.testFunction,T=S.slice().concat(S.map(D=>"val_"+D))):(k=null,x=[],T=S.slice());const $=rV(r.callbacks,r.yieldEvery);return await this.fitLoop(_,b,S,p,r.epochs,r.verbose,$,k,x,r.shuffle,T,r.initialEpoch,null,null)}finally{this.isTraining=!1,Pi(s,e),Pi(i,n),Pi(o,e),Pi(a,n),Pi(c,l),Pi(d,u),f!=null&&Qe(f)}}async fitLoop(e,n,r,s,i,o,a,l,u,c,d,f,p,m){s==null&&(s=32),i==null&&(i=1),c==null&&(c=!0),f==null&&(f=0);let y=!1;if(l!=null&&u!=null&&(y=!0),m!=null&&(y=!0,p==null))throw new X("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(n,s,p,"steps_per_epoch");let x;v!=null&&(x=Ji(0,v)),o==null&&(o=1);const{callbackList:b,history:_}=sV(a,o,i,f,v,p,s,y,d);b.setModel(this),this.history=_,await b.onTrainBegin(),this.stopTraining_=!1;for(let S=f;S<i;++S){await b.onEpochBegin(S);const k={};if(p!=null)throw new Ze("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Ze("batch shuffling is not implemneted yet");c&&oI(x);const T=ur(x),$=VS(v,s);for(let A=0;A<$.length;++A){const D={};if(await b.onBatchBegin(A,D),ee(()=>{const F=$[A][0],M=$[A][1],j=Mu(T,F,M-F);D.batch=A,D.size=M-F;const H=sT(n,j),K=e(H);for(let Q=0;Q<r.length;++Q){const Z=r[Q],se=K[Q];D[Z]=se,bn(se)}if(A===$.length-1&&y){const Q=this.testLoop(l,u,s);for(let Z=0;Z<r.length;++Z){const se=r[Z],B=Q[Z];bn(B),k["val_"+se]=B}}}),await b.onBatchEnd(A,D),nV(D),this.stopTraining_)break}T.dispose()}if(await b.onEpochEnd(S,k),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return hce(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),s=r[0],i=r[1],a=this.makeTrainFunction()(s.concat(i)),l=[];for(const u of a){const c=await u.data();l.push(c[0])}return Qe(a),Pi(r[0],e),Pi(r[1],n),Pr(l)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let o=0;o<s.length;++o)r&&!s[o].trainable||n.push({name:s[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=NC().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-NC().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Zo(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Zo(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const s of n)if(typeof r[s]=="string")e[s]=Zo(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Zo(Tv(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Zo(Tv(e)));{const e={};for(const n in this.metrics)e[n]=Zo(Tv(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=nT(e.optimizer_config),r=aa(n);let s;if(typeof e.loss=="string")s=vu(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(o=>vu(o));else if(e.loss!=null){s={};for(const o in e.loss)s[o]=vu(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>vu(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=vu(e.metrics[o])}this.compile({loss:s,metrics:i,optimizer:r})}async save(e,n){if(typeof e=="string"){const u=IB(e);if(u.length===0)throw new X(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new X(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new X("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await IC(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:bce,generatedBy:`TensorFlow.js tfjs-layers v${dV}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:d}=await IC(await this.optimizer.getWeights(),u);r.specs.push(...d),r.data=TB([r.data,c])}return this.userDefinedMetadata!=null&&(HD(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){HD(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Cd.className="Model";ye(Cd);class gV extends Cd{}gV.className="Functional";ye(gV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fm extends Cd{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:p1("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new X(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof fm||e instanceof Cd;let r;if(n){if(r=e,r.outputs.length!==1)throw new X("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new X("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new X("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=_ue({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new X(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new X("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=Y4(this.outputs[0])}this.inboundNodes=[],new g1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ic(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(dt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Cd({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new ui("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new ui("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new ui("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new ui("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},s=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new X("Legacy serialization format not supported yet.");i=n}else O(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof fm))throw new Ze(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const c=aa(l,void 0,s);s&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(e){if(this.model==null)throw new X("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new X("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}fm.className="Sequential";ye(fm);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let fr=class extends Tc{getConfig(){return{}}};class yV extends fr{apply(e,n=1){return oue(e,n)}}yV.className="elu";ye(yV);class vV extends fr{apply(e){return Ww(e)}}vV.className="selu";ye(vV);class xV extends fr{apply(e){return io(e)}}xV.className="relu";ye(xV);class bV extends fr{apply(e){return ee(()=>Sl(6,io(e)))}}bV.className="relu6";ye(bV);let wV=class extends fr{apply(e){return e}};wV.className="linear";ye(wV);class _V extends fr{apply(e){return Xi(e)}}_V.className="sigmoid";ye(_V);class SV extends fr{apply(e){return lue(e)}}SV.className="hardSigmoid";ye(SV);class kV extends fr{apply(e){return Sc(e)}}kV.className="softplus";ye(kV);class CV extends fr{apply(e){return aue(e)}}CV.className="softsign";ye(CV);class TV extends fr{apply(e){return _l(e)}}TV.className="tanh";ye(TV);let O2=class extends fr{apply(e,n=-1){return sy(e,n)}};O2.className="softmax";ye(O2);class NV extends fr{apply(e,n=-1){return Rw(e,n)}}NV.className="logSoftmax";ye(NV);class IV extends fr{apply(e){return ee(()=>ee(()=>{const n=Math.sqrt(2),r=G(.5,ge(1,Ow(Le(e,n))));return G(e,r)}))}}IV.className="gelu";ye(IV);class $V extends fr{apply(e){return ee(()=>G(.5,G(e,ge(1,_l(G(Rn(Le(2,Math.PI)),ge(e,G(.044715,Po(e,3)))))))))}}$V.className="gelu_new";ye($V);class EV extends fr{apply(e){return ee(()=>G(e,_l(Sc(e))))}}EV.className="mish";ye(EV);class AV extends fr{apply(e,n=1){return ee(()=>G(Xi(G(e,n)),e))}}AV.className="swish";ye(AV);function Cl(t){return t.getClassName()}function WS(t,e={}){return cy(t,Ss.getMap().classNameMap,e,"activation")}function Tl(t){if(t==null){const e={};return e.className="linear",e.config={},WS(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},WS(e)}else return t instanceof fr?t:WS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wce(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class OV extends Tc{}class PV extends OV{constructor(e){super(),wce(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ee(()=>{let n=fn([1]);return this.hasL1&&(n=ge(n,Ae(G(this.l1,dn(e))))),this.hasL2&&(n=ge(n,Ae(G(this.l2,hy(e))))),q(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}PV.className="L1L2";ye(PV);const QD={l1l2:"L1L2"};function Tt(t){return v2(t)}function JD(t,e={}){return cy(t,Ss.getMap().classNameMap,e,"regularizer")}function Bt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in QD?QD[t]:t,config:{}};return JD(n)}else return t instanceof OV?t:JD(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DV extends tt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=We(e);let r=io(e);return this.maxValue!=null&&(r=Br(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}DV.className="ReLU";ye(DV);class RV extends tt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=We(e);return qg(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}RV.className="LeakyReLU";ye(RV);class LV extends tt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=zt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Bt(e.alphaRegularizer),this.alphaConstraint=kn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new X(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=dt(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)n[s-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new _n({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=We(e),ty(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Gt(this.alphaInitializer),alphaRegularizer:Tt(this.alphaRegularizer),alphaConstraint:Sn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}LV.className="PReLU";ye(LV);let FV=class extends tt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Ze(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=We(e);return lf(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};FV.className="ELU";ye(FV);class MV extends tt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=We(e);return G(r,Se(Kr(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}MV.className="ThresholdedReLU";ye(MV);class zV extends tt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new O2().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return ee(()=>{let r=We(e);const s=n.mask;if(s!=null){const i=G(Ie(Dr(r.shape),Se(s,r.dtype)),je(-1e9));r=ge(r,i)}return this.axis instanceof Array?this.axis.length>1?jr(Ie(r,Zg(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}zV.className="Softmax";ye(zV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Td(t,e,n){if(typeof t=="number")return ic(t,e);if(t.length!==e)throw new X(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const s=t[r];if(!nue(s))throw new X(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${s}`)}return t}function Zi(t,e,n,r,s=1){if(t==null)return t;const i=e+(e-1)*(s-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+r-1)/r)}function vo(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+kl([n-e,0]);else if(r==="same")t=t*e;else throw new X(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function P2(t,e){return ee(()=>(an(e),e==="channelsFirst"?st(t,[0,2,3,1]):t))}function BV(t,e){return ee(()=>(an(e),e==="channelsFirst"?st(t,[0,2,3,4,1]):t))}function _ce(t,e,n,r=1,s="valid",i,o=1){return ee(()=>{if(i==null&&(i=eo()),an(i),t.shape.length!==3)throw new X(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new X(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new X(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=st(t,[0,2,1])),s==="causal")throw new Ze("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=Iw(t,e,r,s==="same"?"same":"valid","NWC",o);return n!=null&&(a=oo(a,n)),a})}function eR(t,e,n,r=[1,1],s="valid",i,o,a=null){return ee(()=>{if(i==null&&(i=eo()),an(i),t.rank!==3&&t.rank!==4)throw new X(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new X(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=P2(t,i);if(s==="causal")throw new Ze("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=$j({x:l,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=st(l,[0,3,1,2])),l})}function Sce(t,e,n,r=[1,1,1],s="valid",i,o){return ee(()=>{if(i==null&&(i=eo()),an(i),t.rank!==4&&t.rank!==5)throw new X(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new X(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=BV(t,i);if(s==="causal")throw new Ze("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=UI(a,e,r,s==="same"?"same":"valid","NDHWC",o),n!=null&&(a=oo(a,n)),i==="channelsFirst"&&(a=st(a,[0,4,1,2,3])),a})}class x1 extends tt{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",x1.verifyArgs(n),this.rank=e,Pn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Ze(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Td(n.kernelSize,e,"kernelSize"),this.strides=Td(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Bs(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,an(this.dataFormat),this.activation=Tl(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=zt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=kn(n.biasConstraint),this.biasRegularizer=Bt(n.biasRegularizer),this.activityRegularizer=Bt(n.activityRegularizer),this.dilationRate=Td(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new X(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new X(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new X(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(yo("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!x2(e.kernelSize,"number",1,3))throw new X(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Cl(this.activation),useBias:this.useBias,biasInitializer:Gt(this.biasInitializer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),biasConstraint:Sn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class ff extends x1{constructor(e,n){super(e,n),this.kernel=null,ff.verifyArgs(n),this.filters=n.filters,Pn(this.filters,"filters"),this.kernelInitializer=zt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=kn(n.kernelConstraint),this.kernelRegularizer=Bt(n.kernelRegularizer)}build(e){e=dt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new X(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return ee(()=>{e=We(e);let r;const s=this.bias==null?null:this.bias.read(),i=L4(this.activation.getClassName());if(i!=null&&this.rank===2)r=eR(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=_ce(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=eR(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=Sce(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Ze("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=dt(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const o=Zi(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(n),s.push(this.filters)):(s.push(this.filters),s=s.concat(n)),s}getConfig(){const e={filters:this.filters,kernelInitializer:Gt(this.kernelInitializer),kernelRegularizer:Tt(this.kernelRegularizer),kernelConstraint:Sn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new X(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class gy extends ff{constructor(e){super(2,e),gy.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!x2(e.kernelSize,"number",1,2))throw new X(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}gy.className="Conv2D";ye(gy);class yy extends ff{constructor(e){super(3,e),yy.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new X(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}yy.className="Conv3D";ye(yy);class jV extends gy{constructor(e){if(super(e),this.inputSpec=[new _n({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new X(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=dt(e),e.length!==4)throw new X("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new X("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new _n({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return ee(()=>{let r=We(e);if(r.shape.length!==4)throw new X(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=s[o],u=s[a],c=this.kernelSize[0],d=this.kernelSize[1],f=this.strides[0],p=this.strides[1],m=vo(l,f,c,this.padding),y=vo(u,p,d,this.padding),v=[i,m,y,this.filters];this.dataFormat!=="channelsLast"&&(r=st(r,[0,2,3,1]));let x=$w(r,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=st(x,[0,3,1,2])),this.bias!=null&&(x=oo(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=dt(e);const n=e.slice();let r,s,i;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3):(r=3,s=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[r]=this.filters,n[s]=vo(n[s],l,o,this.padding),n[i]=vo(n[i],u,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}jV.className="Conv2DTranspose";ye(jV);class VV extends yy{constructor(e){if(super(e),this.inputSpec=[new _n({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new X(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=dt(e),e.length!==5)throw new X("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new X("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new _n({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return ee(()=>{let r=We(e);if(r.shape.length!==5)throw new X(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const u=s[l],c=s[o],d=s[a],f=this.kernelSize[0],p=this.kernelSize[1],m=this.kernelSize[2],y=this.strides[0],v=this.strides[1],x=this.strides[2],b=vo(u,y,f,this.padding),_=vo(c,v,p,this.padding),S=vo(d,x,m,this.padding),k=[i,b,_,S,this.filters];this.dataFormat!=="channelsLast"&&(r=st(r,[0,2,3,4,1]));let T=GI(r,this.kernel.read(),k,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(T=st(T,[0,4,1,2,3])),this.bias!==null&&(T=oo(T,this.bias.read(),this.dataFormat)),this.activation!==null&&(T=this.activation.apply(T)),T})}computeOutputShape(e){e=dt(e);const n=e.slice();let r,s,i,o;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3,o=4):(r=4,s=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],d=this.strides[1],f=this.strides[2];return n[r]=this.filters,n[s]=vo(n[s],c,a,this.padding),n[i]=vo(n[i],d,l,this.padding),n[o]=vo(n[o],f,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}VV.className="Conv3DTranspose";ye(VV);class WV extends ff{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new X("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new X("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new X(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=zt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Bt(n.depthwiseRegularizer),this.depthwiseConstraint=kn(n.depthwiseConstraint),this.pointwiseInitializer=zt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Bt(n.pointwiseRegularizer),this.pointwiseConstraint=kn(n.pointwiseConstraint)}build(e){if(e=dt(e),e.length<this.rank+2)throw new X(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new X(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],s=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(r*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new _n({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return ee(()=>{e=We(e);let r;if(this.rank===1)throw new Ze("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=st(e,[0,2,3,1])),r=Uw(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=oo(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=st(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Gt(this.depthwiseInitializer),e.pointwiseInitializer=Gt(this.pointwiseInitializer),e.depthwiseRegularizer=Tt(this.depthwiseRegularizer),e.pointwiseRegularizer=Tt(this.pointwiseRegularizer),e.depthwiseConstraint=Sn(this.depthwiseConstraint),e.pointwiseConstraint=Sn(this.pointwiseConstraint),e}}WV.className="SeparableConv";class UV extends WV{constructor(e){super(2,e)}}UV.className="SeparableConv2D";ye(UV);class b1 extends ff{constructor(e){super(1,e),b1.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!x2(e.kernelSize,"number",1,1))throw new X(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}b1.className="Conv1D";ye(b1);class GV extends tt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return ee(()=>{if(e=We(e),this.dataFormat==="channelsLast"){const r=Cv(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Cv(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=Cv(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Cv(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}GV.className="Cropping2D";ye(GV);class HV extends tt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,an(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Jle(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return ee(()=>{let r=We(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=st(r,[0,2,3,1]);const i=this.size[0]*s[2],o=this.size[1]*s[3],a=this.interpolation==="nearest"?Gi.resizeNearestNeighbor(r,[i,o]):Gi.resizeBilinear(r,[i,o]);return st(a,[0,3,1,2])}else{const i=this.size[0]*s[1],o=this.size[1]*s[2];return this.interpolation==="nearest"?Gi.resizeNearestNeighbor(r,[i,o]):Gi.resizeBilinear(r,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}HV.className="UpSampling2D";ye(HV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kce(t,e,n=[1,1],r="valid",s,i){return ee(()=>{s==null&&(s=eo()),an(s);let o=P2(t,s);if(t.rank!==4)throw new X(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new X(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=af(o,e,n,r==="same"?"same":"valid","NHWC",i),s==="channelsFirst"&&(o=st(o,[0,3,1,2])),o})}class KV extends x1{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=zt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=kn(e.depthwiseConstraint),this.depthwiseRegularizer=Bt(e.depthwiseRegularizer)}build(e){if(e=dt(e),e.length<4)throw new X(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new X(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ee(()=>{e=We(e);let r=kce(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=oo(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=dt(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Zi(n,this.kernelSize[0],this.padding,this.strides[0]),o=Zi(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,o]:[e[0],i,o,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Gt(this.depthwiseInitializer),e.depthwiseRegularizer=Tt(this.depthwiseRegularizer),e.depthwiseConstraint=Sn(this.depthwiseRegularizer),e}}KV.className="DepthwiseConv2D";ye(KV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qV(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new X("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function s(i){return i==null||Array.isArray(i)?i:[i]}return e=s(e),n=s(n),{inputs:t,initialState:e,constants:n}}function XV(t,e,n,r=!1,s,i,o=!1,a=!1){return ee(()=>{const l=e.shape.length;if(l<3)throw new X(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(Ji(2,l));e=st(e,u),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=Se(Se(s,"bool"),"float32"),s.rank===l-1&&(s=lr(s,-1)),s=st(s,u)),r&&(e=Ps(e,0),s!=null&&(s=Ps(s,0)));const c=[];let d,f=n;const p=e.shape[0],m=Ds(e);let y;s!=null&&(y=Ds(s));for(let x=0;x<p;++x){const b=m[x],_=ee(()=>t(b,f));if(s==null)d=_[0],f=_[1];else{const S=ee(()=>{const k=y[x],T=Ie(ds(k),k),$=ge(G(_[0],k),G(f[0],T)),A=f.map((D,F)=>ge(G(_[1][F],k),G(D,T)));return{output:$,newStates:A}});d=S.output,f=S.newStates}a&&c.push(d)}let v;return a&&(v=Vr(c,1)),[d,v,f]})}class Wl extends tt{constructor(e){super(e);let n;if(e.cell==null)throw new X("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new L2({cells:e.cell}):n=e.cell,n.stateSize==null)throw new X("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new _n({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ji(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){JC(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[s].concat(i)}else return s}computeMask(e,n){return ee(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const s=this.states.map(i=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Ze("Constants support is not implemented in RNN yet.");JC(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new _n({shape:[n,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!nt(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new X(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new _n({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){ee(()=>{if(!this.stateful)throw new go("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new X("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>fn([r,s])):this.states_=[fn([r,this.cell.stateSize])];else if(e==null)Qe(this.states_),this.keptStates!=null&&(Qe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>fn([r,s])):this.states_[0]=fn([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new X(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Qe(this.states_);for(let s=0;s<this.states_.length;++s){const i=e[s],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,a=[r,o];if(!nt(i.shape,a))throw new X(`State ${s} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>bn(s.clone()))})}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=qV(e,r,s,this.numConstants);e=i.inputs,r=i.initialState,s=i.constants;let o=[],a=[];if(r!=null){n.initialState=r,o=o.concat(r),this.stateSpec=[];for(const u of r)this.stateSpec.push(new _n({shape:u.shape}));a=a.concat(this.stateSpec)}if(s!=null&&(n.constants=s,o=o.concat(s),this.numConstants=s.length),o[0]instanceof Ro){const u=[e].concat(o),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const f=super.apply(u,n);return this.inputSpec=d,f}else return super.apply(e,n)}call(e,n){return ee(()=>{const r=n==null?null:n.mask,s=n==null?null:n.training;let i=n==null?null:n.initialState;e=We(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new X(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:s},u=XV((m,y)=>{const v=this.cell.call([m].concat(y),a);return[v[0],v.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),c=u[0],d=u[1],f=u[2];this.stateful&&this.resetStates(f,s);const p=this.returnSequences?d:c;return this.returnState?[p].concat(f):p})}getInitialState(e){return ee(()=>{let n=fn(e.shape);return n=Ae(n,[1,2]),n=dy(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?YC(n,[1,r]):n):this.cell.stateSize>1?[YC(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Wl.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const s=n.cell,i=aa(s,r);return new e(Object.assign(n,{cell:i}))}}Wl.className="RNN";ye(Wl);class w1 extends tt{}class D2 extends w1{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Pn(this.units,"units"),this.activation=Tl(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Bt(e.kernelRegularizer),this.recurrentRegularizer=Bt(e.recurrentRegularizer),this.biasRegularizer=Bt(e.biasRegularizer),this.kernelConstraint=kn(e.kernelConstraint),this.recurrentConstraint=kn(e.recurrentConstraint),this.biasConstraint=kn(e.biasConstraint),this.dropout=Gd([1,kl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Gd([1,kl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=dt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ee(()=>{if(e=e,e.length!==2)throw new X(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Nl({ones:()=>ds(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Nl({ones:()=>ds(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=$o(G(e,o),this.kernel.read()):i=$o(e,this.kernel.read()),this.bias!=null&&(i=oo(i,this.bias.read())),a!=null&&(r=G(r,a));let l=ge(i,$o(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Cl(this.activation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:Tt(this.kernelRegularizer),recurrentRegularizer:Tt(this.recurrentRegularizer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),kernelConstraint:Sn(this.kernelConstraint),recurrentConstraint:Sn(this.recurrentConstraint),biasConstraint:Sn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}D2.className="SimpleRNNCell";ye(D2);class ZV extends Wl{constructor(e){e.cell=new D2(e),super(e)}call(e,n){return ee(()=>{this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return new e(n)}}ZV.className="SimpleRNN";ye(ZV);class R2 extends w1{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new X("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Pn(this.units,"units"),this.activation=Tl(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Tl(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Bt(e.kernelRegularizer),this.recurrentRegularizer=Bt(e.recurrentRegularizer),this.biasRegularizer=Bt(e.biasRegularizer),this.kernelConstraint=kn(e.kernelConstraint),this.recurrentConstraint=kn(e.recurrentConstraint),this.biasConstraint=kn(e.biasConstraint),this.dropout=Gd([1,kl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Gd([1,kl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=dt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ee(()=>{if(e=e,e.length!==2)throw new X(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Nl({ones:()=>ds(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Nl({ones:()=>ds(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=G(e,i[0]));let c=$o(e,this.kernel.read());this.useBias&&(c=oo(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=G(s,o[0]));const d=this.recurrentKernel.read(),[f,p]=Fr(d,[2*this.units,this.units],d.rank-1),m=$o(s,f),[y,v,x]=Fr(c,3,c.rank-1),[b,_]=Fr(m,2,m.rank-1);a=this.recurrentActivation.apply(ge(y,b)),l=this.recurrentActivation.apply(ge(v,_));const S=$o(G(l,s),p);u=this.activation.apply(ge(x,S));const k=ge(G(a,s),G(ge(1,$t(a)),u));return[k,k]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Cl(this.activation),recurrentActivation:Cl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:Tt(this.kernelRegularizer),recurrentRegularizer:Tt(this.recurrentRegularizer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),kernelConstraint:Sn(this.kernelConstraint),recurrentConstraint:Sn(this.recurrentConstraint),biasConstraint:Sn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}R2.className="GRUCell";ye(R2);class YV extends Wl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new R2(e),super(e)}call(e,n){return ee(()=>{this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}YV.className="GRU";ye(YV);class _1 extends w1{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Pn(this.units,"units"),this.activation=Tl(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Tl(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Bt(e.kernelRegularizer),this.recurrentRegularizer=Bt(e.recurrentRegularizer),this.biasRegularizer=Bt(e.biasRegularizer),this.kernelConstraint=kn(e.kernelConstraint),this.recurrentConstraint=kn(e.recurrentConstraint),this.biasConstraint=kn(e.biasConstraint),this.dropout=Gd([1,kl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Gd([1,kl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=dt(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;s=new(n=class extends Si{apply(l,u){const c=i.apply([o]),d=new w2().apply([o]),f=i.apply([o*2]);return FD(FD(c,d),f)}},n.className="CustomInit",n)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return ee(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new X(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Nl({ones:()=>ds(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Nl({ones:()=>ds(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,c,d;0<this.dropout&&this.dropout<1&&(e=G(e,o[0]));let f=$o(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=G(s,a[0])),f=ge(f,$o(s,this.recurrentKernel.read())),this.useBias&&(f=oo(f,this.bias.read()));const[p,m,y,v]=Fr(f,4,f.rank-1);l=this.recurrentActivation.apply(p),u=this.recurrentActivation.apply(m),c=ge(G(u,i),G(l,this.activation.apply(y))),d=this.recurrentActivation.apply(v);const x=G(d,this.activation.apply(c));return[x,x,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Cl(this.activation),recurrentActivation:Cl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Tt(this.kernelRegularizer),recurrentRegularizer:Tt(this.recurrentRegularizer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),kernelConstraint:Sn(this.kernelConstraint),recurrentConstraint:Sn(this.recurrentConstraint),biasConstraint:Sn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}_1.className="LSTMCell";ye(_1);class QV extends Wl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new _1(e),super(e)}call(e,n){return ee(()=>{this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}QV.className="LSTM";ye(QV);class L2 extends w1{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return ee(()=>{e=e;let r=e.slice(1);const s=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?s.push(r.splice(0,a.stateSize.length)):s.push(r.splice(0,1));s.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=s[a],a===0?o=[e[0]].concat(r):o=[o[0]].concat(r),o=l.call(o,n),i.push(o.slice(1))}r=[];for(const a of i.slice().reverse())r.push(...a);return[o[0]].concat(r)})}build(e){JC(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,s)=>{Fu(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,n,r={}){const s=[];for(const i of n.cells)s.push(aa(i,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return eT(e)}setWeights(e){const n=[];for(const r of this.cells){const s=r.weights.length,i=e.splice(s);for(let o=0;o<r.weights.length;++o)n.push([r.weights[o],i[o]])}I2(n)}}L2.className="StackedRNNCells";ye(L2);function Nl(t){const{ones:e,rate:n,training:r=!1,count:s=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):W4(e(),n),a=()=>fy(o,e,r);return!s||s<=1?bn(a().clone()):Array(s).fill(void 0).map(a).map(u=>bn(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Cce=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class JV extends Wl{constructor(e){if(e.unroll)throw new Ze("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ze("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new _n({ndim:5})]}call(e,n){return ee(()=>{if(this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new X("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return ee(()=>{const{stateSize:n}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)],o=fn(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){ee(()=>{if(!this.stateful)throw new go("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)];if(r[0]==null)throw new X("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>fn(i)):this.states_=[fn(i)];else if(e==null)Qe(this.states_),this.keptStates!=null&&(Qe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>fn(i)):this.states_[0]=fn(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new X(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Qe(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=i;if(!nt(l.shape,u))throw new X(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>bn(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:s,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",u=e[l?3:2],c=e[l?4:3],d=Zi(u,s[0],i,o[0],a[0]),f=Zi(c,s[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[r,d,f]:[d,f,r]]}}JV.className="ConvRNN2D";class F2 extends _1{constructor(e){const{filters:n,kernelSize:r,strides:s,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Pn(this.filters,"filters"),this.kernelSize=Td(r,2,"kernelSize"),this.kernelSize.forEach(l=>Pn(l,"kernelSize")),this.strides=Td(s||1,2,"strides"),this.strides.forEach(l=>Pn(l,"strides")),this.padding=i||"valid",Bs(this.padding),this.dataFormat=o||"channelsLast",an(this.dataFormat),this.dilationRate=Td(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Pn(l,"dilationRate"))}build(e){var n;e=dt(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new X(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],i=4,o=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends Si{apply(f,p){const m=u.apply([c]),y=Dr([c]),v=u.apply([c*2]);return b2([m,y,v])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return ee(()=>{if(e.length!==3)throw new X(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,s=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Nl({ones:()=>ds(s),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(Y,ie,ne)=>!ie||!ie[ne]?Y:G(ie[ne],Y);let c=u(s,l,0),d=u(s,l,1),f=u(s,l,2),p=u(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Nl({ones:()=>ds(i),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const m=this.recurrentDropoutMask;let y=u(i,m,0),v=u(i,m,1),x=u(i,m,2),b=u(i,m,3);const _=3,[S,k,T,$]=Fr(this.kernel.read(),a,_),[A,D,F,M]=this.useBias?Fr(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,S,A,this.padding),d=this.inputConv(d,k,D,this.padding),f=this.inputConv(f,T,F,this.padding),p=this.inputConv(p,$,M,this.padding);const[j,H,K,Q]=Fr(this.recurrentKernel.read(),a,_);y=this.recurrentConv(y,j),v=this.recurrentConv(v,H),x=this.recurrentConv(x,K),b=this.recurrentConv(b,Q);const Z=this.recurrentActivation.apply(ge(c,y)),se=this.recurrentActivation.apply(ge(d,v)),B=ge(G(se,o),G(Z,this.activation.apply(ge(f,x)))),J=G(this.recurrentActivation.apply(ge(p,b)),this.activation.apply(B));return[J,J,B]})}getConfig(){const e=super.getConfig(),{units:n}=e,r=Cce(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},r),s)}inputConv(e,n,r,s){const i=ga(e,n,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?oo(i,r,this.dataFormat):i}recurrentConv(e,n){return ga(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}F2.className="ConvLSTM2DCell";ye(F2);class eW extends JV{constructor(e){const n=new F2(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}eW.className="ConvLSTM2D";ye(eW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class M2 extends tt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?n[s]:this.noiseShape[s]);return r}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const r=We(e);if(0<this.rate&&this.rate<1){const s=n.training==null?!1:n.training,i=this.getNoiseShape(r);return fy(()=>W4(r,this.rate,i,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}M2.className="Dropout";ye(M2);class tW extends M2{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}tW.className="SpatialDropout1D";ye(tW);class nW extends tt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Pn(this.units,"units"),this.activation=Tl(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=kn(e.kernelConstraint),this.biasConstraint=kn(e.biasConstraint),this.kernelRegularizer=Bt(e.kernelRegularizer),this.biasRegularizer=Bt(e.biasRegularizer),this.activityRegularizer=Bt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=dt(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=dt(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const r=We(e),s=L4(this.activation.getClassName());let i;return s!=null?i=$o(r,this.kernel.read(),s,this.bias?this.bias.read():null):(i=$o(r,this.kernel.read()),this.bias!=null&&(i=oo(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:Cl(this.activation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:Tt(this.kernelRegularizer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),kernelConstraint:Sn(this.kernelConstraint),biasConstraint:Sn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}nW.className="Dense";ye(nW);class rW extends tt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=dt(e);for(const n of e.slice(1))if(n==null)throw new X(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],hl(e,1)]}call(e,n){return ee(()=>{this.invokeCallHook(e,n);let r=We(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let i=2;i<r.rank;++i)s.push(i);s.push(1),r=st(r,s)}return iue(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}rW.className="Flatten";ye(rW);class sW extends tt{constructor(e){super(e),this.supportsMasking=!0,this.activation=Tl(e.activation)}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const r=We(e);return this.activation.apply(r)})}getConfig(){const e={activation:Cl(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}sW.className="Activation";ye(sW);class iW extends tt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return ee(()=>(e=We(e),rue(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}iW.className="RepeatVector";ye(iW);class oW extends tt{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",s=n.slice();let i=1,o=null;for(let l=0;l<s.length;++l){const u=s[l];if(this.isUnknown(u))if(o===null)o=l;else throw new X("Can only specifiy one unknown dimension.");else i*=u}const a=hl(e);if(o!==null){if(i===0||a%i!==0)throw new X(r);s[o]=a/i}else if(a!==i)throw new X(r);return s}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const r=We(e),s=r.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return q(r,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}oW.className="Reshape";ye(oW);class aW extends tt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Ji(1,e.dims.length+1);if(!nt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new _n({ndim:this.dims.length+1})]}computeOutputShape(e){e=dt(e);const n=e.slice();return this.dims.forEach((r,s)=>{n[s+1]=e[r]}),n}call(e,n){return st(We(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}aW.className="Permute";ye(aW);class lW extends tt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=We(e);return am(tc(r,this.maskValue),-1)}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const r=We(e),o=am(tc(r,this.maskValue),-1,!0);return G(r,Se(o,r.dtype))})}}lW.className="Masking";ye(lW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class uW extends tt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(vt(e.inputLength))}this.inputDim=e.inputDim,Pn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Pn(this.outputDim,"outputDim"),this.embeddingsInitializer=zt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Bt(e.embeddingsRegularizer),this.activityRegularizer=Bt(e.activityRegularizer),this.embeddingsConstraint=kn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return ee(()=>this.maskZero?(e=We(e),tc(e,ot(e))):null)}computeOutputShape(e){if(e=dt(e),this.inputLength==null)return[...e,this.outputDim];const n=vt(this.inputLength);if(n.length!==e.length-1)throw new X(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<n.length;++s){const i=n[s],o=e[s+1];if(i!=null&&o!=null&&i!==o)throw new X(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[r]=o),r++}}return[e[0],...n,this.outputDim]}call(e,n){return ee(()=>{this.invokeCallHook(e,n);let r=We(e);r.dtype!=="int32"&&(r=Io(r,"int32"));const s=V4(this.embeddings.read(),q(r,[r.size]));return q(s,dt(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Gt(this.embeddingsInitializer),embeddingsRegularizer:Tt(this.embeddingsRegularizer),activityRegularizer:Tt(this.activityRegularizer),embeddingsConstraint:Sn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}uW.className="Embedding";ye(uW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ic extends tt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Ze}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let s=0;s<n.length;++s){const i=e[e.length-n.length+s],o=n[s];if(i==null||o==null||i<0||o<0)r.push(null);else if(i===1)r.push(o);else if(o===1)r.push(i);else{if(i!==o)throw new X("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[dt(e)]),e=e,e.length<2)throw new X(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=dl(n),n.length>1)throw new X(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const s=e.map(i=>i.length);e.indexOf(null)===-1&&dl(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return ee(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(i=>i.rank);if(s.indexOf(null)===-1){const i=kl(s);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=dy(o,1);r.push(o)}return this.mergeFunction(r)}else{let i=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,d=c[0],f=c.slice(1).concat([d]);let p=q(l,[d].concat(hl(c.slice(1))));p=st(p,[1,0]),p=q(p,f),r.push(p),i=!0}else if(u>1){const c=Ji(1,u).concat([0]);r.push(st(l,c)),i=!0}else r.push(l)}let o=this.mergeFunction(r);const a=o.rank;if(i){if(a==null){const l=o.shape,u=l.length,c=l[u-1],d=[c].concat(l.slice(0,l.length-1));o=q(st(q(o,[-1,c]),[1,0]),d)}else if(a>1){const l=[a-1].concat(Ji(0,a-1));o=st(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=dl(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return ee(()=>{if(n==null)return null;if(!Array.isArray(n))throw new X("`mask` should be an Array");if(!Array.isArray(e))throw new X("`inputs` should be an Array");if(n.length!==e.length)throw new X(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(s=>s==null))return null;n=n.map(s=>s==null?s:lr(s,0));let r=n[0];for(let s=1;s<n.length-1;++s)r=Qi(r,n[s]);return r})}}class cW extends Ic{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=ge(n,e[r]);return n})}}cW.className="Add";ye(cW);class dW extends Ic{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=G(n,e[r]);return n})}}dW.className="Multiply";ye(dW);class hW extends Ic{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=ge(n,e[r]);return G(1/e.length,n)})}}hW.className="Average";ye(hW);class fW extends Ic{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Mo(n,e[r]);return n})}}fW.className="Maximum";ye(fW);class pW extends Ic{constructor(e){super(e)}mergeFunction(e){return ee(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Sl(n,e[r]);return n})}}pW.className="Minimum";ye(pW);class mW extends Ic{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new X("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const s of e)if(s!=null){n=!1;break}if(n)return;const r=[];for(let s=0;s<e.length;++s){const i=e[s].slice();i.splice(this.axis,1);let o=!1;for(const a of r)if(nt(a,i)){o=!0;break}o||r.push(i)}if(r.length>1)throw new X("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ee(()=>b2(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new X("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const i of n.slice(1)){if(r[s]==null||i[s]==null){r[s]=null;break}r[s]+=i[s]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new X("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new X("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new X(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return ee(()=>{let r=!0;if(n.forEach(o=>{if(o!=null){r=!1;return}}),r)return null;const s=[];for(let o=0;o<e.length;++o)n[o]==null?s.push(Se(ds(e[o]),"bool")):n[o].rank<e[o].rank?s.push(lr(n[o],-1)):s.push(n[o]);const i=rn(s,this.axis);return Nw(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}mW.className="Concatenate";ye(mW);function np(t,e){for(;t<0;)t+=e;return t}function Tce(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ze("batchDot is not implemented for tensors of 4D or higher rank yet");if(O(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),O(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Ze("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,s=e.shape.length;n==null&&(n=[r-1,s-2]);const i=n;return ee(()=>{let o;if(r>s){o=r-s;const l=[];for(let u=0;u<o;++u)l.push(1);e=q(e,e.shape.concat(l))}else if(s>r){o=s-r;const l=[];for(let u=0;u<o;++u)l.push(1);t=q(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Ae(G(t,e),i[0]):a=Ae(G(st(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,u=i[1]===e.shape.length-1;a=Ye(t,e,l,u)}if(o>0){let l;r>s?l=r+s-3:l=r-1;const u=[];for(let c=l;c<l+o;++c)u.push(c);a=jl(a,u)}return a.shape.length===1&&(a=lr(a,1)),a})}let gW=class extends Ic{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){O(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new Ze("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);if(n[s[0]]!==r[s[1]])throw new X(`Dimension incompatibility: ${n[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new X(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,o)=>np(i,e[o].shape.length)):s=[np(this.axes,n.shape.length),np(this.axes,r.shape.length)],this.normalize&&(n=ex(n,s[0]),r=ex(r,s[1])),Tce(n,r,s)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[np(this.axes,e.length),np(this.axes,n.length)],r}computeOutputShape(e){O(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new Ze("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);n.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const i=n.concat(r);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}};gW.className="Dot";ye(gW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yW extends tt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const r=We(e);return fy(()=>ge(m1(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}yW.className="GaussianNoise";ye(yW);class vW extends tt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ee(()=>{this.invokeCallHook(e,n);const r=We(e);return this.rate>0&&this.rate<1?fy(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return G(r,m1(r.shape,1,i))},()=>r,n.training||!1):r})}}vW.className="GaussianDropout";ye(vW);class xW extends tt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||We(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ee(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return fy(()=>{const i=We(e),a=-1.6732632423543772*1.0507009873554805;let l=$a(Bl(r),this.rate);l=Io(l,"float32");const u=((1-this.rate)*(1+this.rate*a**2))**-.5,c=-u*a*this.rate,d=ge(G(i,l),G(ge(l,-1),a));return ge(G(d,u),c)},()=>We(e),n.training||!1)}return e})}}xW.className="AlphaDropout";ye(xW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pm(t,e,n,r,s,i=.001){let o;if(t.rank===2)o=DI(t,e,n,r,s,i);else if(t.rank===3)o=RI(t,e,n,r,s,i);else if(t.rank===4)o=LI(t,e,n,r,s,i);else throw new Ze(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function Nce(t,e,n,r,s=.001){return ee(()=>{const i=Jg(t,r),o=i.mean,a=i.variance;return[pm(t,o,a,n,e,s),o,a]})}function Ice(t,e,n,r,s=.001){return ee(()=>{const i=Jg(t,r),o=i.mean,a=i.variance,l=[];for(const m of Ji(0,t.rank))r.indexOf(m)!==-1?l.push(1):l.push(t.shape[m]);const u=q(o,l),c=q(a,l),d=e==null?null:q(e,l),f=n==null?null:q(n,l);return[pm(t,u,c,f,d,s),o,a]})}function $ce(t,e,n,r,s=.001){return nt(r.slice().sort(),Ji(0,t.rank-1))?Nce(t,e,n,r,s):Ice(t,e,n,r,s)}class bW extends tt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=zt(e.betaInitializer||"zeros"),this.gammaInitializer=zt(e.gammaInitializer||"ones"),this.movingMeanInitializer=zt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=zt(e.movingVarianceInitializer||"ones"),this.betaConstraint=kn(e.betaConstraint),this.gammaConstraint=kn(e.gammaConstraint),this.betaRegularizer=Bt(e.betaRegularizer),this.gammaRegularizer=Bt(e.gammaRegularizer)}build(e){e=dt(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new X(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new _n({ndim:e.length,axes:{[n]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return ee(()=>{const r=n.training==null?!1:n.training,s=We(e),i=s.shape,o=i.length,a=Ji(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const u=ic(1,o);u[l]=i[l];const c=a.slice();c.sort();const d=!nt(c,Ji(0,o).slice(0,o-1)),f=()=>{if(d){const b=q(this.movingMean.read(),u),_=q(this.movingVariance.read(),u),S=this.center?q(this.beta.read(),u):null,k=this.scale?q(this.gamma.read(),u):null;return pm(s,b,_,S,k,this.epsilon)}else return pm(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return f();const[p,m,y]=$ce(s,this.gamma.read(),this.beta.read(),a,this.epsilon),v=(b,_,S)=>{ee(()=>{const k=1-S,T=b.read(),$=G(Ie(T,_),k);b.write(Ie(T,$))})};return(()=>{v(this.movingMean,m,this.momentum),v(this.movingVariance,y,this.momentum)})(),p})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gt(this.betaInitializer),gammaInitializer:Gt(this.gammaInitializer),movingMeanInitializer:Gt(this.movingMeanInitializer),movingVarianceInitializer:Gt(this.movingVarianceInitializer),betaRegularizer:Tt(this.betaRegularizer),gammaRegularizer:Tt(this.gammaRegularizer),betaConstraint:Sn(this.betaConstraint),gammaConstraint:Sn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}bW.className="BatchNormalization";ye(bW);class wW extends tt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=zt(e.betaInitializer||"zeros"),this.gammaInitializer=zt(e.gammaInitializer||"ones"),this.betaRegularizer=Bt(e.betaRegularizer),this.gammaRegularizer=Bt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=dt(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==dl(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,n){const r=We(e),s=r.shape,i=s.length;return ee(()=>{let{mean:a,variance:l}=Jg(r,this.axis,!0);const u=ic(1,i);for(const y of this.axis)u[y]=s[y];const c=y=>y!=null&&y.shape.length!==i?q(y,u):y;let d=this.scale?c(this.gamma.read()):null,f=this.center?c(this.beta.read()):null;const p=[],m=[];for(let y=0;y<i;++y)this.axis.indexOf(y)!==-1?(p.push(s[y]),m.push(1)):(p.push(1),m.push(s[y]));return a=Ts(a,p),l=Ts(l,p),d!=null&&(d=Ts(d,m)),f!=null&&(f=Ts(f,m)),pm(r,a,l,f,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gt(this.betaInitializer),gammaInitializer:Gt(this.gammaInitializer),betaRegularizer:Tt(this.betaRegularizer),gammaRegularizer:Tt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}wW.className="LayerNormalization";ye(wW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ece(t,e,n){return ee(()=>{if(t.rank!==4)throw new X(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new X("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=eo()),n!=="channelsLast"&&n!=="channelsFirst")throw new X(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],Ea(t,r)})}class _W extends tt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?eo():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new X(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new X(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new X(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new _n({ndim:4})]}computeOutputShape(e){e=dt(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return ee(()=>Ece(We(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}_W.className="ZeroPadding2D";ye(_W);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function S1(t,e,n,r,s,i){return ee(()=>{an(s),M4(i),Bs(r),n==null&&(n=[1,1]),r==null&&(r="valid"),s==null&&(s=eo()),i==null&&(i="max"),t=P2(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=Qg(t,e,n,a):o=Ug(t,e,n,a),s==="channelsFirst"&&(o=st(o,[0,3,1,2])),o})}function SW(t,e,n,r,s,i){return ee(()=>{an(s),M4(i),Bs(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),s==null&&(s=eo()),i==null&&(i="max"),t=BV(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=i$(t,e,n,a):o=PI(t,e,n,a),s==="channelsFirst"&&(o=st(o,[0,4,1,2,3])),o})}class kW extends tt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new X(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Pn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new X(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Pn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Bs(this.padding),this.inputSpec=[new _n({ndim:3})]}computeOutputShape(e){e=dt(e);const n=Zi(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return ee(()=>{this.invokeCallHook(e,n),e=dy(We(e),2);const r=this.poolingFunction(We(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return jl(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class CW extends kW{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return an(i),Bs(s),S1(e,n,r,s,i,"max")}}CW.className="MaxPooling1D";ye(CW);class TW extends kW{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return an(i),Bs(s),S1(e,n,r,s,i,"avg")}}TW.className="AveragePooling1D";ye(TW);class NW extends tt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new X(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Pn(this.poolSize,"poolSize"),Pn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,an(this.dataFormat),Bs(this.padding),this.inputSpec=[new _n({ndim:4})]}computeOutputShape(e){e=dt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Zi(n,this.poolSize[0],this.padding,this.strides[0]),r=Zi(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return ee(()=>(this.invokeCallHook(e,n),this.poolingFunction(We(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class IW extends NW{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return an(i),Bs(s),S1(e,n,r,s,i,"max")}}IW.className="MaxPooling2D";ye(IW);class $W extends NW{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return an(i),Bs(s),S1(e,n,r,s,i,"avg")}}$W.className="AveragePooling2D";ye($W);class EW extends tt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new X(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Pn(this.poolSize,"poolSize"),Pn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,an(this.dataFormat),Bs(this.padding),this.inputSpec=[new _n({ndim:5})]}computeOutputShape(e){e=dt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Zi(n,this.poolSize[0],this.padding,this.strides[0]),r=Zi(r,this.poolSize[1],this.padding,this.strides[1]),s=Zi(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,s]:[e[0],n,r,s,e[4]]}call(e,n){return ee(()=>(this.invokeCallHook(e,n),this.poolingFunction(We(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class AW extends EW{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return an(i),Bs(s),SW(e,n,r,s,i,"max")}}AW.className="MaxPooling3D";ye(AW);class OW extends EW{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return an(i),Bs(s),SW(e,n,r,s,i,"avg")}}OW.className="AveragePooling3D";ye(OW);class PW extends tt{constructor(e){super(e),this.inputSpec=[new _n({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Ze}}class DW extends PW{constructor(e){super(e||{})}call(e,n){return ee(()=>{const r=We(e);return Ut(r,1)})}}DW.className="GlobalAveragePooling1D";ye(DW);class RW extends PW{constructor(e){super(e||{})}call(e,n){return ee(()=>{const r=We(e);return Es(r,1)})}}RW.className="GlobalMaxPooling1D";ye(RW);class LW extends tt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,an(this.dataFormat),this.inputSpec=[new _n({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Ze}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class FW extends LW{call(e,n){return ee(()=>{const r=We(e);return this.dataFormat==="channelsLast"?Ut(r,[1,2]):Ut(r,[2,3])})}}FW.className="GlobalAveragePooling2D";ye(FW);class MW extends LW{call(e,n){return ee(()=>{const r=We(e);return this.dataFormat==="channelsLast"?Es(r,[1,2]):Es(r,[2,3])})}}MW.className="GlobalMaxPooling2D";ye(MW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zW extends tt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const s=n.layer,i=aa(s,r);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class BW extends zW{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=dt(e),e.length<3)throw new X(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=dt(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,n){return ee(()=>(e=We(e),XV((o,a)=>[We(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}BW.className="TimeDistributed";ye(BW);function Ace(t){Nc(Qle,"BidirectionalMergeMode",t)}const Oce="concat";class jW extends zW{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=aa(r),n.goBackwards=n.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=n,this.backwardLayer=aa(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Oce:e.mergeMode,Ace(this.mergeMode),e.weights)throw new Ze("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,s,i;return this.returnState&&(i=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):Pr(s)}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=qV(e,r,s,this.numConstants);if(e=i.inputs,r=i.initialState,s=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,n);const o=[],a=[];if(r!=null){const u=r.length;if(u%2>0)throw new X("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,o.push(...r);const c=r.map(d=>new _n({shape:d.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),a.push(...c)}if(s!=null)throw new Ze("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof Ro;for(const u of o)if(u instanceof Ro!==l)throw new X("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(o),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const f=super.apply(u,n);return this.inputSpec=d,f}else return super.apply(e,n)}call(e,n){return ee(()=>{const r=n.initialState;let s,i;if(r==null)s=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=r.slice(0,r.length/2),u=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let o;this.returnState&&(Array.isArray(s)&&(o=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=Ps(i,1));let a;return this.mergeMode==="concat"?a=b2([s,i]):this.mergeMode==="sum"?a=ge(s,i):this.mergeMode==="ave"?a=G(.5,ge(s,i)):this.mergeMode==="mul"?a=G(s,i):this.mergeMode==null&&(a=[s,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Fu(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Fu(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=aa(n.layer);if(delete n.layer,n.numConstants!=null)throw new Ze("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=n;return s.layer=r,new e(s)}}jW.className="Bidirectional";ye(jW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class VW extends tt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ee(()=>(e=We(e),e.dtype!=="float32"&&(e=Io(e,"float32")),ge(G(e,this.scale),this.offset)))}}VW.className="Rescaling";ye(VW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Pce,cropAndResize:Dce}=Gi;class WW extends tt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,s,i,o,a,l){return ee(()=>{let u,c=!1;const d=n/o,f=r/a,p=(s+n)/o,m=(i+r)/a,y=[d,f,p,m],v=[];e.rank===3?(c=!0,u=Vr([e])):u=e;for(let k=0;k<u.shape[0];k++)v.push(y);const x=fi(v,[v.length,4]),b=nc(0,v.length,1,"int32"),S=Dce(u,x,b,[s,i],"nearest");return Io(c?We(Ds(S)):S,l)})}upsize(e,n,r,s){return ee(()=>{const i=Pce(e,[n,r]);return Io(i,s)})}call(e,n){return ee(()=>{const r=We(e),s=r.dtype,i=r.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(r,l,u,this.height,this.width,o,a,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=dt(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}WW.className="CenterCrop";ye(WW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rce(t,e,n,r){let s=We(t);if(s.dtype!=="int32"&&(s=Io(s,"int32")),e==="int")return s;const i=s.shape;if(s.rank===0&&(s=lr(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=lr(s,-1)),s.rank>2)throw new X(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${s.rank}.`);const o=["multiHot","oneHot"].includes(e),a=s;let l;if(typeof r<"u"&&e==="count"?l=H0(a,r,n,o):l=H0(a,[],n,o),e!=="tfIdf")return l;if(r)return G(l,r);throw new X("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class UW extends tt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=dt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return ee(()=>{e=We(e),e.dtype!=="int32"&&(e=Io(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new X(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=We(n.countWeights)}const s=Es(e),i=zd(e),o=Kr(this.numTokens,s).bufferSync().get(0),a=$a(i,0).bufferSync().get(0);if(!(o&&a))throw new X(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Rce(e,this.outputMode,this.numTokens,r)})}}UW.className="CategoryEncoding";ye(UW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Lce=["bilinear","nearest"],tR=new Set(Lce);class GW extends tt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(tR.has(e.interpolation))this.interpolation=e.interpolation;else throw new X(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=dt(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ee(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Gi.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Gi.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...tR]} are supported`)})}}GW.className="Resizing";ye(GW);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class HW{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}HW.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class KW extends tt{constructor(e){super(e),this.randomGenerator=new HW(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}KW.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Fce=["bilinear","nearest"],nR=new Set(Fce);class qW extends KW{constructor(e){super(e);const{factor:n,interpolation:r="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new X(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new X(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new X(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(nR.has(r))this.interpolation=r;else throw new X(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=dt(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return ee(()=>{const r=We(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=Bl([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Gi.resizeBilinear(e,o);case"nearest":return Gi.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...nR]} are supported`)}})}}qW.className="RandomWidth";ye(qW);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var rR;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(rR||(rR={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pe(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&O(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mce=Jw;class k1 extends gb{nextDataId(){return k1.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new iI(this,Li())}write(e,n,r){this.firstUse&&(this.firstUse=!1,te().get("IS_NODE")&&_s(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&bo(r[0])){const i=r.map(o=>Co(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return{dataId:s,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,s,i){this.data.set(e,{values:n,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const s=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return ya(s,i)}return Jz(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>pa(s));return qe(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return qe(e.shape,e.dtype,n)}makeOutput(e,n,r){return Li().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=xr();return e(),{kernelMs:xr()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Pe([e],"where");const n=this.readSync(e.dataId);return Mce(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}k1.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const zce=t=>{const{x:e}=t.inputs,n=t.backend;Pe(e,"abs");let r=new Float32Array(oe(e.shape));const s=n.data.get(e.dataId).values;return r=XW(s),n.makeOutput(r,e.shape,e.dtype)},Bce={kernelName:Mm,backendName:"cpu",kernelFunc:zce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ln(t){return(e,n,r,s,i)=>{const o=Ke(e,n),a=o.length,l=ze(o),u=oe(o),c=Dn(i,u),d=e.length,f=n.length,p=ze(e),m=ze(n),y=ec(e,o),v=ec(n,o);if(y.length+v.length===0)for(let x=0;x<c.length;++x)c[x]=t(r[x%r.length],s[x%s.length]);else for(let x=0;x<c.length;++x){const b=xc(x,a,l),_=b.slice(-d);y.forEach($=>_[$]=0);const S=qi(_,d,p),k=b.slice(-f);v.forEach($=>k[$]=0);const T=qi(k,f,m);c[x]=t(r[S],s[T])}return[c,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ns(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(s.shape,"float32",o)},a}const jce={kernelName:Cb,backendName:"cpu",kernelFunc:ns};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ix(t,e,n="float32"){if(n==="complex64"){const s=ix(t,e,"float32"),i=ix(t,e,"float32");return ns({inputs:{real:s,imag:i},backend:t})}const r=Xn(oe(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lo(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Vce={kernelName:Eh,backendName:"cpu",kernelFunc:Lo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oc(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const Wce={kernelName:sw,backendName:"cpu",kernelFunc:oc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=Rl([0],n),[i,o]=ln((a,l)=>a!==l?1:0)(e,[],t,s,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Il(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return Lo({inputs:{x:s},backend:n});const c=ix(n,s.shape,s.dtype),d=Il({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),f=ns({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),f}if(s.dtype==="complex64"){const c=oc({inputs:{input:s},backend:n}),d=Il({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),d}if(!lI(s.dtype,i)){const c=Lo({inputs:{x:s},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:i}}const o=n.data.get(s.dataId).values,[a,l,u]=ZW(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,l,u)}const Uce={kernelName:yh,backendName:"cpu",kernelFunc:Il};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tn(t,e,n,r){return n==null?({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;Pe([o,a],t);const u=l.data.get(o.dataId).values,c=l.data.get(a.dataId).values,d=o.dtype==="string"?va(u):u,f=o.dtype==="string"?va(c):c,p=r||o.dtype,[m,y]=e(o.shape,a.shape,d,f,p);return l.makeTensorInfo(y,p,m)}:({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const u=Il({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,f=c.complexTensorInfos.imag,p=l.data.get(d.dataId).values,m=l.data.get(f.dataId).values,y=Il({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),v=l.data.get(y.dataId),x=v.complexTensorInfos.real,b=v.complexTensorInfos.imag,_=l.data.get(x.dataId).values,S=l.data.get(b.dataId).values,[k,T,$]=n(o.shape,a.shape,p,m,_,S),A=l.makeTensorInfo($,"float32",k),D=l.makeTensorInfo($,"float32",T),F=ns({inputs:{real:A,imag:D},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(y),l.disposeIntermediateTensorInfo(A),l.disposeIntermediateTensorInfo(D),F}else{const u=l.data.get(o.dataId).values,c=l.data.get(a.dataId).values,d=r||o.dtype,[f,p]=e(o.shape,a.shape,u,c,d);return l.makeTensorInfo(p,d,f)}}}function z2(t){return(e,n,r,s,i,o)=>{const a=Ke(e,n),l=oe(a),u=a.length,c=ze(a),d=Dn("float32",l),f=Dn("float32",l),p=ec(e,a),m=ec(n,a),y=ya(r,s),v=ya(i,o),x=e.length,b=ze(e),_=n.length,S=ze(n);if(p.length+m.length===0)for(let k=0;k<d.length;k++){const T=k%y.length,$=k%v.length,A=t(y[T*2],y[T*2+1],v[$*2],v[$*2+1]);d[k]=A.real,f[k]=A.imag}else for(let k=0;k<d.length;k++){const T=xc(k,u,c),$=T.slice(-x);p.forEach(j=>$[j]=0);const A=qi($,x,b),D=T.slice(-_);m.forEach(j=>D[j]=0);const F=qi(D,_,S),M=t(y[A*2],y[A*2+1],v[F*2],v[F*2+1]);d[k]=M.real,f[k]=M.imag}return[d,f,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YW=ln((t,e)=>t+e),Gce=z2((t,e,n,r)=>({real:t+n,imag:e+r})),Hd=Tn(bc,YW,Gce),Hce={kernelName:bc,backendName:"cpu",kernelFunc:Hd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B2(t,e,n,r,s){const i=oe(r),o=Xn(s,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function QW(t,e,n,r=!1){const s=t.shape[0],i=t.shape[1],o=qe([s,n],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<i;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?o.set(1,a,u):e.size>0?o.set(o.get(a,u)+e.get(a,l),a,u):o.set(o.get(a,u)+1,a,u))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JW=ln((t,e)=>t&e),Kce=Tn(Hm,JW),qce={kernelName:Hm,backendName:"cpu",kernelFunc:Kce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zo(t){return(e,n,r)=>{const s=Yt(n,e.length);for(let i=0;i<e.length;++i)s[i]=t(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bt(t,e,n){const r=zo(e);return Ul(t,r,n)}function Ul(t,e,n){return({inputs:r,attrs:s,backend:i})=>{const{x:o}=r;Pe(o,t);const a=i,l=a.data.get(o.dataId).values;let u;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=va(l)}else u=l;const c=n||o.dtype,d=e(u,c,s);return a.makeTensorInfo(o.shape,c,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eU=zo(t=>Math.ceil(t)),Xce=Ul(vh,eU),Zce={kernelName:vh,backendName:"cpu",kernelFunc:Xce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(t,e,n,r){const s=Yt(n,oe(e));if(r&&n!=="string"){let i=0;t.forEach(o=>{const a=oe(o.shape);s.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?va(o.vals):o.vals;let l=0;for(let u=0;u<o.shape[0];++u){const c=u*e[1]+i;for(let d=0;d<o.shape[1];++d)s[c+d]=a[l++]}i+=o.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nU=ln((t,e)=>t===e?1:0),rU=Tn(tg,nU,null,"bool"),Yce={kernelName:tg,backendName:"cpu",kernelFunc:rU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sU=zo(t=>Math.exp(t)),iU=Ul(Ch,sU,"float32"),Qce={kernelName:Ch,backendName:"cpu",kernelFunc:iU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oU=zo(t=>Math.expm1(t)),Jce=Ul(Th,oU),ede={kernelName:Th,backendName:"cpu",kernelFunc:Jce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aU=zo(t=>Math.floor(t)),tde=Ul(Nh,aU),nde={kernelName:Nh,backendName:"cpu",kernelFunc:tde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lU=ln((t,e)=>Math.floor(t/e)),rde=Tn(Ih,lU,null,"int32"),sde={kernelName:Ih,backendName:"cpu",kernelFunc:rde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t,e,n,r,s,i,o,a,l){const u=qe([r,i],n);for(let c=0;c<r;c++){const d=[];let f=0;for(let p=0;p<s;p++){const m=t[c*s+p];f+=m*o[p],d.push(m)}if(f<0||f>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let p=0;p<i;p++)u.values[c*i+p]=e.get(...e.indexToLoc(f*i+p))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cU(t,e,n){const r=qe(n,t.dtype);for(let s=0;s<r.size;++s){const o=r.indexToLoc(s).slice(),a=o[0],l=o[2],u=e.locToIndex([a,l]);o[2]=e.values[u];const c=t.locToIndex(o);0<=c&&c<t.values.length&&(r.values[s]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dU=ln((t,e)=>t>e?1:0),ide=Tn(ig,dU,null,"bool"),ode={kernelName:ig,backendName:"cpu",kernelFunc:ide};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hU=ln((t,e)=>t>=e?1:0),ade=Tn($h,hU,null,"bool"),lde={kernelName:$h,backendName:"cpu",kernelFunc:ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fU=ln((t,e)=>t<e?1:0),ude=Tn(ag,fU,null,"bool"),cde={kernelName:ag,backendName:"cpu",kernelFunc:ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pU=ln((t,e)=>t<=e?1:0),dde=Tn(lg,pU,null,"bool"),hde={kernelName:lg,backendName:"cpu",kernelFunc:dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mU(t,e,n){const r=(e-t)/(n-1),s=Xn(n,"float32");s[0]=t;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gU=zo(t=>Math.log(t)),fde=Ul(Dh,gU),pde={kernelName:Dh,backendName:"cpu",kernelFunc:fde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yU(t,e,n,r){const s=Dn(r,oe(n));for(let i=0;i<s.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const u=t[o+l];(Number.isNaN(u)||u>a)&&(a=u)}s[i]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vU=ln((t,e)=>Math.max(t,e)),mde=Tn(Lh,vU),gde={kernelName:Lh,backendName:"cpu",kernelFunc:mde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xU=ln((t,e)=>Math.min(t,e)),yde=Tn(Fh,xU),vde={kernelName:Fh,backendName:"cpu",kernelFunc:yde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j2=ln((t,e)=>t*e),xde=z2((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),C1=Tn(zh,j2,xde),bde={kernelName:zh,backendName:"cpu",kernelFunc:C1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(t,e,n){const r=Ta(-1,n);return j2([],e,r,t,n)}function wde(t){const{inputs:e,backend:n}=t,{x:r}=e;Pe(r,"neg");const s=n.data.get(r.dataId).values,[i,o]=bU(s,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}const _de={kernelName:xg,backendName:"cpu",kernelFunc:wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wU=ln((t,e)=>t!==e?1:0),Sde=Tn(bg,wU,null,"bool"),kde={kernelName:bg,backendName:"cpu",kernelFunc:Sde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V2(t,e,n,r,s){const i=e.length,o=oe(e),a=ze(e),l=ze(s),u=Dn(n,oe(s));for(let c=0;c<o;++c){const d=xc(c,i,a),f=new Array(d.length);for(let m=0;m<f.length;m++)f[m]=d[r[m]];const p=qi(f,i,l);u[p]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wr(t){const{inputs:e,attrs:n,backend:r}=t,{x:s}=e,{perm:i}=n;Pe(s,"transpose");const o=s.shape.length,a=new Array(o);for(let d=0;d<a.length;d++)a[d]=s.shape[i[d]];const l=r.data.get(s.dataId).values,u=V2(l,s.shape,s.dtype,i,a);return{dataId:r.write(u,a,s.dtype),shape:a,dtype:s.dtype}}const Cde={kernelName:Ru,backendName:"cpu",kernelFunc:Wr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _U(t,e,n,r){const[s,i]=Fn(t,r),o=Mr(e,"int32"),a=Xn(oe(s),o),l=oe(i);for(let u=0;u<a.length;++u){const c=u*l;let d=1;for(let f=0;f<l;++f)d*=n[c+f];a[u]=d}return{outVals:a,outShape:s,outDtype:o}}function Tde(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Pe(s,"prod");const a=s.shape.length,l=Je(i,s.shape),u=qt(l,a);let c=l,d=s;const f=[];u!=null&&(d=Wr({inputs:{x:s},backend:n,attrs:{perm:u}}),f.push(d),c=on(c.length,a));const p=n.data.get(d.dataId).values,{outVals:m,outShape:y,outDtype:v}=_U(d.shape,d.dtype,p,c);let x=y;return o&&(x=sn(y,l)),f.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(x,v,m)}const Nde={kernelName:Tg,backendName:"cpu",kernelFunc:Tde};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ide(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const i=xc(s,e.length,ze(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function $de(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function Ede(t,e,n,r){const s=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);$de(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)a[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let f=0;f<n.length;++f){const p=n[f],m=f+e.length-1;if(m>=0){const y=a[m],v=y[y.length-1]-p[c];for(let x=c;x<d;++x)a[m].push(p[x+1]+v)}c=p[c],d=p[d]}d!==c&&(s.push([c,d]),i+=d-c)}return{outSplits:a,valueSlices:s,numValues:i}}function Ade(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=Yt("int32",r);e.push(s),t[n].forEach((i,o)=>s[o]=i)}return e}function sR(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function Ode(t,e,n,r,s,i){const o=sR(e,2)[1],a=sR(i,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)s[l*a+d]=t[c*o+d];++l}}function Pde(t,e,n,r,s){const i=e.slice();i[0]=s;const o=Yt(n,oe(i)),a=t.length,l=a===0?0:a/e[0];return Ode(t,e,r,l,o,i),[o,i]}function SU(t,e,n,r,s,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Ide(i,o,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:f}=Ede(i,o,t,u),p=Ade(c),m=Pde(n,r,s,d,f);return[p,m[0],m[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iR=2147483647;function kU(t,e,n,r,s,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,u=o.length===0,c=[];a||c.push(e[0]),l||c.push(s[0]),u||c.push(o[0]);for(let v=1;v<c.length;++v)if(c[v]!==c[v-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],f=Yt("int32",d+1);f[0]=0;for(let v=0;v<d;++v){const x=a?t[0]:t[v],b=l?r[0]:r[v],_=u?i[0]:i[v];if(_===0)throw new Error("Requires delta != 0");let S;if(_>0&&b<x||_<0&&b>x)S=0;else if(S=Math.ceil(Math.abs((b-x)/_)),S>iR)throw new Error(`Requires ((limit - start) / delta) <= ${iR}`);f[v+1]=f[v]+S}const p=f[d],m=Yt(n,p);let y=0;for(let v=0;v<d;++v){const x=f[v+1]-f[v];let b=a?t[0]:t[v];const _=u?i[0]:i[v];for(let S=0;S<x;++S)m[y++]=b,b+=_}return[f,m]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Xs=Bi;class ox{constructor(e,n,r,s,i,o,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=i4(c),this.raggedRank=o4(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Xs.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Xs.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Xs.VALUE_ROWIDS:return ox.getMaxWidthValueRowID(n);case Xs.ROW_SPLITS:return ox.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Xs[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==s&&(s=a,i=Math.max(o-r,i),r=o)}return Math.max(n-r,i)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return aR(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;a4(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=s4(this.raggedRank,s,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),i=[];let o=0;for(let a=0;a<s;++a,o+=n)i.push(o);for(let a=s;a<e;++a)i.push(-1);return O(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,r,s){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let u=Math.min(s,l),c=n[a];c===-1&&(u=0);for(let d=0;d<u;++d)o.push(c),c+=r;for(let d=0;d<l-u;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,s){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];o.push(u);for(let c=1;c<i;++c){const d=e[c];if(d===l)u>=0&&(++a,a<s?u+=r:u=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,s){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Xs.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,r,s);case Xs.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,r,s);default:throw new Error(`Unsupported partition type: ${Xs[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Xs.FIRST_DIM_SIZE:return e[0];case Xs.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Xs.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Xs[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const i=aR(r,!1),o=Yt(this.valuesDType,oe(i));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,r,s){if(r.length===0)return;const i=this.values,o=r;let a=s.slice();a=a.slice(e+1);const l=oe(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const m=this.defaultValueShape;ee(()=>{const y=q(c,m);c=Lu(y,a).dataSync()})}let d=0,f=0,p=0;for(let m=0;m<=u;++m){let y=m<u?n[m]:-1;if(y===p){++p;continue}if(f<p){const v=i.subarray(d*l),x=o.subarray(f*l),b=(p-f)*l;oR(x,v,b)}if(m>=u){const v=r.length;y=Math.floor(v/l)}if(y>p)if(this.defaultValue.length===1)o.subarray(p*l,y*l).fill(this.defaultValue[0]),p=y;else for(;y>p;){const v=o.slice(p*l);oR(v,c,l),++p}y<0?(d=m+1,f=p):(d=m,f=p,p=f+1)}}}function oR(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function aR(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function CU(t,e,n,r,s,i,o,a,l,u){return new ox(t,e,n,r,s,i,o,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(t,e,n,r){const s=t===e,i=t<e&&n<0,o=e<t&&n>1;if(s||i||o)return Xn(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=Xn(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NU=zo(t=>1/Math.sqrt(t)),Dde=Ul(Gh,NU),Rde={kernelName:Gh,backendName:"cpu",kernelFunc:Dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tu(t,e,n,r,s,i,o,a,l,u){const c=[r/s,s],d=t.values,f=e.values;if(r===0)return qe(n,e.dtype);const p=l instanceof pn?l:qe(c,e.dtype);typeof l=="string"||typeof l=="number"?p.values.fill(l):typeof l=="boolean"&&p.values.fill(+l);for(let m=0;m<i;m++){const y=[];let v=0;for(let x=0;x<o;x++){const b=d[m*o+x];y.push(b),v+=b*a[x]}if(v<0||v>=r/s)throw new Error(`Invalid indices: ${y} does not index into ${n}`);for(let x=0;x<s;x++)u?p.values[v*s+x]+=f[m*s+x]:p.values[v*s+x]=e.rank===0?f[0]:f[m*s+x]}return p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lde=zo(t=>1/(1+Math.exp(-t))),IU=bt(Zh,t=>1/(1+Math.exp(-t))),Fde={kernelName:Zh,backendName:"cpu",kernelFunc:IU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $U(t,e,n,r,s){const i=G$(r,e,n),o=oe(n),a=ze(r);if(i){const d=H$(e,a);return s==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=s==="string"?va(t):t,u=qe(r,s,l),c=qe(n,s);for(let d=0;d<c.size;++d){const f=c.indexToLoc(d),p=f.map((m,y)=>m+e[y]);c.set(u.get(...p),...f)}return s==="string"?N4(c.values):c.values}function ac(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r;Pe(s,"slice");const[a,l]=c1(s,i,o);W$(s,a,l);const u=n.data.get(s.dataId).values,c=$U(u,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,c)}const Mde={kernelName:Og,backendName:"cpu",kernelFunc:ac};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EU(t,e,n,r,s,i,o){const a=e[0],l=i[0],u=new Array(l),c=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(p4(a));const v=Yt(n,0),x=Yt(s,0);return[v,[0,d],x,u,c]}let f=!0,p=0;const m=new Array(l).fill(0);for(let v=0;v<a;++v){const x=t[v*d];if(x<0)throw new Error(m4(v,x));if(x>=l)throw new Error(g4(v,x,l));++m[x],f=f&&x>=p,p=x}let y=!0;for(let v=0;v<l;++v){const x=m[v]===0;u[v]=x,y=y&&!x,m[v]=Math.max(m[v],1),v>0&&(m[v]+=m[v-1])}if(y&&f){const v=t,x=r;for(let b=0;b<a;++b)c[b]=b;return[v,[a,d],x,u,c]}else{const v=m[l-1],x=Yt(n,v*d),b=Yt(s,v),_=new Array(l).fill(0);for(let S=0;S<a;++S){const k=t[S*d],T=_[k],$=(k===0?0:m[k-1])+T;_[k]++;for(let A=0;A<d;++A)x[$*d+A]=t[S*d+A];b[$]=r[S],c[S]=$}for(let S=0;S<l;++S)if(_[S]===0){const T=S===0?0:m[S-1];x[T*d+0]=S;for(let $=1;$<d;++$)x[T*d+$]=0;b[T]=o}return[x,[v,d],b,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AU(t,e,n,r,s){const i=oe(r),o=e[0],a=s.length,l=[];let u=1,c=-1;for(let v=0;v<a;++v){const x=s[v];if(x===-1){if(c!==-1)throw new Error(y4(c,v));c=v,l.push(1)}else{if(x<0)throw new Error(v4(v,x));u*=x,l.push(x)}}if(c!==-1){if(u<=0)throw new Error(x4());const v=Math.trunc(i/u);if(u*v!==i)throw new Error(b4(r,l));l[c]=v}if(oe(l)!==i)throw new Error(w4(r,l));const f=r.length,p=[];if(f>0){p[f-1]=1;for(let v=f-2;v>=0;--v)p[v]=p[v+1]*r[v+1]}const m=[];if(a>0){m[a-1]=1;for(let v=a-2;v>=0;--v)m[v]=m[v+1]*l[v+1]}const y=Yt(n,o*a);for(let v=0;v<o;++v){let x=0;for(let b=0;b<f;++b)x+=t[v*f+b]*p[b];for(let b=0;b<a;++b)y[v*a+b]=Math.trunc(x/m[b]),x%=m[b]}return[y,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W2(t,e,n,r,s,i=!1,o=0){const a=r.length,l=[e[0],t.length/e[0]],u=l[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error(MC());const f=e.slice();f[0]=d;const p=f.reduce((_,S)=>_*S,1),m=Yt(n,p);if(a===0)return d>0&&m.fill(o),[m,f];if(d<=0)throw new Error(MC());let y=0,v=1,x=0,b=s[y];for(;;){let _=0;if(v<a){if(_=s[v],b===_){++v;continue}if(b>=_)throw new Error(_4())}if(b<0||b>=d)throw new Error(S4(b,d));b>x&&m.fill(o,x*u,b*u);for(let S=y;S<v;++S){const k=r[S];if(k<0||k>=l[0])throw new Error(k4(S,r[S],l[0]));for(let T=0;T<u;T++)m[b*u+T]+=t[k*u+T]}if(i)for(let S=0;S<u;S++)m[b*u+S]/=v-y;if(y=v,++v,x=b+1,b=_,v>a)break}return x<d&&m.fill(o,x*u,d*u),[m,f]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zde=zo(t=>Math.sqrt(t)),Bde=bt(Qh,t=>Math.sqrt(t)),jde={kernelName:Qh,backendName:"cpu",kernelFunc:Bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OU=ln((t,e)=>{const n=t-e;return n*n}),Vde=Tn(Jh,OU),Wde={kernelName:Jh,backendName:"cpu",kernelFunc:Vde};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PU=zo((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)}),Ude=Ul(Fg,PU),Gde={kernelName:Fg,backendName:"cpu",kernelFunc:Ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DU(t,e,n,r){const s=qe(t,e.dtype);for(let i=0;i<s.size;i++){const o=s.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+r[l];s.set(e.get(...a),...o)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hde{constructor(e,n,r,s,i,o){this.separator=Co(e),this.nGramWidths=n,this.leftPad=Co(r),this.rightPad=Co(s),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),u=Math.max(0,l-a),c=Math.max(0,l-(i-(a+1))),d=o-(u+c),f=n+(u>0?0:a-l);let p=0;p+=u*this.leftPad.length;for(let b=0;b<d;++b)p+=e[f+b].length;p+=c*this.rightPad.length;const m=u+c+d-1;p+=m*this.separator.length,r[s+a]=new Uint8Array(p);const y=r[s+a];let v=0;const x=b=>b.forEach(_=>y[v++]=_);for(let b=0;b<u;++b)x(this.leftPad),x(this.separator);for(let b=0;b<d-1;++b)x(e[f+b]),x(this.separator);if(d>0){x(e[f+d-1]);for(let b=0;b<c;++b)x(this.separator),x(this.rightPad)}else{for(let b=0;b<c-1;++b)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=s-1,o=Yt("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=i;++u)o[u]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),o[l]=o[l-1]+c}const a=new Array(o[i]);for(let l=0;l<i;++l){const u=n[l];let c=o[l];if(this.nGramWidths.forEach(d=>{const f=n[l+1]-n[l],p=this.getNumNGrams(f,d);this.createNGrams(e,u,a,c,p,d),c+=p}),this.preserveShort&&c===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const f=d+2*this.padWidth;this.createNGrams(e,u,a,c,1,f)}}return[a,o]}}function RU(t,e,n,r,s,i,o,a){return new Hde(n,r,s,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kde(t,e,n,r){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)r.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&r.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(s,i);(!n||o.length!==0)&&r.push(o),s=i+1}}function LU(t,e,n){const r=t.length,s=[];let i=0,o=0;const a=new Array(r);for(let f=0;f<r;++f){const p=s.length;Kde(t[f],e,n,s);const m=s.length-p;a[f]=m,i+=m,o=Math.max(o,m)}const l=Yt("int32",i*2),u=new Array(i),c=[r,o];let d=0;for(let f=0;f<r;++f)for(let p=0;p<a[f];++p)l[d*2]=f,l[d*2+1]=p,u[d]=s[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FU(t,e){const n=Yt("int32",t.length);for(let r=0;r<t.length;++r)n[r]=pB(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MU=ln((t,e)=>t-e),qde=z2((t,e,n,r)=>({real:t-n,imag:e-r})),U2=Tn(ef,MU,qde),Xde={kernelName:ef,backendName:"cpu",kernelFunc:U2};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zU(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=qe(n,t.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vp=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function BU(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),f=Math.max(n,Math.floor(e-l*c/a+d)),p=Math.min(r,Math.floor(e+(a-l)*c/a+d));BU(t,e,f,p)}const s=t[e];let i=n,o=r;for(Qo(t,n,e),vp(t[r],s)>0&&Qo(t,n,r);i<o;){for(Qo(t,i,o),i++,o--;vp(t[i],s)<0;)i=i+1;for(;vp(t[o],s)>0;)o=o-1}vp(t[n],s)===0?Qo(t,n,o):(o=o+1,Qo(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function jU(t,e,n,r,s){const i=e[e.length-1],[o,a]=[t.length/i,i],l=Dn(n,o*r),u=Dn("int32",o*r);for(let d=0;d<o;d++){const f=d*a,p=t.subarray(f,f+a);let m=new Array(p.length);p.forEach((b,_)=>m[_]={value:b,index:_}),r<m.length&&(BU(m,r),m=m.slice(0,r)),s&&m.sort(vp);const y=d*r,v=l.subarray(y,y+r),x=u.subarray(y,y+r);for(let b=0;b<r;b++)v[b]=m[b].value,x[b]=m[b].index}const c=e.slice();return c[c.length-1]=r,[qe(c,n,l),qe(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(t,e,n,r){const s=Je(e,n)[0],i=[1,n[0],1];for(let m=0;m<s;m++)i[0]*=n[m];i[1]=n[s];for(let m=s+1;m<n.length;m++)i[2]*=n[m];const o=new Map,a=new Int32Array(n[s]),l=new pn(i,r,t),u=[],c=i[0]===1&&i[2]===1;for(let m=0;m<n[s];m++){let y;if(c)y=t[m].toString();else{const x=[];for(let b=0;b<i[0];b++)for(let _=0;_<i[2];_++)x.push(l.get(b,m,_));y=x.join(",")}const v=o.get(y);if(v!=null)a[m]=v;else{const x=o.size;o.set(y,x),a[m]=x,u.push(m)}}const d=i.slice();d[1]=o.size;const f=new pn(d,r);u.forEach((m,y)=>{for(let v=0;v<i[0];v++)for(let x=0;x<i[2];x++)f.set(l.get(v,m,x),v,y,x)});const p=n.slice();return p[s]=d[1],{outputValues:f.values,outputShape:p,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zde=Object.freeze(Object.defineProperty({__proto__:null,addImpl:YW,bincountImpl:B2,bincountReduceImpl:QW,bitwiseAndImpl:JW,castImpl:ZW,ceilImpl:eU,concatImpl:tU,equalImpl:nU,expImpl:sU,expm1Impl:oU,floorDivImpl:lU,floorImpl:aU,gatherNdImpl:uU,gatherV2Impl:cU,greaterEqualImpl:hU,greaterImpl:dU,lessEqualImpl:pU,lessImpl:fU,linSpaceImpl:mU,logImpl:gU,maxImpl:yU,maximumImpl:vU,minimumImpl:xU,multiplyImpl:j2,negImpl:bU,notEqualImpl:wU,prodImpl:_U,raggedGatherImpl:SU,raggedRangeImpl:kU,raggedTensorToTensorImpl:CU,rangeImpl:TU,rsqrtImpl:NU,scatterImpl:Tu,sigmoidImpl:Lde,simpleAbsImpl:XW,sliceImpl:$U,sparseFillEmptyRowsImpl:EU,sparseReshapeImpl:AU,sparseSegmentReductionImpl:W2,sqrtImpl:zde,squaredDifferenceImpl:OU,staticRegexReplaceImpl:PU,stridedSliceImpl:DU,stringNGramsImpl:RU,stringSplitImpl:LU,stringToHashBucketFastImpl:FU,subImpl:MU,tileImpl:zU,topKImpl:jU,transposeImpl:V2,uniqueImpl:VU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */vI("cpu",()=>new k1,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WU=bt(Sh,t=>t>=0?t:Math.exp(t)-1),Yde={kernelName:Sh,backendName:"cpu",kernelFunc:WU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r;Pe([s],"leakyRelu");const o=oe(s.shape),a=n.data.get(s.dataId).values,l=Dn("float32",o);for(let u=0;u<a.length;u++)l[u]=a[u]<0?i*a[u]:a[u];return n.makeTensorInfo(s.shape,"float32",l)}const Qde={kernelName:og,backendName:"cpu",kernelFunc:UU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jde=ln((t,e)=>t<0?e*t:t);function GU(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e;Pe([r,s],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,[a,l]=Jde(r.shape,s.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const ehe={kernelName:Cg,backendName:"cpu",kernelFunc:GU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HU=bt(Vh,t=>Math.max(0,t)),the={kernelName:Vh,backendName:"cpu",kernelFunc:HU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KU=bt(Wh,t=>Math.min(Math.max(0,t),6)),nhe={kernelName:Wh,backendName:"cpu",kernelFunc:KU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ax(t,e,n,r,s){if(n==="linear")return Lo({inputs:{x:e},backend:t});if(n==="relu")return HU({inputs:{x:e},backend:t});if(n==="elu")return WU({inputs:{x:e},backend:t});if(n==="relu6")return KU({inputs:{x:e},backend:t});if(n==="prelu")return GU({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return UU({inputs:{x:e},backend:t,attrs:{alpha:s}});if(n==="sigmoid")return IU({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Et(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=oe(s.shape),a=aI(i,o),l=oe(a);O(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(s.dataId);const u=n.data.get(s.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=a,d.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const rhe={kernelName:Ng,backendName:"cpu",kernelFunc:Et};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qU(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;Pe([s,i],"matMul");const l=s.shape.length,u=i.shape.length,c=o?s.shape[l-2]:s.shape[l-1],d=a?i.shape[u-1]:i.shape[u-2],f=o?s.shape[l-1]:s.shape[l-2],p=a?i.shape[u-2]:i.shape[u-1],m=s.shape.slice(0,-2),y=i.shape.slice(0,-2),v=oe(m),x=oe(y),_=Ke(s.shape.slice(0,-2),i.shape.slice(0,-2)).concat([f,p]);O(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${s.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const S=o?[v,c,f]:[v,f,c],k=a?[x,p,d]:[x,d,p],T=Et({inputs:{x:s},backend:n,attrs:{shape:S}}),$=Et({inputs:{x:i},backend:n,attrs:{shape:k}}),A=o?T.shape[1]:T.shape[2],D=o?T.shape[2]:T.shape[1],F=a?$.shape[1]:$.shape[2],M=Math.max(v,x),j=n.data.get(T.dataId).values,H=n.data.get($.dataId).values,K=ze(T.shape),Q=ze($.shape),[Z,se,B]=o?[K[0],1,K[1]]:[K[0],K[1],1],[J,Y,ie]=a?[1,Q[1],Q[0]]:[Q[1],1,Q[0]],ne=D*F,pe=qe([M,D,F],T.dtype),me=pe.values,de=n.blockSize;for(let fe=0;fe<M;fe++){const ke=fe%v,_e=fe%x;for(let ue=0;ue<D;ue+=de){const be=Math.min(ue+de,D);for(let xe=0;xe<F;xe+=de){const le=Math.min(xe+de,F);for(let Me=0;Me<A;Me+=de){const Be=Math.min(Me+de,A);for(let He=ue;He<be;He++)for(let Ge=xe;Ge<le;Ge++){let lt=0;for(let ht=Me;ht<Be;ht++){const Ti=j[ke*Z+He*se+ht*B],un=H[ht*J+Ge*Y+_e*ie];lt+=Ti*un}me[fe*ne+(He*F+Ge)]+=lt}}}}}return n.disposeIntermediateTensorInfo(T),n.disposeIntermediateTensorInfo($),n.makeTensorInfo(_,pe.dtype,pe.values)}const she={kernelName:Um,backendName:"cpu",kernelFunc:qU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ihe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;let f,p,m;const y=[];f=qU({inputs:{a:s,b:i},attrs:{transposeA:l,transposeB:u},backend:n}),o&&(p=Hd({inputs:{a:f,b:o},backend:n}),y.push(f),f=p),c&&(m=ax(n,f,c,a,d),y.push(f),f=m);for(const x of y)n.disposeIntermediateTensorInfo(x);return f}const ohe={kernelName:em,backendName:"cpu",kernelFunc:ihe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ahe=bt(ch,t=>Math.acos(t)),lhe={kernelName:ch,backendName:"cpu",kernelFunc:ahe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uhe=bt(dh,t=>Math.acosh(t)),che={kernelName:dh,backendName:"cpu",kernelFunc:uhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dhe(t){const{inputs:e,backend:n}=t,r=e;Pe(e,"addN");const s=r.map(a=>n.data.get(a.dataId).values),i=qe(r[0].shape,r[0].dtype),o=i.values;for(let a=0;a<r.length;a++){const l=s[a];for(let u=0;u<o.length;u++)o[u]+=l[u]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const hhe={kernelName:zm,backendName:"cpu",kernelFunc:dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Pe(s,"all");const a=Je(i,s.shape);let l=a;const u=qt(l,s.shape.length);let c=s;u!=null&&(c=Wr({inputs:{x:s},backend:n,attrs:{perm:u}}),l=on(l.length,s.shape.length)),Qn("all",l,c.shape.length);const[d,f]=Fn(c.shape,l),p=oe(f),m=Xn(oe(d),c.dtype),y=n.data.get(c.dataId).values;for(let x=0;x<m.length;++x){const b=x*p;let _=y[b];for(let S=0;S<p;++S){const k=y[b+S];_=_&&k}m[x]=_}u!=null&&n.disposeIntermediateTensorInfo(c);const v=n.makeTensorInfo(d,c.dtype,m);if(o){const x=sn(d,a),b=Et({inputs:{x:v},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(v),b}return v}const phe={kernelName:xb,backendName:"cpu",kernelFunc:fhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Pe(s,"any");const a=Je(i,s.shape);let l=a;const u=qt(l,s.shape.length);let c=s;u!=null&&(c=Wr({inputs:{x:s},backend:n,attrs:{perm:u}}),l=on(l.length,s.shape.length)),Qn("any",l,c.shape.length);const[d,f]=Fn(c.shape,l),p=oe(f),m=Xn(oe(d),c.dtype),y=n.data.get(c.dataId).values;for(let x=0;x<m.length;++x){const b=x*p;let _=y[b];for(let S=0;S<p;++S){const k=y[b+S];_=_||k}m[x]=_}u!=null&&n.disposeIntermediateTensorInfo(c);const v=n.makeTensorInfo(d,c.dtype,m);if(o){const x=sn(d,a),b=Et({inputs:{x:v},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(v),b}return v}const ghe={kernelName:bb,backendName:"cpu",kernelFunc:mhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;Pe(s,"argMax");let o=Je(i,s.shape);const a=qt(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Wr({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=on(o.length,l.shape.length)),o=[o[0]],Qn("argMax",o,l.shape.length);const[c,d]=Fn(l.shape,o),f=oe(c),p=Xn(f,"int32"),m=oe(d),y=n.data.get(l.dataId).values;for(let v=0;v<p.length;++v){const x=v*m;let b=y[x],_=0;for(let S=0;S<m;++S){const k=y[x+S];k>b&&(b=k,_=S)}p[v]=_}return u.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(c,"int32",p)}const vhe={kernelName:Bm,backendName:"cpu",kernelFunc:yhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;Pe(s,"argMin");let o=Je(i,s.shape);const a=qt(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Wr({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=on(o.length,l.shape.length)),o=[o[0]],Qn("argMin",o,l.shape.length);const[c,d]=Fn(l.shape,o),f=oe(c),p=Xn(f,"int32"),m=oe(d),y=n.data.get(l.dataId).values;for(let v=0;v<p.length;++v){const x=v*m;let b=y[x],_=0;for(let S=0;S<m;++S){const k=y[x+S];k<b&&(b=k,_=S)}p[v]=_}return u.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(c,"int32",p)}const bhe={kernelName:jm,backendName:"cpu",kernelFunc:xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const whe=bt(hh,t=>Math.asin(t)),_he={kernelName:hh,backendName:"cpu",kernelFunc:whe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const She=bt(fh,t=>Math.asinh(t)),khe={kernelName:fh,backendName:"cpu",kernelFunc:She};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Che=bt(ph,t=>Math.atan(t)),The={kernelName:ph,backendName:"cpu",kernelFunc:Che};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe=ln((t,e)=>Math.atan2(t,e)),Ihe=Tn(gh,Nhe),$he={kernelName:gh,backendName:"cpu",kernelFunc:Ihe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ehe=bt(mh,t=>Math.atanh(t)),Ahe={kernelName:mh,backendName:"cpu",kernelFunc:Ehe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G2(t,e,n,r,s,i){const o=s.strideHeight,a=s.strideWidth,l=s.dilationHeight,u=s.dilationWidth,c=s.effectiveFilterHeight,d=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=qe(s.outShape,n),v=y.values,x=s.outShape[1]*s.outShape[2]*s.outShape[3],b=s.outShape[2]*s.outShape[3],_=s.outShape[3];for(let S=0;S<s.batchSize;++S){const k=S*x,T=S*r[0];for(let $=0;$<s.inChannels;++$)for(let A=0;A<s.outHeight;++A){const D=A*o-f,F=Math.max(0,D),M=Math.min(s.inHeight,c+D),j=k+A*b;for(let H=0;H<s.outWidth;++H){const K=H*a-p,Q=Math.max(0,K),Z=Math.min(s.inWidth,d+K);let se=m,B=0,J=0;for(let ie=F;ie<M;ie+=l){const ne=T+ie*r[1];for(let pe=Q;pe<Z;pe+=u){const me=ne+pe*r[2],de=t[me+$];i==="max"&&de>se?se=de:i==="avg"&&(B+=de,J++)}if(isNaN(se))break}const Y=j+H*_+$;v[Y]=i==="avg"?B/J:se}}}return y}function XU(t,e,n,r,s=!1,i=!1){const o=qe(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=r.padInfo.top,m=r.padInfo.left,y=qe(e,n,t);for(let v=0;v<r.batchSize;++v)for(let x=0;x<r.inChannels;++x)for(let b=0;b<r.outHeight;++b){const _=b*a-p;let S=_;for(;S<0;)S+=u;const k=Math.min(r.inHeight,d+_);for(let T=0;T<r.outWidth;++T){const $=T*l-m;let A=$;for(;A<0;)A+=c;const D=Math.min(r.inWidth,f+$);let F=Number.NEGATIVE_INFINITY,M=-1;for(let j=S;j<k;j+=u){const H=j-_;for(let K=A;K<D;K+=c){const Q=K-$,Z=y.get(v,j,K,x);Z>F&&(F=Z,s?M=i?((v*r.inHeight+j)*r.inWidth+K)*r.inChannels+x:(j*r.inWidth+K)*r.inChannels+x:M=H*f+Q)}}o.set(M,v,b,T,x)}}return o}function ZU(t,e,n,r,s,i){const o=s.strideDepth,a=s.strideHeight,l=s.strideWidth,u=s.dilationDepth,c=s.dilationHeight,d=s.dilationWidth,f=s.effectiveFilterDepth,p=s.effectiveFilterHeight,m=s.effectiveFilterWidth,y=s.padInfo.front,v=s.padInfo.top,x=s.padInfo.left,b=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,_=qe(s.outShape,n),S=_.values,k=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],T=s.outShape[2]*s.outShape[3]*s.outShape[4],$=s.outShape[3]*s.outShape[4],A=s.outShape[4];for(let D=0;D<s.batchSize;++D){const F=D*k,M=D*r[0];for(let j=0;j<s.inChannels;++j)for(let H=0;H<s.outDepth;++H){const K=H*o-y;let Q=K;for(;Q<0;)Q+=u;const Z=Math.min(s.inDepth,f+K),se=F+H*T;for(let B=0;B<s.outHeight;++B){const J=B*a-v;let Y=J;for(;Y<0;)Y+=c;const ie=Math.min(s.inHeight,p+J),ne=se+B*$;for(let pe=0;pe<s.outWidth;++pe){const me=pe*l-x;let de=me;for(;de<0;)de+=d;const fe=Math.min(s.inWidth,m+me),ke=ne+pe*A;let _e=b,ue=0,be=0;for(let le=Q;le<Z;le+=u){const Me=M+le*r[1];for(let Be=Y;Be<ie;Be+=c){const He=Me+Be*r[2];for(let Ge=de;Ge<fe;Ge+=d){const lt=He+Ge*r[3],ht=t[lt+j];if(i==="max"&&ht>_e?_e=ht:i==="avg"&&(ue+=ht,be++),isNaN(_e))break}if(isNaN(_e))break}if(isNaN(_e))break}const xe=ke+j;S[xe]=i==="avg"?ue/Math.max(be,1):_e}}}}return _}function Ohe(t,e){const n=qe(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;for(let y=0;y<e.batchSize;++y)for(let v=0;v<e.inChannels;++v)for(let x=0;x<e.outDepth;++x){const b=x*r-f;let _=b;for(;_<0;)_+=o;const S=Math.min(e.inDepth,u+b);for(let k=0;k<e.outHeight;++k){const T=k*s-p;let $=T;for(;$<0;)$+=a;const A=Math.min(e.inHeight,c+T);for(let D=0;D<e.outWidth;++D){const F=D*i-m;let M=F;for(;M<0;)M+=l;const j=Math.min(e.inWidth,d+F);let H=Number.NEGATIVE_INFINITY,K=-1;for(let Q=_;Q<S;Q+=o){const Z=Q-b;for(let se=$;se<A;se+=a){const B=se-T;for(let J=M;J<j;J+=l){const Y=J-F,ie=t.get(y,Q,se,J,v);ie>=H&&(H=ie,K=Z*c*d+B*c+Y)}}}n.set(K,y,x,k,D,v)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Phe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Pe(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;O(Yn(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=_i(s.shape,i,o,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&nt(c.inShape,c.outShape))d=Lo({inputs:{x:s},backend:n});else{const f=n.data.get(s.dataId).values,p=ze(s.shape),m=G2(f,s.shape,s.dtype,p,c,"avg");d=n.makeTensorInfo(c.outShape,s.dtype,m.values)}return d}const Dhe={kernelName:Vm,backendName:"cpu",kernelFunc:Phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;Pe(s,"avgPool3d");const c=Na(s.shape,i,o,1,a,l,u),d=n.data.get(s.dataId).values,f=ZU(d,s.shape,s.dtype,ze(s.shape),c,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}const Lhe={kernelName:Wm,backendName:"cpu",kernelFunc:Rhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fhe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;Pe([s,i],"avgPool3DGrad");const c=Na(i.shape,o,a,1,l,u),d=c.strideDepth,f=c.strideHeight,p=c.strideWidth,m=c.filterDepth,y=c.filterHeight,v=c.filterWidth,x=c.dilationDepth,b=c.dilationHeight,_=c.dilationWidth,S=c.effectiveFilterDepth,k=c.effectiveFilterHeight,T=c.effectiveFilterWidth,$=S-1-c.padInfo.front,A=T-1-c.padInfo.left,D=k-1-c.padInfo.top,F=qe(i.shape,"float32"),M=1/(m*y*v),j=n.bufferSync(s);for(let H=0;H<c.batchSize;++H)for(let K=0;K<c.inChannels;++K)for(let Q=0;Q<c.inDepth;++Q)for(let Z=0;Z<c.inHeight;++Z)for(let se=0;se<c.inWidth;++se){const B=Q-$,J=Z-D,Y=se-A;let ie=0;for(let ne=0;ne<S;ne+=x){const pe=(B+ne)/d;if(!(pe<0||pe>=c.outDepth||Math.floor(pe)!==pe))for(let me=0;me<k;me+=b){const de=(J+me)/f;if(!(de<0||de>=c.outHeight||Math.floor(de)!==de))for(let fe=0;fe<T;fe+=_){const ke=(Y+fe)/p;if(ke<0||ke>=c.outWidth||Math.floor(ke)!==ke)continue;const _e=j.get(H,pe,de,ke,K);ie+=_e}}}F.set(ie*M,H,Q,Z,se,K)}return n.makeTensorInfo(F.shape,F.dtype,F.values)}const Mhe={kernelName:_b,backendName:"cpu",kernelFunc:Fhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zhe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;Pe([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=_i(o.shape,a,l,1,u),d=c.strideHeight,f=c.strideWidth,p=c.filterHeight,m=c.filterWidth,y=c.dilationHeight,v=c.dilationWidth,x=c.effectiveFilterHeight,b=c.effectiveFilterWidth,_=b-1-c.padInfo.left,S=x-1-c.padInfo.top,k=qe(o.shape,"float32"),T=1/(p*m),$=n.data.get(s.dataId).values,A=qe(s.shape,"float32",$);for(let D=0;D<c.batchSize;++D)for(let F=0;F<c.inChannels;++F)for(let M=0;M<c.inHeight;++M)for(let j=0;j<c.inWidth;++j){const H=M-S,K=j-_;let Q=0;for(let Z=0;Z<x;Z+=y){const se=(H+Z)/d;if(!(se<0||se>=c.outHeight||Math.floor(se)!==se))for(let B=0;B<b;B+=v){const J=(K+B)/f;if(J<0||J>=c.outWidth||Math.floor(J)!==J)continue;const Y=A.get(D,se,J,F);Q+=Y}}k.set(Q*T,D,M,j,F)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const Bhe={kernelName:wb,backendName:"cpu",kernelFunc:zhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,scale:i,offset:o,mean:a,variance:l}=e;O(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Pe([s,a,l,i,o],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=n.data.get(s.dataId).values,d=n.data.get(a.dataId).values,f=n.data.get(l.dataId).values,p=i?n.data.get(i.dataId).values:new Float32Array([1]),m=o?n.data.get(o.dataId).values:new Float32Array([0]),y=new Float32Array(c.length),v=m.length,x=p.length,b=f.length,_=d.length;let S=0,k=0,T=0,$=0;for(let A=0;A<c.length;++A)y[A]=m[S++]+(c[A]-d[k++])*p[T++]/Math.sqrt(f[$++]+u),S>=v&&(S=0),k>=_&&(k=0),T>=x&&(T=0),$>=b&&($=0);return n.makeTensorInfo(s.shape,s.dtype,y)}const Vhe={kernelName:rg,backendName:"cpu",kernelFunc:jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Whe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;Pe([s],"batchToSpaceND");const a=i.reduce((x,b)=>x*b),l=ay(s.shape,i,a),u=ly(l.length,i.length),c=uy(s.shape,i,a),d=Q$(o,i.length),f=J$(c,o,i.length),p=Et({inputs:{x:s},backend:n,attrs:{shape:l}}),m=Wr({inputs:{x:p},backend:n,attrs:{perm:u}}),y=Et({inputs:{x:m},backend:n,attrs:{shape:c}}),v=ac({inputs:{x:y},backend:n,attrs:{begin:d,size:f}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),v}const Uhe={kernelName:Gm,backendName:"cpu",kernelFunc:Whe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,u=B2(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const Hhe={kernelName:Sb,backendName:"cpu",kernelFunc:Ghe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Khe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=Ke(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const qhe={kernelName:kb,backendName:"cpu",kernelFunc:Khe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xhe=bt(xh,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Zhe={kernelName:xh,backendName:"cpu",kernelFunc:Xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yhe=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(oe(e.shape)),s=n.data.get(e.dataId),i=s.complexTensorInfos.real,o=s.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let u=0;u<a.length;u++){const c=a[u],d=l[u];r[u]=Math.hypot(c,d)}return n.makeOutput(r,e.shape,"float32")},Qhe={kernelName:Km,backendName:"cpu",kernelFunc:Yhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kd(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const Jhe={kernelName:Ub,backendName:"cpu",kernelFunc:Kd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qd(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=Je(s,e[0].shape)[0],o=e.map(y=>y.shape);X$(o,i);let a=No(e.map(y=>y.shape),i);if(oe(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(y=>oe(y.shape)>0);if(l.length===1)return Lo({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const y=l.map(S=>oc({inputs:{input:S},backend:n})),v=l.map(S=>Kd({inputs:{input:S},backend:n})),x=qd({inputs:y,backend:n,attrs:{axis:i}}),b=qd({inputs:v,backend:n,attrs:{axis:i}}),_=ns({inputs:{real:x,imag:b},backend:n});return y.forEach(S=>n.disposeIntermediateTensorInfo(S)),v.forEach(S=>n.disposeIntermediateTensorInfo(S)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),_}const u=l.map(y=>{const x=[-1,oe(y.shape.slice(i))];return Et({inputs:{x:y},backend:n,attrs:{shape:x}})}),c=u.map(y=>({vals:n.data.get(y.dataId).values,shape:y.shape}));a=No(u.map(y=>y.shape),1);const d=u[0].shape[0]===1,f=tU(c,a,e[0].dtype,d),p=No(l.map(y=>y.shape),i),m=n.makeTensorInfo(p,e[0].dtype,f);return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),m}const efe={kernelName:qm,backendName:"cpu",kernelFunc:qd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r;Pe([s,i],"conv2d");const d=Ia(l),f=Ln(s.shape,i.shape,o,u,a,c,!1,d),p=f.filterHeight,m=f.filterWidth,y=f.dilationHeight,v=f.dilationWidth,x=f.padInfo.left,b=f.padInfo.top,_=f.dataFormat==="channelsLast",S=new pn(f.outShape,s.dtype),k=ze(s.shape),T=ze(i.shape),$=k[0],A=_?k[1]:k[2],D=_?k[2]:1,F=_?1:k[1],M=S.strides[0],j=_?S.strides[1]:S.strides[2],H=_?S.strides[2]:1,K=_?1:S.strides[1],Q=n.data.get(s.dataId).values,Z=n.data.get(i.dataId).values,se=S.values;for(let B=0;B<f.batchSize;++B){const J=B*$,Y=B*M;for(let ie=0;ie<f.outHeight;++ie){const ne=Y+ie*j,pe=ie*f.strideHeight-b;for(let me=0;me<p;++me){const de=pe+me*y;if(de<0||de>=f.inHeight)continue;const fe=me*T[0],ke=J+de*A;for(let _e=0;_e<f.outWidth;++_e){const ue=ne+_e*H,be=_e*f.strideWidth-x;for(let xe=0;xe<m;++xe){const le=be+xe*v;if(le<0||le>=f.inWidth)continue;const Me=fe+xe*T[1],Be=ke+le*D;let He=Me;for(let Ge=0;Ge<f.inChannels;++Ge){const lt=Q[Be+Ge*F];for(let ht=0;ht<f.outChannels;++ht)se[ue+ht*K]+=lt*Z[He+ht];He+=f.outChannels}}}}}}return n.makeTensorInfo(S.shape,S.dtype,se)}const tfe={kernelName:Xm,backendName:"cpu",kernelFunc:YU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;Pe([s,i],"conv2dBackpropFilter");const d=Ia(l),f=Ln(s.shape,c,o,1,a,u,!1,d),{strideHeight:p,strideWidth:m,filterHeight:y,filterWidth:v}=f,x=f.dataFormat==="channelsLast",b=new pn(f.filterShape,"float32"),_=f.padInfo.left,S=f.padInfo.top,k=n.data.get(s.dataId).values,T=n.data.get(i.dataId).values,$=new pn(s.shape,s.dtype,k),A=new pn(i.shape,i.dtype,T);for(let D=0;D<y;++D){const F=Math.max(0,Math.ceil((S-D)/p)),M=Math.min(f.outHeight,(f.inHeight+S-D)/p);for(let j=0;j<v;++j){const H=Math.max(0,Math.ceil((_-j)/m)),K=Math.min(f.outWidth,(f.inWidth+_-j)/m);for(let Q=0;Q<f.inChannels;++Q)for(let Z=0;Z<f.outChannels;++Z){let se=0;for(let B=0;B<f.batchSize;++B)for(let J=F;J<M;++J){const Y=D+J*p-S;for(let ie=H;ie<K;++ie){const ne=j+ie*m-_;x?se+=$.get(B,Y,ne,Q)*A.get(B,J,ie,Z):se+=$.get(B,Q,Y,ne)*A.get(B,Z,J,ie)}}b.set(se,D,j,Q,Z)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const rfe={kernelName:Tb,backendName:"cpu",kernelFunc:nfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sfe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r;Pe([s,i],"conv2dBackpropInput");const d=ze(i.shape),f=ze(s.shape);let p=Ia(u);const m=Ln(o,i.shape,a,1,l,c,!1,p),y=new pn(m.inShape,"float32"),v=y.values,x=n.data.get(s.dataId).values,b=n.data.get(i.dataId).values,[_,S,k]=d,{batchSize:T,filterHeight:$,filterWidth:A,inChannels:D,inHeight:F,inWidth:M,outChannels:j,outHeight:H,outWidth:K,strideHeight:Q,strideWidth:Z}=m;p=m.dataFormat;const se=$-1-m.padInfo.top,B=A-1-m.padInfo.left,J=p==="channelsLast",Y=y.strides[0],ie=J?y.strides[1]:y.strides[2],ne=J?y.strides[2]:1,pe=J?1:y.strides[1],me=f[0],de=J?f[1]:f[2],fe=J?f[2]:1,ke=J?1:f[1];for(let _e=0;_e<T;++_e)for(let ue=0;ue<D;++ue)for(let be=0;be<F;++be){const xe=be-se,le=Math.max(0,Math.ceil(xe/Q)),Me=Math.min(H,($+xe)/Q);for(let Be=0;Be<M;++Be){const He=Be-B,Ge=Math.max(0,Math.ceil(He/Z)),lt=Math.min(K,(A+He)/Z);let ht=0;for(let un=le;un<Me;++un){const Ws=un*Q-xe;for(let mr=Ge;mr<lt;++mr){const lo=mr*Z-He,ys=me*_e+de*un+fe*mr,Ni=_*($-1-Ws)+S*(A-1-lo)+k*ue;for(let Us=0;Us<j;++Us){const Ii=x[ys+ke*Us],$i=b[Ni+Us];ht+=Ii*$i}}}const Ti=Y*_e+ie*be+ne*Be+pe*ue;v[Ti]=ht}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const ife={kernelName:Zm,backendName:"cpu",kernelFunc:sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ofe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r;Pe([s,i],"conv3d");const u=Fl(s.shape,i.shape,o,l,a),{filterDepth:c,filterHeight:d,filterWidth:f,dilationDepth:p,dilationHeight:m,dilationWidth:y,padInfo:v}=u,x=v.front,b=v.left,_=v.top,S=new pn(u.outShape,s.dtype),k=n.data.get(s.dataId).values,T=n.data.get(i.dataId).values,$=S.values,A=ze(s.shape),D=ze(i.shape);for(let F=0;F<u.batchSize;++F){const M=F*A[0],j=F*S.strides[0];for(let H=0;H<u.outDepth;++H){const K=j+H*S.strides[1],Q=H*u.strideDepth-x;for(let Z=0;Z<c;++Z){const se=Q+Z*p;if(se<0||se>=u.inDepth)continue;const B=Z*D[0],J=M+se*A[1];for(let Y=0;Y<u.outHeight;++Y){const ie=K+Y*S.strides[2],ne=Y*u.strideHeight-_;for(let pe=0;pe<d;++pe){const me=ne+pe*m;if(me<0||me>=u.inHeight)continue;const de=B+pe*D[1],fe=J+me*A[2];for(let ke=0;ke<u.outWidth;++ke){const _e=ie+ke*u.outChannels,ue=ke*u.strideWidth-b;for(let be=0;be<f;++be){const xe=ue+be*y;if(xe<0||xe>=u.inWidth)continue;const le=de+be*D[2],Me=fe+xe*u.inChannels;let Be=le;for(let He=0;He<u.inChannels;++He){const Ge=k[Me+He];for(let lt=0;lt<u.outChannels;++lt)$[_e+lt]+=Ge*T[Be+lt];Be+=u.outChannels}}}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const afe={kernelName:Ym,backendName:"cpu",kernelFunc:ofe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r;Pe([s,i],"conv3dBackpropFilterV2");const u=ze(s.shape),c=ze(i.shape),d=Fl(s.shape,l,o,1,a),f=d.strideDepth,p=d.strideHeight,m=d.strideWidth,y=d.filterDepth,v=d.filterHeight,x=d.filterWidth,b=new pn(d.filterShape,"float32"),_=b.values,[S,k,T,$]=b.strides,A=n.data.get(i.dataId).values,[D,F,M,j]=c,H=n.data.get(s.dataId).values,[K,Q,Z,se]=u,B=d.padInfo.front,J=d.padInfo.left,Y=d.padInfo.top;for(let ie=0;ie<y;++ie){const ne=Math.max(0,Math.ceil((B-ie)/f)),pe=Math.min(d.outDepth,(d.inDepth+B-ie)/f),me=ie*S;for(let de=0;de<v;++de){const fe=Math.max(0,Math.ceil((Y-de)/p)),ke=Math.min(d.outHeight,(d.inHeight+Y-de)/p),_e=de*k+me;for(let ue=0;ue<x;++ue){const be=Math.max(0,Math.ceil((J-ue)/m)),xe=Math.min(d.outWidth,(d.inWidth+J-ue)/m),le=ue*T+_e;for(let Me=0;Me<d.inChannels;++Me){const Be=Me*$+le;for(let He=0;He<d.outChannels;++He){let Ge=0;for(let lt=0;lt<d.batchSize;++lt){const ht=lt*K,Ti=lt*D;for(let un=ne;un<pe;++un){const mr=(ie+un*f-B)*Q+ht,lo=un*F+Ti;for(let ys=fe;ys<ke;++ys){const Us=(de+ys*p-Y)*Z+mr,Ii=ys*M+lo;for(let $i=be;$i<xe;++$i){const Fc=(ue+$i*m-J)*se+Us,Mc=$i*j+Ii;Ge+=H[Fc+Me]*A[Mc+He]}}}}_[Be+He]=Ge}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const ufe={kernelName:Nb,backendName:"cpu",kernelFunc:lfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cfe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r;Pe([s],"conv3dBackpropInputV2");const u=ze(s.shape),c=ze(i.shape),d=Fl(l,i.shape,a,1,o),f=new pn(d.inShape,"float32"),p=f.values,[m,y,v,x]=f.strides,b=n.data.get(s.dataId).values,[_,S,k,T]=u,$=n.data.get(i.dataId).values,[A,D,F,M]=c,{batchSize:j,filterDepth:H,filterHeight:K,filterWidth:Q,inChannels:Z,inDepth:se,inHeight:B,inWidth:J,outChannels:Y,outDepth:ie,outHeight:ne,outWidth:pe,strideDepth:me,strideHeight:de,strideWidth:fe}=d,ke=H-1-d.padInfo.front,_e=K-1-d.padInfo.top,ue=Q-1-d.padInfo.left;for(let be=0;be<j;++be)for(let xe=0;xe<Z;++xe)for(let le=0;le<se;++le){const Me=le-ke,Be=Math.max(0,Math.ceil(Me/me)),He=Math.min(ie,(H+Me)/me);for(let Ge=0;Ge<B;++Ge){const lt=Ge-_e,ht=Math.max(0,Math.ceil(lt/de)),Ti=Math.min(ne,(K+lt)/de);for(let un=0;un<J;++un){const Ws=un-ue,mr=Math.max(0,Math.ceil(Ws/fe)),lo=Math.min(pe,(Q+Ws)/fe);let ys=0;for(let Ni=Be;Ni<He;++Ni){const Us=Ni*me-Me;for(let Ii=ht;Ii<Ti;++Ii){const $i=Ii*de-lt;for(let Yl=mr;Yl<lo;++Yl){const Fc=Yl*fe-Ws,Mc=_*be+S*Ni+k*Ii+T*Yl,A_=A*(H-1-Us)+D*(K-1-$i)+F*(Q-1-Fc)+M*xe;for(let Ql=0;Ql<Y;++Ql){const Ef=b[Mc+Ql],My=$[A_+Ql];ys+=Ef*My}}}}p[m*be+y*le+v*Ge+x*un+xe]=ys}}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const dfe={kernelName:Ib,backendName:"cpu",kernelFunc:cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hfe=bt(bh,t=>Math.cos(t)),ffe={kernelName:bh,backendName:"cpu",kernelFunc:hfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pfe=bt(wh,t=>Math.cosh(t)),mfe={kernelName:wh,backendName:"cpu",kernelFunc:pfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gfe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,[c,d,f,p]=s.shape,m=i.shape[0],[y,v]=a,x=qe([m,y,v,p],"float32"),b=n.data.get(i.dataId).values,_=n.data.get(o.dataId).values,S=n.data.get(s.dataId).values,k=ze(s.shape),T=ze(x.shape);for(let $=0;$<m;$++){const A=$*4,D=b[A],F=b[A+1],M=b[A+2],j=b[A+3],H=_[$];if(H>=c)continue;const K=y>1?(M-D)*(d-1)/(y-1):0,Q=v>1?(j-F)*(f-1)/(v-1):0;for(let Z=0;Z<y;Z++){const se=y>1?D*(d-1)+Z*K:.5*(D+M)*(d-1);if(se<0||se>d-1){for(let B=0;B<v;B++)for(let J=0;J<p;J++){const Y=J+B*T[2]+Z*T[1]+$*T[0];x.values[Y]=u}continue}if(l==="bilinear"){const B=Math.floor(se),J=Math.ceil(se),Y=se-B;for(let ie=0;ie<v;ie++){const ne=v>1?F*(f-1)+ie*Q:.5*(F+j)*(f-1);if(ne<0||ne>f-1){for(let fe=0;fe<p;fe++){const ke=fe+ie*T[2]+Z*T[1]+$*T[0];x.values[ke]=u}continue}const pe=Math.floor(ne),me=Math.ceil(ne),de=ne-pe;for(let fe=0;fe<p;fe++){let ke=fe+pe*k[2]+B*k[1]+H*k[0];const _e=S[ke];ke=fe+me*k[2]+B*k[1]+H*k[0];const ue=S[ke];ke=fe+pe*k[2]+J*k[1]+H*k[0];const be=S[ke];ke=fe+me*k[2]+J*k[1]+H*k[0];const xe=S[ke],le=_e+(ue-_e)*de,Me=be+(xe-be)*de;ke=fe+ie*T[2]+Z*T[1]+$*T[0],x.values[ke]=le+(Me-le)*Y}}}else for(let B=0;B<v;++B){const J=v>1?F*(f-1)+B*Q:.5*(F+j)*(f-1);if(J<0||J>f-1){for(let ne=0;ne<p;ne++){const pe=ne+B*T[2]+Z*T[1]+$*T[0];x.values[pe]=u}continue}const Y=Math.round(J),ie=Math.round(se);for(let ne=0;ne<p;ne++){const pe=ne+Y*k[2]+ie*k[1]+H*k[0],me=ne+B*T[2]+Z*T[1]+$*T[0];x.values[me]=S[pe]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const yfe={kernelName:Eb,backendName:"cpu",kernelFunc:gfe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;Pe(s,"cumprod");const l=qt([i],s.shape.length);let u=s;l!=null&&(u=Wr({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=on(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=Mr(u.dtype,"int32"),f=vb(oe(u.shape),d),p=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],y=a?(x,b)=>x+m-b-1:(x,b)=>x+b;for(let x=0;x<p.length;x+=m)for(let b=0;b<m;b++){const _=y(x,b);if(b===0)f[_]=o?1:p[_];else{const S=y(x,b-1);f[_]=o?p[S]*f[S]:p[_]*f[S]}}const v=n.makeTensorInfo(u.shape,d,f);if(l!=null){const x=Ml(l),b=Wr({inputs:{x:v},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(u),b}return v}const xfe={kernelName:$b,backendName:"cpu",kernelFunc:vfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;Pe(s,"cumsum");const l=qt([i],s.shape.length);let u=s;l!=null&&(u=Wr({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=on(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=Mr(u.dtype,"int32"),f=Xn(oe(u.shape),d),p=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],y=a?(x,b)=>x+m-b-1:(x,b)=>x+b;for(let x=0;x<p.length;x+=m)for(let b=0;b<m;b++){const _=y(x,b);if(b===0)f[_]=o?0:p[_];else{const S=y(x,b-1);f[_]=o?p[S]+f[S]:p[_]+f[S]}}const v=n.makeTensorInfo(u.shape,d,f);if(l!=null){const x=Ml(l),b=Wr({inputs:{x:v},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(u),b}return v}const wfe={kernelName:Qm,backendName:"cpu",kernelFunc:bfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _fe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=B2(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(i),c=QW(l,u,o,a);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Sfe={kernelName:Ab,backendName:"cpu",kernelFunc:_fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r;O(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=s.shape[0],l=s.shape[1],u=s.shape[2],c=s.shape[3],d=l*i,f=u*i,p=c/(i*i),m=n.data.get(s.dataId).values,y=new Float32Array(a*d*f*p);let v=0;for(let x=0;x<a;++x)for(let b=0;b<d;++b){const _=Math.floor(b/i),S=b%i;for(let k=0;k<f;++k){const T=Math.floor(k/i),$=k%i,A=(S*i+$)*p;for(let D=0;D<p;++D){const M=D+A+c*(T+u*(_+l*x));y[v++]=m[M]}}}return n.makeTensorInfo([a,d,f,p],s.dtype,y)}const Cfe={kernelName:Ob,backendName:"cpu",kernelFunc:kfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;Pe([s,i],"depthwiseConv2DNative");const c=ze(s.shape),d=ze(i.shape);let f=l;f==null&&(f=[1,1]),O(Yn(o,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${f}'`);const p=Ln(s.shape,i.shape,o,f,a,u,!0),{filterHeight:m,filterWidth:y,dilationHeight:v,dilationWidth:x,padInfo:b}=p,_=b.left,S=b.top,k=p.outChannels/p.inChannels,T=new pn(p.outShape,s.dtype),$=n.data.get(s.dataId).values,A=n.data.get(i.dataId).values,D=T.values;for(let F=0;F<p.batchSize;++F){const M=F*c[0],j=F*T.strides[0];for(let H=0;H<p.outHeight;++H){const K=j+H*T.strides[1],Q=H*p.strideHeight-S;for(let Z=0;Z<m;++Z){const se=Q+Z*v;if(se<0||se>=p.inHeight)continue;const B=Z*d[0],J=M+se*c[1];for(let Y=0;Y<p.outWidth;++Y){const ie=K+Y*T.strides[2],ne=Y*p.strideWidth-_;for(let pe=0;pe<y;++pe){const me=ne+pe*x;if(me<0||me>=p.inWidth)continue;const de=B+pe*d[1],fe=J+me*p.inChannels;let ke=ie,_e=de;for(let ue=0;ue<p.inChannels;++ue){const be=$[fe+ue];for(let xe=0;xe<k;++xe)D[ke+xe]+=be*A[_e+xe];ke+=k,_e+=k}}}}}}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const Tfe={kernelName:Jm,backendName:"cpu",kernelFunc:QU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r;Pe([s,i],"depthwiseConv2dNativeBackpropFilter");const d=Ln(s.shape,c,o,a,l,u,!0),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:y}=d,v=new pn(d.filterShape,"float32"),x=d.padInfo.left,b=d.padInfo.top,_=d.outChannels/d.inChannels,S=n.data.get(s.dataId).values,k=new pn(s.shape,s.dtype,S),T=n.data.get(i.dataId).values,$=new pn(i.shape,i.dtype,T);for(let A=0;A<m;++A){const D=Math.max(0,Math.ceil((b-A)/f)),F=Math.min(d.outHeight,(d.inHeight+b-A)/f);for(let M=0;M<y;++M){const j=Math.max(0,Math.ceil((x-M)/p)),H=Math.min(d.outWidth,(d.inWidth+x-M)/p);for(let K=0;K<d.outChannels;++K){const Q=Math.trunc(K/_),Z=K%_;let se=0;for(let B=0;B<d.batchSize;++B)for(let J=D;J<F;++J){const Y=A+J*f-b;for(let ie=j;ie<H;++ie){const ne=M+ie*p-x;se+=k.get(B,Y,ne,Q)*$.get(B,J,ie,K)}}v.set(se,A,M,Q,Z)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const Ife={kernelName:Pb,backendName:"cpu",kernelFunc:Nfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $fe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r;Pe([s,i],"depthwiseConv2DNativeBackpropInput");const d=ze(s.shape),f=ze(i.shape),p=Ln(c,i.shape,o,a,l,u,!0),m=new pn(p.inShape,"float32"),y=m.values,[v,x,b]=m.strides,_=n.data.get(s.dataId).values,[S,k,T]=d,$=n.data.get(i.dataId).values,[A,D,F]=f,{batchSize:M,filterHeight:j,filterWidth:H,inChannels:K,inHeight:Q,inWidth:Z,outChannels:se,outHeight:B,outWidth:J,strideHeight:Y,strideWidth:ie}=p,ne=j-1-p.padInfo.top,pe=H-1-p.padInfo.left,me=se/K;for(let de=0;de<M;++de)for(let fe=0;fe<K;++fe)for(let ke=0;ke<Q;++ke){const _e=ke-ne,ue=Math.max(0,Math.ceil(_e/Y)),be=Math.min(B,(j+_e)/Y);for(let xe=0;xe<Z;++xe){const le=xe-pe,Me=Math.max(0,Math.ceil(le/ie)),Be=Math.min(J,(H+le)/ie);let He=0;for(let Ge=ue;Ge<be;++Ge){const lt=Ge*Y-_e;for(let ht=Me;ht<Be;++ht){const Ti=ht*ie-le,un=S*de+k*Ge+T*ht,Ws=A*(j-1-lt)+D*(H-1-Ti)+F*fe;for(let mr=0;mr<me;++mr){const lo=fe*me+mr,ys=_[un+lo],Ni=$[Ws+mr];He+=ys*Ni}}}y[v*de+x*ke+b*xe+fe]=He}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const Efe={kernelName:Db,backendName:"cpu",kernelFunc:$fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Afe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=oe(r.shape),i=n.data.get(r.dataId).values,o=qe([s,s],r.dtype),a=o.values;for(let u=0;u<i.length;u++)a[u*s+u]=i[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const Ofe={kernelName:Rb,backendName:"cpu",kernelFunc:Afe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pfe={kernelName:eg,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s}=t,{strides:i,pad:o,dilations:a}=n,l=e,u=l.data.get(r.dataId).values,c=r.shape.length,d=l.data.get(s.dataId).values,f=s.shape.length,{batchSize:p,inHeight:m,inWidth:y,inChannels:v,outHeight:x,outWidth:b,padInfo:_,strideHeight:S,strideWidth:k,filterHeight:T,filterWidth:$,dilationHeight:A,dilationWidth:D,outShape:F}=Wg(r.shape,s.shape,i,o,"NHWC",a),M=oe(F),j=F.length,H=Yt(r.dtype,M);for(let Q=0;Q<p;++Q)for(let Z=0;Z<x;++Z){const se=Z*S-_.top;for(let B=0;B<b;++B){const J=B*k-_.left;for(let Y=0;Y<v;++Y){let ie=Number.MIN_SAFE_INTEGER;for(let pe=0;pe<T;++pe){const me=se+pe*A;if(me>=0&&me<m)for(let de=0;de<$;++de){const fe=J+de*D;if(fe>=0&&fe<y){const ke=qi([Q,me,fe,Y],c,ze(r.shape)),_e=qi([pe,de,Y],f,ze(s.shape)),ue=u[ke]+d[_e];ue>ie&&(ie=ue)}}}const ne=qi([Q,Z,B,Y],j,ze(F));H[ne]=ie}}}return{dataId:l.write(Rl(H,r.dtype),F,r.dtype),shape:F,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dfe={kernelName:j0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:l}=n,u=e,c=$s(r.shape,u.data.get(r.dataId).values),d=$s(s.shape,u.data.get(s.dataId).values),{batchSize:f,inHeight:p,inWidth:m,inChannels:y,outHeight:v,outWidth:x,padInfo:b,strideHeight:_,strideWidth:S,filterHeight:k,filterWidth:T,dilationHeight:$,dilationWidth:A,outShape:D}=Wg(r.shape,s.shape,o,a,"NHWC",l);O(i.rank===D.length,()=>`Error in ${j0}, dy must have the same rank as output ${D.length}, but got ${i.rank}`);const F=$s(D,u.data.get(i.dataId).values),M=uI(s.shape,s.dtype);for(let H=0;H<f;++H)for(let K=0;K<v;++K){const Q=K*_-b.top;for(let Z=0;Z<x;++Z){const se=Z*S-b.left;for(let B=0;B<y;++B){let J=Number.MIN_SAFE_INTEGER,Y=0,ie=0;for(let ne=0;ne<k;++ne){const pe=Q+ne*$;if(pe>=0&&pe<p)for(let me=0;me<T;++me){const de=se+me*A;if(de>=0&&de<m){const fe=c[H][pe][de][B]+d[ne][me][B];fe>J&&(J=fe,Y=ne,ie=me)}}}M[Y][ie][B]+=F[H][K][Z][B]}}}return{dataId:u.write(Rl(M,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rfe={kernelName:B0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:l}=n,u=e,c=$s(r.shape,u.data.get(r.dataId).values),d=$s(s.shape,u.data.get(s.dataId).values),{batchSize:f,inHeight:p,inWidth:m,inChannels:y,outHeight:v,outWidth:x,padInfo:b,strideHeight:_,strideWidth:S,filterHeight:k,filterWidth:T,dilationHeight:$,dilationWidth:A,outShape:D}=Wg(r.shape,s.shape,o,a,"NHWC",l);O(i.rank===D.length,()=>`Error in ${B0}, dy must have the same rank as output ${D.length}, but got ${i.rank}`);const F=$s(D,u.data.get(i.dataId).values),M=uI(r.shape,r.dtype);for(let H=0;H<f;++H)for(let K=0;K<v;++K){const Q=K*_-b.top;for(let Z=0;Z<x;++Z){const se=Z*S-b.left;for(let B=0;B<y;++B){let J=Number.MIN_SAFE_INTEGER,Y=Q<0?0:Q,ie=se<0?0:se;for(let ne=0;ne<k;++ne){const pe=Q+ne*$;if(pe>=0&&pe<p)for(let me=0;me<T;++me){const de=se+me*A;if(de>=0&&de<m){const fe=c[H][pe][de][B]+d[ne][me][B];fe>J&&(J=fe,Y=pe,ie=de)}}}M[H][Y][ie][B]+=F[H][K][Z][B]}}}return{dataId:u.write(Rl(M,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lfe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{canvas:i,options:o}=r,{contextOptions:a,imageOptions:l}=o||{},u=(l==null?void 0:l.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=i.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${c} type.`);const[f,p]=s.shape.slice(0,2),m=s.shape.length===2?1:s.shape[2],y=n.data.get(s.dataId).values,v=s.dtype==="float32"?255:1,x=new Uint8ClampedArray(p*f*4);for(let _=0;_<f*p;++_){const S=[0,0,0,255*u];for(let T=0;T<m;T++){const $=y[_*m+T];if(s.dtype==="float32"){if($<0||$>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${$}.`)}else if(s.dtype==="int32"&&($<0||$>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${$}.`);m===1?(S[0]=$*v,S[1]=$*v,S[2]=$*v):S[T]=$*v}const k=_*4;x[k+0]=Math.round(S[0]),x[k+1]=Math.round(S[1]),x[k+2]=Math.round(S[2]),x[k+3]=Math.round(S[3])}i.width=p,i.height=f;const b=new ImageData(x,p,f);return d.putImageData(b,0,0),s}const Ffe={kernelName:Lb,backendName:"cpu",kernelFunc:Lfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vy(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Pe(s,"sum");let a;s.dtype==="bool"?a=Il({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):a=Lo({inputs:{x:s},backend:n});const l=a.shape.length,u=Je(i,a.shape),c=qt(u,l);let d=u,f=a;c!=null&&(f=Wr({inputs:{x:a},backend:n,attrs:{perm:c}}),d=on(d.length,l)),Qn("sum",d,f.shape.length);const[p,m]=Fn(f.shape,d),y=Mr(f.dtype,"int32");let v=ix(n,p,y);const x=oe(m),b=n.data.get(v.dataId).values,_=n.data.get(f.dataId).values;for(let S=0;S<b.length;++S){const k=S*x;let T=0;for(let $=0;$<x;++$)T+=_[k+$];b[S]=T}if(o){const S=sn(v.shape,u),k=v;v=Et({inputs:{x:v},backend:n,attrs:{shape:S}}),n.disposeIntermediateTensorInfo(k)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(f),v}const Mfe={kernelName:Pg,backendName:"cpu",kernelFunc:vy};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zfe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=a2(s,i.length);u2(o.length,l,i);const{path:u,steps:c}=c2(a,l),d=c.length;let f=null,p=o.length;const m=[];for(let y=0;y<d;++y){for(const v of c[y]){const{permutationIndices:x,expandDims:b}=l2(p,l[v]);let _;d2(x)?_=i[v]:(_=Wr({inputs:{x:i[v]},backend:n,attrs:{perm:x}}),m.push(_));const S=_.shape.slice();for(let k=0;k<b.length;++k)S.splice(b[k],0,1);nt(_.shape,S)||(_=Et({inputs:{x:_},backend:n,attrs:{shape:S}}),m.push(_)),f===null?f=_:(f=C1({inputs:{a:_,b:f},backend:n}),m.push(f))}y<d-1&&(u[y]>=0&&(f=vy({inputs:{x:f},backend:n,attrs:{axis:u[y]-(o.length-p),keepDims:!1}}),m.push(f)),p--)}for(const y of m)y!==f&&n.disposeIntermediateTensorInfo(y);return f}const Bfe={kernelName:Fb,backendName:"cpu",kernelFunc:zfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jfe(t){const{inputs:e,backend:n}=t,{dy:r,y:s}=e;Pe([r,s],"eluGrad");const i=new Float32Array(oe(s.shape)),o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const u=o[l];u>=0?i[l]=a[l]:i[l]=a[l]*(u+1)}return n.makeTensorInfo(s.shape,"float32",i)}const Vfe={kernelName:Mb,backendName:"cpu",kernelFunc:jfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wfe=e2,Ufe=t2,Gfe=n2,Hfe=r2,Kfe=s2,qfe=i2,Xfe=bt(kh,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+Wfe*n);return e*(1-((((qfe*r+Kfe)*r+Hfe)*r+Gfe)*r+Ufe)*r*Math.exp(-n*n))}),Zfe={kernelName:kh,backendName:"cpu",kernelFunc:Xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lx(t){const{inputs:e,backend:n,attrs:r}=t,{input:s}=e,{dim:i}=r,o=s.shape.length,a=s.shape.slice();let l=i;return i<0&&(O(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),Et({inputs:{x:s},backend:n,attrs:{shape:a}})}const Yfe={kernelName:ng,backendName:"cpu",kernelFunc:lx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qfe=ln((t,e)=>t/e),H2=Tn(_h,Qfe),oT={kernelName:_h,backendName:"cpu",kernelFunc:H2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JU(t,e,n){const r=t.shape,s=r[0],i=r[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,u=[s,i],c=oe(u),d=Dn("float32",c),f=Dn("float32",c);for(let v=0;v<s;v++){const x=ac({inputs:{x:a},backend:n,attrs:{begin:[v,0],size:[1,i]}}),b=ac({inputs:{x:l},backend:n,attrs:{begin:[v,0],size:[1,i]}}),_=ns({inputs:{real:x,imag:b},backend:n}),{real:S,imag:k}=Jfe(_,e,n),T=ya(S,k);for(let $=0;$<i;$++){const A=o2(T,$);d[v*i+$]=A.real,f[v*i+$]=A.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(_)}const p=n.makeTensorInfo(u,"float32",d),m=n.makeTensorInfo(u,"float32",f),y=ns({inputs:{real:p,imag:m},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),y}function Jfe(t,e,n){const r=oe(t.shape),s=n.data.get(t.dataId),i=n.data.get(s.complexTensorInfos.real.dataId).values,o=n.data.get(s.complexTensorInfos.imag.dataId).values;if(epe(r)){const a=aT(i,o,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",a.real),c=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",Ta(r,"float32")),f=Lo({inputs:{x:d},backend:n}),p=oT.kernelFunc({inputs:{a:u,b:d},backend:n}),m=oT.kernelFunc({inputs:{a:c,b:f},backend:n}),y=n.data.get(p.dataId).values,v=n.data.get(m.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),{real:y,imag:v}}return a}else{const a=ya(i,o),l=tpe(a,r,e);return l4(l)}}function epe(t){return(t&t-1)===0}function aT(t,e,n,r,s){if(n===1)return{real:t,imag:e};const i=ya(t,e),o=n/2,a=u4(i),l=a.real,u=a.imag,c=[l.length],d=s.makeTensorInfo(c,"float32",l),f=s.makeTensorInfo(c,"float32",u),p=ns({inputs:{real:d,imag:f},backend:s}),m=c4(i),y=m.real,v=m.imag,x=[y.length],b=s.makeTensorInfo(x,"float32",y),_=s.makeTensorInfo(x,"float32",v),S=ns({inputs:{real:b,imag:_},backend:s}),k=aT(l,u,o,r,s),T=k.real,$=k.imag,A=[T.length],D=s.makeTensorInfo(A,"float32",T),F=s.makeTensorInfo(A,"float32",$),M=ns({inputs:{real:D,imag:F},backend:s}),j=aT(y,v,o,r,s),H=j.real,K=j.imag,Q=[H.length],Z=s.makeTensorInfo(Q,"float32",H),se=s.makeTensorInfo(Q,"float32",K),B=ns({inputs:{real:Z,imag:se},backend:s}),J=h4(n,r),Y=[J.real.length],ie=s.makeTensorInfo(Y,"float32",J.real),ne=s.makeTensorInfo(Y,"float32",J.imag),pe=ns({inputs:{real:ie,imag:ne},backend:s}),me=C1({inputs:{a:pe,b:B},backend:s}),de=Hd({inputs:{a:M,b:me},backend:s}),fe=U2({inputs:{a:M,b:me},backend:s}),ke=oc({inputs:{input:de},backend:s}),_e=oc({inputs:{input:fe},backend:s}),ue=Kd({inputs:{input:de},backend:s}),be=Kd({inputs:{input:fe},backend:s}),xe=qd({inputs:[ke,_e],backend:s,attrs:{axis:0}}),le=qd({inputs:[ue,be],backend:s,attrs:{axis:0}}),Me=s.data.get(xe.dataId).values,Be=s.data.get(le.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(p),s.disposeIntermediateTensorInfo(b),s.disposeIntermediateTensorInfo(_),s.disposeIntermediateTensorInfo(S),s.disposeIntermediateTensorInfo(D),s.disposeIntermediateTensorInfo(F),s.disposeIntermediateTensorInfo(M),s.disposeIntermediateTensorInfo(Z),s.disposeIntermediateTensorInfo(se),s.disposeIntermediateTensorInfo(B),s.disposeIntermediateTensorInfo(ie),s.disposeIntermediateTensorInfo(ne),s.disposeIntermediateTensorInfo(pe),s.disposeIntermediateTensorInfo(me),s.disposeIntermediateTensorInfo(de),s.disposeIntermediateTensorInfo(fe),s.disposeIntermediateTensorInfo(ke),s.disposeIntermediateTensorInfo(ue),s.disposeIntermediateTensorInfo(_e),s.disposeIntermediateTensorInfo(be),s.disposeIntermediateTensorInfo(xe),s.disposeIntermediateTensorInfo(le),{real:Me,imag:Be}}function tpe(t,e,n){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let i=0,o=0;for(let a=0;a<e;a++){const l=f4(s*a,e,n),u=o2(t,a);i+=u.real*l.real-u.imag*l.imag,o+=u.real*l.imag+u.imag*l.real}n&&(i/=e,o/=e),d4(r,i,o,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function npe(t){const{inputs:e,backend:n}=t,{input:r}=e,s=oe(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=Et({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=JU(a,!1,n),u=Et({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const rpe={kernelName:zb,backendName:"cpu",kernelFunc:npe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2(t){const{backend:e,attrs:n}=t,{shape:r,value:s,dtype:i}=n,o=i||vc(s),a=Yt(o,oe(r));return ipe(a,s,o),e.makeTensorInfo(r,o,a)}const spe={kernelName:Bb,backendName:"cpu",kernelFunc:K2};function ipe(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ope={kernelName:jb,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,s=n,i=Dn(r.dtype,oe(r.shape)),[o,a,l,u]=r.shape,c=s.data.get(r.dataId).values;for(let f=0;f<o;f++){const p=f*l*a*u;for(let m=0;m<a;m++){const y=m*(l*u);for(let v=0;v<l;v++){const x=v*u;for(let b=0;b<u;b++){const _=Math.round(l-v-1),S=p+y+x+b;let k=c[S];if(_>=0&&_<l){const T=_*u,$=p+y+T+b;k=c[$]}i[S]=k}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ape(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:p,leakyreluAlpha:m}=r;let y=YU({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f}});if(o){const v=y;if(c==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const x=Et({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});y=Hd({inputs:{a:y,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else y=Hd({inputs:{a:y,b:o},backend:n});n.disposeIntermediateTensorInfo(v)}if(p){const v=y;if(c==="NCHW"&&p==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const x=Et({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});y=ax(n,y,p,x,m),n.disposeIntermediateTensorInfo(x)}else y=ax(n,y,p,a,m);n.disposeIntermediateTensorInfo(v)}return y}const lpe={kernelName:tm,backendName:"cpu",kernelFunc:ape};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function upe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:p,leakyreluAlpha:m}=r;let y=QU({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f}});if(o){const v=y;y=Hd({inputs:{a:y,b:o},backend:n}),n.disposeIntermediateTensorInfo(v)}if(p){const v=y;y=ax(n,y,p,a,m),n.disposeIntermediateTensorInfo(v)}return y}const cpe={kernelName:nm,backendName:"cpu",kernelFunc:upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=oe(r.shape),o=s.shape,a=o[o.length-1],[l,u,c,d]=u1(r,s);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);const f=n.data.get(s.dataId).values,p=n.bufferSync(r),m=uU(f,p,r.dtype,u,a,c,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,m.values)}const hpe={kernelName:Vb,backendName:"cpu",kernelFunc:dpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r;Pe([s,i],"gatherV2");const l=Je(o,s.shape)[0],u=n.data.get(i.dataId).values,c=s.shape[l];for(let S=0;S<u.length;++S){const k=u[S];O(k<=c-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${c-1}]`)}let d=a;a==null&&(d=0);const f=oe(i.shape),p=f2(s,i,l,d),m=Et({inputs:{x:s},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),y=Et({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,f/p.batchSize]}}),v=[p.batchSize,p.outerSize,f/p.batchSize,p.sliceSize],x=n.bufferSync(y),b=n.bufferSync(m),_=cU(b,x,v);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.makeTensorInfo(p.outputShape,_.dtype,_.values)}const ppe={kernelName:sg,backendName:"cpu",kernelFunc:fpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mpe(t){const{inputs:e,backend:n}=t,{input:r}=e,s=oe(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=Et({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=JU(a,!0,n),u=Et({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const gpe={kernelName:Wb,backendName:"cpu",kernelFunc:mpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ype=bt(Ah,t=>Number.isFinite(t)?1:0,"bool"),vpe={kernelName:Ah,backendName:"cpu",kernelFunc:ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xpe=bt(Oh,t=>Math.abs(t)===1/0?1:0,"bool"),bpe={kernelName:Oh,backendName:"cpu",kernelFunc:xpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wpe=bt(Ph,t=>Number.isNaN(t)?1:0,"bool"),_pe={kernelName:Ph,backendName:"cpu",kernelFunc:wpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Spe(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=mU(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const kpe={kernelName:Gb,backendName:"cpu",kernelFunc:Spe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpe=bt(Rh,t=>Math.log1p(t)),Tpe={kernelName:Rh,backendName:"cpu",kernelFunc:Cpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npe=ln((t,e)=>t&&e),Ipe=Tn(ug,Npe,null,"bool"),$pe={kernelName:ug,backendName:"cpu",kernelFunc:Ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Epe=bt(cg,t=>t?0:1,"bool"),Ape={kernelName:cg,backendName:"cpu",kernelFunc:Epe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ope=ln((t,e)=>t||e),Ppe=Tn(dg,Ope,null,"bool"),Dpe={kernelName:dg,backendName:"cpu",kernelFunc:Ppe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r;Pe(s,"LRN");const u=s.shape[3],c=u-1,d=n.data.get(s.dataId).values,f=oe(s.shape),p=new Float32Array(f);function m(y){const v=y%u;let x=y-v+Math.max(0,v-i);const b=y-v+Math.min(v+i,c);let _=0;for(;x<=b;x++){const S=d[x];_+=S*S}return _}for(let y=0;y<f;y++){const v=m(y),x=d[y]*Math.pow(o+a*v,-l);p[y]=x}return n.makeTensorInfo(s.shape,s.dtype,p)}const Lpe={kernelName:hg,backendName:"cpu",kernelFunc:Rpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r;Pe(o,"LRNGrad");const d=oe(o.shape),f=o.shape[3],p=n.data.get(o.dataId).values,m=n.data.get(s.dataId).values,y=n.data.get(i.dataId).values,v=new Float32Array(d),x=d;for(let b=0;b<x;b++){const _=b%f,S=b-_+Math.max(0,_-a),k=b-_+Math.min(f,_+a+1);let T=0;for(let $=S;$<k;$++)T+=Math.pow(m[$],2);T=u*T+l;for(let $=S;$<k;$++){let A=-2*u*c*m[$]*y[b]/T;b===$&&(A+=Math.pow(T,-c)),A*=p[b],v[$]+=A}}return n.makeTensorInfo(o.shape,s.dtype,v)}const Mpe={kernelName:Hb,backendName:"cpu",kernelFunc:Fpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eG(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=n;let l=s.shape;const u=l.length,c=Je(i,l);let d=c;const f=qt(d,u);let p=a.data.get(s.dataId).values;if(f!=null){const S=new Array(u);for(let k=0;k<S.length;k++)S[k]=l[f[k]];p=V2(p,l,s.dtype,f,S),d=on(d.length,u),l=S}Pe(s,"max"),Qn("max",d,u);const[m,y]=Fn(l,d),v=oe(y),x=yU(p,v,m,s.dtype),b=a.write(x,m,s.dtype);let _=m;return o&&(_=sn(m,c)),{dataId:b,shape:_,dtype:s.dtype}}const zpe={kernelName:fg,backendName:"cpu",kernelFunc:eG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Pe(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;O(Yn(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=_i(s.shape,i,o,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&nt(c.inShape,c.outShape))d=Lo({inputs:{x:s},backend:n});else{const f=n.data.get(s.dataId).values,p=ze(s.shape),m=G2(f,s.shape,s.dtype,p,c,"max");d=n.makeTensorInfo(c.outShape,s.dtype,m.values)}return d}const jpe={kernelName:pg,backendName:"cpu",kernelFunc:Bpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;Pe(s,"maxPool3d");const c=Na(s.shape,i,o,1,a,l,u),d=n.data.get(s.dataId).values,f=ZU(d,s.shape,s.dtype,ze(s.shape),c,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}const Wpe={kernelName:mg,backendName:"cpu",kernelFunc:Vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Upe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;Pe([s,i],"maxPool3DGrad");const c=Na(i.shape,o,a,1,l,u),d=n.bufferSync(i),f=Ohe(d,c),p=c.strideDepth,m=c.strideHeight,y=c.strideWidth,v=c.dilationDepth,x=c.dilationHeight,b=c.dilationWidth,_=c.effectiveFilterDepth,S=c.effectiveFilterHeight,k=c.effectiveFilterWidth,T=_-1-c.padInfo.front,$=k-1-c.padInfo.left,A=S-1-c.padInfo.top,D=qe(i.shape,"float32"),F=n.bufferSync(s);for(let M=0;M<c.batchSize;++M)for(let j=0;j<c.inChannels;++j)for(let H=0;H<c.inDepth;++H)for(let K=0;K<c.inHeight;++K)for(let Q=0;Q<c.inWidth;++Q){const Z=H-T,se=K-A,B=Q-$;let J=0;for(let Y=0;Y<_;Y+=v){const ie=(Z+Y)/p;if(!(ie<0||ie>=c.outDepth||Math.floor(ie)!==ie))for(let ne=0;ne<S;ne+=x){const pe=(se+ne)/m;if(!(pe<0||pe>=c.outHeight||Math.floor(pe)!==pe))for(let me=0;me<k;me+=b){const de=(B+me)/y;if(de<0||de>=c.outWidth||Math.floor(de)!==de)continue;const fe=_*S*k-1-f.get(M,ie,pe,de,j),ke=Y*S*k+ne*k+me,_e=fe===ke?1:0;if(_e===0)continue;const ue=F.get(M,ie,pe,de,j);J+=ue*_e}}}D.set(J,M,H,K,Q,j)}return n.makeTensorInfo(D.shape,D.dtype,D.values)}const Gpe={kernelName:qb,backendName:"cpu",kernelFunc:Upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;Pe([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,f=_i(a.shape,l,u,1,c,d),p=n.data.get(a.dataId).values,m=qe(f.outShape,a.dtype,XU(p,a.shape,a.dtype,f).values),y=f.strideHeight,v=f.strideWidth,x=f.dilationHeight,b=f.dilationWidth,_=f.effectiveFilterHeight,S=f.effectiveFilterWidth,k=S-1-f.padInfo.left,T=_-1-f.padInfo.top,$=qe(a.shape,"float32"),A=n.data.get(s.dataId).values,D=qe(s.shape,"float32",A);for(let F=0;F<f.batchSize;++F)for(let M=0;M<f.inChannels;++M)for(let j=0;j<f.inHeight;++j)for(let H=0;H<f.inWidth;++H){const K=j-T,Q=H-k;let Z=0;for(let se=0;se<_;se+=x){const B=(K+se)/y;if(!(B<0||B>=f.outHeight||Math.floor(B)!==B))for(let J=0;J<S;J+=b){const Y=(Q+J)/v;if(Y<0||Y>=f.outWidth||Math.floor(Y)!==Y)continue;const ie=_*S-1-m.get(F,B,Y,M),ne=se*S+J,pe=ie===ne?1:0;if(pe===0)continue;const me=D.get(F,B,Y,M);Z+=me*pe}}$.set(Z,F,j,H,M)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const Kpe={kernelName:Kb,backendName:"cpu",kernelFunc:Hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qpe(t,e,n,r,s){const i=ze(e),o=G2(t,e,n,i,s,"max"),a=XU(t,e,n,s,!0,r);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xpe={kernelName:Xb,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;Pe(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=_i(r.shape,s,i,[1,1],o),[d,f]=qpe(u,r.shape,r.dtype,a,c),p=l.write(d,c.outShape,r.dtype),m=l.write(f,c.outShape,r.dtype);return[{dataId:p,shape:c.outShape,dtype:r.dtype},{dataId:m,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=Je(i,s.shape),u=Fn(s.shape,a)[1],c=oe(u),d=[],f=n.makeTensorInfo([],"float32",new Float32Array([c]));d.push(f);const p=Il({inputs:{x:s},backend:n,attrs:{dtype:"float32"}});d.push(p);const m=H2({inputs:{a:p,b:f},backend:n});d.push(m);const y=vy({inputs:{x:m},backend:n,attrs:{axis:i,keepDims:o}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),y}const Ype={kernelName:gg,backendName:"cpu",kernelFunc:Zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Pe(s,"min");const a=Je(i,s.shape);let l=a;const u=qt(l,s.shape.length);let c=s;u!=null&&(c=Wr({inputs:{x:s},backend:n,attrs:{perm:u}}),l=on(l.length,s.shape.length)),Qn("min",l,c.shape.length);const[d,f]=Fn(c.shape,l),p=oe(f),m=Xn(oe(d),c.dtype),y=n.data.get(c.dataId).values;for(let x=0;x<m.length;++x){const b=x*p;let _=y[b];for(let S=0;S<p;++S){const k=y[b+S];(Number.isNaN(k)||k<_)&&(_=k)}m[x]=_}u!=null&&n.disposeIntermediateTensorInfo(c);const v=n.makeTensorInfo(d,c.dtype,m);if(o){const x=sn(d,a),b=Et({inputs:{x:v},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(v),b}return v}const Jpe={kernelName:yg,backendName:"cpu",kernelFunc:Qpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,mode:o}=r;Pe(s,"mirrorPad");const a=i.map((_,S)=>_[0]+s.shape[S]+_[1]),l=i.map(_=>_[0]),u=i.map((_,S)=>_[0]+s.shape[S]),c=o==="reflect"?0:1,d=n.data.get(s.dataId).values,f=s.shape.length,p=ze(s.shape),m=oe(a),y=a.length,v=ze(a),x=Dn(s.dtype,m);for(let _=0;_<m;_++){let S=xc(_,y,v);for(let T=0;T<y;T++)S[T]<l[T]?S[T]=l[T]*2-S[T]-c:S[T]>=u[T]&&(S[T]=(u[T]-1)*2-S[T]+c);S=S.map((T,$)=>T-l[$]);const k=qi(S,f,p);x[_]=d[k]}return{dataId:n.write(x,a,s.dtype),shape:a,dtype:s.dtype}}const tme={kernelName:vg,backendName:"cpu",kernelFunc:eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nme=ln((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),rme=Tn(Mh,nme),sme={kernelName:Mh,backendName:"cpu",kernelFunc:rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tG(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=s.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=Je([a],s.shape),u=eG({inputs:{x:s},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=sn(u.shape,l),d=Et({inputs:{x:u},backend:n,attrs:{shape:c}}),f=U2({inputs:{a:s,b:d},backend:n}),p=iU({inputs:{x:f},backend:n}),m=vy({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),y=Et({inputs:{x:m},backend:n,attrs:{shape:c}}),v=H2({inputs:{a:p,b:y},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),v}const ime={kernelName:Lg,backendName:"cpu",kernelFunc:tG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ome(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r;Pe(s,"multinomial");const l=a?s:tG({inputs:{logits:s},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,f=[u,i],p=Xn(oe(f),"int32");for(let m=0;m<u;++m){const y=m*c,v=new Float32Array(c-1);v[0]=d[y];for(let _=1;_<v.length;++_)v[_]=v[_-1]+d[y+_];const x=Mw.alea(o.toString()),b=m*i;for(let _=0;_<i;++_){const S=x();p[b+_]=v.length;for(let k=0;k<v.length;k++)if(S<v[k]){p[b+_]=k;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(f,"int32",p)}const ame={kernelName:Zb,backendName:"cpu",kernelFunc:ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lme=i1;function ume(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r;Pe(s,"NonMaxSuppression");const u=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:d}=lme(u,c,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const cme={kernelName:Yb,backendName:"cpu",kernelFunc:ume};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dme=o1;function hme(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;Pe(s,"NonMaxSuppressionPadded");const c=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:f,validOutputs:p}=dme(c,d,o,a,l,u);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const fme={kernelName:Qb,backendName:"cpu",kernelFunc:hme};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pme=a1;function mme(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;Pe(s,"NonMaxSuppressionWithScore");const c=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,f=o,p=a,m=l,y=u,{selectedIndices:v,selectedScores:x}=pme(c,d,f,p,m,y);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const gme={kernelName:Jb,backendName:"cpu",kernelFunc:mme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yme(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r;Pe(s,"oneHot");const u=oe(s.shape),c=new Float32Array(u*o);c.fill(l);const d=n.data.get(s.dataId).values;for(let f=0;f<u;++f)d[f]>=0&&d[f]<o&&(c[f*o+d[f]]=a);return n.makeTensorInfo([...s.shape,o],i,c)}const vme={kernelName:_g,backendName:"cpu",kernelFunc:yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ux(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=oc({inputs:{input:r},backend:n}),i=ux({inputs:{x:s},backend:n}),o=Kd({inputs:{input:r},backend:n}),a=ux({inputs:{x:o},backend:n}),l=ns({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return K2({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const xme={kernelName:Bg,backendName:"cpu",kernelFunc:ux};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=oc({inputs:{input:r},backend:n}),i=nG({inputs:{x:s},backend:n}),o=Kd({inputs:{input:r},backend:n}),a=ux({inputs:{x:o},backend:n}),l=ns({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return K2({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const bme={kernelName:wg,backendName:"cpu",kernelFunc:nG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rG(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return lx({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{Zn(i,c.shape,"All tensors passed to stack must have matching shapes"),O(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=lx({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=qd({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const wme={kernelName:Sg,backendName:"cpu",kernelFunc:rG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _me(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;Pe(s,"pad");const a=i.map((b,_)=>b[0]+s.shape[_]+b[1]),l=i.map(b=>b[0]),u=n.data.get(s.dataId).values,c=oe(s.shape),d=s.shape.length,f=ze(s.shape),p=oe(a),m=a.length,y=ze(a),v=Dn(s.dtype,p);o!==0&&v.fill(o);for(let b=0;b<c;b++){const S=xc(b,d,f).map((T,$)=>T+l[$]),k=qi(S,m,y);v[k]=u[b]}return{dataId:n.write(v,a,s.dtype),shape:a,dtype:s.dtype}}const sG={kernelName:kg,backendName:"cpu",kernelFunc:_me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sme=ln((t,e)=>Math.pow(t,e)),kme=Tn(Bh,Sme),Cme={kernelName:Bh,backendName:"cpu",kernelFunc:kme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tme(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,l=s.map(x=>n.data.get(x.dataId).values),u=s.map(x=>x.shape),c=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,[f,p,m]=SU(l,u,c,i.shape,i.dtype,d,o.shape),y=f.map(x=>n.makeTensorInfo([x.length],"int32",x)),v=n.makeTensorInfo(m,i.dtype,p);return y.concat([v])}const Nme={kernelName:ew,backendName:"cpu",kernelFunc:Tme};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ime(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[u,c]=kU(o,r.shape,r.dtype,a,s.shape,l,i.shape),d=n.makeTensorInfo([u.length],"int32",u),f=n.makeTensorInfo([c.length],r.dtype,c);return[d,f]}const $me={kernelName:tw,backendName:"cpu",kernelFunc:Ime};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eme(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,f=a.map(v=>n.data.get(v.dataId).values),p=a.map(v=>v.shape),[m,y]=CU(u,s.shape,c,i.shape,i.dtype,d,o.shape,f,p,l);return n.makeTensorInfo(m,i.dtype,y)}const Ame={kernelName:nw,backendName:"cpu",kernelFunc:Eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ome(t){const{backend:e,attrs:n}=t,{start:r,stop:s,dtype:i,step:o}=n,a=TU(r,s,o,i);return e.makeTensorInfo([a.length],i,a)}const Pme={kernelName:rw,backendName:"cpu",kernelFunc:Ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dme=bt(jh,t=>1/t),Rme={kernelName:jh,backendName:"cpu",kernelFunc:Dme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lme(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;Pe(s,"resizeBilinear");const l=ze(s.shape),[u,c]=a,[d,f,p,m]=s.shape,y=n.data.get(s.dataId).values,v=new Float32Array(oe([d,u,c,m])),x=[i&&u>1?f-1:f,i&&c>1?p-1:p],b=[i&&u>1?u-1:u,i&&c>1?c-1:c];let _=0;const S=x[0]/b[0],k=x[1]/b[1];for(let T=0;T<d;T++)for(let $=0;$<u;$++){let A;o?A=S*($+.5)-.5:A=S*$;const D=Math.max(0,Math.floor(A)),F=A-D,M=Math.min(f-1,Math.ceil(A)),j=T*l[0]+D*l[1],H=T*l[0]+M*l[1];for(let K=0;K<c;K++){let Q;o?Q=k*(K+.5)-.5:Q=k*K;const Z=Math.max(0,Math.floor(Q)),se=Q-Z,B=Math.min(p-1,Math.ceil(Q)),J=j+Z*l[2],Y=H+Z*l[2],ie=j+B*l[2],ne=H+B*l[2];for(let pe=0;pe<m;pe++){const me=y[J+pe],de=y[Y+pe],fe=y[ie+pe],ke=y[ne+pe],_e=me+(fe-me)*se,ue=de+(ke-de)*se,be=_e+(ue-_e)*F;v[_++]=be}}}return n.makeTensorInfo([d,u,c,m],"float32",v)}const Fme={kernelName:$g,backendName:"cpu",kernelFunc:Lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mme(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;Pe([i,s],"resizeBilinearGrad");const a=ze(s.shape),[l,u,c,d]=s.shape,[,f,p]=i.shape,m=new Float32Array(l*u*c*d),y=[o&&f>1?u-1:u,o&&p>1?c-1:c],v=[o&&f>1?f-1:f,o&&p>1?p-1:p],x=y[0]/v[0],b=y[1]/v[1],_=n.data.get(i.dataId).values;let S=0;for(let k=0;k<l;k++){const T=k*a[0];for(let $=0;$<f;$++){const A=$*x,D=Math.floor(A),F=Math.min(Math.ceil(A),u-1),M=T+D*a[1],j=T+F*a[1],H=A-D,K=1-H;for(let Q=0;Q<p;Q++){const Z=Q*b,se=Math.floor(Z),B=Math.min(Math.ceil(Z),c-1),J=Z-se,Y=1-J,ie=M+se*a[2],ne=M+B*a[2],pe=j+se*a[2],me=j+B*a[2],de=K*Y,fe=K*J,ke=H*Y,_e=H*J;for(let ue=0;ue<d;ue++){const be=_[S++];m[ie+ue]+=be*de,m[ne+ue]+=be*fe,m[pe+ue]+=be*ke,m[me+ue]+=be*_e}}}}return n.makeTensorInfo([l,c,u,d],"float32",m)}const zme={kernelName:ow,backendName:"cpu",kernelFunc:Mme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bme(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;Pe(s,"resizeNearestNeighbor");const l=ze(s.shape),[u,c]=a,[d,f,p,m]=s.shape,y=n.data.get(s.dataId).values,v=new Float32Array(d*u*c*m),x=[i&&u>1?f-1:f,i&&c>1?p-1:p],b=[i&&u>1?u-1:u,i&&c>1?c-1:c],_=x[0]/b[0],S=x[1]/b[1];let k=0;for(let T=0;T<d;T++){const $=T*l[0];for(let A=0;A<u;A++){const D=o?_*(A+.5):_*A;let F=Math.min(f-1,i?Math.round(D):Math.floor(D));o&&(F=Math.max(0,F));const M=$+F*l[1];for(let j=0;j<c;j++){const H=o?S*(j+.5):S*j;let K=Math.min(p-1,i?Math.round(H):Math.floor(H));o&&(K=Math.max(0,K));const Q=M+K*l[2];for(let Z=0;Z<m;Z++){const se=y[Q+Z];v[k++]=se}}}}return n.makeTensorInfo([d,u,c,m],s.dtype,v)}const jme={kernelName:Ig,backendName:"cpu",kernelFunc:Bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vme(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;Pe([i,s],"resizeNearestNeighborGrad");const a=ze(s.shape),l=ze(i.shape),[u,c,d,f]=s.shape,[,p,m]=i.shape,y=new Float32Array(u*c*d*f),v=n.data.get(i.dataId).values,x=[o&&p>1?c-1:c,o&&m>1?d-1:d],b=[o&&p>1?p-1:p,o&&m>1?m-1:m],_=x[0]/b[0],S=x[1]/b[1],k=1/_,T=1/S,$=Math.ceil(k)*2+2,A=Math.ceil(T)*2+2;for(let D=0;D<u;D++){const F=D*a[0];for(let M=0;M<c;M++){const j=F+M*a[1],H=Math.floor(M*k),K=Math.floor(H-$/2);for(let Q=0;Q<d;Q++){const Z=j+Q*a[2],se=Math.floor(Q*T),B=Math.floor(se-A/2);for(let J=0;J<f;J++){let Y=0;for(let ie=0;ie<$;ie++){const ne=ie+K;if(ne<0||ne>=p)continue;const pe=F+ne*l[1],me=ne*_,de=Math.min(c-1,o?Math.round(me):Math.floor(me));if(M===de)for(let fe=0;fe<A;fe++){const ke=fe+B;if(ke<0||ke>=m)continue;const _e=pe+ke*l[2],ue=ke*S,be=Math.min(d-1,o?Math.round(ue):Math.floor(ue));Q===be&&(Y+=v[_e+J])}}y[Z+J]=Y}}}}return n.makeTensorInfo(s.shape,s.dtype,y)}const Wme={kernelName:iw,backendName:"cpu",kernelFunc:Vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ume(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r;Pe(s,"reverse");const o=s.shape.length,a=Je(i,s.shape);if(o===0)return Lo({inputs:{x:s},backend:n});const l=new pn(s.shape,s.dtype),u=n.bufferSync(s);for(let c=0;c<l.size;c++){const d=l.indexToLoc(c),f=d.slice();a.forEach(p=>f[p]=s.shape[p]-1-f[p]),l.set(u.get(...f),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Gme={kernelName:Eg,backendName:"cpu",kernelFunc:Ume};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hme={kernelName:Sw,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,l=Dn(r.dtype,oe(r.shape)),[u,c,d,f]=r.shape,[p,m]=Y$(o,c,d),y=255,v=Math.sin(s),x=Math.cos(s),b=a.data.get(r.dataId).values;for(let S=0;S<u;S++){const k=S*d*c*f;for(let T=0;T<c;T++){const $=T*(d*f);for(let A=0;A<d;A++){const D=A*f;for(let F=0;F<f;F++){const M=[u,T,A,F],j=M[2],H=M[1];let K=(j-p)*x-(H-m)*v,Q=(j-p)*v+(H-m)*x;K=Math.round(K+p),Q=Math.round(Q+m);let Z=i;if(typeof i!="number"&&(F===3?Z=y:Z=i[F]),K>=0&&K<d&&Q>=0&&Q<c){const B=Q*(d*f),J=K*f,Y=k+B+J+F;Z=b[Y]}const se=k+$+D+F;l[se]=Z}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kme=bt(Uh,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),qme={kernelName:Uh,backendName:"cpu",kernelFunc:Kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xme(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Vl(i,s,o),f=!0,p=n.bufferSync(s),m=n.bufferSync(i),y=Tu(p,m,o,d,u,l,a,c,0,f);return n.makeTensorInfo(o,y.dtype,y.values)}const Zme={kernelName:aw,backendName:"cpu",kernelFunc:Xme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yme(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<e?n=s+1:r=s;return r}function Qme(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<=e?n=s+1:r=s;return r}function Jme(t,e,n,r,s,i){const o=Yt("int32",n*s);for(let a=0;a<n;++a){const l=t.slice(a*r,(a+1)*r),u=a*s;for(let c=0;c<s;++c)o[u+c]=i==="left"?Yme(l,e[c+u]):Qme(l,e[c+u])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ege(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,u=Jme(a,l,s.shape[0],s.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",u)}const tge={kernelName:uw,backendName:"cpu",kernelFunc:ege};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nge(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e;Pe([r,s,i],"select");const o=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=Mr(s.dtype,i.dtype),d=Xn(oe(s.shape),c);let f=0;const p=o===0||o>1||s.shape.length===1?1:oe(s.shape.slice(1));for(let m=0;m<a.length;m++)for(let y=0;y<p;y++)a[m]===1?d[f++]=l[m]:d[f++]=u[m];return n.makeTensorInfo(s.shape,c,d)}const rge={kernelName:Ag,backendName:"cpu",kernelFunc:nge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sge=h1,ige=f1,oge=bt(Hh,t=>t>=0?ige*t:sge*(Math.exp(t)-1)),age={kernelName:Hh,backendName:"cpu",kernelFunc:oge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lge=bt(Xh,t=>t<0?-1:t>0?1:0),uge={kernelName:Xh,backendName:"cpu",kernelFunc:lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cge=bt(Kh,t=>Math.sin(t)),dge={kernelName:Kh,backendName:"cpu",kernelFunc:cge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hge=bt(qh,t=>Math.sinh(t)),fge={kernelName:qh,backendName:"cpu",kernelFunc:hge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pge=11920928955078125e-23,lR=Math.log(pge)+2,mge=bt(Yh,t=>{const e=t>-lR,n=t<lR,r=Math.exp(t);let s;return n?s=r:e?s=t:s=Math.log(1+r),s}),gge={kernelName:Yh,backendName:"cpu",kernelFunc:mge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;Pe([s],"spaceToBatchND");const a=oe(i),l=[[0,0]];l.push(...o);for(let T=1+i.length;T<s.shape.length;++T)l.push([0,0]);const u=sG.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),c=ay(u.shape,i,a,!1),d=ly(c.length,i.length,!1),f=uy(u.shape,i,a,!1),y=Et({inputs:{x:u},backend:n,attrs:{shape:c}}),b=Wr({inputs:{x:y},backend:n,attrs:{perm:d}}),k=Et({inputs:{x:b},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),k}const vge={kernelName:Dg,backendName:"cpu",kernelFunc:yge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xge(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values[0],[d,f,p,m,y]=EU(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],s.dtype,p),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(v=>Number(v)))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}const bge={kernelName:cw,backendName:"cpu",kernelFunc:xge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wge(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(s.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[u,c,d]=AU(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const _ge={kernelName:dw,backendName:"cpu",kernelFunc:wge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[u,c]=W2(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const kge={kernelName:hw,backendName:"cpu",kernelFunc:Sge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cge(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[u,c]=W2(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const Tge={kernelName:fw,backendName:"cpu",kernelFunc:Cge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nge(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=Vl(i,s,a),p=!1,m=n.bufferSync(s);let y;switch(i.dtype){case"bool":{const v=n.bufferSync(i),x=!!n.data.get(o.dataId).values[0];y=Tu(m,v,a,f,c,u,l,d,x,p);break}case"float32":{const v=n.bufferSync(i),x=n.data.get(o.dataId).values[0];y=Tu(m,v,a,f,c,u,l,d,x,p);break}case"int32":{const v=n.bufferSync(i),x=n.data.get(o.dataId).values[0];y=Tu(m,v,a,f,c,u,l,d,x,p);break}case"string":{const v=n.bufferSync(i),x=pa(n.data.get(o.dataId).values[0]);y=Tu(m,v,a,f,c,u,l,d,x,p);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,y.dtype,y.values)}const Ige={kernelName:pw,backendName:"cpu",kernelFunc:Nge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=Je(o,s.shape)[0],l=h2(s,i,a),u=new Array(s.shape.length).fill(0),c=s.shape.slice();return l.map(d=>{const f=[...c];f[a]=d;const p=ac({inputs:{x:s},backend:n,attrs:{begin:u,size:f}});return u[a]+=d,p})}const Ege={kernelName:Rg,backendName:"cpu",kernelFunc:$ge};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Age={kernelName:mw,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;Pe(n,"square");const s=r.data.get(n.dataId).values,i=new Float32Array(s.length);for(let a=0;a<s.length;++a){const l=s[a];i[a]=l*l}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge=bt(sf,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),Pge={kernelName:sf,backendName:"cpu",kernelFunc:Oge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=r;Pe(s,"stridedSlice");const{finalShapeSparse:p,finalShape:m,isIdentity:y,sliceDim0:v,isSimpleSlice:x,begin:b,end:_,strides:S}=K$(s.shape,i,o,a,l,u,c,d,f);let k;if(y)k=Et({inputs:{x:s},backend:n,attrs:{shape:m}});else if(v||x){O(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const T=U$(b,_,S),$=ac({inputs:{x:s},backend:n,attrs:{begin:b,size:T}});k=Et({inputs:{x:$},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo($)}else{const T=n.bufferSync(s),$=DU(p,T,S,b);k=n.makeTensorInfo(m,$.dtype,$.values)}return k}const Rge={kernelName:gw,backendName:"cpu",kernelFunc:Dge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lge(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,f=n.data.get(c.dataId).values,p=n.data.get(d.dataId).values,[m,y]=RU(f,p,s,i,o,a,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",y)]}const Fge={kernelName:yw,backendName:"cpu",kernelFunc:Lge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mge(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[u,c,d]=LU(a,l,s),f=c.length;return[n.makeTensorInfo([f,2],"int32",u),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const zge={kernelName:vw,backendName:"cpu",kernelFunc:Mge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bge(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=FU(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const jge={kernelName:xw,backendName:"cpu",kernelFunc:Bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vge=bt(tf,t=>Math.tan(t)),Wge={kernelName:tf,backendName:"cpu",kernelFunc:Vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uge=bt(nf,t=>Math.tanh(t)),Gge={kernelName:nf,backendName:"cpu",kernelFunc:Uge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hge(t){const{inputs:e,backend:n}=t,{tensor:r,indices:s,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=Vl(i,s,r.shape),d=!1,f=n.bufferSync(s),p=n.bufferSync(i),m=n.bufferSync(r),y=Tu(f,p,r.shape,c,l,a,o,u,m,d);return n.makeTensorInfo(r.shape,y.dtype,y.values)}const Kge={kernelName:lw,backendName:"cpu",kernelFunc:Hge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;Pe(s,"tile");const o=zU(n.bufferSync(s),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const Xge={kernelName:rf,backendName:"cpu",kernelFunc:qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r;Pe(s,"topk");const a=n.data.get(s.dataId).values,[l,u]=jU(a,s.shape,s.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const Yge={kernelName:bw,backendName:"cpu",kernelFunc:Zge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qge(t){const{inputs:e,attrs:n,backend:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=n,[c,d,f,p]=s.shape,[m,y]=u??[d,f],v=[c,m,y,p],x=ze(s.shape),b=x[0],_=x[1],S=x[2],k=ze(v),T=k[0],$=k[1],A=k[2],D=Dn(s.dtype,oe(v));D.fill(l);const F=r.data.get(s.dataId).values,M=r.data.get(i.dataId).values;for(let H=0;H<c;++H){const K=i.shape[0]===1?M:M.subarray(H*8,H*8+8);for(let Q=0;Q<m;++Q)for(let Z=0;Z<y;++Z)for(let se=0;se<p;++se){let B;const J=K[6]*Z+K[7]*Q+1;if(J===0)continue;const Y=(K[0]*Z+K[1]*Q+K[2])/J,ie=(K[3]*Z+K[4]*Q+K[5])/J,ne=uR(Y,f,a),pe=uR(ie,d,a);switch(o){case"nearest":B=sye(F,d,f,b,_,S,H,pe,ne,se,l);break;case"bilinear":B=iye(F,d,f,b,_,S,H,pe,ne,se,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const me=H*T+Q*$+Z*A+se;D[me]=B}return r.makeTensorInfo(v,s.dtype,D)}return{dataId:r.write(D,v,s.dtype),shape:s.shape,dtype:s.dtype}}const Jge={kernelName:ww,backendName:"cpu",kernelFunc:Qge};function uR(t,e,n){switch(n){case"reflect":return eye(t,e);case"wrap":return tye(t,e);case"nearest":return rye(t,e);case"constant":default:return nye(t)}}function eye(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return yl(0,n,e-1)}function tye(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return yl(0,n,e-1)}function nye(t,e){return t}function rye(t,e){return yl(0,t,e-1)}function xp(t,e,n,r,s,i,o,a,l,u,c){const d=o*r+a*s+l*i+u;return 0<=a&&a<e&&0<=l&&l<n?t[d]:c}function sye(t,e,n,r,s,i,o,a,l,u,c){const d=Math.round(a),f=Math.round(l);return xp(t,e,n,r,s,i,o,d,f,u,c)}function iye(t,e,n,r,s,i,o,a,l,u,c){const d=Math.floor(a),f=Math.floor(l),p=d+1,m=f+1,y=(m-l)*xp(t,e,n,r,s,i,o,d,f,u,c)+(l-f)*xp(t,e,n,r,s,i,o,d,m,u,c),v=(m-l)*xp(t,e,n,r,s,i,o,p,f,u,c)+(l-f)*xp(t,e,n,r,s,i,o,p,m,u,c);return(p-a)*y+(a-d)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oye(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;Pe(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:u}=VU(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const aye={kernelName:_w,backendName:"cpu",kernelFunc:oye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lye(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s.shape.length,a=s.shape[i],l=new Array(o-1);let u=0;for(let p=0;p<o;p++)p!==i&&(l[u++]=s.shape[p]);const c=new Array(o).fill(0),d=s.shape.slice();d[i]=1;const f=new Array(a);for(let p=0;p<f.length;p++){c[i]=p;const m=ac({inputs:{x:s},backend:n,attrs:{begin:c,size:d}});f[p]=Et({inputs:{x:m},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(m)}return f}const uye={kernelName:Mg,backendName:"cpu",kernelFunc:lye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r;Pe(s,"unsortedSegmentSum");const a=s.shape.length,l=i.shape.length,u=[],c=[],d=a-l;let f=i;for(let m=0;m<d;++m){const y=lx({inputs:{input:f},backend:n,attrs:{dim:m+1}});f=y,c.push(y)}for(let m=0;m<o;++m){const y=Ta(m,"int32"),v=n.makeTensorInfo([],"int32",y),x=rU({inputs:{a:v,b:f},backend:n}),b=Il({inputs:{x},backend:n,attrs:{dtype:"float32"}}),_=C1({inputs:{a:b,b:s},backend:n}),S=vy({inputs:{x:_},backend:n,attrs:{axis:0,keepDims:!1}});u.push(S),c.push(v),c.push(x),c.push(b),c.push(_),c.push(S)}const p=rG({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const dye={kernelName:zg,backendName:"cpu",kernelFunc:cye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hye=[ohe,Bce,lhe,che,Hce,hhe,phe,ghe,vhe,bhe,_he,khe,The,$he,Ahe,Dhe,Lhe,Mhe,Bhe,she,Vhe,Uhe,Hhe,qce,qhe,Uce,Zce,Zhe,jce,Qhe,efe,tfe,rfe,ife,afe,ufe,dfe,ffe,mfe,yfe,xfe,wfe,Sfe,Cfe,Tfe,Ife,Efe,Ofe,Pfe,Dfe,Rfe,Ffe,Bfe,Yde,Vfe,Yce,Zfe,Qce,Yfe,ede,rpe,spe,ope,nde,sde,lpe,cpe,hpe,ppe,ode,lde,Vce,gpe,Jhe,vpe,bpe,_pe,Qde,cde,hde,kpe,pde,Tpe,$pe,Ape,Dpe,Lpe,Mpe,zpe,gde,jpe,Wpe,Gpe,Kpe,Xpe,Ype,Jpe,vde,tme,sme,ame,bde,_de,cme,fme,gme,kde,vme,bme,wme,sG,Cme,ehe,Nde,Nme,$me,Ame,Pme,Wce,oT,Rme,the,nhe,rhe,Fme,zme,jme,Wme,Gme,Hme,qme,Rde,Zme,tge,rge,age,Fde,uge,dge,fge,Mde,ime,gge,vge,bge,_ge,kge,Tge,Ige,Ege,jde,Age,Wde,Gde,Pge,Rge,Fge,zge,jge,Xde,Mfe,Wge,Gge,Kge,Xge,Yge,Jge,Cde,aye,uye,dye,xme];for(const t of hye)kw(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xu={},Nv={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function fye(t,e){xu[t]=e}function to(t,e){if(!(t in xu)||e!=null){const r=mye(t,e);if(r!==null)xu[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=xu[t];return n==null||n.isContextLost()?(delete xu[t],to(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),xu[t])}function pye(t){if(!te().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function mye(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??pye(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete xu[t]},!1),te().getBool("SOFTWARE_WEBGL_ENABLED")&&(Nv.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Nv)||n.getContext("experimental-webgl",Nv):n.getContext("webgl2",Nv)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mm;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(mm||(mm={}));var Ns;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Ns||(Ns={}));var Gn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Gn||(Gn={}));function xy(t,e){return[e,t]}function gye(t,e){return t*e}function Iv(t){const e=oe(t),n=Math.ceil(e/4);return F0(n)}function pf(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function yye(t,e){const[n,r]=pf(t,e);return n*r*4}function q2(t,e){const n=t;let r,s,i,o,a,l,u,c,d,f;return te().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,u=4,c=1,d=n.HALF_FLOAT,f=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,f=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:f}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ne(t,e){const n=e();return te().getBool("DEBUG")&&vye(t),n}function vye(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+_ye(t,e))}const xye=596e-10,bye=65504;function wye(t){return!!(te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||xye<Math.abs(t)&&Math.abs(t)<bye)}function _ye(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function $v(t,e){return Pa(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Sye(t,e){const n=Pa(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ne(t,()=>t.shaderSource(n,e)),Ne(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function kye(t,e){const n=Pa(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ne(t,()=>t.shaderSource(n,e)),Ne(t,()=>t.compileShader(n)),te().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw iG(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Cye=/ERROR: [0-9]+:([0-9]+):/g;function iG(t,e){const n=Cye.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),i=s.length.toString().length+2,o=s.map((d,f)=>Du((f+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const l=o.slice(0,r-1),u=o.slice(r-1,r),c=o.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Du(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function Tye(t){return Pa(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function Nye(t,e){if(Ne(t,()=>t.linkProgram(e)),!te().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function US(t,e){if(Ne(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Iye(t,e){const n=Pa(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ne(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Ne(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function $ye(t,e){const n=Pa(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ne(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Ne(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Eye(t){return Pa(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function Aye(t,e){const n=te().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function Oye(t){return Pa(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function cR(t,e,n,r,s,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(Ne(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),Ne(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,i,o)),Ne(t,()=>t.enableVertexAttribArray(a)),!0)}function Pye(t,e,n){Mye(t,n),Ne(t,()=>t.activeTexture(t.TEXTURE0+n)),Ne(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Dye(t,e,n){return Pa(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Rye(t,e,n){return t.getUniformLocation(e,n)}function Lye(t,e,n,r){Ne(t,()=>Pye(t,e,r)),Ne(t,()=>t.uniform1i(n,r))}function GS(t,e,n){Ne(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Ne(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function dR(t,e){Ne(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Ne(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Ev(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Fye(t,e))}function Fye(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Pa(t,e,n){const r=Ne(t,()=>e());if(r==null)throw new Error(n);return r}function Mye(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function Xd(t,e=2){return oe(t.slice(0,t.length-e))}function Zd(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Av(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Xd(t),...Zd(t)]),e}function zye(t,e=!1){let n=te().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=te().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&te().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?yb(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Ca(t).newShape);let s=oe(t),i=null;t.length<=1&&s<=n?i=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=Xd(t);let l=2,u=2;t.length&&([l,u]=Zd(t)),s=a*(l/2)*(u/2),i=F0(s).map(c=>c*2)}else i=F0(s);return i}function Ov(t){return t%2===0}function cx(t,e){if(t=t.slice(-2),e=e.slice(-2),nt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||Ov(n)&&Ov(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Ov(t[0])&&Ov(e[0])}let HS,KS;function Bye(t){if(HS==null){const e=to(t);HS=e.getParameter(e.MAX_TEXTURE_SIZE)}return HS}function jye(t){if(KS==null){const e=to(t);KS=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,KS)}function Vye(t){if(t===0)return 0;let e;const n=to(t);return ci(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:ci(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function ci(t,e){return t.getExtension(e)!=null}function hR(t){try{if(to(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Wye(t){if(t===0)return!1;const e=to(t);if(t===1){if(!ci(e,"OES_texture_float"))return!1}else if(!ci(e,"EXT_color_buffer_float"))return!1;return lT(e)}function Uye(t){if(t===0)return!1;const e=to(t);if(t===1){if(!ci(e,"OES_texture_float")||!ci(e,"WEBGL_color_buffer_float"))return!1}else{if(ci(e,"EXT_color_buffer_float"))return lT(e);const r="EXT_color_buffer_half_float";if(ci(e,r)){const s=e.getExtension(r);return Gye(e,s)}return!1}return lT(e)}function lT(t){const e=q2(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function Gye(t,e){const n=q2(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),a}function Hye(t){return t!==2?!1:to(t).fenceSync!=null}function by(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&O(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Re=te();Re.registerFlag("HAS_WEBGL",()=>Re.getNumber("WEBGL_VERSION")>0);Re.registerFlag("WEBGL_VERSION",()=>hR(2)?2:hR(1)?1:0);Re.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Re.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Re.get("WEBGL_VERSION")===2);Re.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Re.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Re.registerFlag("WEBGL_PACK",()=>Re.getBool("HAS_WEBGL"));Re.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_PACK_CLIP",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_PACK_REDUCE",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_LAZILY_UNPACK",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_CONV_IM2COL",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Re.getBool("WEBGL_PACK"));Re.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Bye(Re.getNumber("WEBGL_VERSION")));Re.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>jye(Re.getNumber("WEBGL_VERSION")));Re.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Re.getNumber("WEBGL_VERSION");return t===0?0:Vye(t)});Re.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Re.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!mI());Re.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Wye(Re.getNumber("WEBGL_VERSION")));Re.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Re.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Re.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Re.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Uye(Re.getNumber("WEBGL_VERSION")));Re.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Hye(Re.getNumber("WEBGL_VERSION")));Re.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Re.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Re.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Re.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>mI()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Re.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Re.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Re.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Re.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Re.registerFlag("WEBGL_EXP_CONV",()=>!1);Re.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Re.getBool("IS_TEST"));Re.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Re.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Re.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Re.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Er(){let t,e,n,r,s,i,o,a,l,u;return te().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",i="outputColor",o="out vec4 outputColor;",a=te().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $c(t,e,n="index"){const r=ze(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / ${s}`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s}`:`index -= ${t[i]} * ${s}`;return`${o}; ${a};`}).join("")}function T1(t,e,n="index"){const r=ze(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function Kye(t,e){const n=t.length,r=t.map(i=>`${e}[${i}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let i=n-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function qye(t,e,n="index"){const r=t.map((i,o)=>o),s=Kye(r,e);return s.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${s[o]}`,l=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s[o]}`:`index -= ${t[o]} * ${s[o]}`;return`${a}; ${l};`}).join("")}function X2(t){const e=ze(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function Z2(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const oG=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:aG}=I4;function Xye(t,e,n){const r=[];if(t.forEach(p=>{const m=oe(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${m>1?`[${m}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){const{uniformShape:y}=Y2(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(y.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});const s=r.join(`
`),i=t.map(p=>Zye(p,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=Er(),l=Jye(a);let u,c,d=nve(a);return e.isPacked?(u=Yye(e.logicalShape,o,n.enableShapeUniforms),c=tve(a)):(u=Qye(e.logicalShape,o,n.enableShapeUniforms),c=eve(a)),n.packedInputs&&(d+=ove),[d,l,c,s,u,i,n.userCode].join(`
`)}function mf(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return vve(t,e);case 1:return bve(t,e);case 2:return _ve(t,e);case 3:return kve(t,e);case 4:return Tve(t,e);case 5:return Nve(t);case 6:return Ive(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function lG(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return yve(t);case 1:return xve(t,e);case 2:return wve(t,e);case 3:return Sve(t,e);default:return Cve(t,e)}}function Zye(t,e,n=!1,r){let s="";n?s+=lG(t,r):s+=mf(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?s+=$ve(t,e):s+=Eve(t,e)),s}function Yye(t,e,n){switch(t.length){case 0:return uG();case 1:return ave(t,e,n);case 2:return mve(t,e,n);case 3:return uve(t,e,n);default:return dve(t,e,n)}}function Qye(t,e,n){switch(t.length){case 0:return uG();case 1:return lve(t,e,n);case 2:return gve(t,e,n);case 3:return cve(t,e,n);case 4:return hve(t,e,n);case 5:return fve(t,e);case 6:return pve(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Jye(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function eve(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function tve(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function nve(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${rve}
    ${sve}
    ${ive}
  `}const rve=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,sve=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ive=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ove=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function uG(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function ave(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function lve(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function uve(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),i=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function cve(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${T1(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=$c(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function dve(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),i=s*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)o*=t[t.length-u-1],a=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function hve(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${T1(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=$c(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function fve(t,e){const n=$c(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function pve(t,e){const n=$c(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function mve(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(nt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function gve(t,e,n){return nt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Ec(t){return`offset${t}`}function yve(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Er();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function vve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,i]=t.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Ec(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function xve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,i=Er();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function bve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${gf(t)}
      }
    `;const s=t.shapeInfo.texShape,i=s[0],o=s[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Ec(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function wve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=Er();if(i!=null&&nt(n,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function _ve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(i!=null&&nt(n,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const f=i[0],p=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=Ca(n),l=o;if(l.length<n.length){const f=yf(t,l),p=["row","col"];return`
      ${mf(f,e)}
      float ${s}(int row, int col) {
        return ${s}(${vf(p,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${gf(t)}
      }
    `;const u=i[0],c=i[1],d=Ec(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function Sve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const f=n.slice(1),p=[1,2],m=yf(t,f),y=["b","row","col"];return`
        ${lG(m,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${vf(y,p)});
        }
      `}const a=Er();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=o[0],u=o[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function kve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=Ca(n),u=a;if(u.length<n.length){const y=yf(t,u),v=["row","col","depth"];return`
        ${mf(y,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${vf(v,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${gf(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],f=c[1],p=t.shapeInfo.flatOffset;if(f===i&&p==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(f===o&&p==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const m=Ec(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${m};
        vec2 uv = uvFromFlat(${d}, ${f}, index);
        return sampleTexture(${r}, uv);
      }
  `}function Cve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=Er();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],d=Math.ceil(i[o-1]/2);let f=d*Math.ceil(i[o-2]/2),p="int b, int row, int col",m=`b * ${f} + (row / 2) * ${d} + (col / 2)`;for(let y=2;y<o-1;y++)p=`int b${y}, `+p,f*=i[o-y-1],m=`b${y} * ${f} + `+m;return`
    vec4 ${r}(${p}) {
      int index = ${m};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${n}, uv);
    }
  `}function Tve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:u}=Ca(n);if(l.length<n.length){const b=yf(t,l),_=["row","col","depth","depth2"];return`
      ${mf(b,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${vf(_,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${gf(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1],m=`int stride2 = ${r}Shape[3];`,y=`int stride1 = ${r}Shape[2] * stride2;`,v=`int stride0 = ${r}Shape[1] * stride1;`;if(p===a&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${m}
        ${y}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(p===i&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;const x=Ec(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${y}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${x});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${f}, ${p}, index + ${x});
      return sampleTexture(${r}, uv);
    }
  `}function Nve(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],i=e[3]*s,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:u}=Ca(e);if(l.length<e.length){const y=yf(t,l),v=["row","col","depth","depth2","depth3"];return`
      ${mf(y)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${vf(v,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${s})) +
          depth3;
        ${gf(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1];if(p===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Ec(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${s} + depth3 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Ive(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:i}=Ca(e);if(s.length<e.length){const v=yf(t,s),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${mf(v)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${vf(x,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${gf(t)}
      }
    `;const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,p=f[0],m=f[1];if(m===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(m===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=Ec(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${y};
      vec2 uv = uvFromFlat(${p}, ${m}, index);
      return sampleTexture(${n}, uv);
    }
  `}function gf(t){const e=t.name,n=oe(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function $ve(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=aG(t.shapeInfo.logicalShape,e.logicalShape),l=kt(o),u=o-i;let c;const d=["x","y","z","w","u","v"];i===0?c="":o<2&&a.length>=1?c="coords = 0;":c=a.map(b=>`coords.${d[b+u]} = 0;`).join(`
`);let f="";o<2&&i>0?f="coords":f=t.shapeInfo.logicalShape.map((b,_)=>`coords.${d[_+u]}`).join(", ");let p="return outputValue;";const y=oe(t.shapeInfo.logicalShape)===1,x=oe(e.logicalShape)===1;if(i===1&&!y&&!x)p=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(y&&!x)o===1?p=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:p=`
        return vec4(outputValue.x);
      `;else if(a.length){const b=i-2,_=i-1;a.indexOf(b)>-1&&a.indexOf(_)>-1?p="return vec4(outputValue.x);":a.indexOf(b)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(_)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${f});
      ${p}
    }
  `}function Eve(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&nt(o,i))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=kt(l),c=aG(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let f;const p=["x","y","z","w","u","v"];a===0?f="":l<2&&c.length>=1?f="coords = 0;":f=c.map(y=>`coords.${p[y+d]} = 0;`).join(`
`);let m="";return l<2&&a>0?m="coords":m=t.shapeInfo.logicalShape.map((y,v)=>`coords.${p[v+d]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${f}
      return get${r}(${m});
    }
  `}function kt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function Y2(t,e,n){const{newShape:r,keptDims:s}=Ca(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):r,l=!t&&i>1&&!nt(e,n)&&r.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function yf(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function vf(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ave(t,e,n,r){const s=n.map((c,d)=>{const f={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(f.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:f}}),i=s.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=Xye(s,o,e),l=kye(t.gl,a),u=t.createProgram(l);return te().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o},cG(t,e,u)))}function cG(t,e,n){const r=[],s=[];let i,o,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),te().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const f={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(f.shape=t.getUniformLocation(n,`${d}Shape`,c),f.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),r.push(f)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),o=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function fR(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,i=e[r],o=i.shape;if(!nt(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!nt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Ove(t,e,n,r,s){e.program.enableShapeUniforms||(fR(e.inShapeInfos,n),fR([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),te().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:f,texShape:p}=e.variablesLocations[l];if(f){const{uniformShape:m}=Y2(e.program.packedInputs,u.shape,u.texData.texShape);switch(m.length){case 1:t.gl.uniform1iv(f,new Int32Array(m));break;case 2:t.gl.uniform2iv(f,new Int32Array(m));break;case 3:t.gl.uniform3iv(f,new Int32Array(m));break;case 4:t.gl.uniform4iv(f,new Int32Array(m));break}}if(p&&t.gl.uniform2i(p,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(oe(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let m=u.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),t.gl.uniform1fv(c,m)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=ze(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=s[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function Pve(t,e,n){let r="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=Y2(t.packedInputs,o.shape,l);let f="",p="",m="";if(c.length===1&&t.packedInputs){const k=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];f=`${k[0]>1}_${k[1]>1}`}else if(c.length===2&&!t.packedInputs)p=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const k=ze(c);m=`${k[0]===l[1]}_${k[k.length-1]===l[1]}`}const y=o.shape.length,v=c.length===2&&nt(o.shape,l),x=oe(o.shape)===1,b=ec(o.shape,n.shape),_=!t.packedInputs&&y===n.shape.length&&nt(l,n.texData.texShape),S=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${y}_${_}_${u?d:""}_${c.length}_${x}_${b}_${v}_${f}_${p}_${m}_${S}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${l}_${a}`}});const s=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+s+`${te().getNumber("WEBGL_VERSION")}`,i}function pr(t){return te().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dve{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=mm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Er();this.outputShape=e,this.enableShapeUniforms=pr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?T1(["r","c","d"],e):$c(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rve{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=mm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Er();this.outputShape=e,this.enableShapeUniforms=pr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?T1(["r","c","d"],e):$c(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lve{constructor(e){this.variableNames=["A"],this.outTexUsage=Ns.DOWNLOAD;const n=Er();this.outputShape=e,this.userCode=`
      ${oG}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fve{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ns.DOWNLOAD;const n=Er();this.outputShape=e,this.userCode=`
      ${oG}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mve={R:0,G:1,B:2,A:3};class pR{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Er();this.outputShape=e,this.enableShapeUniforms=pr(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const l=r[a];o+=`
          if(offset == ${a}) {
            result = values[${Mve[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?Z2():X2(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${o}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zve{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Er();this.outputShape=e,this.enableShapeUniforms=pr(this.outputShape.length);let s="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?Z2():X2(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bve(t){const e=Er(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Sye(t,n)}function jve(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Iye(t,e)}function Vve(t){const e=new Uint16Array([0,1,2,2,1,3]);return $ye(t,e)}function wy(t,e,n,r,s,i){Aye(e,n);const o=Eye(t),a=t.TEXTURE_2D;return Ne(t,()=>t.bindTexture(a,o)),Ne(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Ne(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Ne(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),Ne(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),te().getNumber("WEBGL_VERSION")===1?Ne(t,()=>t.texImage2D(a,0,r,e,n,0,s,i,null)):Ne(t,()=>t.texStorage2D(a,1,r,e,n)),Ne(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function dG(t){return t.internalFormatFloat}function Wve(t,e,n,r){const[s,i]=xy(e,n);return wy(t,s,i,dG(r),r.textureFormatFloat,t.FLOAT)}function hG(t){return t.internalFormatHalfFloat}function Uve(t,e,n,r){const[s,i]=xy(e,n);return wy(t,s,i,hG(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function fG(t){return t.downloadTextureFormat}function Gve(t,e,n,r){const[s,i]=xy(e,n);return wy(t,s,i,fG(r),t.RGBA,t.UNSIGNED_BYTE)}function pG(t){return t.internalFormatPackedFloat}function Hve(t,e,n,r){const[s,i]=pf(e,n);return wy(t,s,i,pG(r),t.RGBA,t.FLOAT)}function mG(t){return t.internalFormatPackedHalfFloat}function Kve(t,e,n,r){const[s,i]=pf(e,n);return wy(t,s,i,mG(r),t.RGBA,r.textureTypeHalfFloat)}function qve(t,e,n){return Ne(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),cR(t,e,"clipSpacePos",n,3,20,0)&&cR(t,e,"uv",n,2,20,12)}function Xve(t,e,n,r,s,i){Ne(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;s instanceof Uint8Array?(o=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*r*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(s),te().getNumber("WEBGL_VERSION")===2?Ne(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,o)):Ne(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,o)),Ne(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Zve(t,e,n){Ne(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?te().getNumber("WEBGL_VERSION")===2?Ne(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Ne(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):te().getNumber("WEBGL_VERSION")===2?Ne(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Ne(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Ne(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Yve(t,e,n,r){const s=t.createBuffer();Ne(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return Ne(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),Ne(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Ne(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function Qve(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function Jve(t,e,n,r){const[s,i]=xy(e,n),o=4,a=new Uint8Array(gye(e*n,o));return Ne(t,()=>t.readPixels(0,0,s,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function e0e(t,e,n,r,s,i,o,a){const l=t,u=new Float32Array(yye(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function t0e(t,e,n){const r=new Float32Array(e*n*4);return Ne(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qS{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=te().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,fye(n,e)):this.gl=to(n),e=this.gl,te().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>Ne(i,()=>i.createVertexArray()),this.bindVertexArray=o=>Ne(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>Ne(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>Ne(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ne(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>Ne(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Ne(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>Ne(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),te().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=$v(this.gl,i),ci(this.gl,o))this.textureHalfFloatExtension=$v(this.gl,o);else if(te().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ci(this.gl,s))this.colorBufferHalfFloatExtension=$v(this.gl,s);else if(te().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ci(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(ci(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=jve(this.gl),this.indexBuffer=Vve(this.gl),this.framebuffer=Oye(this.gl),this.textureConfig=q2(this.gl,this.textureHalfFloatExtension)}get debug(){return te().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ne(e,()=>e.finish()),Ne(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ne(e,()=>e.deleteFramebuffer(this.framebuffer)),Ne(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ne(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ne(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Wve(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Uve(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Gve(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Zve(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),Xve(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Kve(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Hve(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(dR(this.gl,this.framebuffer),this.outputTexture=null),Ne(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Jve(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,i,o){return e0e(this.gl,e,n,r,s,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Qve(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=Yve(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(te().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=s.clientWaitSync(i,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},n=i}else te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>t0e(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Bve(n));const r=Tye(n);Ne(n,()=>n.attachShader(r,this.vertexShader)),Ne(n,()=>n.attachShader(r,e)),Nye(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&US(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;Ne(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),qve(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ne(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&US(this.gl,this.program),Ne(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?Dye(this.gl,e,n):Rye(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Ne(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),Lye(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,i]=pf(n,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&US(this.gl,this.program),Ev(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ne(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ne(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=$v(this.gl,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await yC(()=>this.disposed||this.isQueryAvailable(e,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=n0e(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in te().platform&&(r=te().platform.setTimeoutCustom.bind(te().platform)),yC(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),GS(this.gl,e,this.framebuffer),this.debug&&Ev(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(GS(this.gl,this.outputTexture,this.framebuffer),this.debug&&Ev(this.gl)):dR(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;GS(s,e,this.framebuffer),this.debug&&Ev(s),this.outputTexture=e,Ne(s,()=>s.viewport(0,0,n,r)),Ne(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),Ne(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function n0e(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:r0e,bincountImpl:gG,bincountReduceImpl:s0e,bitwiseAndImpl:i0e,castImpl:o0e,ceilImpl:a0e,concatImpl:l0e,equalImpl:u0e,expImpl:c0e,expm1Impl:d0e,floorImpl:h0e,gatherNdImpl:f0e,gatherV2Impl:p0e,greaterImpl:m0e,greaterEqualImpl:g0e,lessImpl:y0e,lessEqualImpl:v0e,linSpaceImpl:x0e,logImpl:b0e,maxImpl:w0e,maximumImpl:_0e,minimumImpl:S0e,multiplyImpl:k0e,negImpl:C0e,notEqualImpl:T0e,prodImpl:N0e,raggedGatherImpl:I0e,raggedRangeImpl:$0e,raggedTensorToTensorImpl:E0e,rangeImpl:A0e,rsqrtImpl:O0e,scatterImpl:P0e,sigmoidImpl:D0e,simpleAbsImpl:yG,sliceImpl:R0e,sparseFillEmptyRowsImpl:L0e,sparseReshapeImpl:F0e,sparseSegmentReductionImpl:vG,sqrtImpl:M0e,staticRegexReplaceImpl:z0e,stridedSliceImpl:B0e,stringNGramsImpl:j0e,stringSplitImpl:V0e,stringToHashBucketFastImpl:W0e,subImpl:U0e,tileImpl:G0e,topKImpl:H0e,transposeImpl:Q2,uniqueImpl:K0e}=Zde;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Tr(t,e){return e===1?[t]:xG(t,e)}function q0e(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X0e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=pr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Tr("rc",this.rank),r=kt(this.rank),s=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bG{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=pr(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${Z0e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?Z2():X2(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function Z0e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?qye(["r","c","d"],"inputShape"):$c(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y0e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=gR(n,r),i=yR(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=mR(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return s===Gn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===Gn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===Gn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===Gn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===Gn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const i=gR(r,s),o=yR(n,i,s);o in this.freeTextures||(this.freeTextures[o]=[]);const a=mR(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=te().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[o],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Q0e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function mR(t,e,n,r,s){const i=J0e(e,r);let o;if(s){const[l,u]=pf(t[0],t[1]);o=l*u}else{const[l,u]=xy(t[0],t[1]);o=l*u}const a=Q0e(n,i);return o*a}function J0e(t,e){switch(t){case Gn.PACKED_2X2_FLOAT32:return pG(e);case Gn.PACKED_2X2_FLOAT16:return mG(e);case Gn.UNPACKED_FLOAT32:return dG(e);case Gn.UNPACKED_FLOAT16:return hG(e);case Gn.PACKED_4X1_UNSIGNED_BYTE:return fG(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function exe(t){return te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Gn.PACKED_2X2_FLOAT32:Gn.UNPACKED_FLOAT32:t?Gn.PACKED_2X2_FLOAT16:Gn.UNPACKED_FLOAT16}function gR(t,e){if(t===Ns.UPLOAD)return Gn.PACKED_2X2_FLOAT32;if(t===Ns.RENDER||t==null)return exe(e);if(t===Ns.DOWNLOAD||t===Ns.PIXELS)return Gn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function yR(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wo{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=pr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const ki="if (isnan(x)) return x;",txe="return x;",vR="return abs(x);",nxe="return (x >= 0.0) ? x : (exp(x) - 1.0);",rxe=ki+`
  return (x < 0.0) ? 0.0 : x;
`,sxe=ki+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ha="return x;",ixe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oxe="return x;",axe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,lxe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,uxe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cxe="return 1.0 / (1.0 + exp(-1.0 * x));";class tl{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=pr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dxe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=pr(this.outputShape.length);const n=e.length,r=Tr("rc",n),s=kt(n),i=q0e(n,r),o=r.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hxe=Jw,fxe=1e-7,pxe=1e-4,Pv={};function mxe(t){return t in Pv||(Pv[t]={}),Pv[t]}const gxe=te().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),yxe=600;function vxe(){return te().global.screen==null?1024:te().global.screen.height*te().global.screen.width*window.devicePixelRatio*yxe/1024/1024}class N1 extends gb{nextDataId(){return N1.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!te().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof qS)n=e;else{const r=to(te().getNumber("WEBGL_VERSION"),e);n=new qS(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=to(te().getNumber("WEBGL_VERSION"));n=new qS(r),this.binaryCache=mxe(te().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Y0e(this.gpgpu),this.numMBBeforeWarning=vxe(),this.texData=new iI(this,Li())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,i,o){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,i]},l.texShape=[s,i];const u=Av(n),c=new pR(u,!1,o),d=this.runWebGLProgram(c,[a],r,[[s,i]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((te().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||te().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:Ns.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,i){if(te().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:Ns.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let f;l?f=new tl(a,Ha):f=new wo(a,Ha);const p=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:s}],s),m=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),m}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=xr());let d;if(s==="complex64"){const f=this.readSync(i.real.dataId),p=this.readSync(i.imag.dataId);d=ya(f,p)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=xr()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const m=this.pendingRead.get(e);return new Promise(y=>m.push(y))}const n=this.texData.get(e),{values:r,shape:s,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let m;l?m=new tl(s,Ha):m=new wo(s,Ha);const y=this.runWebGLProgram(m,[{dataId:e,shape:s,dtype:o}],o),v=this.read(y.dataId);return this.disposeIntermediateTensorInfo(y),v}if(r!=null)return this.convertAndCacheOnCPU(e);if(te().getBool("DEBUG")&&!te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&te().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(o!=="complex64"&&te().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const m=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(m.texture.texture,...Iv(s))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const m=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),y=m[0],v=m[1];d=ya(y,v)}else if(u==null)d=this.getValuesFromTexture(e);else{const m=oe(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,m)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const m=this.gpgpu.gl;Ne(m,()=>m.deleteBuffer(u))}const f=this.convertAndCacheOnCPU(e,d),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(m=>m(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Li().removeDataId(e,this),this.pendingDeletes--),f}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:i,slice:o,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let p;l?p=new tl(i,Ha):p=new wo(i,Ha);const m=this.runWebGLProgram(p,[{dataId:e,shape:i,dtype:a}],a),y=this.readToGPU(m,n);return this.disposeIntermediateTensorInfo(m),y}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=Li().makeTensorFromTensorInfo(c),f=this.texData.get(c.dataId);return Object.assign({tensorRef:d},f.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>pa(s));return qe(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return qe(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!wye(r))throw te().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),i=oe(n);if(te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const f=this.decode(e),p=this.texData.get(f.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...Iv(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(f),m}const o=te().getBool("WEBGL_PACK")&&s===!0,a=o?Av(n):n,l=o?new Fve(a):new Lve(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=Ao(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=Ao(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=Hz(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:o[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:xr(),endMs:null}}endTimer(e){return te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=xr(),e)}async getQueryTime(e){if(te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,i,o)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=gxe){return te().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&oe(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){_s("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return hxe(e.shape,n)}packedUnaryOp(e,n,r){const s=new tl(e.shape,n),i=this.compileAndRun(s,[e],r);return Li().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=yG(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,vR,e.dtype);const n=new wo(e.shape,vR),r=this.compileAndRun(n,[e]);return Li().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&bo(r[0])){const i=r.map(o=>Co(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return Li().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new dxe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new X0e(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[Xd(e.shape),...Zd(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[Xd(n),...Zd(n)],o=new bG(i,r),a=!0,l=[r],u=this.runWebGLProgram(o,[s],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:o}=r;if(n!=null){const f=oe(i),p=n[0]*n[1]*4;O(f<=p,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Av(i);let l;s?l=new Rve(a):l=new Dve(a);const u=!0,c=[n??Iv(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,c,u,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,r,s,i=!1,o){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===mm.DENSE){const x=o??Iv(e.outputShape);l.texShape=x.map(b=>b*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),oe(a.shape)===0)return l.values=Dn(a.dtype,0),a;const u=[],c=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(x.dataId);if(b.texture==null){if(!e.packedInputs&&oe(x.shape)<=te().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:b.values};e.packedInputs&&(b.isPacked=!0,b.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!b.isPacked!=!!e.packedInputs)x=b.isPacked?this.unpackTensor(x):this.packTensor(x),u.push(x),b=this.texData.get(x.dataId);else if(b.isPacked&&!cx(b.shape,x.shape)){const _=x,S=x.shape;x.shape=b.shape,x=this.packedReshape(x,S),u.push(x),b=this.texData.get(x.dataId),_.shape=S}return{shape:x.shape,texData:b,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},f=Pve(e,c,d),p=this.getAndSaveBinary(f,()=>Ave(this.gpgpu,e,c,d)),m=this.activeTimers!=null;let y;m&&(y=this.startTimer()),te().get("ENGINE_COMPILE_ONLY")||Ove(this.gpgpu,p,c,d,s),u.forEach(x=>this.disposeIntermediateTensorInfo(x)),m&&(y=this.endTimer(y),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(y)}));const v=te().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const x=xr();x-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!te().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const x=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),x}return a}compileAndRun(e,n,r,s,i=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(te().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ee(()=>{if(!te().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=te().getBool("DEBUG");te().set("DEBUG",!1);const n=this.abs(je(1e-8)).dataSync()[0];if(te().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?fxe:pxe}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const u=this.activeTimers!=null;let c;u&&(c=xr());let d=n.texShape;if(d==null&&(d=zye(r,l),n.texShape=d),i!=null){const f=Av(r);let p,m=d[1],y=d[0];const v=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!v)&&([m,y]=pf(d[0],d[1])),l?p=new zve(f,v):p=new pR(f,v);const x=v?[y,m]:d,b=this.makeTensorInfo(x,s),_=this.texData.get(b.dataId);v?_.usage=Ns.PIXELS:_.usage=Ns.UPLOAD,_.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),m,y,i);const S=[[y,m]],T=this.runWebGLProgram(p,[b],s,S,!0),$=this.texData.get(T.dataId);n.texShape=$.texShape,n.isPacked=$.isPacked,n.usage=$.usage,te().get("ENGINE_COMPILE_ONLY")?this.disposeData(T.dataId):(n.texture=$.texture,n.values=null,this.texData.delete(T.dataId)),this.disposeIntermediateTensorInfo(b),u&&(this.uploadWaitMs+=xr()-c)}else{const f=this.acquireTexture(d,a,s,l);n.texture=f}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=xxe(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*Jp(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await q$(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(iG(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=cG(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:o,channels:a}=e,l=Li().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,n,r,i,o,a);return Li().makeTensorFromDataId(u,n,r,l)}}N1.nextDataId=0;function xxe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gI()&&vI("webgl",()=>new N1,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J2=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class lc{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=Ke(n,r),this.enableShapeUniforms=pr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ac=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class xf{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ke(n,r);const i=this.outputShape.length;this.enableShapeUniforms=pr(i);let o="";if(s)if(i===0||oe(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${kt(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Tr("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fs(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const bxe={kernelName:Eh,backendName:"webgl",kernelFunc:fs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gl(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),a=fs({inputs:{x:r},backend:n}),l=fs({inputs:{x:s},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const wxe={kernelName:Cb,backendName:"webgl",kernelFunc:Gl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wG="return (a < 0.) ? b * a : a;",_G=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function _xe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r,o=n.makeTensorInfo([],"float32",Ta(i,"float32")),a=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xf(_G,s.shape,o.shape):new lc(wG,s.shape,o.shape),l=n.runWebGLProgram(a,[s,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const Sxe={kernelName:og,backendName:"webgl",kernelFunc:_xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SG="return (a < 0.) ? b * a : a;",kG=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function kxe(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xf(kG,r.shape,s.shape):new lc(SG,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],"float32")}const Cxe={kernelName:Cg,backendName:"webgl",kernelFunc:kxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bf="if (isnan(x)) return x;";function ut({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:i})=>{const{x:o}=s,a=i,l=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),f=n(d.values,l);return a.makeTensorInfo(o.shape,l,f)}const u=te().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new tl(o.shape,e):c=new wo(o.shape,t),a.runWebGLProgram(c,[o],l)}}function er({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:u}=o,c=a;if(r&&l.dtype==="complex64"){const m=c.texData.get(l.dataId),y=c.texData.get(u.dataId),[v,x]=[[m.complexTensorInfos.real,y.complexTensorInfos.real],[m.complexTensorInfos.imag,y.complexTensorInfos.imag]].map(_=>{const[S,k]=_,T={dataId:S.dataId,dtype:S.dtype,shape:l.shape},$={dataId:k.dataId,dtype:k.dtype,shape:u.shape},A=new lc(t,l.shape,u.shape);return c.runWebGLProgram(A,[T,$],Mr(S.dtype,k.dtype))}),b=Gl({inputs:{real:v,imag:x},backend:c});return c.disposeIntermediateTensorInfo(v),c.disposeIntermediateTensorInfo(x),b}const d=i||Mr(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&s!=null){const m=c.texData.get(l.dataId).values,y=c.texData.get(u.dataId).values,v=l.dtype==="string"?va(m):m,x=l.dtype==="string"?va(y):y,[b,_]=s(l.shape,u.shape,v,x,d),S=c.makeTensorInfo(_,d),k=c.texData.get(S.dataId);return k.values=b,S}const f=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let p;return f?p=new xf(e,l.shape,u.shape,n):p=new lc(t,l.shape,u.shape),c.runWebGLProgram(p,[l,u],d)}}function gm(t,e=!1){if(t==="linear")return e?oxe:txe;if(t==="relu")return e?lxe:rxe;if(t==="elu")return e?axe:nxe;if(t==="relu6")return e?uxe:sxe;if(t==="prelu")return e?kG:SG;if(t==="leakyrelu")return e?_G:wG;if(t==="sigmoid")return e?cxe:ixe;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CG{constructor(e,n,r,s=!1,i=!1,o=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=pr(this.outputShape.length);const c=s?e[1]:e[2],d=Math.ceil(c/2),f=s?"i * 2, rc.y":"rc.y, i * 2",p=i?"rc.z, i * 2":"i * 2, rc.z",m=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],y=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",x="";a&&(l?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:v=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");const b=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let _="rc.x",S="rc.x";e[0]<n[0]?_=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(S=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${_};
        int batchB = ${S};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${f});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${m[0]} * ${y[0]});
          result += (${m[1]} * ${y[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${x}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xR={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class bR{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ke(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wR="return a * b;";function eE(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=Mr(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),u=new bR(xR.REAL,r.shape,s.shape),c=new bR(xR.IMAG,r.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],f=n.runWebGLProgram(u,d,"float32"),p=n.runWebGLProgram(c,d,"float32"),m=Gl({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[u,c]=k0e(r.shape,s.shape,a.values,l.values,i),d=n.makeTensorInfo(c,i),f=n.texData.get(d.dataId);return f.values=u,d}let o;return te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new xf(wR,r.shape,s.shape):o=new lc(wR,r.shape,s.shape),n.runWebGLProgram(o,[r,s],i)}const Txe={kernelName:zh,backendName:"webgl",kernelFunc:eE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxe(t,e,n){const r=[Xd(t.shape),...Zd(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},i=[Xd(e),...Zd(e)],o=new bG(i,r),a=!0,l=[r],u=n.runWebGLProgram(o,[s],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=n,a=oe(s.shape),l=aI(i,a),u=oe(l);O(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(s.dataId);return c.isPacked&&!cx(s.shape,l)&&!(c.texture!==null&&cx(c.shape,l))?Nxe(s,l,o):(o.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const Ixe={kernelName:Ng,backendName:"webgl",kernelFunc:Ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _R{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${qu(d)?d.toPrecision(2):d}, ones);`}let c="";i%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $xe{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let f=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";n==="all"?(a="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):n==="any"&&(a="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Exe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=d1(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function Oc(t,e,n,r){const s=Exe(t.shape);let i=t;for(let o=0;o<s.length;o++){const{inSize:a,windowSize:l,outSize:u}=s[o];let c,d;n==="mean"?c=o===0?new _R({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new _R({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new $xe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),d=i,i=r.runWebGLProgram(c,[i],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Axe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const s=kt(this.rank),i=Oxe(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function Oxe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pxe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=kt(this.rank),i=xG("rc",this.rank),o=new Array(this.rank);for(let c=0;c<n.length;c++)o[n[c]]=i[c];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I1(t,e,n){const r=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Pxe(t.shape,e):new Axe(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dxe(t,e,n,r){const s=e,i=t.shape.length,o=Je(s,t.shape);let a=o;const l=qt(a,i),u=l!=null;let c=t;u&&(c=I1(t,l,r),a=on(a.length,i)),Qn("sum",a,i);const[d,f]=Fn(c.shape,a);let p=d;n&&(p=sn(d,o));const m=oe(f),v=oe(t.shape)/m,x=Ce({inputs:{x:c},attrs:{shape:[v,m]},backend:r}),b=Cw(t.dtype),_=Oc(x,b,"sum",r),S=Ce({inputs:{x:_},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(_),u&&r.disposeIntermediateTensorInfo(c),S}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;return Dxe(s,i,o,n)}const Rxe={kernelName:Pg,backendName:"webgl",kernelFunc:$1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ir(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:i}=r,o=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[i[c]];let u;if(o.shouldExecuteOnCPU([s])){const d=o.texData.get(s.dataId).values,f=Q2(d,s.shape,s.dtype,i,l);u=o.makeTensorInfo(l,s.dtype);const p=o.texData.get(u.dataId);p.values=f}else u=I1(s,i,o);return u}const Lxe={kernelName:Ru,backendName:"webgl",kernelFunc:Ir};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TG=1e3;function dx({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],f=r?e.shape[c-1]:e.shape[c-2],p=n?t.shape[u-1]:t.shape[u-2],m=r?e.shape[c-2]:e.shape[c-1],y=t.shape.slice(0,-2),v=e.shape.slice(0,-2),x=oe(y),b=oe(v),S=Ke(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([p,m]);O(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const k=n?[x,d,p]:[x,p,d],T=r?[b,m,f]:[b,f,m],$=Ce({inputs:{x:t},backend:s,attrs:{shape:k}}),A=Ce({inputs:{x:e},backend:s,attrs:{shape:T}}),D=[$,A],F=Math.max(x,b),M=n?$.shape[1]:$.shape[2],j=i!=null,H=o!=null,K=l==="leakyrelu",Q=l!=null?gm(l,!0):null,Z=j||H||K||Q!=null;let se;if((p===1||m===1)&&M>TG&&Z===!1){let J=$,Y=A;n&&(J=Ir({inputs:{x:$},backend:s,attrs:{perm:[0,2,1]}}),D.push(J)),r&&(Y=Ir({inputs:{x:A},backend:s,attrs:{perm:[0,2,1]}}),D.push(Y));const ie=m!==1,ne=m===1;let pe=J;ie&&(pe=Ce({inputs:{x:J},backend:s,attrs:{shape:[F,M,1]}}),D.push(pe));const me=m===1?2:1;let de=Y;ne&&(de=Ce({inputs:{x:Y},backend:s,attrs:{shape:[F,1,M]}}),D.push(de));const fe=eE({inputs:{a:pe,b:de},backend:s});se=$1({inputs:{x:fe},backend:s,attrs:{axis:me,keepDims:!0}}),D.push(fe)}else{const J=Mr(t.dtype,e.dtype),Y=new CG(k,T,[F,p,m],n,r,j,Q,H,K),ie=[$,A];if(i!=null&&ie.push(i),H&&ie.push(o),K){const ne=s.makeTensorInfo([],"float32",Ta(a,"float32"));ie.push(ne),D.push(ne)}se=s.runWebGLProgram(Y,ie,J)}const B=Ce({inputs:{x:se},backend:s,attrs:{shape:S}});D.push(se);for(const J of D)s.disposeIntermediateTensorInfo(J);return B}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fxe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return dx({a:s,b:i,transposeA:l,transposeB:u,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const Mxe={kernelName:em,backendName:"webgl",kernelFunc:Fxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SR="return abs(x);";function zxe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=n.texData.get(r.dataId),o=yG(i.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let s;return te().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new tl(r.shape,SR):s=new wo(r.shape,SR),n.runWebGLProgram(s,[r],r.dtype)}const Bxe={kernelName:Mm,backendName:"webgl",kernelFunc:zxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jxe=ki+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Vxe=ut({opSnippet:jxe}),Wxe={kernelName:ch,backendName:"webgl",kernelFunc:Vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uxe=ki+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Gxe=ut({opSnippet:Uxe}),Hxe={kernelName:dh,backendName:"webgl",kernelFunc:Gxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kR="return a + b;",Kxe=er({opSnippet:kR,packedOpSnippet:kR,supportsComplex:!0,cpuKernelImpl:r0e}),qxe={kernelName:bc,backendName:"webgl",kernelFunc:Kxe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xxe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zxe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return fs({inputs:{x:r[0]},backend:n});if(r.length>te().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=d0({inputs:r.slice(0,l),backend:n}),c=d0({inputs:r.slice(l),backend:n});return d0({inputs:[u,c],backend:n})}const s=r.map(l=>l.dtype).reduce((l,u)=>Mr(l,u)),i=r.map(l=>l.shape),a=te().getBool("WEBGL_PACK")?new Zxe(r[0].shape,i):new Xxe(r[0].shape,i);return n.runWebGLProgram(a,r,s)}const Yxe={kernelName:zm,backendName:"webgl",kernelFunc:d0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=Je(i,s.shape);let u=l;const c=qt(u,a);let d=s;c!=null&&(d=Ir({inputs:{x:s},backend:n,attrs:{perm:c}}),u=on(u.length,a)),Qn("all",u,a);const[f,p]=Fn(d.shape,u),m=oe(p),y=Ce({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),v=Oc(y,y.dtype,"all",n);let x;if(o){const b=sn(f,l);x=Ce({inputs:{x:v},backend:n,attrs:{shape:b}})}else x=Ce({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),x}const Jxe={kernelName:xb,backendName:"webgl",kernelFunc:Qxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ebe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=Je(i,s.shape);let u=l;const c=qt(u,a);let d=s;c!=null&&(d=Ir({inputs:{x:s},backend:n,attrs:{perm:c}}),u=on(u.length,a)),Qn("any",u,a);const[f,p]=Fn(d.shape,u),m=oe(p),y=Ce({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),v=Oc(y,y.dtype,"any",n);let x;if(o){const b=sn(f,l);x=Ce({inputs:{x:v},backend:n,attrs:{shape:b}})}else x=Ce({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),x}const tbe={kernelName:bb,backendName:"webgl",kernelFunc:ebe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nbe{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rbe{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,O(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=kt(l),c=Tr("coords",l);let d,f;if(o===1){f=l+1;const A=kt(f);d=`
        ${A} sourceLocR = ${A}(${c.join()}, 0);
        ++${c[l-1]};
        ${A} sourceLocG = ${A}(${c.join()}, 0);
        ++${c[l-2]};
        ${A} sourceLocA = ${A}(${c.join()}, 0);
        --${c[l-1]};
        ${A} sourceLocB = ${A}(${c.join()}, 0);
        --${c[l-2]};`}else f=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const p=["x","y","z","w","u","v"].slice(0,f),m="."+p[f-1],y=p.map(A=>"int "+A),v=Tr("sourceLocR",f-1).concat("inIdx.r"),x=Tr("sourceLocG",f-1).concat("inIdx.g"),b=Tr("sourceLocB",f-1).concat("inIdx.b"),_=Tr("sourceLocA",f-1).concat("inIdx.a"),S=r==="max"?"greaterThan":"lessThan",k=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${_.join()})));`,T=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${_.join()}) : 0.)`,$=s?"":`
      float getBestIndicesAChannel(${y.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${y.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${$}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${m}, sourceLocG${m},
          sourceLocB${m}, sourceLocA${m}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${T};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${k}
          vec4 candidate = ${T};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${S}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(t,e,n,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const o=d1(i),a={windowSize:o,inSize:i,batchSize:s,outSize:Math.ceil(i/o)},l=new nbe(a,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=NG(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function IG(t,e,n,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],o=d1(i),a=new rbe(s,o,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=IG(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function $G(t,e,n,r){const s=[n];if(Qn("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!te().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[u,c]=Fn(l.shape,s),d=oe(c),f=Ce({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(f);const p=NG(t,f,r);i.push(p);const m=Ce({inputs:{x:p},backend:t,attrs:{shape:u}});return i.forEach(y=>t.disposeIntermediateTensorInfo(y)),m}return IG(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Je(i,s.shape);const a=qt(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Ir({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=on(o.length,l.shape.length)),Qn("argMax",[o[0]],l.shape.length);const c=$G(n,l,o[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const ibe={kernelName:Bm,backendName:"webgl",kernelFunc:sbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function obe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Je(i,s.shape);const a=qt(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Ir({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=on(o.length,l.shape.length)),Qn("argMin",[o[0]],l.shape.length);const c=$G(n,l,o[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const abe={kernelName:jm,backendName:"webgl",kernelFunc:obe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lbe=ki+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,ube=ut({opSnippet:lbe}),cbe={kernelName:hh,backendName:"webgl",kernelFunc:ube};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dbe=ki+"return log(x + sqrt(x * x + 1.0));",hbe=ut({opSnippet:dbe}),fbe={kernelName:fh,backendName:"webgl",kernelFunc:hbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pbe=ki+`
  return atan(x);
`,mbe=ut({opSnippet:pbe}),gbe={kernelName:ph,backendName:"webgl",kernelFunc:mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ybe=J2+`
  return atan(a, b);
`,vbe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ac+`
  return result;
`,xbe=er({opSnippet:ybe,packedOpSnippet:vbe}),bbe={kernelName:gh,backendName:"webgl",kernelFunc:xbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wbe=ki+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,_be=ut({opSnippet:wbe}),Sbe={kernelName:mh,backendName:"webgl",kernelFunc:_be};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ym{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;const y=n==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,x=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let b="0.0";if(y||(b="-1.0 / 1e-20"),r){const A=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${p}, ${m});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${A} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?v:x:`wR * ${f} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const _="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / max(count, 1.0)");const k=Math.floor(o/4)*4,T=o%4,$=`
      if (${y}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${_}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${p}, ${m});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${k}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${$}
          }

          int xC = xCCorner + ${k};
          if (${T===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${T===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${T===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${$}
          }
        }
        setOutput(${S});
      }
    `}}class tE{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,f=e.dilationWidth,p=e.effectiveFilterDepth,m=e.effectiveFilterHeight,y=e.effectiveFilterWidth,v=e.padInfo.front,x=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const _=n==="avg";let S="0.0";if(_||(S="-1.0 / 1e-20"),r){const F=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${v}, ${x}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${m};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${y};
                  wC += ${f}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${F} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${m} * ${y} +
                      wR * ${y} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const k="max";let T=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(T="avgValue / max(count, 1.0)");const $=Math.floor(o/4)*4,A=o%4,D=`
      if (${_}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${k}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${v}, ${x}, ${b});
      const float initializationValue = ${S};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${S});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$}; wC += 4) {
              int xC = xCCorner + wC * ${f};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                getValue(batch, xD, xR, xC + 3 * ${f}, ch)
              );

              ${D}
            }

            int xC = xCCorner + ${$};
            if (${A===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${A===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${A===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                initializationValue
              );

              ${D}
            }
          }
        }
        setOutput(${T});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;by(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;O(Yn(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=_i(s.shape,i,o,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&nt(c.inShape,c.outShape))return fs({inputs:{x:s},backend:n});const d=new ym(c,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const Cbe={kernelName:Vm,backendName:"webgl",kernelFunc:kbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=Na(s.shape,i,o,c,a,l,u),f=new tE(d,"avg",!1);return n.runWebGLProgram(f,[s],"float32")}const Nbe={kernelName:Wm,backendName:"webgl",kernelFunc:Tbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ibe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,f=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class $be{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,f=e.effectiveFilterHeight,p=e.effectiveFilterWidth,m=d-1-e.padInfo.front,y=f-1-e.padInfo.top,v=p-1-e.padInfo.left,x=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${m}, ${y}, ${v});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ebe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],f=Na(o.shape,a,l,d,u,c),p=new $be(f);return n.runWebGLProgram(p,[s],o.dtype)}const Abe={kernelName:_b,backendName:"webgl",kernelFunc:Ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;by([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=_i(o.shape,a,l,1,u),d=new Ibe(c);return n.runWebGLProgram(d,[s],o.dtype)}const Pbe={kernelName:wb,backendName:"webgl",kernelFunc:Obe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dbe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;return dx({a:s,b:i,transposeA:o,transposeB:a,backend:n})}const Rbe={kernelName:Um,backendName:"webgl",kernelFunc:Dbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lbe{constructor(e,n,r,s,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Ke(e,n),Ke(e,r);let a="0.0";s!=null&&(Ke(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Ke(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fbe{constructor(e,n,r,s,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ke(e,n),Ke(e,r);let a="vec4(0.0)";s!=null&&(Ke(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Ke(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mbe=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:i,offset:o,scale:a}=t;O(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,s,i];let c=null;o!=null&&(c=o.shape,u.push(o));let d=null;a!=null&&(d=a.shape,u.push(a));const f=te().getBool("WEBGL_PACK_NORMALIZATION")?new Fbe(r.shape,s.shape,i.shape,c,d,l):new Lbe(r.shape,s.shape,i.shape,c,d,l);return e.runWebGLProgram(f,u,u[0].dtype)},zbe={kernelName:rg,backendName:"webgl",kernelFunc:Mbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bbe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=kt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=jbe(this.rank);let s;const i=e.map((o,a)=>`sourceLoc.${uT[a]} = start[${a}] + coords.${uT[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const uT=["x","y","z","w","u","v"];function jbe(t){if(t===1)return"sourceLoc";if(t<=6)return uT.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vbe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=kt(this.rank),r=Tr("coords",this.rank),s=Tr("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${o};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(t,e,n,r){const s=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),o=r.texData.get(i.dataId);Object.assign(o,s),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=H$(e,ze(t.shape));s.slice&&(a+=s.slice.flatOffset),o.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),i}function wf(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r,[a,l]=c1(s,i,o);if(W$(s,a,l),oe(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),f=R0e(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,f)}const{isPacked:u}=n.texData.get(s.dataId),c=G$(s.shape,a,l);if(u||!c){const d=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Vbe(l):new Bbe(l),f=[a];return n.runWebGLProgram(d,[s],s.dtype,f)}return n.uploadToGPU(s.dataId),Wbe(s,a,l,n)}const Ube={kernelName:Og,backendName:"webgl",kernelFunc:wf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gbe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;O(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((b,_)=>b*_),l=ay(s.shape,i,a),u=ly(l.length,i.length),c=uy(s.shape,i,a),d=Q$(o,i.length),f=J$(c,o,i.length),p=[],m=Ce({inputs:{x:s},backend:n,attrs:{shape:l}}),y=Ir({inputs:{x:m},backend:n,attrs:{perm:u}}),v=Ce({inputs:{x:y},backend:n,attrs:{shape:c}}),x=wf({inputs:{x:v},backend:n,attrs:{begin:d,size:f}});return p.push(m),p.push(y),p.push(v),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),x},Hbe={kernelName:Gm,backendName:"webgl",kernelFunc:Gbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.readSync(s.dataId),l=n.readSync(i.dataId),u=gG(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const qbe={kernelName:Sb,backendName:"webgl",kernelFunc:Kbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xbe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Zbe=`
  return float(int(a.r) & int(b.r));
`;function Ybe(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=te().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||o===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(s.dataId).values,[c,d]=i0e(r.shape,s.shape,l,u,r.dtype),f=n.makeTensorInfo(d,r.dtype),p=n.texData.get(f.dataId);return p.values=c,f}let a;return i?a=new xf(Xbe,r.shape,s.shape,!1):a=new lc(Zbe,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const Qbe={kernelName:Hm,backendName:"webgl",kernelFunc:Ybe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.readSync(r.dataId),o=n.readSync(s.dataId),a=Ke(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const ewe={kernelName:kb,backendName:"webgl",kernelFunc:Jbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const twe="return float(a != b);",EG=er({opSnippet:twe,cpuKernelImpl:T0e,dtype:"bool"}),nwe={kernelName:bg,backendName:"webgl",kernelFunc:EG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _y(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return fs({inputs:{x:s.complexTensorInfos.real},backend:n})}const rwe={kernelName:sw,backendName:"webgl",kernelFunc:_y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const swe="return float(int(x));";function iwe(t,e){const n=new wo(t.shape,swe),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cT(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return fs({inputs:{x:s},backend:n});const o=fn(s.shape),a=cT({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=Gl({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const o=_y({inputs:{input:s},backend:n}),a=cT({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!lI(s.dtype,i)){const o=fs({inputs:{x:s},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId).values,[a,l,u]=o0e(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,l,u)}if(i==="int32")return iwe(s,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",Dn("bool",1)),l=EG({inputs:{a:s,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const owe={kernelName:yh,backendName:"webgl",kernelFunc:cT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CR="return ceil(x);",awe=ut({opSnippet:CR,packedOpSnippet:CR,cpuKernelImpl:a0e}),lwe={kernelName:vh,backendName:"webgl",kernelFunc:awe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uwe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cwe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:i,clipValueMax:o}=r;let a;te().getBool("WEBGL_PACK_CLIP")?a=new cwe(s.shape):a=new uwe(s.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[s],s.dtype,l)}const hwe={kernelName:xh,backendName:"webgl",kernelFunc:dwe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fwe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TR(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function pwe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),i=new fwe(r.shape),o=[TR(r,s.complexTensorInfos.real),TR(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const mwe={kernelName:Km,backendName:"webgl",kernelFunc:pwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gwe{constructor(e){this.outputShape=[],this.outputShape=No(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const s=n.length,i=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ywe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=No(e,n);const r=this.outputShape,s=r.length,i=kt(s),o=Tr("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((y,v)=>`T${v}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let y=1;y<l.length;y++)l[y]=l[y-1]+e[y][n];const u=a[n],c=a.slice(-2),d=a.join();let f=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let y=1;y<l.length;y++){const v=l[y-1];f+=`
        if (${u} < ${l[y]}  && ${u} >= ${l[y-1]}) {
          return getChannel(
            getT${y}(${Dv(a,u,v)}),
            vec2(${Dv(c,u,v)}));
        }`}const p=l.length,m=l[l.length-1];f+=`
        return getChannel(
          getT${p}(${Dv(a,u,m)}),
          vec2(${Dv(c,u,m)}));`,this.userCode=`
      float getValue(${a.map(y=>"int "+y)}) {
        ${f}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[s-1]} = ${o[s-1]} + 1;
        if (${o[s-1]} < ${r[s-1]}) {
          result.g = getValue(${o});
        }

        ${o[s-2]} = ${o[s-2]} + 1;
        if (${o[s-2]} < ${r[s-2]}) {
          result.a = getValue(${o});
        }

        ${o[s-1]} = ${o[s-1]} - 1;
        if (${o[s-2]} < ${r[s-2]} &&
            ${o[s-1]} < ${r[s-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Dv(t,e,n){const r=t.indexOf(e);return t.map((i,o)=>o===r?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E1(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return fs({inputs:{x:s.complexTensorInfos.imag},backend:n})}const vwe={kernelName:Ub,backendName:"webgl",kernelFunc:E1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bp(t,e,n){const r=t[0].dtype;if(r==="complex64"){const p=t.map(b=>_y({inputs:{input:b},backend:n})),m=t.map(b=>E1({inputs:{input:b},backend:n})),y=bp(p,e,n),v=bp(m,e,n),x=Gl({inputs:{real:y,imag:v},backend:n});return p.forEach(b=>n.disposeIntermediateTensorInfo(b)),m.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),x}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const p=t.map(S=>{const T=[-1,oe(S.shape.slice(e))];return Ce({inputs:{x:S},backend:n,attrs:{shape:T}})}),m=p.map(S=>({vals:n.readSync(S.dataId),shape:S.shape})),y=No(p.map(S=>S.shape),1),v=p[0].shape[0]===1,x=l0e(m,y,r,v),b=No(t.map(S=>S.shape),e),_=n.makeTensorInfo(b,r,x);return p.forEach(S=>n.disposeIntermediateTensorInfo(S)),_}const i=t.filter(p=>oe(p.shape)>0),o=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const p=o?new wo(t[0].shape,Ha):new tl(t[0].shape,Ha);return n.runWebGLProgram(p,t,r)}const a=te().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const p=[];for(let y=0;y<i.length;y+=a){const v=i.slice(y,y+a);p.push(bp(v,e,n))}const m=bp(p,e,n);for(const y of p)n.disposeIntermediateTensorInfo(y);return m}if(o){const p=new ywe(i.map(m=>m.shape),e);return n.runWebGLProgram(p,i,r)}const{tensors2D:l,outShape:u}=xwe(i,e,n),c=new gwe(l.map(p=>p.shape)),d=n.runWebGLProgram(c,l,r);l.forEach(p=>n.disposeIntermediateTensorInfo(p));const f=Ce({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),f}function xwe(t,e,n){const r=No(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>Ce({inputs:{x:i},attrs:{shape:[-1,oe(i.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=Je(s,e[0].shape)[0],o=e.map(u=>u.shape);X$(o,i);const a=No(e.map(u=>u.shape),i);if(oe(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>oe(u.shape)>0);return l.length===1?fs({inputs:{x:l[0]},backend:n}):bp(l,i,n)}const bwe={kernelName:qm,backendName:"webgl",kernelFunc:AG};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OG{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,p=e.filterWidth,m=Math.floor(e.inChannels/4)*4,y=e.inChannels%4,v=e.dataFormat==="channelsLast",x=v?1:2,b=v?2:3,_=v?3:1;let S="",k="";r&&(s?S=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?S=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:S=`
          float activation(float x) {
            ${r}
          }
        `,k="result = activation(result);");const T=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${S}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${_}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${m}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${y===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${m}) *
                    getW(wR, wC, ${m}, d2);
              } else {
                dotProd +=
                    getX(batch, ${m}, xR, xC) *
                    getW(wR, wC, ${m}, d2);
              }

            } else if (${y===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${y===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2),
                getW(wR, wC, ${m} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1),
                  getX(batch, xR, xC, ${m} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC),
                  getX(batch, ${m} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${T}
        ${k}
        setOutput(result);
      }
    `}}class wwe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,f=e.filterHeight,p=e.filterWidth,m=Math.floor(e.inChannels/4)*4,y=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${m}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${y===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${m}) *
                  getW(wF, wR, wC, ${m}, d2);
              } else if (${y===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${y===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1),
                  getX(batch, xF, xR, xC, ${m} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2),
                  getW(wF, wR, wC, ${m} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PG{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=pr(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let f=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<c;v++)f+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;f+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<c;v++)f+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;f+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(d+1)/2;v++){const x=v*2;if(f+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<c&&(o%2===1?(f+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?f+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:f+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):f+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<c)){const b=o%2===0?yb(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(f+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?f+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:f+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):b===1?f+=`
                     xC${x+1} = xTexelC${x};
                     `:f+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<c&&(o%2===1?(f+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<c&&(f+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(f+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<c&&(f+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<c&&(f+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<c&&(f+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}f+=`
     }
   `,f+=`
     }
   `,f+=`
     }
   `;let p="",m="";r&&(s?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:p=`vec4 activation(vec4 x) {
           ${r}
         }`,m="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${f}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${y}
         ${m}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _we{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=pr(this.outputShape.length);const{dataFormat:r}=n,s=Er(),i=r==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hx(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function DG({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],f=n.outChannels,p=n.dataFormat==="channelsLast",m=!1,y=!1;let v;const x=[];if(i!=null){const S=hx(i.shape,p);S!=null&&(i=Ce({inputs:{x:i},backend:r,attrs:{shape:S}}),x.push(i))}if(s!=null){const S=hx(s.shape,p);S!=null&&(s=Ce({inputs:{x:s},backend:r,attrs:{shape:S}}),x.push(s))}if(!((d===1||f===1)&&c>TG)&&u.isPacked&&p&&u.texture!=null&&l[2]%2!==0&&nt(u.shape.slice(-3),l.slice(-3))){const S=l[0]*l[1]*(l[2]+1),k={dataId:t.dataId,shape:[1,S,n.inChannels],dtype:t.dtype},T=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,O(cx(u.shape,k.shape),()=>`packed reshape ${u.shape} to ${k.shape} isn't free`);const $=Ce({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push($);const A=dx({a:k,b:$,backend:r,transposeA:m,transposeB:y,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),D=r.texData.get(A.dataId);O(D.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=T,D.shape=n.outShape,v=fs({inputs:{x:A},backend:r}),v.shape=n.outShape,x.push(A)}else{const S=n.outHeight*n.outWidth,k=Ce({inputs:{x:t},backend:r,attrs:{shape:p?[n.batchSize,S,n.inChannels]:[n.batchSize,n.inChannels,S]}}),T=Ce({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),$=dx({a:p?k:T,b:p?T:k,transposeA:!p,transposeB:y,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o});v=Ce({inputs:{x:$},backend:r,attrs:{shape:n.outShape}}),x.push(k),x.push(T),x.push($)}for(const S of x)r.disposeIntermediateTensorInfo(S);return v}function RG({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:f,dataFormat:p}=n,m=p==="channelsLast",y=l*u*c,v=f*d,x=[n.batchSize,y,v],b=!0,_=!1,S=[];if(i!=null){const B=hx(i.shape,m);B!=null&&(i=Ce({inputs:{x:i},backend:r,attrs:{shape:B}}),S.push(i))}if(s!=null){const B=hx(s.shape,m);B!=null&&(s=Ce({inputs:{x:s},backend:r,attrs:{shape:B}}),S.push(s))}const k=Ce({inputs:{x:e},backend:r,attrs:{shape:[1,y,oe(e.shape)/y]}});S.push(k);const T=new _we(x,n),$=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],A=r.runWebGLProgram(T,[t],"float32",$),D=Ce({inputs:{x:A},backend:r,attrs:{shape:x}});S.push(A),S.push(D);const F=s!=null,M=i!=null,j=a==="leakyrelu",H=a?gm(a,!0):null,K=new CG(m?D.shape:k.shape,m?k.shape:D.shape,m?[n.batchSize,v,n.outChannels]:[n.batchSize,n.outChannels,v],b,_,F,H,M,j),Q=m?[D,k]:[k,D];if(s&&Q.push(s),M&&Q.push(i),j){const B=r.makeTensorInfo([],"float32",Ta(o,"float32"));Q.push(B),S.push(B)}const Z=r.runWebGLProgram(K,Q,"float32"),se=Ce({inputs:{x:Z},backend:r,attrs:{shape:n.outShape}});S.push(Z);for(const B of S)r.disposeIntermediateTensorInfo(B);return se}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Swe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=Ia(l),f=Ln(s.shape,i.shape,o,u,a,c,!1,d);let p;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type==="SAME"||f.padInfo.type==="VALID"))p=DG({x:s,filter:i,convInfo:f,backend:n});else if(f.strideWidth<=2&&d==="channelsLast"&&te().getBool("WEBGL_EXP_CONV")){const y=new PG(f),v=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];p=n.runWebGLProgram(y,[s,i],"float32",v)}else if(te().getBool("WEBGL_CONV_IM2COL"))p=RG({x:s,filter:i,convInfo:f,backend:n});else{const y=new OG(f);p=n.runWebGLProgram(y,[s,i],"float32")}const m=Ce({inputs:{x:p},backend:n,attrs:{shape:f.outShape}});return n.disposeIntermediateTensorInfo(p),m}const kwe={kernelName:Xm,backendName:"webgl",kernelFunc:Swe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cwe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Twe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=o?1:2,c=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Nwe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Iwe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $we(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=Ia(l),f=Ln(s.shape,c,o,1,a,u,!1,d),p=new Cwe(f);return n.runWebGLProgram(p,[s,i],"float32")}const Ewe={kernelName:Tb,backendName:"webgl",kernelFunc:$we};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Awe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=pr(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Owe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=Ia(u),f=Ln(o,i.shape,a,1,l,c,!1,d);if(te().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const p=[[f.strideHeight,f.strideWidth]],m=new Awe(f);return n.runWebGLProgram(m,[s,i],"float32",p)}else{const p=new Twe(f);return n.runWebGLProgram(p,[s,i],"float32")}}const Pwe={kernelName:Zm,backendName:"webgl",kernelFunc:Owe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=Fl(s.shape,i.shape,o,l,a),c=new wwe(u);return n.runWebGLProgram(c,[s,i],"float32")}const Rwe={kernelName:Ym,backendName:"webgl",kernelFunc:Dwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r,u=Fl(s.shape,l,o,1,a),c=new Nwe(u);return n.runWebGLProgram(c,[s,i],"float32")}const Fwe={kernelName:Nb,backendName:"webgl",kernelFunc:Lwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r,u=Fl(l,i.shape,a,1,o),c=new Iwe(u);return n.runWebGLProgram(c,[s,i],"float32")}const zwe={kernelName:Ib,backendName:"webgl",kernelFunc:Mwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bwe=bf+`
  return cos(x);
`,jwe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Ac}
  return result;
`,Vwe=ut({opSnippet:Bwe,packedOpSnippet:jwe}),Wwe={kernelName:bh,backendName:"webgl",kernelFunc:Vwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uwe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Gwe=ut({opSnippet:Uwe}),Hwe={kernelName:wh,backendName:"webgl",kernelFunc:Gwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kwe{constructor(e,n,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,u]=e,[c]=n,[d,f]=r;this.outputShape=[c,d,f,u];const p=s==="bilinear"?1:0,[m,y]=[`${a-1}.0`,`${l-1}.0`],[v,x,b]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${m} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${m}`],[_,S,k]=f>1?[`${(l-1)/(f-1)}`,"(x2-x1) * width_ratio",`x1*${y} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${y}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${_});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${S};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${m} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${k};
        if( in_x < 0.0 || in_x > ${y} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qwe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new Kwe(s.shape,i.shape,a,l,u);return n.runWebGLProgram(c,[s,i,o],"float32")},Xwe={kernelName:Eb,backendName:"webgl",kernelFunc:qwe};var vm;(function(t){t.Prod="*",t.Sum="+"})(vm||(vm={}));class NR{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===vm.Prod?"1.0":"0.0",a=r?o:`getX(${IR(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=s?`end != ${l-1}`:"end != 0",c=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${kt(i)} coords = getOutputCoords();
        int end = ${$R(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${$R(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${IR(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function IR(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function $R(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LG(t,e,n,r,s,i){const o=e.shape.length,a=qt([r],o);let l=e;a!=null&&(l=Ir({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=on(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=fs({inputs:{x:l},backend:n});for(let f=0;f<=Math.ceil(Math.log2(c))-1;f++){const p=new NR(t,l.shape,!1,i),m=[[f]],y=d;d=n.runWebGLProgram(p,[d],d.dtype,m),n.disposeIntermediateTensorInfo(y)}if(s){const f=new NR(t,l.shape,s,i),p=d;d=n.runWebGLProgram(f,[d],d.dtype),n.disposeIntermediateTensorInfo(p)}if(a!=null){const f=Ml(a),p=Ir({inputs:{x:d},backend:n,attrs:{perm:f}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),p}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return LG(vm.Prod,s,n,i,o,a)}const Ywe={kernelName:$b,backendName:"webgl",kernelFunc:Zwe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return LG(vm.Sum,s,n,i,o,a)}const Jwe={kernelName:Qm,backendName:"webgl",kernelFunc:Qwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),u=n.readSync(i.dataId),c=gG(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(i),c=s0e(l,u,o,a);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const t1e={kernelName:Ab,backendName:"webgl",kernelFunc:e1e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n1e{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r,a=s.shape[0],l=o==="NHWC"?s.shape[1]:s.shape[2],u=o==="NHWC"?s.shape[2]:s.shape[3],c=o==="NHWC"?s.shape[3]:s.shape[1],d=l*i,f=u*i,p=c/(i*i),m=o==="NHWC"?[a,d,f,p]:[a,p,d,f],y=new n1e(m,i,o);return n.runWebGLProgram(y,[s],s.dtype)}const s1e={kernelName:Ob,backendName:"webgl",kernelFunc:r1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FG{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=pr(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MG{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=pr(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=d;let p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<d;x++)p+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;p+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let x=0;x<d;x++)p+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(f+1)/2;x++){const b=x*2;if(p+=`
          xC = xCCorner + ${b*u};
          `,l===1){if(b<d&&(a%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,u===1&&b>0?p+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<d)){const _=a%2===0?yb(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${_};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,u>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:p+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):_===1?p+=`
                    xC${b+1} = xTexelC${b};
                    `:p+=`
                    xCOffset = xC + ${_};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<d&&(a%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<d&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<d&&(p+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<d&&(p+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<d&&(p+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let m="",y="";r&&(s?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:m=`vec4 activation(vec4 x) {
          ${r}
        }`,y="result = activation(result);");const v=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${m}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),O(Yn(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const d=Ln(s.shape,i.shape,o,c,a,u,!0);let f;te().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?f=new MG(d):f=new FG(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[s,i],"float32",p)}const o1e={kernelName:Jm,backendName:"webgl",kernelFunc:i1e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a1e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class l1e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,d=Ln(s.shape,c,o,a,l,u,!0),f=new a1e(d);return n.runWebGLProgram(f,[s,i],"float32")}const c1e={kernelName:Pb,backendName:"webgl",kernelFunc:u1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d1e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,d=Ln(c,i.shape,o,a,l,u,!0),f=new l1e(d);return n.runWebGLProgram(f,[s,i],"float32")}const h1e={kernelName:Db,backendName:"webgl",kernelFunc:d1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f1e{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p1e(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],i=oe(r.shape),o=Ce({inputs:{x:r},backend:n,attrs:{shape:[i]}}),a=new f1e(i),l=n.runWebGLProgram(a,[o],o.dtype),u=Ce({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const m1e={kernelName:Rb,backendName:"webgl",kernelFunc:p1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g1e{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:f}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${f});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=Wg(s.shape,i.shape,o,a,"NHWC",l);let c;const d=new g1e(u);c=n.runWebGLProgram(d,[s,i],"float32");const f=Ce({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),f}const v1e={kernelName:eg,backendName:"webgl",kernelFunc:y1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1e(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=a2(s,i.length);u2(o.length,l,i);const{path:u,steps:c}=c2(a,l),d=c.length;let f=null,p=o.length;const m=[];for(let y=0;y<d;++y){for(const v of c[y]){const{permutationIndices:x,expandDims:b}=l2(p,l[v]);let _;d2(x)?_=i[v]:(_=Ir({inputs:{x:i[v]},backend:n,attrs:{perm:x}}),m.push(_));const S=_.shape.slice();for(let k=0;k<b.length;++k)S.splice(b[k],0,1);nt(_.shape,S)||(_=Ce({inputs:{x:_},backend:n,attrs:{shape:S}}),m.push(_)),f===null?f=_:(f=eE({inputs:{a:_,b:f},backend:n}),m.push(f))}y<d-1&&(u[y]>=0&&(f=$1({inputs:{x:f},backend:n,attrs:{axis:u[y]-(o.length-p),keepDims:!1}}),m.push(f)),p--)}for(const y of m)y!==f&&n.disposeIntermediateTensorInfo(y);return f}const b1e={kernelName:Fb,backendName:"webgl",kernelFunc:x1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1e="return (x >= 0.0) ? x : (exp(x) - 1.0);",_1e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,S1e=ut({opSnippet:w1e,packedOpSnippet:_1e}),k1e={kernelName:Sh,backendName:"webgl",kernelFunc:S1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C1e="return (b >= 0.0) ? a : a * (b + 1.0);",T1e=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,N1e=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xf(T1e,r.shape,s.shape):new lc(C1e,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],r.dtype)},I1e={kernelName:Mb,backendName:"webgl",kernelFunc:N1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $1e=`
  return vec4(equal(a, b));
`,E1e="return float(a == b);",A1e=er({opSnippet:E1e,packedOpSnippet:$1e,dtype:"bool",cpuKernelImpl:u0e}),O1e={kernelName:tg,backendName:"webgl",kernelFunc:A1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P1e=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${e2};
  float a1 = ${t2};
  float a2 = ${n2};
  float a3 = ${r2};
  float a4 = ${s2};
  float a5 = ${i2};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,D1e=ut({opSnippet:P1e}),R1e={kernelName:kh,backendName:"webgl",kernelFunc:D1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L1e=bf+`
  return exp(x);
`,F1e=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zG=ut({opSnippet:L1e,packedOpSnippet:F1e,cpuKernelImpl:c0e,dtype:"float32"}),M1e={kernelName:Ch,backendName:"webgl",kernelFunc:zG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dT(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=s;return s<0&&(O(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+s+1),a.splice(l,0,1),Ce({inputs:{x:i},backend:r,attrs:{shape:a}})}const z1e={kernelName:ng,backendName:"webgl",kernelFunc:dT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ER="return exp(x) - 1.0;",B1e=ut({opSnippet:ER,packedOpSnippet:ER,cpuKernelImpl:d0e}),j1e={kernelName:Th,backendName:"webgl",kernelFunc:B1e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AR{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BG(t,e,n){const r=n.texData.get(t.dataId),s=oe(t.shape),i=t.shape[t.shape.length-1],o=s/i,a=Ce({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,u=new AR("real",l,e),c=new AR("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],f=n.runWebGLProgram(u,d,"float32"),p=n.runWebGLProgram(c,d,"float32"),m=Gl({inputs:{real:f,imag:p},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p);const y=Ce({inputs:{x:m},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(m),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1e(t){const{inputs:e,backend:n}=t,{input:r}=e;return BG(r,!1,n)}const W1e={kernelName:zb,backendName:"webgl",kernelFunc:V1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U1e{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sy(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:i}=n;if(i=i||vc(s),i==="string"){const o=Yt(i,oe(r));return o.fill(s),e.makeTensorInfo(r,i,o)}else{const o=new U1e(r,s),a=[[s]];return e.runWebGLProgram(o,[],i,a)}}const G1e={kernelName:Bb,backendName:"webgl",kernelFunc:Sy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H1e{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K1e={kernelName:jb,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new H1e(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OR="return floor(x);",q1e=ut({opSnippet:OR,packedOpSnippet:OR,cpuKernelImpl:h0e}),X1e={kernelName:Nh,backendName:"webgl",kernelFunc:q1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z1e=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Y1e=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Q1e=er({opSnippet:Z1e,packedOpSnippet:Y1e,dtype:"int32"}),J1e={kernelName:Ih,backendName:"webgl",kernelFunc:Q1e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e_e{constructor(e){this.variableNames=["A"];const n=Er(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t_e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Er(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n_e={kernelName:V0,backendName:"webgl",kernelFunc:r_e};let Zc,XS=te().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function r_e(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],d=[u,l,i];if(a||o){const y=te().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Zc==null||y!==XS)&&(XS=y,Zc=document.createElement("canvas").getContext("2d",{willReadFrequently:XS})),Zc.canvas.width=l,Zc.canvas.height=u,Zc.drawImage(s,0,0,l,u),s=Zc.canvas}const f=n.makeTensorInfo(c,"int32");n.texData.get(f.dataId).usage=Ns.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),s);const p=te().getBool("WEBGL_PACK")?new t_e(d):new e_e(d),m=n.runWebGLProgram(p,[f],"int32");return n.disposeData(f.dataId),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:p,leakyreluAlpha:m}=r,y=Ia(c),v=Ln(s.shape,i.shape,l,d,u,f,!1,y);let x;const b=[],_=o!=null,S=a!=null,k=p==="leakyrelu",T=()=>{const A=[s,i],D=(F,M)=>{if(M==="NCHW"&&F.shape.length===1&&F.shape[0]!==1){const j=Ce({inputs:{x:F},backend:n,attrs:{shape:[F.shape[0],1,1]}});return b.push(j),j}return F};if(_&&A.push(D(o,c)),S&&A.push(D(a,c)),k){const F=n.makeTensorInfo([],"float32",Ta(m,"float32"));A.push(F),b.push(F)}return A};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))x=DG({x:s,filter:i,convInfo:v,backend:n,bias:o,activation:p,preluActivationWeights:a,leakyreluAlpha:m});else if(v.strideWidth<=2&&y==="channelsLast"&&te().getBool("WEBGL_EXP_CONV")){const A=p?gm(p,!0):null,D=new PG(v,_,A,S,k),F=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],M=T();x=n.runWebGLProgram(D,M,"float32",F)}else if(te().getBool("WEBGL_CONV_IM2COL"))x=RG({x:s,filter:i,convInfo:v,backend:n,bias:o,activation:p,preluActivationWeights:a,leakyreluAlpha:m});else{const A=p?gm(p,!1):null,D=new OG(v,_,A,S,k),F=T();x=n.runWebGLProgram(D,F,"float32")}const $=Ce({inputs:{x},backend:n,attrs:{shape:v.outShape}});return b.push(x),b.forEach(A=>n.disposeIntermediateTensorInfo(A)),$}const i_e={kernelName:tm,backendName:"webgl",kernelFunc:s_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r,m=[];let y=c;y==null&&(y=[1,1]),O(Yn(l,y),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${y}'`);const v=Ln(s.shape,i.shape,l,y,u,d,!0),x=te().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,b=f?gm(f,x):null,_=[s,i],S=o!=null,k=a!=null,T=f==="leakyrelu";if(S&&_.push(o),k&&_.push(a),T){const F=n.makeTensorInfo([],"float32",Ta(p,"float32"));_.push(F),m.push(F)}let $;x?$=new MG(v,S,b,k,T):$=new FG(v,S,b,k,T);const A=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],D=n.runWebGLProgram($,_,"float32",A);return m.forEach(F=>n.disposeIntermediateTensorInfo(F)),D}const a_e={kernelName:nm,backendName:"webgl",kernelFunc:o_e};class l_e{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=kt(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_e(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=s.shape,o=i[i.length-1],a=oe(r.shape),[l,u,c,d]=u1(r,s),f=Ce({inputs:{x:s},backend:n,attrs:{shape:[u,o]}}),p=Ce({inputs:{x:r},backend:n,attrs:{shape:[oe(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const x=n.readSync(s.dataId),b=n.bufferSync(r),_=f0e(x,b,r.dtype,u,o,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,_.values)}const m=new l_e(o,d,[u,c],r.shape),y=n.runWebGLProgram(m,[p,f],p.dtype),v=Ce({inputs:{x:y},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),v}const c_e={kernelName:Vb,backendName:"webgl",kernelFunc:u_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d_e{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=kt(this.rank),s=h_e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function h_e(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r,l=Je(o,s.shape)[0];if(te().get("DEBUG")){const b=n.readSync(i.dataId),_=s.shape[l];for(let S=0;S<b.length;++S){const k=b[S];O(k<=_-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${_-1}]`)}}const u=f2(s,i,l,a),c=oe(i.shape),d=[],f=Ce({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=Ce({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(f),d.push(p);const m=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const b=n.bufferSync(p),_=n.bufferSync(f),S=p0e(_,b,m);return d.forEach(k=>n.disposeIntermediateTensorInfo(k)),n.makeTensorInfo(u.outputShape,S.dtype,S.values)}const y=new d_e(f.shape,m),v=n.runWebGLProgram(y,[f,p],f.dtype);d.push(v);const x=Ce({inputs:{x:v},backend:n,attrs:{shape:u.outputShape}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),x}const f_e={kernelName:sg,backendName:"webgl",kernelFunc:jG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p_e="return float(a > b);",m_e=`
  return vec4(greaterThan(a, b));
`,g_e=er({opSnippet:p_e,packedOpSnippet:m_e,cpuKernelImpl:m0e,dtype:"bool"}),y_e={kernelName:ig,backendName:"webgl",kernelFunc:g_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v_e="return float(a >= b);",x_e=`
  return vec4(greaterThanEqual(a, b));
`,b_e=er({opSnippet:v_e,packedOpSnippet:x_e,dtype:"bool",cpuKernelImpl:g0e}),w_e={kernelName:$h,backendName:"webgl",kernelFunc:b_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function __e(t){const{inputs:e,backend:n}=t,{input:r}=e;return BG(r,!0,n)}const S_e={kernelName:Wb,backendName:"webgl",kernelFunc:__e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k_e="return float(!isnan(x) && !isinf(x));",C_e=ut({opSnippet:k_e,dtype:"bool"}),T_e={kernelName:Ah,backendName:"webgl",kernelFunc:C_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N_e="return float(isinf(x));",I_e=ut({opSnippet:N_e,dtype:"bool"}),$_e={kernelName:Oh,backendName:"webgl",kernelFunc:I_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E_e="return float(isnan(x));",A_e=ut({opSnippet:E_e,dtype:"bool"}),O_e={kernelName:Ph,backendName:"webgl",kernelFunc:A_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P_e="return float(a < b);",D_e=`
  return vec4(lessThan(a, b));
`,R_e=er({opSnippet:P_e,packedOpSnippet:D_e,cpuKernelImpl:y0e,dtype:"bool"}),L_e={kernelName:ag,backendName:"webgl",kernelFunc:R_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F_e="return float(a <= b);",M_e=`
  return vec4(lessThanEqual(a, b));
`,z_e=er({opSnippet:F_e,packedOpSnippet:M_e,cpuKernelImpl:v0e,dtype:"bool"}),B_e={kernelName:lg,backendName:"webgl",kernelFunc:z_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j_e(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=x0e(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const V_e={kernelName:Gb,backendName:"webgl",kernelFunc:j_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W_e=bf+`
  return x < 0.0 ? 0./0. : log(x);
`,U_e=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,G_e=ut({opSnippet:W_e,packedOpSnippet:U_e,cpuKernelImpl:b0e}),H_e={kernelName:Dh,backendName:"webgl",kernelFunc:G_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K_e=bf+`
  return log(1.0 + x);
`,q_e=ut({opSnippet:K_e}),X_e={kernelName:Rh,backendName:"webgl",kernelFunc:q_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z_e="return float(a >= 1.0 && b >= 1.0);",Y_e=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Q_e=er({opSnippet:Z_e,packedOpSnippet:Y_e,dtype:"bool"}),J_e={kernelName:ug,backendName:"webgl",kernelFunc:Q_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eSe="return float(!(x >= 1.0));",tSe=ut({opSnippet:eSe}),nSe={kernelName:cg,backendName:"webgl",kernelFunc:tSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rSe="return float(a >= 1.0 || b >= 1.0);",sSe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,iSe=er({opSnippet:rSe,packedOpSnippet:sSe,dtype:"bool"}),oSe={kernelName:dg,backendName:"webgl",kernelFunc:iSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aSe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lSe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uSe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r,u=te().getBool("WEBGL_PACK_NORMALIZATION")?new lSe(s.shape,i,o,a,l):new aSe(s.shape,i,o,a,l);return n.runWebGLProgram(u,[s],s.dtype)},cSe={kernelName:hg,backendName:"webgl",kernelFunc:uSe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dSe{constructor(e,n,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hSe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,d=new dSe(s.shape,a,l,u,c);return n.runWebGLProgram(d,[s,i,o],s.dtype)},fSe={kernelName:Hb,backendName:"webgl",kernelFunc:hSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pSe(t,e,n,r){const s=oe(e),o=oe(t.shape)/s,a=Ce({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),l=Oc(a,t.dtype,"max",r),u=Ce({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VG(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=s.shape.length,l=Je(i,s.shape);let u=l;const c=qt(u,a),d=c!=null,f=n.shouldExecuteOnCPU([s]);let p=s;if(d){if(f){const _=n.texData.get(p.dataId).values,S=new Array(a);for(let $=0;$<S.length;$++)S[$]=s.shape[c[$]];const k=Q2(_,s.shape,s.dtype,c,S);p=n.makeTensorInfo(S,s.dtype);const T=n.texData.get(p.dataId);T.values=k}else p=I1(s,c,n);u=on(u.length,a)}Qn("max",u,a);const[m,y]=Fn(p.shape,u);let v=m;o&&(v=sn(m,l));let x;if(f){const _=n.texData.get(p.dataId).values,S=w0e(_,oe(y),v,s.dtype);x=n.makeTensorInfo(v,s.dtype);const k=n.texData.get(x.dataId);k.values=S}else x=pSe(p,y,v,n);return d&&n.disposeIntermediateTensorInfo(p),x}const mSe={kernelName:fg,backendName:"webgl",kernelFunc:VG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gSe=J2+`
  return max(a, b);
`,ySe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ac+`
  return result;
`,vSe=er({opSnippet:gSe,packedOpSnippet:ySe,cpuKernelImpl:_0e}),xSe={kernelName:Lh,backendName:"webgl",kernelFunc:vSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;by(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;O(Yn(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=_i(s.shape,i,o,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&nt(c.inShape,c.outShape))return fs({inputs:{x:s},backend:n});const d=new ym(c,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const wSe={kernelName:pg,backendName:"webgl",kernelFunc:bSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Se(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Na(s.shape,i,o,c,a,u,l),f=new tE(d,"max",!1);return n.runWebGLProgram(f,[s],s.dtype)}const SSe={kernelName:mg,backendName:"webgl",kernelFunc:_Se};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kSe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class CSe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,f=u-1-e.padInfo.top,p=c-1-e.padInfo.left,m=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${f}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${m} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TSe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],f=Na(o.shape,a,l,d,u,c),p=new tE(f,"max",!0),m=n.runWebGLProgram(p,[o],o.dtype),y=new CSe(f),v=n.runWebGLProgram(y,[s,m],o.dtype);return n.disposeIntermediateTensorInfo(m),v}const NSe={kernelName:qb,backendName:"webgl",kernelFunc:TSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;by([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,f=_i(a.shape,l,u,1,c,d),p=!0,m=new ym(f,"max",p),y=n.runWebGLProgram(m,[a],a.dtype),v=new kSe(f),x=n.runWebGLProgram(v,[s,y],a.dtype);return n.disposeIntermediateTensorInfo(y),x}const $Se={kernelName:Kb,backendName:"webgl",kernelFunc:ISe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ESe(t,e,n,r){let s=new ym(n,"max",!1);const i=r.runWebGLProgram(s,[t],"float32");s=new ym(n,"max",!0,!0,e);const o=r.runWebGLProgram(s,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ASe={kernelName:Xb,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;O(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];O(Yn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=_i(r.shape,s,i,u,o),[d,f]=ESe(r,a,c,l);return[d,f]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OSe(t,e,n,r){const s=oe(e),o=oe(t.shape)/s,a=Ce({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),l=Oc(a,"float32","mean",r),u=Ce({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PSe={kernelName:gg,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:i}=e,o=n,a=r.shape.length,l=Je(i,r.shape);let u=l;const c=qt(u,a),d=c!=null,f=o.shouldExecuteOnCPU([r]),p=[];let m=r;if(d){if(f){const S=o.texData.get(m.dataId).values,k=new Array(a);for(let A=0;A<k.length;A++)k[A]=r.shape[c[A]];const T=Q2(S,r.shape,r.dtype,c,k);m=o.makeTensorInfo(k,r.dtype);const $=o.texData.get(m.dataId);$.values=T}else m=I1(r,c,o);p.push(m),u=on(u.length,a)}Qn("sum",u,a);const[y,v]=Fn(m.shape,u);let x=y;s&&(x=sn(y,l));const b=OSe(m,v,x,o);for(const _ of p)o.disposeIntermediateTensorInfo(_);return b}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=Je(i,s.shape);let u=l;const c=qt(u,a);let d=s;c!=null&&(d=Ir({inputs:{x:s},backend:n,attrs:{perm:c}}),u=on(u.length,s.shape.length)),Qn("min",u,a);const[f,p]=Fn(d.shape,u),m=oe(p),y=Ce({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),v=Oc(y,y.dtype,"min",n);let x;if(o){const b=sn(f,l);x=Ce({inputs:{x:v},backend:n,attrs:{shape:b}})}else x=Ce({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),x}const RSe={kernelName:yg,backendName:"webgl",kernelFunc:DSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LSe=J2+`
  return min(a, b);
`,FSe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ac+`
  return result;
`,MSe=er({opSnippet:LSe,packedOpSnippet:FSe,cpuKernelImpl:S0e}),zSe={kernelName:Fh,backendName:"webgl",kernelFunc:MSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BSe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const s=e.length,i=kt(s),o=n.map(c=>c[0]).join(","),a=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jSe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((m,y)=>m[0]+e[y]+m[1]);const s=e.length,i=kt(s),o=n.map(m=>m[0]).join(","),a=n.map((m,y)=>m[0]+e[y]).join(","),l=Tr("rc",s),u=Tr("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,f=r==="reflect"?0:1;let p="";if(s===1){const m=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${f};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${f};
        }
        source -= start;
      `;p=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const m=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${f}) +
                gte * ((end - 1) * 2 - source + ${f});
        source -= start;
      `;p=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${m}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[s-1]} += 1;
          if(${c}) {
            ${m}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VSe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:i}=n,o=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jSe(r.shape,s,i):new BSe(r.shape,s,i);return e.runWebGLProgram(o,[r],r.dtype)},WSe={kernelName:vg,backendName:"webgl",kernelFunc:VSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const USe=`if (b == 0.0) return NAN;
  return mod(a, b);`,GSe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Ac+`
  return result;
`,HSe=er({opSnippet:USe,packedOpSnippet:GSe}),KSe={kernelName:Mh,backendName:"webgl",kernelFunc:HSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qSe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XSe=`
if (a == b) {
  return 1.0;
};
return a / b;`,ZSe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,WG=er({opSnippet:XSe,packedOpSnippet:ZSe,checkOutOfBounds:!0}),YSe={kernelName:_h,backendName:"webgl",kernelFunc:WG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PR="return a - b;",UG=er({opSnippet:PR,packedOpSnippet:PR,supportsComplex:!0,cpuKernelImpl:U0e}),QSe={kernelName:ef,backendName:"webgl",kernelFunc:UG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=Je([i],s.shape),a=VG({inputs:{x:s},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=sn(a.shape,o),u=Ce({inputs:{x:a},backend:n,attrs:{shape:l}}),c=UG({inputs:{a:s,b:u},backend:n}),d=zG({inputs:{x:c},backend:n}),f=$1({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),p=Ce({inputs:{x:f},backend:n,attrs:{shape:l}}),m=WG({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}const JSe={kernelName:Lg,backendName:"webgl",kernelFunc:GG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eke(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r,l=a?s:GG({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new qSe(u,c,i),f=[[o]],p=n.runWebGLProgram(d,[l],"int32",f);return a||n.disposeIntermediateTensorInfo(l),p}const tke={kernelName:Zb,backendName:"webgl",kernelFunc:eke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nke=ki+`
  return -x;
`,rke=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function ske(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId),[o,a]=C0e(i.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}let s;return te().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new tl(r.shape,rke):s=new wo(r.shape,nke),n.runWebGLProgram(s,[r],r.dtype)}const ike={kernelName:xg,backendName:"webgl",kernelFunc:ske};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oke=i1;function ake(t){_s("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(i.dataId),{selectedIndices:d}=oke(u,c,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const lke={kernelName:Yb,backendName:"webgl",kernelFunc:ake};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uke=o1;function cke(t){_s("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),d=n.readSync(i.dataId),{selectedIndices:f,validOutputs:p}=uke(c,d,o,a,l,u);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const dke={kernelName:Qb,backendName:"webgl",kernelFunc:cke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hke=a1;function fke(t){_s("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(i.dataId),f=o,p=a,m=l,y=u,{selectedIndices:v,selectedScores:x}=hke(c,d,f,p,m,y);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const pke={kernelName:Jb,backendName:"webgl",kernelFunc:fke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mke{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gke=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r,u=oe(s.shape),c=new mke(u,o,a,l),d=Ce({inputs:{x:s},backend:n,attrs:{shape:[u]}}),f=n.runWebGLProgram(c,[d],i);n.disposeIntermediateTensorInfo(d);const p=[...s.shape,o],m=Ce({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(f),m},yke={kernelName:_g,backendName:"webgl",kernelFunc:gke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fx(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=_y({inputs:{input:r},backend:n}),i=fx({inputs:{x:s},backend:n}),o=E1({inputs:{input:r},backend:n}),a=fx({inputs:{x:o},backend:n}),l=Gl({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Sy({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const vke={kernelName:Bg,backendName:"webgl",kernelFunc:fx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=_y({inputs:{input:r},backend:n}),i=HG({inputs:{x:s},backend:n}),o=E1({inputs:{input:r},backend:n}),a=fx({inputs:{x:o},backend:n}),l=Gl({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Sy({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const xke={kernelName:wg,backendName:"webgl",kernelFunc:HG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bke(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return dT({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{Zn(i,c.shape,"All tensors passed to stack must have matching shapes"),O(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=dT({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=AG({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const wke={kernelName:Sg,backendName:"webgl",kernelFunc:bke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ke{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const s=e.length,i=kt(s),o=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ske{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((y,v)=>y[0]+e[v]+y[1]);const s=e.length,i=kt(s),o=n.map(y=>y[0]).join(","),a=n.map((y,v)=>y[0]+e[v]).join(","),l=Tr("rc",s),u=Tr("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,f=[`${i} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${c}) {`],p=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let m="";for(let y=0,v=s===1?2:4;y<v;y++)m+=`
        ${f[y]}
        if (${p}) {
          result[${y}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${y}] = getChannel(getX(${u.join()}), ${d});
        }
      `;m+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KG=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;if(oe(s.shape)===0){const u=i.map((c,d)=>c[0]+s.shape[d]+c[1]);return Sy({backend:n,attrs:{shape:u,value:o,dtype:s.dtype}})}const a=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ske(s.shape,i,o):new _ke(s.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[s],s.dtype,l)},kke={kernelName:kg,backendName:"webgl",kernelFunc:KG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cke=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Tke=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Ac+`
  return result;
`,Nke=er({opSnippet:Cke,packedOpSnippet:Tke}),Ike={kernelName:Bh,backendName:"webgl",kernelFunc:Nke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=[],u=Je(i,s.shape);let c=u;const d=qt(c,a);let f=s;d!=null&&(f=Ir({inputs:{x:s},backend:n,attrs:{perm:d}}),c=on(c.length,a),l.push(f)),Qn("prod",c,a);let p;if(n.shouldExecuteOnCPU([f])){const m=n.texData.get(f.dataId).values,{outVals:y,outShape:v,outDtype:x}=N0e(f.shape,f.dtype,m,c);p=n.makeTensorInfo(v,x,y)}else{const[m,y]=Fn(f.shape,c),v=oe(y),x=Ce({inputs:{x:f},backend:n,attrs:{shape:[-1,v]}}),b=Cw(s.dtype),_=Oc(x,b,"prod",n);p=Ce({inputs:{x:_},backend:n,attrs:{shape:m}}),l.push(x),l.push(_)}if(o){l.push(p);const m=sn(p.shape,u);p=Ce({inputs:{x:p},backend:n,attrs:{shape:m}})}return l.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Eke={kernelName:Tg,backendName:"webgl",kernelFunc:$ke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ake(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,l=s.map(x=>n.readSync(x.dataId)),u=s.map(x=>x.shape),c=n.readSync(i.dataId),d=n.readSync(o.dataId),[f,p,m]=I0e(l,u,c,i.shape,i.dtype,d,o.shape,a),y=f.map(x=>n.makeTensorInfo([x.length],"int32",x)),v=n.makeTensorInfo(m,i.dtype,p);return y.concat([v])}const Oke={kernelName:ew,backendName:"webgl",kernelFunc:Ake};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pke(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[u,c]=$0e(o,r.shape,r.dtype,a,s.shape,l,i.shape),d=n.makeTensorInfo([u.length],"int32",u),f=n.makeTensorInfo([c.length],r.dtype,c);return[d,f]}const Dke={kernelName:tw,backendName:"webgl",kernelFunc:Pke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rke(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.readSync(s.dataId),c=n.readSync(i.dataId),d=n.readSync(o.dataId),f=a.map(v=>n.readSync(v.dataId)),p=a.map(v=>v.shape),[m,y]=E0e(u,s.shape,c,i.shape,i.dtype,d,o.shape,f,p,l);return n.makeTensorInfo(m,i.dtype,y)}const Lke={kernelName:nw,backendName:"webgl",kernelFunc:Rke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qG=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:i,dtype:o}=n,a=A0e(r,s,i,o);return e.makeTensorInfo([a.length],o,a)},Fke={kernelName:rw,backendName:"webgl",kernelFunc:qG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mke="return 1.0 / x;",zke=ut({opSnippet:Mke}),Bke={kernelName:jh,backendName:"webgl",kernelFunc:zke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jke=ki+`
  return (x < 0.0) ? 0.0 : x;
`,Vke=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Wke=ut({opSnippet:jke,packedOpSnippet:Vke}),Uke={kernelName:Vh,backendName:"webgl",kernelFunc:Wke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gke=ki+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Hke=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Kke=ut({opSnippet:Gke,packedOpSnippet:Hke}),qke={kernelName:Wh,backendName:"webgl",kernelFunc:Kke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xke{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let f;i?f="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zke{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let f;i?f="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yke(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,c=te().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Zke(s.shape,l,u,i,o):new Xke(s.shape,l,u,i,o);return n.runWebGLProgram(c,[s],"float32")}const Qke={kernelName:$g,backendName:"webgl",kernelFunc:Yke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jke{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],f=1/c,p=1/d,m=Math.ceil(f)*2+2,y=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${p});

        const int winHeight = int(${m});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eCe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new Jke(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const tCe={kernelName:ow,backendName:"webgl",kernelFunc:eCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nCe{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],f=s?"0.5":"0.0";let p;i?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rCe{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],f=s?"0.5":"0.0";let p;i?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sCe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,c=te().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new rCe(s.shape,l,u,i,o):new nCe(s.shape,l,u,i,o);return n.runWebGLProgram(c,[s],s.dtype)}const iCe={kernelName:Ig,backendName:"webgl",kernelFunc:sCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oCe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],f=1/c,p=1/d,m=Math.ceil(f)*2+2,y=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${p});

        const int winHeight = int(${m});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aCe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new oCe(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const lCe={kernelName:iw,backendName:"webgl",kernelFunc:aCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uCe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>s(l)).join(","),o=kt(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cCe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=Tr("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=kt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${i}){
            result.g = ${u(s.slice())};
          }
          if(${o}) {
            result.b = ${c(s.slice())};
            if(${i}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(m){return f(m)}function u(m){return m[r-1]="("+m[r-1]+" + 1)",f(m)}function c(m){return m[r-2]="("+m[r-2]+" + 1)",f(m)}function d(m){return m[r-1]="("+m[r-1]+" + 1)",m[r-2]="("+m[r-2]+" + 1)",f(m)}function f(m){const y=e.map((b,_)=>p(_,m)),v=y.join(","),x=y.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${x}))`}function p(m,y){return n.indexOf(m)!==-1&&e[m]!==1?`${e[m]} - ${y[m]} - 1`:`${y[m]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r,o=s.shape.length,a=Je(i,s.shape);if(o===0)return fs({inputs:{x:s},backend:n});const l=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cCe(s.shape,a):new uCe(s.shape,a);return n.runWebGLProgram(l,[s],s.dtype)}const hCe={kernelName:Eg,backendName:"webgl",kernelFunc:dCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fCe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pCe={kernelName:Sw,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,l=new fCe(r.shape,i),[u,c]=Y$(o,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mCe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,gCe=ut({opSnippet:mCe}),yCe={kernelName:Uh,backendName:"webgl",kernelFunc:gCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vCe="return inversesqrt(x);",xCe=ut({opSnippet:vCe,cpuKernelImpl:O0e}),bCe={kernelName:Gh,backendName:"webgl",kernelFunc:xCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nE{constructor(e,n,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=kt(i.length),c=kt(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let p="";s===1?p="i":s===2&&(p="i, coords[1]");const m=`getUpdates(${p})`;let y="";l&&(y="coords[0], coords[1]");const v=`getDefaultValue(${y})`,x=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${m};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wCe{constructor(e,n,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=kt(i.length),c=kt(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let p="";s===1?p="i":s===2&&(p="i, coords[1]");const m=`getUpdates(${p})`;let y="";l&&(y="coords[0], coords[1]");const v=`getDefaultValue(${y})`,x=n>1?"strides[j]":"strides",b=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${f});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${b};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${m};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ce(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Vl(i,s,o),f=[d/u,u];if(d===0)return n.makeTensorInfo(o,s.dtype);const p=Ce({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),m=Ce({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),y=n.makeTensorInfo([],"float32",new Float32Array([0]));let v;te().getBool("WEBGL_PACK")?v=new wCe(l,a,p.shape.length,m.shape.length,c,f):v=new nE(l,a,p.shape.length,m.shape.length,c,f);const x=n.runWebGLProgram(v,[m,p,y],m.dtype),b=Ce({inputs:{x},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),b}const SCe={kernelName:aw,backendName:"webgl",kernelFunc:_Ce};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kCe{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=te().getNumber("WEBGL_VERSION")===2?i:o,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CCe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=new kCe(s.shape[0],s.shape[1],i.shape[1],o),l=[[s.shape[1]]];return n.runWebGLProgram(a,[s,i],"int32",l)}const TCe={kernelName:uw,backendName:"webgl",kernelFunc:CCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NCe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);s=l.join(),i=u.join()}const o=kt(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ICe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e,o=new NCe(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(o,[r,s,i],Mr(s.dtype,i.dtype))}const $Ce={kernelName:Ag,backendName:"webgl",kernelFunc:ICe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ECe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${h1};
  float scale = ${f1};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,ACe=ut({opSnippet:ECe}),OCe={kernelName:Hh,backendName:"webgl",kernelFunc:ACe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PCe=bf+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,DCe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,RCe=ut({opSnippet:PCe,packedOpSnippet:DCe,cpuKernelImpl:D0e}),LCe={kernelName:Zh,backendName:"webgl",kernelFunc:RCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FCe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,MCe=ut({opSnippet:FCe}),zCe={kernelName:Xh,backendName:"webgl",kernelFunc:MCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BCe=bf+`
  return sin(x);
`,jCe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Ac}
  return result;
`,VCe=ut({opSnippet:BCe,packedOpSnippet:jCe}),WCe={kernelName:Kh,backendName:"webgl",kernelFunc:VCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UCe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,GCe=ut({opSnippet:UCe}),HCe={kernelName:qh,backendName:"webgl",kernelFunc:GCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KCe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,qCe=ut({opSnippet:KCe}),XCe={kernelName:Yh,backendName:"webgl",kernelFunc:qCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZCe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;O(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,b)=>x*b),l=[[0,0]];l.push(...o);for(let x=1+i.length;x<s.shape.length;++x)l.push([0,0]);const u=[],c=KG({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=ay(c.shape,i,a,!1),f=ly(d.length,i.length,!1),p=uy(c.shape,i,a,!1),m=Ce({inputs:{x:c},backend:n,attrs:{shape:d}}),y=Ir({inputs:{x:m},backend:n,attrs:{perm:f}}),v=Ce({inputs:{x:y},backend:n,attrs:{shape:p}});return u.push(c),u.push(m),u.push(y),u.forEach(x=>n.disposeIntermediateTensorInfo(x)),v},YCe={kernelName:Dg,backendName:"webgl",kernelFunc:ZCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QCe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(r.dataId),l=n.readSync(s.dataId),u=n.readSync(i.dataId),c=n.readSync(o.dataId)[0],[d,f,p,m,y]=L0e(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],s.dtype,p),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(v=>Number(v)))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}const JCe={kernelName:cw,backendName:"webgl",kernelFunc:QCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eTe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[u,c,d]=F0e(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const tTe={kernelName:dw,backendName:"webgl",kernelFunc:eTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nTe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[u,c]=vG(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const rTe={kernelName:hw,backendName:"webgl",kernelFunc:nTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sTe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[u,c]=vG(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const iTe={kernelName:fw,backendName:"webgl",kernelFunc:sTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oTe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=Vl(i,s,a),p=!1;if(i.dtype==="string"){const x=n.bufferSync(s),b=n.bufferSync(i),_=pa(n.readSync(o.dataId)[0]),S=P0e(x,b,a,f,c,u,l,d,_,p);return n.makeTensorInfo(a,S.dtype,S.values)}const m=new nE(u,l,s.shape.length,i.shape.length,d,[f,1],p),y=n.runWebGLProgram(m,[i,s,o],i.dtype),v=Ce({inputs:{x:y},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(y),v}const aTe={kernelName:pw,backendName:"webgl",kernelFunc:oTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lTe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=Je(o,s.shape)[0],l=h2(s,i,a),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(f=>{const p=[...d];p[a]=f;const m=wf({inputs:{x:s},backend:n,attrs:{begin:c,size:p}});return c[a]+=f,m})}const uTe={kernelName:Rg,backendName:"webgl",kernelFunc:lTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DR="return sqrt(x);",cTe=ut({opSnippet:DR,packedOpSnippet:DR,cpuKernelImpl:M0e}),dTe={kernelName:Qh,backendName:"webgl",kernelFunc:cTe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hTe="return x * x;",fTe=ut({opSnippet:hTe}),pTe={kernelName:mw,backendName:"webgl",kernelFunc:fTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RR="return (a - b) * (a - b);",mTe=er({opSnippet:RR,packedOpSnippet:RR}),gTe={kernelName:Jh,backendName:"webgl",kernelFunc:mTe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yTe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(s.dataId),o=va(i),a=z0e(o,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const vTe={kernelName:Fg,backendName:"webgl",kernelFunc:yTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xTe({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=ki+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new wo(r.shape,s);return n.runWebGLProgram(i,[r],r.dtype)}const bTe={kernelName:sf,backendName:"webgl",kernelFunc:xTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wTe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=kt(r.length),o=kt(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Te(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=r,{finalShapeSparse:p,finalShape:m,isIdentity:y,sliceDim0:v,isSimpleSlice:x,begin:b,end:_,strides:S}=K$(s.shape,i,o,a,l,u,c,d,f);let k;if(y)k=Ce({inputs:{x:s},backend:n,attrs:{shape:m}});else if(v||x){O(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const $=U$(b,_,S),A=wf({inputs:{x:s},backend:n,attrs:{begin:b,size:$}});k=Ce({inputs:{x:A},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(A)}else if(n.shouldExecuteOnCPU([s])){const A=n.readSync(s.dataId),D=qe(s.shape,s.dtype,A),F=B0e(p,D,S,b);k=n.makeTensorInfo(m,s.dtype,F.values)}else{const A=new wTe(b,S,p);k=n.runWebGLProgram(A,[s],s.dtype)}const T=Ce({inputs:{x:k},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(k),T}const STe={kernelName:gw,backendName:"webgl",kernelFunc:_Te};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kTe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,f=n.readSync(c.dataId),p=n.readSync(d.dataId),[m,y]=j0e(f,p,s,i,o,a,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",y)]}const CTe={kernelName:yw,backendName:"webgl",kernelFunc:kTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TTe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[u,c,d]=V0e(a,l,s),f=c.length;return[n.makeTensorInfo([f,2],"int32",u),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const NTe={kernelName:vw,backendName:"webgl",kernelFunc:TTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ITe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=W0e(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const $Te={kernelName:xw,backendName:"webgl",kernelFunc:ITe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ETe="return tan(x);",ATe=ut({opSnippet:ETe}),OTe={kernelName:tf,backendName:"webgl",kernelFunc:ATe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PTe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,DTe=ut({opSnippet:PTe}),RTe={kernelName:nf,backendName:"webgl",kernelFunc:DTe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LTe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Vl(o,i,s.shape),f=[d/u,u];if(d===0)return n.makeTensorInfo(s.shape,i.dtype);const p=Ce({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),m=Ce({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),y=Ce({inputs:{x:s},backend:n,attrs:{shape:f}}),v=new nE(l,a,p.shape.length,m.shape.length,c,f,!1,!0),x=n.runWebGLProgram(v,[m,p,y],y.dtype),b=Ce({inputs:{x},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),b}const FTe={kernelName:lw,backendName:"webgl",kernelFunc:LTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MTe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const s=kt(this.rank),i=zTe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function zTe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XG(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(f=>pa(f)):l,c=qe(s.shape,s.dtype,u),d=G0e(c,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new MTe(s.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}const BTe={kernelName:rf,backendName:"webgl",kernelFunc:XG};class jTe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class VTe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ou(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function LR(t){let e=1;for(;e<t;)e*=2;return e}function WTe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r,a=te().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=te().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([s])||c<a||i>l){const F=n.readSync(s.dataId),[M,j]=H0e(F,u,s.dtype,i,o);return[n.makeTensorInfo(M.shape,M.dtype,M.values),n.makeTensorInfo(j.shape,j.dtype,j.values)]}if(i===0)return u[u.length-1]=0,[n.makeTensorInfo(u,s.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[s,Sy({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),f=d!==null&&d.isPacked,p=f?n.unpackTensor(s):s,y=oe(u)/c,v=Ce({inputs:{x:p},attrs:{shape:[y,c]},backend:n});f&&ou(n,p);const x=LR(i),b=LR(c);let _=null;const S=()=>_===null?[v,v]:[v,_],k=(F,M,j)=>{const H=S(),K=new jTe(j),Z=[[c],[_===null?1:0],[Number.NEGATIVE_INFINITY],[F],[M]],se=_;_=n.runWebGLProgram(K,H,"int32",Z),ou(n,se)};for(let F=1;F<x;F*=2){const M=F*2;for(let j=F;j>=1;j/=2)k(M,j,[y,b])}for(let F=b;F>x;F/=2){const M=S(),j=new VTe([y,F/2]),K=[[c],[_===null?1:0],[x]],Q=_;_=n.runWebGLProgram(j,M,"int32",K),ou(n,Q);const Z=x/2,se=Z*2;for(let B=Z;B>=1;B/=2)k(se,B,_.shape)}let T=_;_=wf({inputs:{x:_},backend:n,attrs:{begin:0,size:[y,i]}}),ou(n,T);let $=jG({inputs:{x:v,indices:_},backend:n,attrs:{axis:1,batchDims:1}});ou(n,v);const A=u.slice(0,-1);A.push(i),T=_,_=Ce({inputs:{x:_},attrs:{shape:A},backend:n}),ou(n,T);const D=$;return $=Ce({inputs:{x:$},attrs:{shape:A},backend:n}),ou(n,D),[$,_]}const UTe={kernelName:bw,backendName:"webgl",kernelFunc:WTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GTe{constructor(e,n,r,s,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HTe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=r,[c,d,f,p]=s.shape,[m,y]=u??[d,f],v=[c,m,y,p],x=new GTe(d,f,o,a,l,v);return n.runWebGLProgram(x,[s,i],"float32")}const KTe={kernelName:ww,backendName:"webgl",kernelFunc:HTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qTe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;by(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:a,outputShape:l,indices:u}=K0e(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const XTe={kernelName:_w,backendName:"webgl",kernelFunc:qTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZTe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s,a=o.shape.length,l=s.shape[i],u=new Array(a-1);let c=0;for(let y=0;y<a;y++)y!==i&&(u[c++]=o.shape[y]);const d=[],f=new Array(a).fill(0),p=o.shape.slice();p[i]=1;const m=new Array(l);for(let y=0;y<m.length;y++){f[i]=y;const v=wf({inputs:{x:o},backend:n,attrs:{begin:f,size:p}}),x=Ce({inputs:{x:v},backend:n,attrs:{shape:u}});m[y]=x,d.push(v)}return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),m}const YTe={kernelName:Mg,backendName:"webgl",kernelFunc:ZTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QTe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/r);this.outputShape=[s,a];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,f=`
        sumValue += dot(values, segFilter);
    `;let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${m}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${f}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${f}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JTe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r,a=s.shape.length,l=[];let u=0;const c=qt([u],a);let d=s;c!=null&&(d=Ir({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=on(1,a)[0]);const f=T4(d.shape,u,o),p=oe([d.shape[u]]),m=Ce({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});l.push(m);const y=Cw(s.dtype),v=(S,k,T,$,A)=>{const D=S.shape[0],F=S.shape[1],M=C4(F,A),j={windowSize:M,inSize:F,batchSize:D,numSegments:A},H=new QTe(j,k),K=n.compileAndRun(H,[S,T],$);if(l.push(K),K.shape[1]===A)return K;const Q=qG({backend:n,attrs:{start:0,stop:A,step:1,dtype:"float32"}}),Z=XG({inputs:{x:Q},backend:n,attrs:{reps:[F/M]}});return l.push(Q),l.push(Z),v(K,k,Z,$,A)},x=v(m,"unsortedSegmentSum",i,y,o),b=Ce({inputs:{x},backend:n,attrs:{shape:f}});let _=b;if(c!=null){l.push(b);const S=Ml(c);_=Ir({inputs:{x:_},backend:n,attrs:{perm:S}})}return l.forEach(S=>n.disposeIntermediateTensorInfo(S)),_}const eNe={kernelName:zg,backendName:"webgl",kernelFunc:JTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tNe=[Mxe,Bxe,Wxe,Hxe,qxe,Yxe,Jxe,tbe,ibe,abe,cbe,fbe,gbe,bbe,Sbe,Cbe,Nbe,Abe,Pbe,Rbe,zbe,Hbe,qbe,Qbe,ewe,owe,lwe,hwe,wxe,mwe,bwe,kwe,Ewe,Pwe,Rwe,Fwe,zwe,Wwe,Hwe,Xwe,Ywe,Jwe,t1e,s1e,o1e,c1e,h1e,m1e,v1e,b1e,k1e,I1e,O1e,R1e,M1e,z1e,j1e,W1e,G1e,K1e,X1e,J1e,n_e,i_e,a_e,c_e,f_e,y_e,w_e,bxe,S_e,vwe,T_e,$_e,O_e,Sxe,L_e,B_e,V_e,H_e,X_e,J_e,nSe,oSe,cSe,fSe,mSe,xSe,wSe,SSe,NSe,$Se,ASe,PSe,RSe,zSe,WSe,KSe,tke,Txe,ike,lke,dke,pke,nwe,yke,xke,wke,kke,Ike,Cxe,Eke,Oke,Dke,Lke,Fke,rwe,YSe,Bke,Uke,qke,Ixe,Qke,tCe,iCe,lCe,hCe,pCe,yCe,bCe,SCe,TCe,$Ce,OCe,LCe,zCe,WCe,HCe,Ube,JSe,XCe,YCe,JCe,tTe,rTe,iTe,aTe,uTe,dTe,pTe,gTe,vTe,bTe,STe,CTe,NTe,$Te,QSe,Rxe,OTe,RTe,FTe,BTe,UTe,KTe,Lxe,XTe,YTe,eNe,vke];for(const t of tNe)kw(t);class ZG{constructor(){Uf(this,"model",null);Uf(this,"detectionHistory",[])}async initialize(){try{console.log("Loading COCO-SSD model..."),this.model=await zoe.load(),console.log("Model loaded successfully")}catch(e){throw console.error("Failed to load model:",e),e}}async detectObjects(e,n){if(!this.model)throw new Error("Model not initialized");const s=(await this.model.detect(e)).map(i=>({bbox:i.bbox,class:this.mapToTrafficClass(i.class),score:i.score,timestamp:n}));return this.detectionHistory.push(...s),s}mapToTrafficClass(e){return{car:"cars",truck:"trucks",bus:"buses",motorcycle:"motorcycles",bicycle:"bicycles",person:"pedestrians"}[e]||e}getTrafficCount(e){const n={cars:0,trucks:0,buses:0,motorcycles:0,bicycles:0,pedestrians:0};return e.forEach(r=>{const s=r.class;s in n&&n[s]++}),n}getAggregatedData(e,n,r){const s=[];for(let i=e;i<n;i+=r){const o=this.detectionHistory.filter(l=>l.timestamp>=i&&l.timestamp<i+r),a=this.getTrafficCount(o);s.push({...a,time:i})}return s}clearHistory(){this.detectionHistory=[]}exportToCSV(e){const n=Math.max(...this.detectionHistory.map(o=>o.timestamp),0),r=this.getAggregatedData(0,n,e),s=`Time,Cars,Trucks,Buses,Motorcycles,Bicycles,Pedestrians,Total
`,i=r.map(o=>{const a=o.cars+o.trucks+o.buses+o.motorcycles+o.bicycles+o.pedestrians;return`${new Date(o.time*1e3).toISOString().substr(11,8)},${o.cars},${o.trucks},${o.buses},${o.motorcycles},${o.bicycles},${o.pedestrians},${a}`}).join(`
`);return s+i}}const YG=()=>{const t="https://classificationbackend.boshang.online",e=typeof window<"u"&&window.location.protocol==="https:";if(t.trim().length>0){const r=t.replace(/\/$/,"");if(!(e&&r.startsWith("http://")))return r}const n=typeof window<"u"?window.location.hostname:"";return n==="classificationbackend.boshang.online"?window.location.origin:n==="classification.boshang.online"||n==="asdfghjklzxcvbnm.aimobilitylab.xyz"||n==="cnpcshangbo.github.io"||n==="ai-mobility-research-lab.github.io"?"https://classificationbackend.boshang.online":"http://localhost:8001"},bu=YG(),du={processingStatus:t=>`${bu}/processing-status/${encodeURIComponent(t)}`,processVideo:`${bu}/process-video`,processedVideo:t=>`${bu}${t}`,health:`${bu}/health`,locations:`${bu}/locations`},nNe=()=>{if(typeof window>"u")return!1;const t=window.location.hostname;return t==="classification.boshang.online"||t==="asdfghjklzxcvbnm.aimobilitylab.xyz"||t==="cnpcshangbo.github.io"||t==="ai-mobility-research-lab.github.io"},QG={"74th-Amsterdam-Columbus":"https://classificationbackend.boshang.online/processed-videos/74th-Amsterdam-Columbus_adjusted_loop_full_demo.mp4"},rNe=t=>{const e=QG[t];return typeof e=="string"&&e.trim().length>0?e:null},sNe=()=>{const t=Object.keys(QG);return t.length>0?t[0]:null},iNe=({videoPath:t,locationId:e,onTimeUpdate:n,onDetections:r})=>{const s=E.useRef(null),i=E.useRef(null),[o]=E.useState(()=>new ZG),[a,l]=E.useState(!1),[u,c]=E.useState(!1),[d,f]=E.useState(500),[p,m]=E.useState(.5),[y,v]=E.useState(!1),[x,b]=E.useState(null),[_,S]=E.useState(null),[k,T]=E.useState(!0),[$,A]=E.useState(null),[D,F]=E.useState(!0),[M,j]=E.useState(!1),H=E.useRef(),K=E.useRef(0);E.useEffect(()=>{Q()},[e]);const Q=async()=>{var _e;F(!0),T(!0),console.log(`🔍 Checking for processed video for location: ${e}`);try{const ue=rNe(e);if(ue){console.log(`✅ Using override processed video for ${e}: ${ue}`),A(ue),T(!0);return}const be=du.processingStatus(e);console.log(`🌐 API URL: ${be}`);const xe=await fetch(be);if(console.log(`📡 Response status: ${xe.status}, ok: ${xe.ok}`),!xe.ok)throw new Error(`HTTP ${xe.status}: ${xe.statusText}`);const le=await xe.json();if(console.log("📦 API Response data:",le),le.status==="completed"&&le.files.length>0){const Me=du.processedVideo(le.files[0]);console.log(`✅ Found processed video: ${Me}`),A(Me),T(!0)}else console.log(`❌ No processed video found. Status: ${le.status}, Files: ${((_e=le.files)==null?void 0:_e.length)||0}`),A(null),T(!1)}catch(ue){console.error("❌ Error checking for processed video:",ue),A(null),T(!1)}finally{F(!1),console.log(`🏁 Finished checking. ProcessedVideoUrl: ${$}, UseProcessedVideo: ${k}`)}},Z=async()=>{j(!0);try{const _e=t.split("/").pop()||"",be=await(await fetch(du.processVideo,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location_id:e,video_filename:_e})})).json();if(be.status==="already_processed")A(du.processedVideo(be.output_path)),T(!0),j(!1);else if(be.status==="processing"){const xe=setInterval(async()=>{const Me=await(await fetch(du.processingStatus(e))).json();Me.status==="completed"&&Me.files.length>0&&(A(du.processedVideo(Me.files[0])),T(!0),j(!1),clearInterval(xe))},3e3);setTimeout(()=>{clearInterval(xe),j(!1)},3e5)}else j(!1)}catch(_e){console.error("Error triggering video processing:",_e),j(!1)}};E.useEffect(()=>(k||o.initialize().then(()=>{l(!0),console.log("Object detection model loaded")}).catch(_e=>{console.error("Failed to load detection model:",_e),b("AI model failed to load. Using processed video mode instead."),T(!0)}),()=>{H.current&&cancelAnimationFrame(H.current)}),[o,k]),E.useEffect(()=>{S(null),s.current&&(s.current.currentTime=0),k||o.clearHistory()},[t,o,k]);const se=E.useCallback(_e=>{const ue=i.current,be=s.current;if(!ue||!be)return;const xe=ue.getContext("2d");xe&&(xe.clearRect(0,0,ue.width,ue.height),_e.forEach(le=>{const[Me,Be,He,Ge]=le.bbox;xe.strokeStyle=B(le.class),xe.lineWidth=2,xe.strokeRect(Me,Be,He,Ge),xe.fillStyle=B(le.class),xe.fillRect(Me,Be-20,He,20),xe.fillStyle="white",xe.font="14px Arial",xe.fillText(`${le.class} (${Math.round(le.score*100)}%)`,Me+5,Be-5)}))},[]),B=_e=>({car:"#22c55e",cars:"#22c55e",truck:"#ef4444",trucks:"#ef4444",bus:"#3b82f6",buses:"#3b82f6",motorcycle:"#eab308",motorcycles:"#eab308",bicycle:"#a855f7",bicycles:"#a855f7",person:"#f97316",pedestrian:"#f97316",pedestrians:"#f97316"})[_e.toLowerCase()]||"#666666",J=E.useCallback(async()=>{if(!a||!s.current||!u||k)return;const _e=Date.now();if(_e-K.current<d){H.current=requestAnimationFrame(J);return}const ue=s.current,be=i.current;if(be&&ue.videoWidth>0&&!ue.paused){(be.width!==ue.videoWidth||be.height!==ue.videoHeight)&&(be.width=ue.videoWidth,be.height=ue.videoHeight);try{const xe=ue.currentTime,Me=(await o.detectObjects(ue,xe)).filter(Be=>Be.score>=p);se(Me),r&&r(Me),K.current=_e}catch(xe){console.error("Detection error:",xe)}}H.current=requestAnimationFrame(J)},[a,u,o,se,r,d,p,k]);E.useEffect(()=>{u&&!k?J():H.current&&cancelAnimationFrame(H.current)},[u,J,k]);const Y=()=>{s.current&&n(s.current.currentTime)},ie=()=>{k||c(!0)},ne=()=>{c(!1)},pe=()=>{c(!1)},me=_e=>{if(console.error("Video error:",_e),console.error("Current video URL:",ke),console.error("Use processed video:",k),console.error("Processed video URL:",$),k&&$){console.log("Processed video failed, falling back to original video"),T(!1),S(null);return}S(`Failed to load video: ${ke}. Please check the video file exists.`),c(!1)},de=()=>{console.log("Video metadata loaded"),S(null)},fe=t.replace("../","/"),ke=k&&$?$:fe;return console.log("Playing video:",ke,"Processed:",k),z.jsxs("div",{style:{position:"relative",width:"100%",maxWidth:"800px"},children:[z.jsx("video",{ref:s,src:ke,controls:!0,preload:"metadata",style:{width:"100%",height:"auto",display:"block"},onTimeUpdate:Y,onPlay:ie,onPause:ne,onEnded:pe,onError:me,onLoadedMetadata:de,onCanPlay:()=>{console.log("Video can play:",ke),S(null)}}),!k&&z.jsx("canvas",{ref:i,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"}}),!D&&z.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"10px",borderRadius:"8px",fontSize:"14px",display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[z.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"5px",cursor:"pointer"},children:[z.jsx("input",{type:"checkbox",checked:k&&!!$,onChange:_e=>T(_e.target.checked),disabled:!$}),$?"Use Server-Processed Video":"Server-Processed Video (Not Available)"]}),!$&&z.jsx("button",{onClick:Z,disabled:M,style:{background:M?"#6b7280":"#3b82f6",border:"none",color:"white",padding:"5px 10px",borderRadius:"4px",cursor:M?"not-allowed":"pointer",fontSize:"12px"},children:M?"Processing...":"Process with YOLOv8"}),k&&$&&z.jsx("span",{style:{color:"#22c55e",fontSize:"12px"},children:"✓ YOLOv8 Processed"}),z.jsx("button",{onClick:()=>{console.log("=== VIDEO DEBUG INFO ==="),console.log("Current video URL:",ke),console.log("Processed video URL:",$),console.log("Use processed:",k),console.log("Original video path:",fe),console.log("Location ID:",e)},style:{background:"#64748b",border:"none",color:"white",padding:"3px 6px",borderRadius:"3px",cursor:"pointer",fontSize:"10px"},children:"🐛 Debug"})]}),!k&&!a&&!x&&z.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"20px",borderRadius:"8px",textAlign:"center"},children:["Loading object detection model...",z.jsx("div",{style:{marginTop:"10px",fontSize:"12px",opacity:.8},children:"This may take a few moments"})]}),x&&!k&&z.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(34, 197, 94, 0.9)",color:"white",padding:"20px",borderRadius:"8px",textAlign:"center",maxWidth:"300px"},children:[z.jsx("div",{style:{fontSize:"16px",marginBottom:"10px"},children:"ℹ️ Notice"}),z.jsx("div",{children:x}),z.jsx("div",{style:{fontSize:"12px",marginTop:"10px",opacity:.9},children:"Automatically switched to processed video mode for better performance."})]}),_&&z.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(220, 38, 38, 0.9)",color:"white",padding:"20px",borderRadius:"8px",textAlign:"center",maxWidth:"300px",zIndex:10},children:[z.jsx("div",{style:{fontSize:"16px",marginBottom:"10px"},children:"🎥 Video Error"}),z.jsx("div",{children:_})]}),!k&&a&&!_&&z.jsxs("div",{style:{position:"absolute",bottom:"10px",right:"10px",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"10px",borderRadius:"8px",fontSize:"12px",maxWidth:"200px"},children:[z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",flexWrap:"wrap"},children:[z.jsxs("button",{onClick:()=>v(!y),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",color:"white",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},children:["⚙️ ",y?"Hide":"Show"," Controls"]}),z.jsxs("span",{style:{color:u?"#4ade80":"#fbbf24"},children:["● ",u?"Detecting":"Paused"]})]}),y&&z.jsxs("div",{style:{marginTop:"10px",display:"flex",flexDirection:"column",gap:"8px"},children:[z.jsxs("div",{children:[z.jsxs("label",{style:{display:"block",marginBottom:"2px"},children:["Detection Interval: ",d,"ms"]}),z.jsx("input",{type:"range",min:"100",max:"2000",step:"100",value:d,onChange:_e=>f(Number(_e.target.value)),style:{width:"100%"}})]}),z.jsxs("div",{children:[z.jsxs("label",{style:{display:"block",marginBottom:"2px"},children:["Confidence: ",Math.round(p*100),"%"]}),z.jsx("input",{type:"range",min:"0.1",max:"0.9",step:"0.1",value:p,onChange:_e=>m(Number(_e.target.value)),style:{width:"100%"}})]})]})]})]})};function JG(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=JG(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function xt(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=JG(t))&&(r&&(r+=" "),r+=e);return r}var A1={},eH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n==="__proto__"}t.isUnsafeProperty=e})(eH);var rE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}t.isDeepKey=e})(rE);var sE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){var r;return typeof n=="string"||typeof n=="symbol"?n:Object.is((r=n==null?void 0:n.valueOf)==null?void 0:r.call(n),-0)?"-0":String(n)}t.toKey=e})(sE);var O1={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){const r=[],s=n.length;if(s===0)return r;let i=0,o="",a="",l=!1;for(n.charCodeAt(0)===46&&(r.push(""),i++);i<s;){const u=n[i];a?u==="\\"&&i+1<s?(i++,o+=n[i]):u===a?a="":o+=u:l?u==='"'||u==="'"?a=u:u==="]"?(l=!1,r.push(o),o=""):o+=u:u==="["?(l=!0,o&&(r.push(o),o="")):u==="."?o&&(r.push(o),o=""):o+=u,i++}return o&&r.push(o),r}t.toPath=e})(O1);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eH,n=rE,r=sE,s=O1;function i(a,l,u){if(a==null)return u;switch(typeof l){case"string":{if(e.isUnsafeProperty(l))return u;const c=a[l];return c===void 0?n.isDeepKey(l)?i(a,s.toPath(l),u):u:c}case"number":case"symbol":{typeof l=="number"&&(l=r.toKey(l));const c=a[l];return c===void 0?u:c}default:{if(Array.isArray(l))return o(a,l,u);if(Object.is(l==null?void 0:l.valueOf(),-0)?l="-0":l=String(l),e.isUnsafeProperty(l))return u;const c=a[l];return c===void 0?u:c}}}function o(a,l,u){if(l.length===0)return u;let c=a;for(let d=0;d<l.length;d++){if(c==null||e.isUnsafeProperty(l[d]))return u;c=c[l[d]]}return c===void 0?u:c}t.get=i})(A1);var oNe=A1.get;const uc=wi(oNe);var tH={exports:{}},Ct={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tr=typeof Symbol=="function"&&Symbol.for,iE=tr?Symbol.for("react.element"):60103,oE=tr?Symbol.for("react.portal"):60106,P1=tr?Symbol.for("react.fragment"):60107,D1=tr?Symbol.for("react.strict_mode"):60108,R1=tr?Symbol.for("react.profiler"):60114,L1=tr?Symbol.for("react.provider"):60109,F1=tr?Symbol.for("react.context"):60110,aE=tr?Symbol.for("react.async_mode"):60111,M1=tr?Symbol.for("react.concurrent_mode"):60111,z1=tr?Symbol.for("react.forward_ref"):60112,B1=tr?Symbol.for("react.suspense"):60113,aNe=tr?Symbol.for("react.suspense_list"):60120,j1=tr?Symbol.for("react.memo"):60115,V1=tr?Symbol.for("react.lazy"):60116,lNe=tr?Symbol.for("react.block"):60121,uNe=tr?Symbol.for("react.fundamental"):60117,cNe=tr?Symbol.for("react.responder"):60118,dNe=tr?Symbol.for("react.scope"):60119;function js(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case iE:switch(t=t.type,t){case aE:case M1:case P1:case R1:case D1:case B1:return t;default:switch(t=t&&t.$$typeof,t){case F1:case z1:case V1:case j1:case L1:return t;default:return e}}case oE:return e}}}function nH(t){return js(t)===M1}Ct.AsyncMode=aE;Ct.ConcurrentMode=M1;Ct.ContextConsumer=F1;Ct.ContextProvider=L1;Ct.Element=iE;Ct.ForwardRef=z1;Ct.Fragment=P1;Ct.Lazy=V1;Ct.Memo=j1;Ct.Portal=oE;Ct.Profiler=R1;Ct.StrictMode=D1;Ct.Suspense=B1;Ct.isAsyncMode=function(t){return nH(t)||js(t)===aE};Ct.isConcurrentMode=nH;Ct.isContextConsumer=function(t){return js(t)===F1};Ct.isContextProvider=function(t){return js(t)===L1};Ct.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===iE};Ct.isForwardRef=function(t){return js(t)===z1};Ct.isFragment=function(t){return js(t)===P1};Ct.isLazy=function(t){return js(t)===V1};Ct.isMemo=function(t){return js(t)===j1};Ct.isPortal=function(t){return js(t)===oE};Ct.isProfiler=function(t){return js(t)===R1};Ct.isStrictMode=function(t){return js(t)===D1};Ct.isSuspense=function(t){return js(t)===B1};Ct.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===P1||t===M1||t===R1||t===D1||t===B1||t===aNe||typeof t=="object"&&t!==null&&(t.$$typeof===V1||t.$$typeof===j1||t.$$typeof===L1||t.$$typeof===F1||t.$$typeof===z1||t.$$typeof===uNe||t.$$typeof===cNe||t.$$typeof===dNe||t.$$typeof===lNe)};Ct.typeOf=js;tH.exports=Ct;var hNe=tH.exports,is=t=>t===0?0:t>0?1:-1,Ur=t=>typeof t=="number"&&t!=+t,Nu=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,De=t=>(typeof t=="number"||t instanceof Number)&&!Ur(t),yi=t=>De(t)||typeof t=="string",fNe=0,xm=t=>{var e=++fNe;return"".concat(t||"").concat(e)},no=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!De(e)&&typeof e!="string")return r;var i;if(Nu(e)){if(n==null)return r;var o=e.indexOf("%");i=n*parseFloat(e.slice(0,o))/100}else i=+e;return Ur(i)&&(i=r),s&&n!=null&&i>n&&(i=n),i},rH=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,n={},r=0;r<e;r++)if(!n[t[r]])n[t[r]]=!0;else return!0;return!1};function ji(t,e,n){return De(t)&&De(e)?t+n*(e-t):e}function sH(t,e,n){if(!(!t||!t.length))return t.find(r=>r&&(typeof e=="function"?e(r):uc(r,e))===n)}var jt=t=>t===null||typeof t>"u",ky=t=>jt(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),pNe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function lE(t){if(typeof t!="string")return!1;var e=pNe;return e.includes(t)}var mNe=["viewBox","children"],FR=["points","pathLength"],ZS={svg:mNe,polygon:FR,polyline:FR},uE=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(E.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var r={};return Object.keys(n).forEach(s=>{lE(s)&&(r[s]=i=>n[s](n,i))}),r},gNe=(t,e,n)=>r=>(t(e,n,r),null),W1=(t,e,n)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var r=null;return Object.keys(t).forEach(s=>{var i=t[s];lE(s)&&typeof i=="function"&&(r||(r={}),r[s]=gNe(i,e,n))}),r},yNe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function iH(t){if(typeof t!="string")return!1;var e=yNe;return e.includes(t)}function Pc(t){var e=Object.entries(t).filter(n=>{var[r]=n;return iH(r)});return Object.fromEntries(e)}var MR=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",zR=null,YS=null,oH=t=>{if(t===zR&&Array.isArray(YS))return YS;var e=[];return E.Children.forEach(t,n=>{jt(n)||(hNe.isFragment(n)?e=e.concat(oH(n.props.children)):e.push(n))}),YS=e,zR=t,e};function cE(t,e){var n=[],r=[];return Array.isArray(e)?r=e.map(s=>MR(s)):r=[MR(e)],oH(t).forEach(s=>{var i=uc(s,"type.displayName")||uc(s,"type.name");r.indexOf(i)!==-1&&n.push(s)}),n}var aH=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,vNe=(t,e,n,r)=>{var s;if(typeof e=="symbol"||typeof e=="number")return!0;var i=(s=r&&(ZS==null?void 0:ZS[r]))!==null&&s!==void 0?s:[],o=e.startsWith("data-"),a=typeof t!="function"&&(!!r&&i.includes(e)||iH(e)),l=!!n&&lE(e);return o||a||l},Qt=(t,e,n)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(E.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var s={};return Object.keys(r).forEach(i=>{var o;vNe((o=r)===null||o===void 0?void 0:o[i],i,e,n)&&(s[i]=r[i])}),s},xNe=["children","width","height","viewBox","className","style","title","desc"];function hT(){return hT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hT.apply(null,arguments)}function bNe(t,e){if(t==null)return{};var n,r,s=wNe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function wNe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var dE=E.forwardRef((t,e)=>{var{children:n,width:r,height:s,viewBox:i,className:o,style:a,title:l,desc:u}=t,c=bNe(t,xNe),d=i||{width:r,height:s,x:0,y:0},f=xt("recharts-surface",o);return E.createElement("svg",hT({},Qt(c,!0,"svg"),{className:f,width:r,height:s,style:a,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height),ref:e}),E.createElement("title",null,l),E.createElement("desc",null,u),n)}),_Ne=["children","className"];function fT(){return fT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fT.apply(null,arguments)}function SNe(t,e){if(t==null)return{};var n,r,s=kNe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function kNe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var vi=E.forwardRef((t,e)=>{var{children:n,className:r}=t,s=SNe(t,_Ne),i=xt("recharts-layer",r);return E.createElement("g",fT({className:i},Qt(s,!0),{ref:e}),n)}),lH=E.createContext(null),CNe=()=>E.useContext(lH);function Ot(t){return function(){return t}}const uH=Math.cos,px=Math.sin,ao=Math.sqrt,mx=Math.PI,U1=2*mx,pT=Math.PI,mT=2*pT,hu=1e-6,TNe=mT-hu;function cH(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function NNe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return cH;const n=10**e;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class INe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?cH:NNe(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,s){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(e,n,r,s,i,o){this._append`C${+e},${+n},${+r},${+s},${this._x1=+i},${this._y1=+o}`}arcTo(e,n,r,s,i){if(e=+e,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,a=this._y1,l=r-e,u=s-n,c=o-e,d=a-n,f=c*c+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>hu)if(!(Math.abs(d*l-u*c)>hu)||!i)this._append`L${this._x1=e},${this._y1=n}`;else{let p=r-o,m=s-a,y=l*l+u*u,v=p*p+m*m,x=Math.sqrt(y),b=Math.sqrt(f),_=i*Math.tan((pT-Math.acos((y+f-v)/(2*x*b)))/2),S=_/b,k=_/x;Math.abs(S-1)>hu&&this._append`L${e+S*c},${n+S*d}`,this._append`A${i},${i},0,0,${+(d*p>c*m)},${this._x1=e+k*l},${this._y1=n+k*u}`}}arc(e,n,r,s,i,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(s),l=r*Math.sin(s),u=e+a,c=n+l,d=1^o,f=o?s-i:i-s;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>hu||Math.abs(this._y1-c)>hu)&&this._append`L${u},${c}`,r&&(f<0&&(f=f%mT+mT),f>TNe?this._append`A${r},${r},0,1,${d},${e-a},${n-l}A${r},${r},0,1,${d},${this._x1=u},${this._y1=c}`:f>hu&&this._append`A${r},${r},0,${+(f>=pT)},${d},${this._x1=e+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(e,n,r,s){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function hE(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new INe(e)}function fE(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function dH(t){this._context=t}dH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function G1(t){return new dH(t)}function hH(t){return t[0]}function fH(t){return t[1]}function pH(t,e){var n=Ot(!0),r=null,s=G1,i=null,o=hE(a);t=typeof t=="function"?t:t===void 0?hH:Ot(t),e=typeof e=="function"?e:e===void 0?fH:Ot(e);function a(l){var u,c=(l=fE(l)).length,d,f=!1,p;for(r==null&&(i=s(p=o())),u=0;u<=c;++u)!(u<c&&n(d=l[u],u,l))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+t(d,u,l),+e(d,u,l));if(p)return i=null,p+""||null}return a.x=function(l){return arguments.length?(t=typeof l=="function"?l:Ot(+l),a):t},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:Ot(+l),a):e},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Ot(!!l),a):n},a.curve=function(l){return arguments.length?(s=l,r!=null&&(i=s(r)),a):s},a.context=function(l){return arguments.length?(l==null?r=i=null:i=s(r=l),a):r},a}function Rv(t,e,n){var r=null,s=Ot(!0),i=null,o=G1,a=null,l=hE(u);t=typeof t=="function"?t:t===void 0?hH:Ot(+t),e=typeof e=="function"?e:Ot(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?fH:Ot(+n);function u(d){var f,p,m,y=(d=fE(d)).length,v,x=!1,b,_=new Array(y),S=new Array(y);for(i==null&&(a=o(b=l())),f=0;f<=y;++f){if(!(f<y&&s(v=d[f],f,d))===x)if(x=!x)p=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),m=f-1;m>=p;--m)a.point(_[m],S[m]);a.lineEnd(),a.areaEnd()}x&&(_[f]=+t(v,f,d),S[f]=+e(v,f,d),a.point(r?+r(v,f,d):_[f],n?+n(v,f,d):S[f]))}if(b)return a=null,b+""||null}function c(){return pH().defined(s).curve(o).context(i)}return u.x=function(d){return arguments.length?(t=typeof d=="function"?d:Ot(+d),r=null,u):t},u.x0=function(d){return arguments.length?(t=typeof d=="function"?d:Ot(+d),u):t},u.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:Ot(+d),u):r},u.y=function(d){return arguments.length?(e=typeof d=="function"?d:Ot(+d),n=null,u):e},u.y0=function(d){return arguments.length?(e=typeof d=="function"?d:Ot(+d),u):e},u.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:Ot(+d),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(d){return arguments.length?(s=typeof d=="function"?d:Ot(!!d),u):s},u.curve=function(d){return arguments.length?(o=d,i!=null&&(a=o(i)),u):o},u.context=function(d){return arguments.length?(d==null?i=a=null:a=o(i=d),u):i},u}class mH{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function $Ne(t){return new mH(t,!0)}function ENe(t){return new mH(t,!1)}const pE={draw(t,e){const n=ao(e/mx);t.moveTo(n,0),t.arc(0,0,n,0,U1)}},ANe={draw(t,e){const n=ao(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},gH=ao(1/3),ONe=gH*2,PNe={draw(t,e){const n=ao(e/ONe),r=n*gH;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},DNe={draw(t,e){const n=ao(e),r=-n/2;t.rect(r,r,n,n)}},RNe=.8908130915292852,yH=px(mx/10)/px(7*mx/10),LNe=px(U1/10)*yH,FNe=-uH(U1/10)*yH,MNe={draw(t,e){const n=ao(e*RNe),r=LNe*n,s=FNe*n;t.moveTo(0,-n),t.lineTo(r,s);for(let i=1;i<5;++i){const o=U1*i/5,a=uH(o),l=px(o);t.lineTo(l*n,-a*n),t.lineTo(a*r-l*s,l*r+a*s)}t.closePath()}},QS=ao(3),zNe={draw(t,e){const n=-ao(e/(QS*3));t.moveTo(0,n*2),t.lineTo(-QS*n,-n),t.lineTo(QS*n,-n),t.closePath()}},Zs=-.5,Ys=ao(3)/2,gT=1/ao(12),BNe=(gT/2+1)*3,jNe={draw(t,e){const n=ao(e/BNe),r=n/2,s=n*gT,i=r,o=n*gT+n,a=-i,l=o;t.moveTo(r,s),t.lineTo(i,o),t.lineTo(a,l),t.lineTo(Zs*r-Ys*s,Ys*r+Zs*s),t.lineTo(Zs*i-Ys*o,Ys*i+Zs*o),t.lineTo(Zs*a-Ys*l,Ys*a+Zs*l),t.lineTo(Zs*r+Ys*s,Zs*s-Ys*r),t.lineTo(Zs*i+Ys*o,Zs*o-Ys*i),t.lineTo(Zs*a+Ys*l,Zs*l-Ys*a),t.closePath()}};function VNe(t,e){let n=null,r=hE(s);t=typeof t=="function"?t:Ot(t||pE),e=typeof e=="function"?e:Ot(e===void 0?64:+e);function s(){let i;if(n||(n=i=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return s.type=function(i){return arguments.length?(t=typeof i=="function"?i:Ot(i),s):t},s.size=function(i){return arguments.length?(e=typeof i=="function"?i:Ot(+i),s):e},s.context=function(i){return arguments.length?(n=i??null,s):n},s}function gx(){}function yx(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function vH(t){this._context=t}vH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:yx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:yx(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function WNe(t){return new vH(t)}function xH(t){this._context=t}xH.prototype={areaStart:gx,areaEnd:gx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:yx(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function UNe(t){return new xH(t)}function bH(t){this._context=t}bH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:yx(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function GNe(t){return new bH(t)}function wH(t){this._context=t}wH.prototype={areaStart:gx,areaEnd:gx,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function HNe(t){return new wH(t)}function BR(t){return t<0?-1:1}function jR(t,e,n){var r=t._x1-t._x0,s=e-t._x1,i=(t._y1-t._y0)/(r||s<0&&-0),o=(n-t._y1)/(s||r<0&&-0),a=(i*s+o*r)/(r+s);return(BR(i)+BR(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(a))||0}function VR(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function JS(t,e,n){var r=t._x0,s=t._y0,i=t._x1,o=t._y1,a=(i-r)/3;t._context.bezierCurveTo(r+a,s+a*e,i-a,o-a*n,i,o)}function vx(t){this._context=t}vx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:JS(this,this._t0,VR(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,JS(this,VR(this,n=jR(this,t,e)),n);break;default:JS(this,this._t0,n=jR(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function _H(t){this._context=new SH(t)}(_H.prototype=Object.create(vx.prototype)).point=function(t,e){vx.prototype.point.call(this,e,t)};function SH(t){this._context=t}SH.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,s,i){this._context.bezierCurveTo(e,t,r,n,i,s)}};function KNe(t){return new vx(t)}function qNe(t){return new _H(t)}function kH(t){this._context=t}kH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=WR(t),s=WR(e),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],t[o],e[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function WR(t){var e,n=t.length-1,r,s=new Array(n),i=new Array(n),o=new Array(n);for(s[0]=0,i[0]=2,o[0]=t[0]+2*t[1],e=1;e<n-1;++e)s[e]=1,i[e]=4,o[e]=4*t[e]+2*t[e+1];for(s[n-1]=2,i[n-1]=7,o[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=s[e]/i[e-1],i[e]-=r,o[e]-=r*o[e-1];for(s[n-1]=o[n-1]/i[n-1],e=n-2;e>=0;--e)s[e]=(o[e]-s[e+1])/i[e];for(i[n-1]=(t[n]+s[n-1])/2,e=0;e<n-1;++e)i[e]=2*t[e+1]-s[e+1];return[s,i]}function XNe(t){return new kH(t)}function H1(t,e){this._context=t,this._t=e}H1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function ZNe(t){return new H1(t,.5)}function YNe(t){return new H1(t,0)}function QNe(t){return new H1(t,1)}function Yd(t,e){if((o=t.length)>1)for(var n=1,r,s,i=t[e[0]],o,a=i.length;n<o;++n)for(s=i,i=t[e[n]],r=0;r<a;++r)i[r][1]+=i[r][0]=isNaN(s[r][1])?s[r][0]:s[r][1]}function yT(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function JNe(t,e){return t[e]}function eIe(t){const e=[];return e.key=t,e}function tIe(){var t=Ot([]),e=yT,n=Yd,r=JNe;function s(i){var o=Array.from(t.apply(this,arguments),eIe),a,l=o.length,u=-1,c;for(const d of i)for(a=0,++u;a<l;++a)(o[a][u]=[0,+r(d,o[a].key,u,i)]).data=d;for(a=0,c=fE(e(o));a<l;++a)o[c[a]].index=a;return n(o,c),o}return s.keys=function(i){return arguments.length?(t=typeof i=="function"?i:Ot(Array.from(i)),s):t},s.value=function(i){return arguments.length?(r=typeof i=="function"?i:Ot(+i),s):r},s.order=function(i){return arguments.length?(e=i==null?yT:typeof i=="function"?i:Ot(Array.from(i)),s):e},s.offset=function(i){return arguments.length?(n=i??Yd,s):n},s}function nIe(t,e){if((r=t.length)>0){for(var n,r,s=0,i=t[0].length,o;s<i;++s){for(o=n=0;n<r;++n)o+=t[n][s][1]||0;if(o)for(n=0;n<r;++n)t[n][s][1]/=o}Yd(t,e)}}function rIe(t,e){if((s=t.length)>0){for(var n=0,r=t[e[0]],s,i=r.length;n<i;++n){for(var o=0,a=0;o<s;++o)a+=t[o][n][1]||0;r[n][1]+=r[n][0]=-a/2}Yd(t,e)}}function sIe(t,e){if(!(!((o=t.length)>0)||!((i=(s=t[e[0]]).length)>0))){for(var n=0,r=1,s,i,o;r<i;++r){for(var a=0,l=0,u=0;a<o;++a){for(var c=t[e[a]],d=c[r][1]||0,f=c[r-1][1]||0,p=(d-f)/2,m=0;m<a;++m){var y=t[e[m]],v=y[r][1]||0,x=y[r-1][1]||0;p+=v-x}l+=d,u+=p*d}s[r-1][1]+=s[r-1][0]=n,l&&(n-=u/l)}s[r-1][1]+=s[r-1][0]=n,Yd(t,e)}}var iIe=["type","size","sizeType"];function vT(){return vT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vT.apply(null,arguments)}function UR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function GR(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UR(Object(n),!0).forEach(function(r){oIe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UR(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function oIe(t,e,n){return(e=aIe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aIe(t){var e=lIe(t,"string");return typeof e=="symbol"?e:e+""}function lIe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uIe(t,e){if(t==null)return{};var n,r,s=cIe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function cIe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var CH={symbolCircle:pE,symbolCross:ANe,symbolDiamond:PNe,symbolSquare:DNe,symbolStar:MNe,symbolTriangle:zNe,symbolWye:jNe},dIe=Math.PI/180,hIe=t=>{var e="symbol".concat(ky(t));return CH[e]||pE},fIe=(t,e,n)=>{if(e==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var r=18*dIe;return 1.25*t*t*(Math.tan(r)-Math.tan(r*2)*Math.tan(r)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},pIe=(t,e)=>{CH["symbol".concat(ky(t))]=e},mE=t=>{var{type:e="circle",size:n=64,sizeType:r="area"}=t,s=uIe(t,iIe),i=GR(GR({},s),{},{type:e,size:n,sizeType:r}),o=()=>{var d=hIe(e),f=VNe().type(d).size(fIe(n,r,e));return f()},{className:a,cx:l,cy:u}=i,c=Qt(i,!0);return l===+l&&u===+u&&n===+n?E.createElement("path",vT({},c,{className:xt("recharts-symbols",a),transform:"translate(".concat(l,", ").concat(u,")"),d:o()})):null};mE.registerSymbol=pIe;function xT(){return xT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xT.apply(null,arguments)}function HR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function mIe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?HR(Object(n),!0).forEach(function(r){gE(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HR(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function gE(t,e,n){return(e=gIe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gIe(t){var e=yIe(t,"string");return typeof e=="symbol"?e:e+""}function yIe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Qs=32;class yE extends E.PureComponent{renderIcon(e,n){var{inactiveColor:r}=this.props,s=Qs/2,i=Qs/6,o=Qs/3,a=e.inactive?r:e.color,l=n??e.type;if(l==="none")return null;if(l==="plainline")return E.createElement("line",{strokeWidth:4,fill:"none",stroke:a,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:s,x2:Qs,y2:s,className:"recharts-legend-icon"});if(l==="line")return E.createElement("path",{strokeWidth:4,fill:"none",stroke:a,d:"M0,".concat(s,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(s,`
            H`).concat(Qs,"M").concat(2*o,",").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(s),className:"recharts-legend-icon"});if(l==="rect")return E.createElement("path",{stroke:"none",fill:a,d:"M0,".concat(Qs/8,"h").concat(Qs,"v").concat(Qs*3/4,"h").concat(-Qs,"z"),className:"recharts-legend-icon"});if(E.isValidElement(e.legendIcon)){var u=mIe({},e);return delete u.legendIcon,E.cloneElement(e.legendIcon,u)}return E.createElement(mE,{fill:a,cx:s,cy:s,size:Qs,sizeType:"diameter",type:l})}renderItems(){var{payload:e,iconSize:n,layout:r,formatter:s,inactiveColor:i,iconType:o}=this.props,a={x:0,y:0,width:Qs,height:Qs},l={display:r==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((c,d)=>{var f=c.formatter||s,p=xt({"recharts-legend-item":!0,["legend-item-".concat(d)]:!0,inactive:c.inactive});if(c.type==="none")return null;var m=c.inactive?i:c.color,y=f?f(c.value,c,d):c.value;return E.createElement("li",xT({className:p,style:l,key:"legend-item-".concat(d)},W1(this.props,c,d)),E.createElement(dE,{width:n,height:n,viewBox:a,style:u,"aria-label":"".concat(y," legend icon")},this.renderIcon(c,o)),E.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},y))})}render(){var{payload:e,layout:n,align:r}=this.props;if(!e||!e.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?r:"left"};return E.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}gE(yE,"displayName","Legend");gE(yE,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var TH={},NH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,r){const s=new Map;for(let i=0;i<n.length;i++){const o=n[i],a=r(o);s.has(a)||s.set(a,o)}return Array.from(s.values())}t.uniqBy=e})(NH);var vE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n}t.identity=e})(vE);var IH={},K1={},$H={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return Number.isSafeInteger(n)&&n>=0}t.isLength=e})($H);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=$H;function n(r){return r!=null&&typeof r!="function"&&e.isLength(r.length)}t.isArrayLike=n})(K1);var EH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="object"&&n!==null}t.isObjectLike=e})(EH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=K1,n=EH;function r(s){return n.isObjectLike(s)&&e.isArrayLike(s)}t.isArrayLikeObject=r})(IH);var AH={},OH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=A1;function n(r){return function(s){return e.get(s,r)}}t.property=n})(OH);var PH={},ek={},tk={},xE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n!==null&&(typeof n=="object"||typeof n=="function")}t.isObject=e})(xE);var bE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n==null||typeof n!="object"&&typeof n!="function"}t.isPrimitive=e})(bE);var q1={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,r){return n===r||Number.isNaN(n)&&Number.isNaN(r)}t.eq=e})(q1);var KR;function vIe(){return KR||(KR=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=wE(),n=xE,r=bE,s=q1;function i(d,f,p){return typeof p!="function"?e.isMatch(d,f):o(d,f,function m(y,v,x,b,_,S){const k=p(y,v,x,b,_,S);return k!==void 0?!!k:o(y,v,m,S)},new Map)}function o(d,f,p,m){if(f===d)return!0;switch(typeof f){case"object":return a(d,f,p,m);case"function":return Object.keys(f).length>0?o(d,{...f},p,m):s.eq(d,f);default:return n.isObject(d)?typeof f=="string"?f==="":!0:s.eq(d,f)}}function a(d,f,p,m){if(f==null)return!0;if(Array.isArray(f))return u(d,f,p,m);if(f instanceof Map)return l(d,f,p,m);if(f instanceof Set)return c(d,f,p,m);const y=Object.keys(f);if(d==null)return y.length===0;if(y.length===0)return!0;if(m&&m.has(f))return m.get(f)===d;m&&m.set(f,d);try{for(let v=0;v<y.length;v++){const x=y[v];if(!r.isPrimitive(d)&&!(x in d)||f[x]===void 0&&d[x]!==void 0||f[x]===null&&d[x]!==null||!p(d[x],f[x],x,d,f,m))return!1}return!0}finally{m&&m.delete(f)}}function l(d,f,p,m){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[y,v]of f.entries()){const x=d.get(y);if(p(x,v,y,d,f,m)===!1)return!1}return!0}function u(d,f,p,m){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const y=new Set;for(let v=0;v<f.length;v++){const x=f[v];let b=!1;for(let _=0;_<d.length;_++){if(y.has(_))continue;const S=d[_];let k=!1;if(p(S,x,v,d,f,m)&&(k=!0),k){y.add(_),b=!0;break}}if(!b)return!1}return!0}function c(d,f,p,m){return f.size===0?!0:d instanceof Set?u([...d],[...f],p,m):!1}t.isMatchWith=i,t.isSetMatch=c}(tk)),tk}var qR;function wE(){return qR||(qR=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=vIe();function n(r,s){return e.isMatchWith(r,s,()=>{})}t.isMatch=n}(ek)),ek}var DH={},_E={},SE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return Object.getOwnPropertySymbols(n).filter(r=>Object.prototype.propertyIsEnumerable.call(n,r))}t.getSymbols=e})(SE);var X1={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}t.getTag=e})(X1);var Z1={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",n="[object String]",r="[object Number]",s="[object Boolean]",i="[object Arguments]",o="[object Symbol]",a="[object Date]",l="[object Map]",u="[object Set]",c="[object Array]",d="[object Function]",f="[object ArrayBuffer]",p="[object Object]",m="[object Error]",y="[object DataView]",v="[object Uint8Array]",x="[object Uint8ClampedArray]",b="[object Uint16Array]",_="[object Uint32Array]",S="[object BigUint64Array]",k="[object Int8Array]",T="[object Int16Array]",$="[object Int32Array]",A="[object BigInt64Array]",D="[object Float32Array]",F="[object Float64Array]";t.argumentsTag=i,t.arrayBufferTag=f,t.arrayTag=c,t.bigInt64ArrayTag=A,t.bigUint64ArrayTag=S,t.booleanTag=s,t.dataViewTag=y,t.dateTag=a,t.errorTag=m,t.float32ArrayTag=D,t.float64ArrayTag=F,t.functionTag=d,t.int16ArrayTag=T,t.int32ArrayTag=$,t.int8ArrayTag=k,t.mapTag=l,t.numberTag=r,t.objectTag=p,t.regexpTag=e,t.setTag=u,t.stringTag=n,t.symbolTag=o,t.uint16ArrayTag=b,t.uint32ArrayTag=_,t.uint8ArrayTag=v,t.uint8ClampedArrayTag=x})(Z1);var RH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}t.isTypedArray=e})(RH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=SE,n=X1,r=Z1,s=bE,i=RH;function o(c,d){return a(c,void 0,c,new Map,d)}function a(c,d,f,p=new Map,m=void 0){const y=m==null?void 0:m(c,d,f,p);if(y!=null)return y;if(s.isPrimitive(c))return c;if(p.has(c))return p.get(c);if(Array.isArray(c)){const v=new Array(c.length);p.set(c,v);for(let x=0;x<c.length;x++)v[x]=a(c[x],x,f,p,m);return Object.hasOwn(c,"index")&&(v.index=c.index),Object.hasOwn(c,"input")&&(v.input=c.input),v}if(c instanceof Date)return new Date(c.getTime());if(c instanceof RegExp){const v=new RegExp(c.source,c.flags);return v.lastIndex=c.lastIndex,v}if(c instanceof Map){const v=new Map;p.set(c,v);for(const[x,b]of c)v.set(x,a(b,x,f,p,m));return v}if(c instanceof Set){const v=new Set;p.set(c,v);for(const x of c)v.add(a(x,void 0,f,p,m));return v}if(typeof Buffer<"u"&&Buffer.isBuffer(c))return c.subarray();if(i.isTypedArray(c)){const v=new(Object.getPrototypeOf(c)).constructor(c.length);p.set(c,v);for(let x=0;x<c.length;x++)v[x]=a(c[x],x,f,p,m);return v}if(c instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&c instanceof SharedArrayBuffer)return c.slice(0);if(c instanceof DataView){const v=new DataView(c.buffer.slice(0),c.byteOffset,c.byteLength);return p.set(c,v),l(v,c,f,p,m),v}if(typeof File<"u"&&c instanceof File){const v=new File([c],c.name,{type:c.type});return p.set(c,v),l(v,c,f,p,m),v}if(c instanceof Blob){const v=new Blob([c],{type:c.type});return p.set(c,v),l(v,c,f,p,m),v}if(c instanceof Error){const v=new c.constructor;return p.set(c,v),v.message=c.message,v.name=c.name,v.stack=c.stack,v.cause=c.cause,l(v,c,f,p,m),v}if(typeof c=="object"&&u(c)){const v=Object.create(Object.getPrototypeOf(c));return p.set(c,v),l(v,c,f,p,m),v}return c}function l(c,d,f=c,p,m){const y=[...Object.keys(d),...e.getSymbols(d)];for(let v=0;v<y.length;v++){const x=y[v],b=Object.getOwnPropertyDescriptor(c,x);(b==null||b.writable)&&(c[x]=a(d[x],x,f,p,m))}}function u(c){switch(n.getTag(c)){case r.argumentsTag:case r.arrayTag:case r.arrayBufferTag:case r.dataViewTag:case r.booleanTag:case r.dateTag:case r.float32ArrayTag:case r.float64ArrayTag:case r.int8ArrayTag:case r.int16ArrayTag:case r.int32ArrayTag:case r.mapTag:case r.numberTag:case r.objectTag:case r.regexpTag:case r.setTag:case r.stringTag:case r.symbolTag:case r.uint8ArrayTag:case r.uint8ClampedArrayTag:case r.uint16ArrayTag:case r.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=a,t.copyProperties=l})(_E);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_E;function n(r){return e.cloneDeepWithImpl(r,void 0,r,new Map,void 0)}t.cloneDeep=n})(DH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=wE(),n=DH;function r(s){return s=n.cloneDeep(s),i=>e.isMatch(i,s)}t.matches=r})(PH);var LH={},FH={},MH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_E,n=Z1;function r(s,i){return e.cloneDeepWith(s,(o,a,l,u)=>{const c=i==null?void 0:i(o,a,l,u);if(c!=null)return c;if(typeof s=="object")switch(Object.prototype.toString.call(s)){case n.numberTag:case n.stringTag:case n.booleanTag:{const d=new s.constructor(s==null?void 0:s.valueOf());return e.copyProperties(d,s),d}case n.argumentsTag:{const d={};return e.copyProperties(d,s),d.length=s.length,d[Symbol.iterator]=s[Symbol.iterator],d}default:return}})}t.cloneDeepWith=r})(MH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=MH;function n(r){return e.cloneDeepWith(r)}t.cloneDeep=n})(FH);var zH={},kE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function n(r,s=Number.MAX_SAFE_INTEGER){switch(typeof r){case"number":return Number.isInteger(r)&&r>=0&&r<s;case"symbol":return!1;case"string":return e.test(r)}}t.isIndex=n})(kE);var BH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=X1;function n(r){return r!==null&&typeof r=="object"&&e.getTag(r)==="[object Arguments]"}t.isArguments=n})(BH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=rE,n=kE,r=BH,s=O1;function i(o,a){let l;if(Array.isArray(a)?l=a:typeof a=="string"&&e.isDeepKey(a)&&(o==null?void 0:o[a])==null?l=s.toPath(a):l=[a],l.length===0)return!1;let u=o;for(let c=0;c<l.length;c++){const d=l[c];if((u==null||!Object.hasOwn(u,d))&&!((Array.isArray(u)||r.isArguments(u))&&n.isIndex(d)&&d<u.length))return!1;u=u[d]}return!0}t.has=i})(zH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=wE(),n=sE,r=FH,s=A1,i=zH;function o(a,l){switch(typeof a){case"object":{Object.is(a==null?void 0:a.valueOf(),-0)&&(a="-0");break}case"number":{a=n.toKey(a);break}}return l=r.cloneDeep(l),function(u){const c=s.get(u,a);return c===void 0?i.has(u,a):l===void 0?c===void 0:e.isMatch(c,l)}}t.matchesProperty=o})(LH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=vE,n=OH,r=PH,s=LH;function i(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?s.matchesProperty(o[0],o[1]):r.matches(o);case"string":case"symbol":case"number":return n.property(o)}}t.iteratee=i})(AH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=NH,n=vE,r=IH,s=AH;function i(o,a=n.identity){return r.isArrayLikeObject(o)?e.uniqBy(Array.from(o),s.iteratee(a)):[]}t.uniqBy=i})(TH);var xIe=TH.uniqBy;const XR=wi(xIe);function jH(t,e,n){return e===!0?XR(t,n):typeof e=="function"?XR(t,e):t}var VH={exports:{}},WH={},UH={exports:{}},GH={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qd=E;function bIe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wIe=typeof Object.is=="function"?Object.is:bIe,_Ie=Qd.useState,SIe=Qd.useEffect,kIe=Qd.useLayoutEffect,CIe=Qd.useDebugValue;function TIe(t,e){var n=e(),r=_Ie({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return kIe(function(){s.value=n,s.getSnapshot=e,nk(s)&&i({inst:s})},[t,n,e]),SIe(function(){return nk(s)&&i({inst:s}),t(function(){nk(s)&&i({inst:s})})},[t]),CIe(n),n}function nk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wIe(t,n)}catch{return!0}}function NIe(t,e){return e()}var IIe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?NIe:TIe;GH.useSyncExternalStore=Qd.useSyncExternalStore!==void 0?Qd.useSyncExternalStore:IIe;UH.exports=GH;var $Ie=UH.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y1=E,EIe=$Ie;function AIe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var OIe=typeof Object.is=="function"?Object.is:AIe,PIe=EIe.useSyncExternalStore,DIe=Y1.useRef,RIe=Y1.useEffect,LIe=Y1.useMemo,FIe=Y1.useDebugValue;WH.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=DIe(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=LIe(function(){function l(p){if(!u){if(u=!0,c=p,p=r(p),s!==void 0&&o.hasValue){var m=o.value;if(s(m,p))return d=m}return d=p}if(m=d,OIe(c,p))return m;var y=r(p);return s!==void 0&&s(m,y)?(c=p,m):(c=p,d=y)}var u=!1,c,d,f=n===void 0?null:n;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,n,r,s]);var a=PIe(t,i[0],i[1]);return RIe(function(){o.hasValue=!0,o.value=a},[a]),FIe(a),a};VH.exports=WH;var MIe=VH.exports,CE=E.createContext(null),zIe=t=>t,gn=()=>{var t=E.useContext(CE);return t?t.store.dispatch:zIe},h0=()=>{},BIe=()=>h0,jIe=(t,e)=>t===e;function Fe(t){var e=E.useContext(CE);return MIe.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:BIe,e?e.store.getState:h0,e?e.store.getState:h0,e?t:h0,jIe)}function VIe(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function WIe(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function UIe(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(n=>typeof n=="function")){const n=t.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${e}[${n}]`)}}var ZR=t=>Array.isArray(t)?t:[t];function GIe(t){const e=Array.isArray(t[0])?t[0]:t;return UIe(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function HIe(t,e){const n=[],{length:r}=t;for(let s=0;s<r;s++)n.push(t[s].apply(null,e));return n}var KIe=class{constructor(t){this.value=t}deref(){return this.value}},qIe=typeof WeakRef<"u"?WeakRef:KIe,XIe=0,YR=1;function Lv(){return{s:XIe,v:void 0,o:null,p:null}}function HH(t,e={}){let n=Lv();const{resultEqualityCheck:r}=e;let s,i=0;function o(){var d;let a=n;const{length:l}=arguments;for(let f=0,p=l;f<p;f++){const m=arguments[f];if(typeof m=="function"||typeof m=="object"&&m!==null){let y=a.o;y===null&&(a.o=y=new WeakMap);const v=y.get(m);v===void 0?(a=Lv(),y.set(m,a)):a=v}else{let y=a.p;y===null&&(a.p=y=new Map);const v=y.get(m);v===void 0?(a=Lv(),y.set(m,a)):a=v}}const u=a;let c;if(a.s===YR)c=a.v;else if(c=t.apply(null,arguments),i++,r){const f=((d=s==null?void 0:s.deref)==null?void 0:d.call(s))??s;f!=null&&r(f,c)&&(c=f,i!==0&&i--),s=typeof c=="object"&&c!==null||typeof c=="function"?new qIe(c):c}return u.s=YR,u.v=c,c}return o.clearCache=()=>{n=Lv(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function ZIe(t,...e){const n=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,r=(...s)=>{let i=0,o=0,a,l={},u=s.pop();typeof u=="object"&&(l=u,u=s.pop()),VIe(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const c={...n,...l},{memoize:d,memoizeOptions:f=[],argsMemoize:p=HH,argsMemoizeOptions:m=[]}=c,y=ZR(f),v=ZR(m),x=GIe(s),b=d(function(){return i++,u.apply(null,arguments)},...y),_=p(function(){o++;const k=HIe(x,arguments);return a=b.apply(null,k),a},...v);return Object.assign(_,{resultFunc:u,memoizedResultFunc:b,dependencies:x,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>a,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:d,argsMemoize:p})};return Object.assign(r,{withTypes:()=>r}),r}var he=ZIe(HH),YIe=Object.assign((t,e=he)=>{WIe(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const n=Object.keys(t),r=n.map(i=>t[i]);return e(r,(...i)=>i.reduce((o,a,l)=>(o[n[l]]=a,o),{}))},{withTypes:()=>YIe}),KH={},qH={},XH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"?1:r===null?2:r===void 0?3:r!==r?4:0}const n=(r,s,i)=>{if(r!==s){const o=e(r),a=e(s);if(o===a&&o===0){if(r<s)return i==="desc"?1:-1;if(r>s)return i==="desc"?-1:1}return i==="desc"?a-o:o-a}return 0};t.compareValues=n})(XH);var ZH={},TE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"||n instanceof Symbol}t.isSymbol=e})(TE);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=TE,n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function s(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||e.isSymbol(i)?!0:typeof i=="string"&&(r.test(i)||!n.test(i))||o!=null&&Object.hasOwn(o,i)}t.isKey=s})(ZH);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=XH,n=ZH,r=O1;function s(i,o,a,l){if(i==null)return[];a=l?void 0:a,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(a)||(a=a==null?[]:[a]),a=a.map(p=>String(p));const u=(p,m)=>{let y=p;for(let v=0;v<m.length&&y!=null;++v)y=y[m[v]];return y},c=(p,m)=>m==null||p==null?m:typeof p=="object"&&"key"in p?Object.hasOwn(m,p.key)?m[p.key]:u(m,p.path):typeof p=="function"?p(m):Array.isArray(p)?u(m,p):typeof m=="object"?m[p]:m,d=o.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||n.isKey(p)?p:{key:p,path:r.toPath(p)}));return i.map(p=>({original:p,criteria:d.map(m=>c(m,p))})).slice().sort((p,m)=>{for(let y=0;y<d.length;y++){const v=e.compareValues(p.criteria[y],m.criteria[y],a[y]);if(v!==0)return v}return 0}).map(p=>p.original)}t.orderBy=s})(qH);var YH={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,r=1){const s=[],i=Math.floor(r),o=(a,l)=>{for(let u=0;u<a.length;u++){const c=a[u];Array.isArray(c)&&l<i?o(c,l+1):s.push(c)}};return o(n,0),s}t.flatten=e})(YH);var NE={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=kE,n=K1,r=xE,s=q1;function i(o,a,l){return r.isObject(l)&&(typeof a=="number"&&n.isArrayLike(l)&&e.isIndex(a)&&a<l.length||typeof a=="string"&&a in l)?s.eq(l[a],o):!1}t.isIterateeCall=i})(NE);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=qH,n=YH,r=NE;function s(i,...o){const a=o.length;return a>1&&r.isIterateeCall(i,o[0],o[1])?o=[]:a>2&&r.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(i,n.flatten(o),["asc"])}t.sortBy=s})(KH);var QIe=KH.sortBy;const Q1=wi(QIe);var QH=t=>t.legend.settings,JIe=t=>t.legend.size,e$e=t=>t.legend.payload,t$e=he([e$e,QH],(t,e)=>{var{itemSorter:n}=e,r=t.flat(1);return n?Q1(r,n):r});function n$e(){return Fe(t$e)}var Fv=1;function JH(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,n]=E.useState({height:0,left:0,top:0,width:0}),r=E.useCallback(s=>{if(s!=null){var i=s.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-e.height)>Fv||Math.abs(o.left-e.left)>Fv||Math.abs(o.top-e.top)>Fv||Math.abs(o.width-e.width)>Fv)&&n({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,r]}function ir(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var r$e=typeof Symbol=="function"&&Symbol.observable||"@@observable",QR=r$e,rk=()=>Math.random().toString(36).substring(7).split("").join("."),s$e={INIT:`@@redux/INIT${rk()}`,REPLACE:`@@redux/REPLACE${rk()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${rk()}`},xx=s$e;function IE(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function e6(t,e,n){if(typeof t!="function")throw new Error(ir(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(ir(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(ir(1));return n(e6)(t,e)}let r=t,s=e,i=new Map,o=i,a=0,l=!1;function u(){o===i&&(o=new Map,i.forEach((v,x)=>{o.set(x,v)}))}function c(){if(l)throw new Error(ir(3));return s}function d(v){if(typeof v!="function")throw new Error(ir(4));if(l)throw new Error(ir(5));let x=!0;u();const b=a++;return o.set(b,v),function(){if(x){if(l)throw new Error(ir(6));x=!1,u(),o.delete(b),i=null}}}function f(v){if(!IE(v))throw new Error(ir(7));if(typeof v.type>"u")throw new Error(ir(8));if(typeof v.type!="string")throw new Error(ir(17));if(l)throw new Error(ir(9));try{l=!0,s=r(s,v)}finally{l=!1}return(i=o).forEach(b=>{b()}),v}function p(v){if(typeof v!="function")throw new Error(ir(10));r=v,f({type:xx.REPLACE})}function m(){const v=d;return{subscribe(x){if(typeof x!="object"||x===null)throw new Error(ir(11));function b(){const S=x;S.next&&S.next(c())}return b(),{unsubscribe:v(b)}},[QR](){return this}}}return f({type:xx.INIT}),{dispatch:f,subscribe:d,getState:c,replaceReducer:p,[QR]:m}}function i$e(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:xx.INIT})>"u")throw new Error(ir(12));if(typeof n(void 0,{type:xx.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ir(13))})}function t6(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(n[o]=t[o])}const r=Object.keys(n);let s;try{i$e(n)}catch(i){s=i}return function(o={},a){if(s)throw s;let l=!1;const u={};for(let c=0;c<r.length;c++){const d=r[c],f=n[d],p=o[d],m=f(p,a);if(typeof m>"u")throw a&&a.type,new Error(ir(14));u[d]=m,l=l||m!==p}return l=l||r.length!==Object.keys(o).length,l?u:o}}function bx(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function o$e(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(ir(15))};const o={getState:s.getState,dispatch:(l,...u)=>i(l,...u)},a=t.map(l=>l(o));return i=bx(...a)(s.dispatch),{...s,dispatch:i}}}function n6(t){return IE(t)&&"type"in t&&typeof t.type=="string"}var r6=Symbol.for("immer-nothing"),JR=Symbol.for("immer-draftable"),Rs=Symbol.for("immer-state");function Wi(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Jd=Object.getPrototypeOf;function cc(t){return!!t&&!!t[Rs]}function xa(t){var e;return t?s6(t)||Array.isArray(t)||!!t[JR]||!!((e=t.constructor)!=null&&e[JR])||e_(t)||t_(t):!1}var a$e=Object.prototype.constructor.toString();function s6(t){if(!t||typeof t!="object")return!1;const e=Jd(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===a$e}function wx(t,e){J1(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function J1(t){const e=t[Rs];return e?e.type_:Array.isArray(t)?1:e_(t)?2:t_(t)?3:0}function bT(t,e){return J1(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function i6(t,e,n){const r=J1(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function l$e(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function e_(t){return t instanceof Map}function t_(t){return t instanceof Set}function fu(t){return t.copy_||t.base_}function wT(t,e){if(e_(t))return new Map(t);if(t_(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=s6(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[Rs];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],a=r[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(Jd(t),r)}else{const r=Jd(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function $E(t,e=!1){return n_(t)||cc(t)||!xa(t)||(J1(t)>1&&(t.set=t.add=t.clear=t.delete=u$e),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>$E(r,!0))),t}function u$e(){Wi(2)}function n_(t){return Object.isFrozen(t)}var c$e={};function dc(t){const e=c$e[t];return e||Wi(0,t),e}var bm;function o6(){return bm}function d$e(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function eL(t,e){e&&(dc("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function _T(t){ST(t),t.drafts_.forEach(h$e),t.drafts_=null}function ST(t){t===bm&&(bm=t.parent_)}function tL(t){return bm=d$e(bm,t)}function h$e(t){const e=t[Rs];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function nL(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Rs].modified_&&(_T(e),Wi(4)),xa(t)&&(t=_x(e,t),e.parent_||Sx(e,t)),e.patches_&&dc("Patches").generateReplacementPatches_(n[Rs].base_,t,e.patches_,e.inversePatches_)):t=_x(e,n,[]),_T(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==r6?t:void 0}function _x(t,e,n){if(n_(e))return e;const r=e[Rs];if(!r)return wx(e,(s,i)=>rL(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return Sx(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,o=!1;r.type_===3&&(i=new Set(s),s.clear(),o=!0),wx(i,(a,l)=>rL(t,r,s,a,l,n,o)),Sx(t,s,!1),n&&t.patches_&&dc("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function rL(t,e,n,r,s,i,o){if(cc(s)){const a=i&&e&&e.type_!==3&&!bT(e.assigned_,r)?i.concat(r):void 0,l=_x(t,s,a);if(i6(n,r,l),cc(l))t.canAutoFreeze_=!1;else return}else o&&n.add(s);if(xa(s)&&!n_(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;_x(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&Sx(t,s)}}function Sx(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&$E(e,n)}function f$e(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:o6(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=EE;n&&(s=[r],i=wm);const{revoke:o,proxy:a}=Proxy.revocable(s,i);return r.draft_=a,r.revoke_=o,a}var EE={get(t,e){if(e===Rs)return t;const n=fu(t);if(!bT(n,e))return p$e(t,n,e);const r=n[e];return t.finalized_||!xa(r)?r:r===sk(t.base_,e)?(ik(t),t.copy_[e]=CT(r,t)):r},has(t,e){return e in fu(t)},ownKeys(t){return Reflect.ownKeys(fu(t))},set(t,e,n){const r=a6(fu(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=sk(fu(t),e),i=s==null?void 0:s[Rs];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(l$e(n,s)&&(n!==void 0||bT(t.base_,e)))return!0;ik(t),kT(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return sk(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,ik(t),kT(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=fu(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Wi(11)},getPrototypeOf(t){return Jd(t.base_)},setPrototypeOf(){Wi(12)}},wm={};wx(EE,(t,e)=>{wm[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});wm.deleteProperty=function(t,e){return wm.set.call(this,t,e,void 0)};wm.set=function(t,e,n){return EE.set.call(this,t[0],e,n,t[0])};function sk(t,e){const n=t[Rs];return(n?fu(n):t)[e]}function p$e(t,e,n){var s;const r=a6(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function a6(t,e){if(!(e in t))return;let n=Jd(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Jd(n)}}function kT(t){t.modified_||(t.modified_=!0,t.parent_&&kT(t.parent_))}function ik(t){t.copy_||(t.copy_=wT(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var m$e=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const o=this;return function(l=i,...u){return o.produce(l,c=>n.call(this,c,...u))}}typeof n!="function"&&Wi(6),r!==void 0&&typeof r!="function"&&Wi(7);let s;if(xa(e)){const i=tL(this),o=CT(e,void 0);let a=!0;try{s=n(o),a=!1}finally{a?_T(i):ST(i)}return eL(i,r),nL(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===r6&&(s=void 0),this.autoFreeze_&&$E(s,!0),r){const i=[],o=[];dc("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else Wi(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let r,s;return[this.produce(e,n,(o,a)=>{r=o,s=a}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){xa(t)||Wi(8),cc(t)&&(t=la(t));const e=tL(this),n=CT(t,void 0);return n[Rs].isManual_=!0,ST(e),n}finishDraft(t,e){const n=t&&t[Rs];(!n||!n.isManual_)&&Wi(9);const{scope_:r}=n;return eL(r,e),nL(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=dc("Patches").applyPatches_;return cc(t)?r(t,e):this.produce(t,s=>r(s,e))}};function CT(t,e){const n=e_(t)?dc("MapSet").proxyMap_(t,e):t_(t)?dc("MapSet").proxySet_(t,e):f$e(t,e);return(e?e.scope_:o6()).drafts_.push(n),n}function la(t){return cc(t)||Wi(10,t),l6(t)}function l6(t){if(!xa(t)||n_(t))return t;const e=t[Rs];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=wT(t,e.scope_.immer_.useStrictShallowCopy_)}else n=wT(t,!0);return wx(n,(r,s)=>{i6(n,r,l6(s))}),e&&(e.finalized_=!1),n}var Ls=new m$e,u6=Ls.produce;Ls.produceWithPatches.bind(Ls);Ls.setAutoFreeze.bind(Ls);Ls.setUseStrictShallowCopy.bind(Ls);Ls.applyPatches.bind(Ls);Ls.createDraft.bind(Ls);Ls.finishDraft.bind(Ls);function c6(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var g$e=c6(),y$e=c6,v$e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?bx:bx.apply(null,arguments)};function xi(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(As(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>n6(r)&&r.type===t,n}var d6=class wp extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,wp.prototype)}static get[Symbol.species](){return wp}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new wp(...e[0].concat(this)):new wp(...e.concat(this))}};function sL(t){return xa(t)?u6(t,()=>{}):t}function Mv(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function x$e(t){return typeof t=="boolean"}var b$e=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new d6;return n&&(x$e(n)?o.push(g$e):o.push(y$e(n.extraArgument))),o},w$e="RTK_autoBatch",iL=t=>e=>{setTimeout(e,t)},_$e=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:iL(10):t.type==="callback"?t.queueNotification:iL(t.timeout),u=()=>{o=!1,i&&(i=!1,a.forEach(c=>c()))};return Object.assign({},r,{subscribe(c){const d=()=>s&&c(),f=r.subscribe(d);return a.add(c),()=>{f(),a.delete(c)}},dispatch(c){var d;try{return s=!((d=c==null?void 0:c.meta)!=null&&d[w$e]),i=!s,i&&(o||(o=!0,l(u))),r.dispatch(c)}finally{s=!0}}})},S$e=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new d6(t);return r&&s.push(_$e(typeof r=="object"?r:void 0)),s};function k$e(t){const e=b$e(),{reducer:n=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let a;if(typeof n=="function")a=n;else if(IE(n))a=t6(n);else throw new Error(As(1));let l;typeof r=="function"?l=r(e):l=e();let u=bx;s&&(u=v$e({trace:!1,...typeof s=="object"&&s}));const c=o$e(...l),d=S$e(c);let f=typeof o=="function"?o(d):d();const p=u(...f);return e6(a,i,p)}function h6(t){const e={},n=[];let r;const s={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(As(28));if(a in e)throw new Error(As(29));return e[a]=o,s},addMatcher(i,o){return n.push({matcher:i,reducer:o}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function C$e(t){return typeof t=="function"}function T$e(t,e){let[n,r,s]=h6(e),i;if(C$e(t))i=()=>sL(t());else{const a=sL(t);i=()=>a}function o(a=i(),l){let u=[n[l.type],...r.filter(({matcher:c})=>c(l)).map(({reducer:c})=>c)];return u.filter(c=>!!c).length===0&&(u=[s]),u.reduce((c,d)=>{if(d)if(cc(c)){const p=d(c,l);return p===void 0?c:p}else{if(xa(c))return u6(c,f=>d(f,l));{const f=d(c,l);if(f===void 0){if(c===null)return c;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return c},a)}return o.getInitialState=i,o}var N$e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",I$e=(t=21)=>{let e="",n=t;for(;n--;)e+=N$e[Math.random()*64|0];return e},$$e=Symbol.for("rtk-slice-createasyncthunk");function E$e(t,e){return`${t}/${e}`}function A$e({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[$$e];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(As(11));const a=(typeof s.reducers=="function"?s.reducers(P$e()):s.reducers)||{},l=Object.keys(a),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(S,k){const T=typeof S=="string"?S:S.type;if(!T)throw new Error(As(12));if(T in u.sliceCaseReducersByType)throw new Error(As(13));return u.sliceCaseReducersByType[T]=k,c},addMatcher(S,k){return u.sliceMatchers.push({matcher:S,reducer:k}),c},exposeAction(S,k){return u.actionCreators[S]=k,c},exposeCaseReducer(S,k){return u.sliceCaseReducersByName[S]=k,c}};l.forEach(S=>{const k=a[S],T={reducerName:S,type:E$e(i,S),createNotation:typeof s.reducers=="function"};R$e(k)?F$e(T,k,c,e):D$e(T,k,c)});function d(){const[S={},k=[],T=void 0]=typeof s.extraReducers=="function"?h6(s.extraReducers):[s.extraReducers],$={...S,...u.sliceCaseReducersByType};return T$e(s.initialState,A=>{for(let D in $)A.addCase(D,$[D]);for(let D of u.sliceMatchers)A.addMatcher(D.matcher,D.reducer);for(let D of k)A.addMatcher(D.matcher,D.reducer);T&&A.addDefaultCase(T)})}const f=S=>S,p=new Map,m=new WeakMap;let y;function v(S,k){return y||(y=d()),y(S,k)}function x(){return y||(y=d()),y.getInitialState()}function b(S,k=!1){function T(A){let D=A[S];return typeof D>"u"&&k&&(D=Mv(m,T,x)),D}function $(A=f){const D=Mv(p,k,()=>new WeakMap);return Mv(D,A,()=>{const F={};for(const[M,j]of Object.entries(s.selectors??{}))F[M]=O$e(j,A,()=>Mv(m,A,x),k);return F})}return{reducerPath:S,getSelectors:$,get selectors(){return $(T)},selectSlice:T}}const _={name:i,reducer:v,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:x,...b(o),injectInto(S,{reducerPath:k,...T}={}){const $=k??o;return S.inject({reducerPath:$,reducer:v},T),{..._,...b($,!0)}}};return _}}function O$e(t,e,n,r){function s(i,...o){let a=e(i);return typeof a>"u"&&r&&(a=n()),t(a,...o)}return s.unwrapped=t,s}var Vs=A$e();function P$e(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function D$e({type:t,reducerName:e,createNotation:n},r,s){let i,o;if("reducer"in r){if(n&&!L$e(r))throw new Error(As(17));i=r.reducer,o=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?xi(t,o):xi(t))}function R$e(t){return t._reducerDefinitionType==="asyncThunk"}function L$e(t){return t._reducerDefinitionType==="reducerWithPrepare"}function F$e({type:t,reducerName:e},n,r,s){if(!s)throw new Error(As(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:l,settled:u,options:c}=n,d=s(t,i,c);r.exposeAction(e,d),o&&r.addCase(d.fulfilled,o),a&&r.addCase(d.pending,a),l&&r.addCase(d.rejected,l),u&&r.addMatcher(d.settled,u),r.exposeCaseReducer(e,{fulfilled:o||zv,pending:a||zv,rejected:l||zv,settled:u||zv})}function zv(){}var M$e="task",f6="listener",p6="completed",AE="cancelled",z$e=`task-${AE}`,B$e=`task-${p6}`,TT=`${f6}-${AE}`,j$e=`${f6}-${p6}`,r_=class{constructor(t){Uf(this,"name","TaskAbortError");Uf(this,"message");this.code=t,this.message=`${M$e} ${AE} (reason: ${t})`}},OE=(t,e)=>{if(typeof t!="function")throw new TypeError(As(32))},kx=()=>{},m6=(t,e=kx)=>(t.catch(e),t),g6=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),zu=(t,e)=>{const n=t.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},Bu=t=>{if(t.aborted){const{reason:e}=t;throw new r_(e)}};function y6(t,e){let n=kx;return new Promise((r,s)=>{const i=()=>s(new r_(t.reason));if(t.aborted){i();return}n=g6(t,i),e.finally(()=>n()).then(r,s)}).finally(()=>{n=kx})}var V$e=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(n){return{status:n instanceof r_?"cancelled":"rejected",error:n}}finally{e==null||e()}},Cx=t=>e=>m6(y6(t,e).then(n=>(Bu(t),n))),v6=t=>{const e=Cx(t);return n=>e(new Promise(r=>setTimeout(r,n)))},{assign:Nd}=Object,oL={},s_="listenerMiddleware",W$e=(t,e)=>{const n=r=>g6(t,()=>zu(r,t.reason));return(r,s)=>{OE(r);const i=new AbortController;n(i);const o=V$e(async()=>{Bu(t),Bu(i.signal);const a=await r({pause:Cx(i.signal),delay:v6(i.signal),signal:i.signal});return Bu(i.signal),a},()=>zu(i,B$e));return s!=null&&s.autoJoin&&e.push(o.catch(kx)),{result:Cx(t)(o),cancel(){zu(i,z$e)}}}},U$e=(t,e)=>{const n=async(r,s)=>{Bu(e);let i=()=>{};const a=[new Promise((l,u)=>{let c=t({predicate:r,effect:(d,f)=>{f.unsubscribe(),l([d,f.getState(),f.getOriginalState()])}});i=()=>{c(),u()}})];s!=null&&a.push(new Promise(l=>setTimeout(l,s,null)));try{const l=await y6(e,Promise.race(a));return Bu(e),l}finally{i()}};return(r,s)=>m6(n(r,s))},x6=t=>{let{type:e,actionCreator:n,matcher:r,predicate:s,effect:i}=t;if(e)s=xi(e).match;else if(n)e=n.type,s=n.match;else if(r)s=r;else if(!s)throw new Error(As(21));return OE(i),{predicate:s,type:e,effect:i}},b6=Nd(t=>{const{type:e,predicate:n,effect:r}=x6(t);return{id:I$e(),effect:r,type:e,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(As(22))}}},{withTypes:()=>b6}),aL=(t,e)=>{const{type:n,effect:r,predicate:s}=x6(e);return Array.from(t.values()).find(i=>(typeof n=="string"?i.type===n:i.predicate===s)&&i.effect===r)},NT=t=>{t.pending.forEach(e=>{zu(e,TT)})},G$e=t=>()=>{t.forEach(NT),t.clear()},lL=(t,e,n)=>{try{t(e,n)}catch(r){setTimeout(()=>{throw r},0)}},w6=Nd(xi(`${s_}/add`),{withTypes:()=>w6}),H$e=xi(`${s_}/removeAll`),_6=Nd(xi(`${s_}/remove`),{withTypes:()=>_6}),K$e=(...t)=>{console.error(`${s_}/error`,...t)},Cy=(t={})=>{const e=new Map,{extra:n,onError:r=K$e}=t;OE(r);const s=c=>(c.unsubscribe=()=>e.delete(c.id),e.set(c.id,c),d=>{c.unsubscribe(),d!=null&&d.cancelActive&&NT(c)}),i=c=>{const d=aL(e,c)??b6(c);return s(d)};Nd(i,{withTypes:()=>i});const o=c=>{const d=aL(e,c);return d&&(d.unsubscribe(),c.cancelActive&&NT(d)),!!d};Nd(o,{withTypes:()=>o});const a=async(c,d,f,p)=>{const m=new AbortController,y=U$e(i,m.signal),v=[];try{c.pending.add(m),await Promise.resolve(c.effect(d,Nd({},f,{getOriginalState:p,condition:(x,b)=>y(x,b).then(Boolean),take:y,delay:v6(m.signal),pause:Cx(m.signal),extra:n,signal:m.signal,fork:W$e(m.signal,v),unsubscribe:c.unsubscribe,subscribe:()=>{e.set(c.id,c)},cancelActiveListeners:()=>{c.pending.forEach((x,b,_)=>{x!==m&&(zu(x,TT),_.delete(x))})},cancel:()=>{zu(m,TT),c.pending.delete(m)},throwIfCancelled:()=>{Bu(m.signal)}})))}catch(x){x instanceof r_||lL(r,x,{raisedBy:"effect"})}finally{await Promise.all(v),zu(m,j$e),c.pending.delete(m)}},l=G$e(e);return{middleware:c=>d=>f=>{if(!n6(f))return d(f);if(w6.match(f))return i(f.payload);if(H$e.match(f)){l();return}if(_6.match(f))return o(f.payload);let p=c.getState();const m=()=>{if(p===oL)throw new Error(As(23));return p};let y;try{if(y=d(f),e.size>0){const v=c.getState(),x=Array.from(e.values());for(const b of x){let _=!1;try{_=b.predicate(f,v,p)}catch(S){_=!1,lL(r,S,{raisedBy:"predicate"})}_&&a(b,f,c,m)}}}finally{p=oL}return y},startListening:i,stopListening:o,clearListeners:l}};function As(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var q$e={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},S6=Vs({name:"chartLayout",initialState:q$e,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){t.margin.top=e.payload.top,t.margin.right=e.payload.right,t.margin.bottom=e.payload.bottom,t.margin.left=e.payload.left},setScale(t,e){t.scale=e.payload}}}),{setMargin:X$e,setLayout:Z$e,setChartSize:Y$e,setScale:Q$e}=S6.actions,J$e=S6.reducer;function uL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function cL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?uL(Object(n),!0).forEach(function(r){e2e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function e2e(t,e,n){return(e=t2e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t2e(t){var e=n2e(t,"string");return typeof e=="symbol"?e:e+""}function n2e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Tx=Math.PI/180,r2e=t=>t*180/Math.PI,cr=(t,e,n,r)=>({x:t+Math.cos(-Tx*r)*n,y:e+Math.sin(-Tx*r)*n}),s2e=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(r.left||0)-(r.right||0)),Math.abs(n-(r.top||0)-(r.bottom||0)))/2},i2e=(t,e)=>{var{x:n,y:r}=t,{x:s,y:i}=e;return Math.sqrt((n-s)**2+(r-i)**2)},o2e=(t,e)=>{var{x:n,y:r}=t,{cx:s,cy:i}=e,o=i2e({x:n,y:r},{x:s,y:i});if(o<=0)return{radius:o,angle:0};var a=(n-s)/o,l=Math.acos(a);return r>i&&(l=2*Math.PI-l),{radius:o,angle:r2e(l),angleInRadian:l}},a2e=t=>{var{startAngle:e,endAngle:n}=t,r=Math.floor(e/360),s=Math.floor(n/360),i=Math.min(r,s);return{startAngle:e-i*360,endAngle:n-i*360}},l2e=(t,e)=>{var{startAngle:n,endAngle:r}=e,s=Math.floor(n/360),i=Math.floor(r/360),o=Math.min(s,i);return t+o*360},u2e=(t,e)=>{var{x:n,y:r}=t,{radius:s,angle:i}=o2e({x:n,y:r},e),{innerRadius:o,outerRadius:a}=e;if(s<o||s>a||s===0)return null;var{startAngle:l,endAngle:u}=a2e(e),c=i,d;if(l<=u){for(;c>u;)c-=360;for(;c<l;)c+=360;d=c>=l&&c<=u}else{for(;c>l;)c-=360;for(;c<u;)c+=360;d=c>=u&&c<=l}return d?cL(cL({},e),{},{radius:s,angle:l2e(c,e)}):null};function k6(t,e,n){return Array.isArray(t)&&t&&e+n!==0?t.slice(e,n+1):t}function dL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function si(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dL(Object(n),!0).forEach(function(r){c2e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function c2e(t,e,n){return(e=d2e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d2e(t){var e=h2e(t,"string");return typeof e=="symbol"?e:e+""}function h2e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qn(t,e,n){return jt(t)||jt(e)?n:yi(e)?uc(t,e,n):typeof e=="function"?e(t):n}var f2e=(t,e,n,r,s)=>{var i,o=-1,a=(i=e==null?void 0:e.length)!==null&&i!==void 0?i:0;if(a<=1||t==null)return 0;if(r==="angleAxis"&&s!=null&&Math.abs(Math.abs(s[1]-s[0])-360)<=1e-6)for(var l=0;l<a;l++){var u=l>0?n[l-1].coordinate:n[a-1].coordinate,c=n[l].coordinate,d=l>=a-1?n[0].coordinate:n[l+1].coordinate,f=void 0;if(is(c-u)!==is(d-c)){var p=[];if(is(d-c)===is(s[1]-s[0])){f=d;var m=c+s[1]-s[0];p[0]=Math.min(m,(m+u)/2),p[1]=Math.max(m,(m+u)/2)}else{f=u;var y=d+s[1]-s[0];p[0]=Math.min(c,(y+c)/2),p[1]=Math.max(c,(y+c)/2)}var v=[Math.min(c,(f+c)/2),Math.max(c,(f+c)/2)];if(t>v[0]&&t<=v[1]||t>=p[0]&&t<=p[1]){({index:o}=n[l]);break}}else{var x=Math.min(u,d),b=Math.max(u,d);if(t>(x+c)/2&&t<=(b+c)/2){({index:o}=n[l]);break}}}else if(e){for(var _=0;_<a;_++)if(_===0&&t<=(e[_].coordinate+e[_+1].coordinate)/2||_>0&&_<a-1&&t>(e[_].coordinate+e[_-1].coordinate)/2&&t<=(e[_].coordinate+e[_+1].coordinate)/2||_===a-1&&t>(e[_].coordinate+e[_-1].coordinate)/2){({index:o}=e[_]);break}}return o},p2e=(t,e,n)=>{if(e&&n){var{width:r,height:s}=n,{align:i,verticalAlign:o,layout:a}=e;if((a==="vertical"||a==="horizontal"&&o==="middle")&&i!=="center"&&De(t[i]))return si(si({},t),{},{[i]:t[i]+(r||0)});if((a==="horizontal"||a==="vertical"&&i==="center")&&o!=="middle"&&De(t[o]))return si(si({},t),{},{[o]:t[o]+(s||0)})}return t},Hl=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",C6=(t,e,n,r)=>{if(r)return t.map(a=>a.coordinate);var s,i,o=t.map(a=>(a.coordinate===e&&(s=!0),a.coordinate===n&&(i=!0),a.coordinate));return s||o.push(e),i||o.push(n),o},T6=(t,e,n)=>{if(!t)return null;var{duplicateDomain:r,type:s,range:i,scale:o,realScaleType:a,isCategorical:l,categoricalDomain:u,tickCount:c,ticks:d,niceTicks:f,axisType:p}=t;if(!o)return null;var m=a==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,y=s==="category"&&o.bandwidth?o.bandwidth()/m:0;if(y=p==="angleAxis"&&i&&i.length>=2?is(i[0]-i[1])*2*y:y,d||f){var v=(d||f||[]).map((x,b)=>{var _=r?r.indexOf(x):x;return{coordinate:o(_)+y,value:x,offset:y,index:b}});return v.filter(x=>!Ur(x.coordinate))}return l&&u?u.map((x,b)=>({coordinate:o(x)+y,value:x,index:b,offset:y})):o.ticks&&c!=null?o.ticks(c).map((x,b)=>({coordinate:o(x)+y,value:x,offset:y,index:b})):o.domain().map((x,b)=>({coordinate:o(x)+y,value:r?r[x]:x,index:b,offset:y}))},hL=1e-4,m2e=t=>{var e=t.domain();if(!(!e||e.length<=2)){var n=e.length,r=t.range(),s=Math.min(r[0],r[1])-hL,i=Math.max(r[0],r[1])+hL,o=t(e[0]),a=t(e[n-1]);(o<s||o>i||a<s||a>i)&&t.domain([e[0],e[n-1]])}},g2e=(t,e)=>{if(!e||e.length!==2||!De(e[0])||!De(e[1]))return t;var n=Math.min(e[0],e[1]),r=Math.max(e[0],e[1]),s=[t[0],t[1]];return(!De(t[0])||t[0]<n)&&(s[0]=n),(!De(t[1])||t[1]>r)&&(s[1]=r),s[0]>r&&(s[0]=r),s[1]<n&&(s[1]=n),s},y2e=t=>{var e=t.length;if(!(e<=0))for(var n=0,r=t[0].length;n<r;++n)for(var s=0,i=0,o=0;o<e;++o){var a=Ur(t[o][n][1])?t[o][n][0]:t[o][n][1];a>=0?(t[o][n][0]=s,t[o][n][1]=s+a,s=t[o][n][1]):(t[o][n][0]=i,t[o][n][1]=i+a,i=t[o][n][1])}},v2e=t=>{var e=t.length;if(!(e<=0))for(var n=0,r=t[0].length;n<r;++n)for(var s=0,i=0;i<e;++i){var o=Ur(t[i][n][1])?t[i][n][0]:t[i][n][1];o>=0?(t[i][n][0]=s,t[i][n][1]=s+o,s=t[i][n][1]):(t[i][n][0]=0,t[i][n][1]=0)}},x2e={sign:y2e,expand:nIe,none:Yd,silhouette:rIe,wiggle:sIe,positive:v2e},b2e=(t,e,n)=>{var r=x2e[n],s=tIe().keys(e).value((i,o)=>+qn(i,o,0)).order(yT).offset(r);return s(t)};function w2e(t){return t==null?void 0:String(t)}function fL(t){var{axis:e,ticks:n,bandSize:r,entry:s,index:i,dataKey:o}=t;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!jt(s[e.dataKey])){var a=sH(n,"value",s[e.dataKey]);if(a)return a.coordinate+r/2}return n[i]?n[i].coordinate+r/2:null}var l=qn(s,jt(o)?e.dataKey:o);return jt(l)?null:e.scale(l)}var pL=t=>{var{axis:e,ticks:n,offset:r,bandSize:s,entry:i,index:o}=t;if(e.type==="category")return n[o]?n[o].coordinate+r:null;var a=qn(i,e.dataKey,e.scale.domain()[o]);return jt(a)?null:e.scale(a)-s/2+r},_2e=t=>{var{numericAxis:e}=t,n=e.scale.domain();if(e.type==="number"){var r=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]);return r<=0&&s>=0?0:s<0?s:r}return n[0]},S2e=t=>{var e=t.flat(2).filter(De);return[Math.min(...e),Math.max(...e)]},k2e=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],C2e=(t,e,n)=>{if(t!=null)return k2e(Object.keys(t).reduce((r,s)=>{var i=t[s],{stackedData:o}=i,a=o.reduce((l,u)=>{var c=k6(u,e,n),d=S2e(c);return[Math.min(l[0],d[0]),Math.max(l[1],d[1])]},[1/0,-1/0]);return[Math.min(a[0],r[0]),Math.max(a[1],r[1])]},[1/0,-1/0]))},mL=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,gL=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,_m=(t,e,n)=>{if(t&&t.scale&&t.scale.bandwidth){var r=t.scale.bandwidth();if(!n||r>0)return r}if(t&&e&&e.length>=2){for(var s=Q1(e,c=>c.coordinate),i=1/0,o=1,a=s.length;o<a;o++){var l=s[o],u=s[o-1];i=Math.min((l.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0};function yL(t){var{tooltipEntrySettings:e,dataKey:n,payload:r,value:s,name:i}=t;return si(si({},e),{},{dataKey:n,payload:r,value:s,name:i})}function i_(t,e){if(t)return String(t);if(typeof e=="string")return e}function T2e(t,e,n,r,s){if(n==="horizontal"||n==="vertical"){var i=t>=s.left&&t<=s.left+s.width&&e>=s.top&&e<=s.top+s.height;return i?{x:t,y:e}:null}return r?u2e({x:t,y:e},r):null}var N2e=(t,e,n,r)=>{var s=e.find(u=>u&&u.index===n);if(s){if(t==="horizontal")return{x:s.coordinate,y:r.y};if(t==="vertical")return{x:r.x,y:s.coordinate};if(t==="centric"){var i=s.coordinate,{radius:o}=r;return si(si(si({},r),cr(r.cx,r.cy,o,i)),{},{angle:i,radius:o})}var a=s.coordinate,{angle:l}=r;return si(si(si({},r),cr(r.cx,r.cy,a,l)),{},{angle:l,radius:a})}return{x:0,y:0}},I2e=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,Da=t=>t.layout.width,Ra=t=>t.layout.height,$2e=t=>t.layout.scale,N6=t=>t.layout.margin,PE=he(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),DE=he(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),E2e="data-recharts-item-index",A2e="data-recharts-item-data-key",o_=60;function vL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Va(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vL(Object(n),!0).forEach(function(r){O2e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function O2e(t,e,n){return(e=P2e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P2e(t){var e=D2e(t,"string");return typeof e=="symbol"?e:e+""}function D2e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var R2e=t=>t.brush.height,nr=he([Da,Ra,N6,R2e,PE,DE,QH,JIe],(t,e,n,r,s,i,o,a)=>{var l=i.reduce((m,y)=>{var{orientation:v}=y;if(!y.mirror&&!y.hide){var x=typeof y.width=="number"?y.width:o_;return Va(Va({},m),{},{[v]:m[v]+x})}return m},{left:n.left||0,right:n.right||0}),u=s.reduce((m,y)=>{var{orientation:v}=y;return!y.mirror&&!y.hide?Va(Va({},m),{},{[v]:uc(m,"".concat(v))+y.height}):m},{top:n.top||0,bottom:n.bottom||0}),c=Va(Va({},u),l),d=c.bottom;c.bottom+=r,c=p2e(c,o,a);var f=t-c.left-c.right,p=e-c.top-c.bottom;return Va(Va({brushBottom:d},c),{},{width:Math.max(f,0),height:Math.max(p,0)})}),L2e=he(nr,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),I6=he(Da,Ra,(t,e)=>({x:0,y:0,width:t,height:e})),F2e=E.createContext(null),qr=()=>E.useContext(F2e)!=null,a_=t=>t.brush,l_=he([a_,nr,N6],(t,e,n)=>({height:t.height,x:De(t.x)?t.x:e.left,y:De(t.y)?t.y:e.top+e.height+e.brushBottom-((n==null?void 0:n.bottom)||0),width:De(t.width)?t.width:e.width})),u_=()=>{var t,e=qr(),n=Fe(L2e),r=Fe(l_),s=(t=Fe(a_))===null||t===void 0?void 0:t.padding;return!e||!r||!s?n:{width:r.width-s.left-s.right,height:r.height-s.top-s.bottom,x:s.left,y:s.top}},M2e={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},$6=()=>{var t;return(t=Fe(nr))!==null&&t!==void 0?t:M2e},RE=()=>Fe(Da),LE=()=>Fe(Ra),z2e={top:0,right:0,bottom:0,left:0},B2e=()=>{var t;return(t=Fe(e=>e.layout.margin))!==null&&t!==void 0?t:z2e},yt=t=>t.layout.layoutType,c_=()=>Fe(yt),j2e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},E6=Vs({name:"legend",initialState:j2e,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var n=la(t).payload.indexOf(e.payload);n>-1&&t.payload.splice(n,1)}}}),{setLegendSize:xL,setLegendSettings:V2e,addLegendPayload:W2e,removeLegendPayload:U2e}=E6.actions,G2e=E6.reducer,H2e=["contextPayload"];function IT(){return IT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},IT.apply(null,arguments)}function bL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function eh(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bL(Object(n),!0).forEach(function(r){FE(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function FE(t,e,n){return(e=K2e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K2e(t){var e=q2e(t,"string");return typeof e=="symbol"?e:e+""}function q2e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X2e(t,e){if(t==null)return{};var n,r,s=Z2e(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Z2e(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Y2e(t){return t.value}function Q2e(t){var{contextPayload:e}=t,n=X2e(t,H2e),r=jH(e,t.payloadUniqBy,Y2e),s=eh(eh({},n),{},{payload:r});return E.isValidElement(t.content)?E.cloneElement(t.content,s):typeof t.content=="function"?E.createElement(t.content,s):E.createElement(yE,s)}function J2e(t,e,n,r,s,i){var{layout:o,align:a,verticalAlign:l}=e,u,c;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(a==="center"&&o==="vertical"?u={left:((r||0)-i.width)/2}:u=a==="right"?{right:n&&n.right||0}:{left:n&&n.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(l==="middle"?c={top:((s||0)-i.height)/2}:c=l==="bottom"?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),eh(eh({},u),c)}function eEe(t){var e=gn();return E.useEffect(()=>{e(V2e(t))},[e,t]),null}function tEe(t){var e=gn();return E.useEffect(()=>(e(xL(t)),()=>{e(xL({width:0,height:0}))}),[e,t]),null}function nEe(t){var e=n$e(),n=CNe(),r=B2e(),{width:s,height:i,wrapperStyle:o,portal:a}=t,[l,u]=JH([e]),c=RE(),d=LE(),f=c-(r.left||0)-(r.right||0),p=th.getWidthOrHeight(t.layout,i,s,f),m=a?o:eh(eh({position:"absolute",width:(p==null?void 0:p.width)||s||"auto",height:(p==null?void 0:p.height)||i||"auto"},J2e(o,t,r,c,d,l)),o),y=a??n;if(y==null)return null;var v=E.createElement("div",{className:"recharts-legend-wrapper",style:m,ref:u},E.createElement(eEe,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),E.createElement(tEe,{width:l.width,height:l.height}),E.createElement(Q2e,IT({},t,p,{margin:r,chartWidth:c,chartHeight:d,contextPayload:e})));return mb.createPortal(v,y)}class th extends E.PureComponent{static getWidthOrHeight(e,n,r,s){return e==="vertical"&&De(n)?{height:n}:e==="horizontal"?{width:r||s}:null}render(){return E.createElement(nEe,this.props)}}FE(th,"displayName","Legend");FE(th,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function $T(){return $T=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$T.apply(null,arguments)}function wL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function ok(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?wL(Object(n),!0).forEach(function(r){rEe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function rEe(t,e,n){return(e=sEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sEe(t){var e=iEe(t,"string");return typeof e=="symbol"?e:e+""}function iEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oEe(t){return Array.isArray(t)&&yi(t[0])&&yi(t[1])?t.join(" ~ "):t}var aEe=t=>{var{separator:e=" : ",contentStyle:n={},itemStyle:r={},labelStyle:s={},payload:i,formatter:o,itemSorter:a,wrapperClassName:l,labelClassName:u,label:c,labelFormatter:d,accessibilityLayer:f=!1}=t,p=()=>{if(i&&i.length){var k={padding:0,margin:0},T=(a?Q1(i,a):i).map(($,A)=>{if($.type==="none")return null;var D=$.formatter||o||oEe,{value:F,name:M}=$,j=F,H=M;if(D){var K=D(F,M,$,A,i);if(Array.isArray(K))[j,H]=K;else if(K!=null)j=K;else return null}var Q=ok({display:"block",paddingTop:4,paddingBottom:4,color:$.color||"#000"},r);return E.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:Q},yi(H)?E.createElement("span",{className:"recharts-tooltip-item-name"},H):null,yi(H)?E.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,E.createElement("span",{className:"recharts-tooltip-item-value"},j),E.createElement("span",{className:"recharts-tooltip-item-unit"},$.unit||""))});return E.createElement("ul",{className:"recharts-tooltip-item-list",style:k},T)}return null},m=ok({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),y=ok({margin:0},s),v=!jt(c),x=v?c:"",b=xt("recharts-default-tooltip",l),_=xt("recharts-tooltip-label",u);v&&d&&i!==void 0&&i!==null&&(x=d(c,i));var S=f?{role:"status","aria-live":"assertive"}:{};return E.createElement("div",$T({className:b,style:m},S),E.createElement("p",{className:_,style:y},E.isValidElement(x)?x:"".concat(x)),p())},rp="recharts-tooltip-wrapper",lEe={visibility:"hidden"};function uEe(t){var{coordinate:e,translateX:n,translateY:r}=t;return xt(rp,{["".concat(rp,"-right")]:De(n)&&e&&De(e.x)&&n>=e.x,["".concat(rp,"-left")]:De(n)&&e&&De(e.x)&&n<e.x,["".concat(rp,"-bottom")]:De(r)&&e&&De(e.y)&&r>=e.y,["".concat(rp,"-top")]:De(r)&&e&&De(e.y)&&r<e.y})}function _L(t){var{allowEscapeViewBox:e,coordinate:n,key:r,offsetTopLeft:s,position:i,reverseDirection:o,tooltipDimension:a,viewBox:l,viewBoxDimension:u}=t;if(i&&De(i[r]))return i[r];var c=n[r]-a-(s>0?s:0),d=n[r]+s;if(e[r])return o[r]?c:d;var f=l[r];if(f==null)return 0;if(o[r]){var p=c,m=f;return p<m?Math.max(d,f):Math.max(c,f)}if(u==null)return 0;var y=d+a,v=f+u;return y>v?Math.max(c,f):Math.max(d,f)}function cEe(t){var{translateX:e,translateY:n,useTranslate3d:r}=t;return{transform:r?"translate3d(".concat(e,"px, ").concat(n,"px, 0)"):"translate(".concat(e,"px, ").concat(n,"px)")}}function dEe(t){var{allowEscapeViewBox:e,coordinate:n,offsetTopLeft:r,position:s,reverseDirection:i,tooltipBox:o,useTranslate3d:a,viewBox:l}=t,u,c,d;return o.height>0&&o.width>0&&n?(c=_L({allowEscapeViewBox:e,coordinate:n,key:"x",offsetTopLeft:r,position:s,reverseDirection:i,tooltipDimension:o.width,viewBox:l,viewBoxDimension:l.width}),d=_L({allowEscapeViewBox:e,coordinate:n,key:"y",offsetTopLeft:r,position:s,reverseDirection:i,tooltipDimension:o.height,viewBox:l,viewBoxDimension:l.height}),u=cEe({translateX:c,translateY:d,useTranslate3d:a})):u=lEe,{cssProperties:u,cssClasses:uEe({translateX:c,translateY:d,coordinate:n})}}function SL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Bv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?SL(Object(n),!0).forEach(function(r){ET(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):SL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ET(t,e,n){return(e=hEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hEe(t){var e=fEe(t,"string");return typeof e=="symbol"?e:e+""}function fEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pEe extends E.PureComponent{constructor(){super(...arguments),ET(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),ET(this,"handleKeyDown",e=>{if(e.key==="Escape"){var n,r,s,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==null&&n!==void 0?n:0,y:(s=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&s!==void 0?s:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,n;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:n,animationDuration:r,animationEasing:s,children:i,coordinate:o,hasPayload:a,isAnimationActive:l,offset:u,position:c,reverseDirection:d,useTranslate3d:f,viewBox:p,wrapperStyle:m,lastBoundingBox:y,innerRef:v,hasPortalFromProps:x}=this.props,{cssClasses:b,cssProperties:_}=dEe({allowEscapeViewBox:n,coordinate:o,offsetTopLeft:u,position:c,reverseDirection:d,tooltipBox:{height:y.height,width:y.width},useTranslate3d:f,viewBox:p}),S=x?{}:Bv(Bv({transition:l&&e?"transform ".concat(r,"ms ").concat(s):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&a?"visible":"hidden",position:"absolute",top:0,left:0}),k=Bv(Bv({},S),{},{visibility:!this.state.dismissed&&e&&a?"visible":"hidden"},m);return E.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:b,style:k,ref:v},i)}}var mEe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),_f={isSsr:mEe()},A6=()=>Fe(t=>t.rootProps.accessibilityLayer);function Fs(t){return Number.isFinite(t)}function Nx(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function AT(){return AT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},AT.apply(null,arguments)}function kL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function CL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kL(Object(n),!0).forEach(function(r){gEe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function gEe(t,e,n){return(e=yEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yEe(t){var e=vEe(t,"string");return typeof e=="symbol"?e:e+""}function vEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var TL={curveBasisClosed:UNe,curveBasisOpen:GNe,curveBasis:WNe,curveBumpX:$Ne,curveBumpY:ENe,curveLinearClosed:HNe,curveLinear:G1,curveMonotoneX:KNe,curveMonotoneY:qNe,curveNatural:XNe,curveStep:ZNe,curveStepAfter:QNe,curveStepBefore:YNe},jv=t=>Fs(t.x)&&Fs(t.y),sp=t=>t.x,ip=t=>t.y,xEe=(t,e)=>{if(typeof t=="function")return t;var n="curve".concat(ky(t));return(n==="curveMonotone"||n==="curveBump")&&e?TL["".concat(n).concat(e==="vertical"?"Y":"X")]:TL[n]||G1},bEe=t=>{var{type:e="linear",points:n=[],baseLine:r,layout:s,connectNulls:i=!1}=t,o=xEe(e,s),a=i?n.filter(jv):n,l;if(Array.isArray(r)){var u=i?r.filter(d=>jv(d)):r,c=a.map((d,f)=>CL(CL({},d),{},{base:u[f]}));return s==="vertical"?l=Rv().y(ip).x1(sp).x0(d=>d.base.x):l=Rv().x(sp).y1(ip).y0(d=>d.base.y),l.defined(jv).curve(o),l(c)}return s==="vertical"&&De(r)?l=Rv().y(ip).x1(sp).x0(r):De(r)?l=Rv().x(sp).y1(ip).y0(r):l=pH().x(sp).y(ip),l.defined(jv).curve(o),l(a)},O6=t=>{var{className:e,points:n,path:r,pathRef:s}=t;if((!n||!n.length)&&!r)return null;var i=n&&n.length?bEe(t):r;return E.createElement("path",AT({},Pc(t),uE(t),{className:xt("recharts-curve",e),d:i===null?void 0:i,ref:s}))},wEe=["x","y","top","left","width","height","className"];function OT(){return OT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},OT.apply(null,arguments)}function NL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function _Ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?NL(Object(n),!0).forEach(function(r){SEe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):NL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function SEe(t,e,n){return(e=kEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kEe(t){var e=CEe(t,"string");return typeof e=="symbol"?e:e+""}function CEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TEe(t,e){if(t==null)return{};var n,r,s=NEe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function NEe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var IEe=(t,e,n,r,s,i)=>"M".concat(t,",").concat(s,"v").concat(r,"M").concat(i,",").concat(e,"h").concat(n),$Ee=t=>{var{x:e=0,y:n=0,top:r=0,left:s=0,width:i=0,height:o=0,className:a}=t,l=TEe(t,wEe),u=_Ee({x:e,y:n,top:r,left:s,width:i,height:o},l);return!De(e)||!De(n)||!De(i)||!De(o)||!De(r)||!De(s)?null:E.createElement("path",OT({},Qt(u,!0),{className:xt("recharts-cross",a),d:IEe(e,n,i,o,r,s)}))};function EEe(t,e,n,r){var s=r/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-s:n.left+.5,y:t==="horizontal"?n.top+.5:e.y-s,width:t==="horizontal"?r:n.width-1,height:t==="horizontal"?n.height-1:r}}function IL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function AEe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?IL(Object(n),!0).forEach(function(r){OEe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):IL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function OEe(t,e,n){return(e=PEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PEe(t){var e=DEe(t,"string");return typeof e=="symbol"?e:e+""}function DEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bo(t,e){var n=AEe({},t),r=e,s=Object.keys(e),i=s.reduce((o,a)=>(o[a]===void 0&&r[a]!==void 0&&(o[a]=r[a]),o),n);return i}var P6={},D6={},R6={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){if(!n||typeof n!="object")return!1;const r=Object.getPrototypeOf(n);return r===null||r===Object.prototype||Object.getPrototypeOf(r)===null?Object.prototype.toString.call(n)==="[object Object]":!1}t.isPlainObject=e})(R6);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=R6,n=SE,r=X1,s=Z1,i=q1;function o(u,c,d){return a(u,c,void 0,void 0,void 0,void 0,d)}function a(u,c,d,f,p,m,y){const v=y(u,c,d,f,p,m);if(v!==void 0)return v;if(typeof u==typeof c)switch(typeof u){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return u===c;case"number":return u===c||Object.is(u,c);case"function":return u===c;case"object":return l(u,c,m,y)}return l(u,c,m,y)}function l(u,c,d,f){if(Object.is(u,c))return!0;let p=r.getTag(u),m=r.getTag(c);if(p===s.argumentsTag&&(p=s.objectTag),m===s.argumentsTag&&(m=s.objectTag),p!==m)return!1;switch(p){case s.stringTag:return u.toString()===c.toString();case s.numberTag:{const x=u.valueOf(),b=c.valueOf();return i.eq(x,b)}case s.booleanTag:case s.dateTag:case s.symbolTag:return Object.is(u.valueOf(),c.valueOf());case s.regexpTag:return u.source===c.source&&u.flags===c.flags;case s.functionTag:return u===c}d=d??new Map;const y=d.get(u),v=d.get(c);if(y!=null&&v!=null)return y===c;d.set(u,c),d.set(c,u);try{switch(p){case s.mapTag:{if(u.size!==c.size)return!1;for(const[x,b]of u.entries())if(!c.has(x)||!a(b,c.get(x),x,u,c,d,f))return!1;return!0}case s.setTag:{if(u.size!==c.size)return!1;const x=Array.from(u.values()),b=Array.from(c.values());for(let _=0;_<x.length;_++){const S=x[_],k=b.findIndex(T=>a(S,T,void 0,u,c,d,f));if(k===-1)return!1;b.splice(k,1)}return!0}case s.arrayTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:case s.bigUint64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.bigInt64ArrayTag:case s.float32ArrayTag:case s.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(u)!==Buffer.isBuffer(c)||u.length!==c.length)return!1;for(let x=0;x<u.length;x++)if(!a(u[x],c[x],x,u,c,d,f))return!1;return!0}case s.arrayBufferTag:return u.byteLength!==c.byteLength?!1:l(new Uint8Array(u),new Uint8Array(c),d,f);case s.dataViewTag:return u.byteLength!==c.byteLength||u.byteOffset!==c.byteOffset?!1:l(new Uint8Array(u),new Uint8Array(c),d,f);case s.errorTag:return u.name===c.name&&u.message===c.message;case s.objectTag:{if(!(l(u.constructor,c.constructor,d,f)||e.isPlainObject(u)&&e.isPlainObject(c)))return!1;const b=[...Object.keys(u),...n.getSymbols(u)],_=[...Object.keys(c),...n.getSymbols(c)];if(b.length!==_.length)return!1;for(let S=0;S<b.length;S++){const k=b[S],T=u[k];if(!Object.hasOwn(c,k))return!1;const $=c[k];if(!a(T,$,k,u,c,d,f))return!1}return!0}default:return!1}}finally{d.delete(u),d.delete(c)}}t.isEqualWith=o})(D6);var L6={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(){}t.noop=e})(L6);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=D6,n=L6;function r(s,i){return e.isEqualWith(s,i,n.noop)}t.isEqual=r})(P6);var REe=P6.isEqual;const LEe=wi(REe);var Ix=1e-4,F6=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],M6=(t,e)=>t.map((n,r)=>n*e**r).reduce((n,r)=>n+r),$L=(t,e)=>n=>{var r=F6(t,e);return M6(r,n)},FEe=(t,e)=>n=>{var r=F6(t,e),s=[...r.map((i,o)=>i*o).slice(1),0];return M6(s,n)},EL=function(){for(var e,n,r,s,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];if(o.length===1)switch(o[0]){case"linear":[e,r,n,s]=[0,0,1,1];break;case"ease":[e,r,n,s]=[.25,.1,.25,1];break;case"ease-in":[e,r,n,s]=[.42,0,1,1];break;case"ease-out":[e,r,n,s]=[.42,0,.58,1];break;case"ease-in-out":[e,r,n,s]=[0,0,.58,1];break;default:{var l=o[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([e,r,n,s]=l[1].split(")")[0].split(",").map(m=>parseFloat(m)))}}else o.length===4&&([e,r,n,s]=o);var u=$L(e,n),c=$L(r,s),d=FEe(e,n),f=m=>m>1?1:m<0?0:m,p=m=>{for(var y=m>1?1:m,v=y,x=0;x<8;++x){var b=u(v)-y,_=d(v);if(Math.abs(b-y)<Ix||_<Ix)return c(v);v=f(v-b/_)}return c(v)};return p.isStepper=!1,p},MEe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:r=8,dt:s=17}=e,i=(o,a,l)=>{var u=-(o-a)*n,c=l*r,d=l+(u-c)*s/1e3,f=l*s/1e3+o;return Math.abs(f-a)<Ix&&Math.abs(d)<Ix?[a,0]:[f,d]};return i.isStepper=!0,i.dt=s,i},z6=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return EL(t);case"spring":return MEe();default:if(t.split("(")[0]==="cubic-bezier")return EL(t)}return typeof t=="function"?t:null};function AL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function OL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AL(Object(n),!0).forEach(function(r){zEe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function zEe(t,e,n){return(e=BEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BEe(t){var e=jEe(t,"string");return typeof e=="symbol"?e:e+""}function jEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VEe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),WEe=(t,e,n)=>t.map(r=>"".concat(VEe(r)," ").concat(e,"ms ").concat(n)).join(","),UEe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((n,r)=>n.filter(s=>r.includes(s))),Sm=(t,e)=>Object.keys(e).reduce((n,r)=>OL(OL({},n),{},{[r]:t(r,e[r])}),{});function PL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function ar(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?PL(Object(n),!0).forEach(function(r){GEe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):PL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function GEe(t,e,n){return(e=HEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HEe(t){var e=KEe(t,"string");return typeof e=="symbol"?e:e+""}function KEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $x=(t,e,n)=>t+(e-t)*n,PT=t=>{var{from:e,to:n}=t;return e!==n},B6=(t,e,n)=>{var r=Sm((s,i)=>{if(PT(i)){var[o,a]=t(i.from,i.to,i.velocity);return ar(ar({},i),{},{from:o,velocity:a})}return i},e);return n<1?Sm((s,i)=>PT(i)?ar(ar({},i),{},{velocity:$x(i.velocity,r[s].velocity,n),from:$x(i.from,r[s].from,n)}):i,e):B6(t,r,n-1)};function qEe(t,e,n,r,s,i){var o,a=r.reduce((f,p)=>ar(ar({},f),{},{[p]:{from:t[p],velocity:0,to:e[p]}}),{}),l=()=>Sm((f,p)=>p.from,a),u=()=>!Object.values(a).filter(PT).length,c=null,d=f=>{o||(o=f);var p=f-o,m=p/n.dt;a=B6(n,a,m),s(ar(ar(ar({},t),e),l())),o=f,u()||(c=i.setTimeout(d))};return()=>(c=i.setTimeout(d),()=>{c()})}function XEe(t,e,n,r,s,i,o){var a=null,l=s.reduce((d,f)=>ar(ar({},d),{},{[f]:[t[f],e[f]]}),{}),u,c=d=>{u||(u=d);var f=(d-u)/r,p=Sm((y,v)=>$x(...v,n(f)),l);if(i(ar(ar(ar({},t),e),p)),f<1)a=o.setTimeout(c);else{var m=Sm((y,v)=>$x(...v,n(1)),l);i(ar(ar(ar({},t),e),m))}};return()=>(a=o.setTimeout(c),()=>{a()})}const j6=(t,e,n,r,s,i)=>{var o=UEe(t,e);return n.isStepper===!0?qEe(t,e,n,o,s,i):XEe(t,e,n,r,o,s,i)};function ZEe(t){var e,n=()=>null,r=!1,s=null,i=o=>{if(!r){if(Array.isArray(o)){if(!o.length)return;var a=o,[l,...u]=a;if(typeof l=="number"){s=t.setTimeout(i.bind(null,u),l);return}i(l),s=t.setTimeout(i.bind(null,u));return}typeof o=="string"&&(e=o,n(e)),typeof o=="object"&&(e=o,n(e)),typeof o=="function"&&o()}};return{stop:()=>{r=!0},start:o=>{r=!1,s&&(s(),s=null),i(o)},subscribe:o=>(n=o,()=>{n=()=>null}),getTimeoutController:()=>t}}class YEe{setTimeout(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=performance.now(),s=null,i=o=>{o-r>=n?e(o):typeof requestAnimationFrame=="function"&&(s=requestAnimationFrame(i))};return s=requestAnimationFrame(i),()=>{cancelAnimationFrame(s)}}}function QEe(){return ZEe(new YEe)}var JEe=E.createContext(QEe);function V6(t,e){var n=E.useContext(JEe);return E.useMemo(()=>e??n(t),[t,e,n])}var eAe=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function DT(){return DT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},DT.apply(null,arguments)}function tAe(t,e){if(t==null)return{};var n,r,s=nAe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function nAe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function DL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Wa(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?DL(Object(n),!0).forEach(function(r){Iu(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):DL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Iu(t,e,n){return(e=rAe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rAe(t){var e=sAe(t,"string");return typeof e=="symbol"?e:e+""}function sAe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ME extends E.PureComponent{constructor(e,n){super(e,n),Iu(this,"mounted",!1),Iu(this,"manager",void 0),Iu(this,"stopJSAnimation",null),Iu(this,"unSubscribe",null);var{isActive:r,attributeName:s,from:i,to:o,children:a,duration:l,animationManager:u}=this.props;if(this.manager=u,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!r||l<=0){this.state={style:{}},typeof a=="function"&&(this.state={style:o});return}if(i){if(typeof a=="function"){this.state={style:i};return}this.state={style:s?{[s]:i}:i}}else this.state={style:{}}}componentDidMount(){var{isActive:e,canBegin:n}=this.props;this.mounted=!0,!(!e||!n)&&this.runAnimation(this.props)}componentDidUpdate(e){var{isActive:n,canBegin:r,attributeName:s,shouldReAnimate:i,to:o,from:a}=this.props,{style:l}=this.state;if(r){if(!n){var u={style:s?{[s]:o}:o};this.state&&l&&(s&&l[s]!==o||!s&&l!==o)&&this.setState(u);return}if(!(LEe(e.to,o)&&e.canBegin&&e.isActive)){var c=!e.canBegin||!e.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var d=c||i?a:e.to;if(this.state&&l){var f={style:s?{[s]:d}:d};(s&&l[s]!==d||!s&&l!==d)&&this.setState(f)}this.runAnimation(Wa(Wa({},this.props),{},{from:d,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:e}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}handleStyleChange(e){this.changeStyle(e)}changeStyle(e){this.mounted&&this.setState({style:e})}runJSAnimation(e){var{from:n,to:r,duration:s,easing:i,begin:o,onAnimationEnd:a,onAnimationStart:l}=e,u=j6(n,r,z6(i),s,this.changeStyle,this.manager.getTimeoutController()),c=()=>{this.stopJSAnimation=u()};this.manager.start([l,o,c,s,a])}runAnimation(e){var{begin:n,duration:r,attributeName:s,to:i,easing:o,onAnimationStart:a,onAnimationEnd:l,children:u}=e;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof o=="function"||typeof u=="function"||o==="spring"){this.runJSAnimation(e);return}var c=s?{[s]:i}:i,d=WEe(Object.keys(c),r,o);this.manager.start([a,n,Wa(Wa({},c),{},{transition:d}),r,l])}render(){var e=this.props,{children:n,begin:r,duration:s,attributeName:i,easing:o,isActive:a,from:l,to:u,canBegin:c,onAnimationEnd:d,shouldReAnimate:f,onAnimationReStart:p,animationManager:m}=e,y=tAe(e,eAe),v=E.Children.count(n),x=this.state.style;if(typeof n=="function")return n(x);if(!a||v===0||s<=0)return n;var b=_=>{var{style:S={},className:k}=_.props,T=E.cloneElement(_,Wa(Wa({},y),{},{style:Wa(Wa({},S),x),className:k}));return T};return v===1?b(E.Children.only(n)):E.createElement("div",null,E.Children.map(n,_=>b(_)))}}Iu(ME,"displayName","Animate");Iu(ME,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});function Ex(t){var e,n=V6((e=t.attributeName)!==null&&e!==void 0?e:Object.keys(t.to).join(","),t.animationManager);return E.createElement(ME,DT({},t,{animationManager:n}))}function Ax(){return Ax=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ax.apply(null,arguments)}var RL=(t,e,n,r,s)=>{var i=Math.min(Math.abs(n)/2,Math.abs(r)/2),o=r>=0?1:-1,a=n>=0?1:-1,l=r>=0&&n>=0||r<0&&n<0?1:0,u;if(i>0&&s instanceof Array){for(var c=[0,0,0,0],d=0,f=4;d<f;d++)c[d]=s[d]>i?i:s[d];u="M".concat(t,",").concat(e+o*c[0]),c[0]>0&&(u+="A ".concat(c[0],",").concat(c[0],",0,0,").concat(l,",").concat(t+a*c[0],",").concat(e)),u+="L ".concat(t+n-a*c[1],",").concat(e),c[1]>0&&(u+="A ".concat(c[1],",").concat(c[1],",0,0,").concat(l,`,
        `).concat(t+n,",").concat(e+o*c[1])),u+="L ".concat(t+n,",").concat(e+r-o*c[2]),c[2]>0&&(u+="A ".concat(c[2],",").concat(c[2],",0,0,").concat(l,`,
        `).concat(t+n-a*c[2],",").concat(e+r)),u+="L ".concat(t+a*c[3],",").concat(e+r),c[3]>0&&(u+="A ".concat(c[3],",").concat(c[3],",0,0,").concat(l,`,
        `).concat(t,",").concat(e+r-o*c[3])),u+="Z"}else if(i>0&&s===+s&&s>0){var p=Math.min(i,s);u="M ".concat(t,",").concat(e+o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+a*p,",").concat(e,`
            L `).concat(t+n-a*p,",").concat(e,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+n,",").concat(e+o*p,`
            L `).concat(t+n,",").concat(e+r-o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+n-a*p,",").concat(e+r,`
            L `).concat(t+a*p,",").concat(e+r,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t,",").concat(e+r-o*p," Z")}else u="M ".concat(t,",").concat(e," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return u},iAe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},W6=t=>{var e=Bo(t,iAe),n=E.useRef(null),[r,s]=E.useState(-1);E.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var x=n.current.getTotalLength();x&&s(x)}catch{}},[]);var{x:i,y:o,width:a,height:l,radius:u,className:c}=e,{animationEasing:d,animationDuration:f,animationBegin:p,isAnimationActive:m,isUpdateAnimationActive:y}=e;if(i!==+i||o!==+o||a!==+a||l!==+l||a===0||l===0)return null;var v=xt("recharts-rectangle",c);return y?E.createElement(Ex,{canBegin:r>0,from:{width:a,height:l,x:i,y:o},to:{width:a,height:l,x:i,y:o},duration:f,animationEasing:d,isActive:y},x=>{var{width:b,height:_,x:S,y:k}=x;return E.createElement(Ex,{canBegin:r>0,from:"0px ".concat(r===-1?1:r,"px"),to:"".concat(r,"px 0px"),attributeName:"strokeDasharray",begin:p,duration:f,isActive:m,easing:d},E.createElement("path",Ax({},Qt(e,!0),{className:v,d:RL(S,k,b,_,u),ref:n})))}):E.createElement("path",Ax({},Qt(e,!0),{className:v,d:RL(i,o,a,l,u)}))};function U6(t){var{cx:e,cy:n,radius:r,startAngle:s,endAngle:i}=t,o=cr(e,n,r,s),a=cr(e,n,r,i);return{points:[o,a],cx:e,cy:n,radius:r,startAngle:s,endAngle:i}}function RT(){return RT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},RT.apply(null,arguments)}var oAe=(t,e)=>{var n=is(e-t),r=Math.min(Math.abs(e-t),359.999);return n*r},Vv=t=>{var{cx:e,cy:n,radius:r,angle:s,sign:i,isExternal:o,cornerRadius:a,cornerIsExternal:l}=t,u=a*(o?1:-1)+r,c=Math.asin(a/u)/Tx,d=l?s:s+i*c,f=cr(e,n,u,d),p=cr(e,n,r,d),m=l?s-i*c:s,y=cr(e,n,u*Math.cos(c*Tx),m);return{center:f,circleTangency:p,lineTangency:y,theta:c}},G6=t=>{var{cx:e,cy:n,innerRadius:r,outerRadius:s,startAngle:i,endAngle:o}=t,a=oAe(i,o),l=i+a,u=cr(e,n,s,i),c=cr(e,n,s,l),d="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(a)>180),",").concat(+(i>l),`,
    `).concat(c.x,",").concat(c.y,`
  `);if(r>0){var f=cr(e,n,r,i),p=cr(e,n,r,l);d+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(a)>180),",").concat(+(i<=l),`,
            `).concat(f.x,",").concat(f.y," Z")}else d+="L ".concat(e,",").concat(n," Z");return d},aAe=t=>{var{cx:e,cy:n,innerRadius:r,outerRadius:s,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:a,startAngle:l,endAngle:u}=t,c=is(u-l),{circleTangency:d,lineTangency:f,theta:p}=Vv({cx:e,cy:n,radius:s,angle:l,sign:c,cornerRadius:i,cornerIsExternal:a}),{circleTangency:m,lineTangency:y,theta:v}=Vv({cx:e,cy:n,radius:s,angle:u,sign:-c,cornerRadius:i,cornerIsExternal:a}),x=a?Math.abs(l-u):Math.abs(l-u)-p-v;if(x<0)return o?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):G6({cx:e,cy:n,innerRadius:r,outerRadius:s,startAngle:l,endAngle:u});var b="M ".concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(c<0),",").concat(d.x,",").concat(d.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(x>180),",").concat(+(c<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(c<0),",").concat(y.x,",").concat(y.y,`
  `);if(r>0){var{circleTangency:_,lineTangency:S,theta:k}=Vv({cx:e,cy:n,radius:r,angle:l,sign:c,isExternal:!0,cornerRadius:i,cornerIsExternal:a}),{circleTangency:T,lineTangency:$,theta:A}=Vv({cx:e,cy:n,radius:r,angle:u,sign:-c,isExternal:!0,cornerRadius:i,cornerIsExternal:a}),D=a?Math.abs(l-u):Math.abs(l-u)-k-A;if(D<0&&i===0)return"".concat(b,"L").concat(e,",").concat(n,"Z");b+="L".concat($.x,",").concat($.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(c<0),",").concat(T.x,",").concat(T.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(D>180),",").concat(+(c>0),",").concat(_.x,",").concat(_.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(c<0),",").concat(S.x,",").concat(S.y,"Z")}else b+="L".concat(e,",").concat(n,"Z");return b},lAe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},H6=t=>{var e=Bo(t,lAe),{cx:n,cy:r,innerRadius:s,outerRadius:i,cornerRadius:o,forceCornerRadius:a,cornerIsExternal:l,startAngle:u,endAngle:c,className:d}=e;if(i<s||u===c)return null;var f=xt("recharts-sector",d),p=i-s,m=no(o,p,0,!0),y;return m>0&&Math.abs(u-c)<360?y=aAe({cx:n,cy:r,innerRadius:s,outerRadius:i,cornerRadius:Math.min(m,p/2),forceCornerRadius:a,cornerIsExternal:l,startAngle:u,endAngle:c}):y=G6({cx:n,cy:r,innerRadius:s,outerRadius:i,startAngle:u,endAngle:c}),E.createElement("path",RT({},Qt(e,!0),{className:f,d:y}))};function uAe(t,e,n){var r,s,i,o;if(t==="horizontal")r=e.x,i=r,s=n.top,o=n.top+n.height;else if(t==="vertical")s=e.y,o=s,r=n.left,i=n.left+n.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var{cx:a,cy:l,innerRadius:u,outerRadius:c,angle:d}=e,f=cr(a,l,u,d),p=cr(a,l,c,d);r=f.x,s=f.y,i=p.x,o=p.y}else return U6(e);return[{x:r,y:s},{x:i,y:o}]}var K6={},q6={},X6={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=TE;function n(r){return e.isSymbol(r)?NaN:Number(r)}t.toNumber=n})(X6);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=X6;function n(r){return r?(r=e.toNumber(r),r===1/0||r===-1/0?(r<0?-1:1)*Number.MAX_VALUE:r===r?r:0):r===0?r:0}t.toFinite=n})(q6);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=NE,n=q6;function r(s,i,o){o&&typeof o!="number"&&e.isIterateeCall(s,i,o)&&(i=o=void 0),s=n.toFinite(s),i===void 0?(i=s,s=0):i=n.toFinite(i),o=o===void 0?s<i?1:-1:n.toFinite(o);const a=Math.max(Math.ceil((i-s)/(o||1)),0),l=new Array(a);for(let u=0;u<a;u++)l[u]=s,s+=o;return l}t.range=r})(K6);var cAe=K6.range;const Z6=wi(cAe);function fl(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function dAe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function zE(t){let e,n,r;t.length!==2?(e=fl,n=(a,l)=>fl(t(a),l),r=(a,l)=>t(a)-l):(e=t===fl||t===dAe?t:hAe,n=t,r=t);function s(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const d=u+c>>>1;n(a[d],l)<0?u=d+1:c=d}while(u<c)}return u}function i(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const d=u+c>>>1;n(a[d],l)<=0?u=d+1:c=d}while(u<c)}return u}function o(a,l,u=0,c=a.length){const d=s(a,l,u,c-1);return d>u&&r(a[d-1],l)>-r(a[d],l)?d-1:d}return{left:s,center:o,right:i}}function hAe(){return 0}function Y6(t){return t===null?NaN:+t}function*fAe(t,e){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const pAe=zE(fl),Ty=pAe.right;zE(Y6).center;class LL extends Map{constructor(e,n=yAe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,s]of e)this.set(r,s)}get(e){return super.get(FL(this,e))}has(e){return super.has(FL(this,e))}set(e,n){return super.set(mAe(this,e),n)}delete(e){return super.delete(gAe(this,e))}}function FL({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function mAe({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function gAe({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function yAe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function vAe(t=fl){if(t===fl)return Q6;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function Q6(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const xAe=Math.sqrt(50),bAe=Math.sqrt(10),wAe=Math.sqrt(2);function Ox(t,e,n){const r=(e-t)/Math.max(0,n),s=Math.floor(Math.log10(r)),i=r/Math.pow(10,s),o=i>=xAe?10:i>=bAe?5:i>=wAe?2:1;let a,l,u;return s<0?(u=Math.pow(10,-s)/o,a=Math.round(t*u),l=Math.round(e*u),a/u<t&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,s)*o,a=Math.round(t/u),l=Math.round(e/u),a*u<t&&++a,l*u>e&&--l),l<a&&.5<=n&&n<2?Ox(t,e,n*2):[a,l,u]}function LT(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[s,i,o]=r?Ox(e,t,n):Ox(t,e,n);if(!(i>=s))return[];const a=i-s+1,l=new Array(a);if(r)if(o<0)for(let u=0;u<a;++u)l[u]=(i-u)/-o;else for(let u=0;u<a;++u)l[u]=(i-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(s+u)/-o;else for(let u=0;u<a;++u)l[u]=(s+u)*o;return l}function FT(t,e,n){return e=+e,t=+t,n=+n,Ox(t,e,n)[2]}function MT(t,e,n){e=+e,t=+t,n=+n;const r=e<t,s=r?FT(e,t,n):FT(t,e,n);return(r?-1:1)*(s<0?1/-s:s)}function ML(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function zL(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function J6(t,e,n=0,r=1/0,s){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(s=s===void 0?Q6:vAe(s);r>n;){if(r-n>600){const l=r-n+1,u=e-n+1,c=Math.log(l),d=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*d*(l-d)/l)*(u-l/2<0?-1:1),p=Math.max(n,Math.floor(e-u*d/l+f)),m=Math.min(r,Math.floor(e+(l-u)*d/l+f));J6(t,e,p,m,s)}const i=t[e];let o=n,a=r;for(op(t,n,e),s(t[r],i)>0&&op(t,n,r);o<a;){for(op(t,o,a),++o,--a;s(t[o],i)<0;)++o;for(;s(t[a],i)>0;)--a}s(t[n],i)===0?op(t,n,a):(++a,op(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function op(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function _Ae(t,e,n){if(t=Float64Array.from(fAe(t)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return zL(t);if(e>=1)return ML(t);var r,s=(r-1)*e,i=Math.floor(s),o=ML(J6(t,i).subarray(0,i+1)),a=zL(t.subarray(i+1));return o+(a-o)*(s-i)}}function SAe(t,e,n=Y6){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,s=(r-1)*e,i=Math.floor(s),o=+n(t[i],i,t),a=+n(t[i+1],i+1,t);return o+(a-o)*(s-i)}}function kAe(t,e,n){t=+t,e=+e,n=(s=arguments.length)<2?(e=t,t=0,1):s<3?1:+n;for(var r=-1,s=Math.max(0,Math.ceil((e-t)/n))|0,i=new Array(s);++r<s;)i[r]=t+r*n;return i}function Ci(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function La(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const zT=Symbol("implicit");function BE(){var t=new LL,e=[],n=[],r=zT;function s(i){let o=t.get(i);if(o===void 0){if(r!==zT)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return s.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new LL;for(const o of i)t.has(o)||t.set(o,e.push(o)-1);return s},s.range=function(i){return arguments.length?(n=Array.from(i),s):n.slice()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return BE(e,n).unknown(r)},Ci.apply(s,arguments),s}function jE(){var t=BE().unknown(void 0),e=t.domain,n=t.range,r=0,s=1,i,o,a=!1,l=0,u=0,c=.5;delete t.unknown;function d(){var f=e().length,p=s<r,m=p?s:r,y=p?r:s;i=(y-m)/Math.max(1,f-l+u*2),a&&(i=Math.floor(i)),m+=(y-m-i*(f-l))*c,o=i*(1-l),a&&(m=Math.round(m),o=Math.round(o));var v=kAe(f).map(function(x){return m+i*x});return n(p?v.reverse():v)}return t.domain=function(f){return arguments.length?(e(f),d()):e()},t.range=function(f){return arguments.length?([r,s]=f,r=+r,s=+s,d()):[r,s]},t.rangeRound=function(f){return[r,s]=f,r=+r,s=+s,a=!0,d()},t.bandwidth=function(){return o},t.step=function(){return i},t.round=function(f){return arguments.length?(a=!!f,d()):a},t.padding=function(f){return arguments.length?(l=Math.min(1,u=+f),d()):l},t.paddingInner=function(f){return arguments.length?(l=Math.min(1,f),d()):l},t.paddingOuter=function(f){return arguments.length?(u=+f,d()):u},t.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),d()):c},t.copy=function(){return jE(e(),[r,s]).round(a).paddingInner(l).paddingOuter(u).align(c)},Ci.apply(d(),arguments)}function e5(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return e5(e())},t}function CAe(){return e5(jE.apply(null,arguments).paddingInner(1))}function VE(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function t5(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ny(){}var km=.7,Px=1/km,Id="\\s*([+-]?\\d+)\\s*",Cm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Eo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",TAe=/^#([0-9a-f]{3,8})$/,NAe=new RegExp(`^rgb\\(${Id},${Id},${Id}\\)$`),IAe=new RegExp(`^rgb\\(${Eo},${Eo},${Eo}\\)$`),$Ae=new RegExp(`^rgba\\(${Id},${Id},${Id},${Cm}\\)$`),EAe=new RegExp(`^rgba\\(${Eo},${Eo},${Eo},${Cm}\\)$`),AAe=new RegExp(`^hsl\\(${Cm},${Eo},${Eo}\\)$`),OAe=new RegExp(`^hsla\\(${Cm},${Eo},${Eo},${Cm}\\)$`),BL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};VE(Ny,Tm,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:jL,formatHex:jL,formatHex8:PAe,formatHsl:DAe,formatRgb:VL,toString:VL});function jL(){return this.rgb().formatHex()}function PAe(){return this.rgb().formatHex8()}function DAe(){return n5(this).formatHsl()}function VL(){return this.rgb().formatRgb()}function Tm(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=TAe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?WL(e):n===3?new os(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Wv(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Wv(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=NAe.exec(t))?new os(e[1],e[2],e[3],1):(e=IAe.exec(t))?new os(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=$Ae.exec(t))?Wv(e[1],e[2],e[3],e[4]):(e=EAe.exec(t))?Wv(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=AAe.exec(t))?HL(e[1],e[2]/100,e[3]/100,1):(e=OAe.exec(t))?HL(e[1],e[2]/100,e[3]/100,e[4]):BL.hasOwnProperty(t)?WL(BL[t]):t==="transparent"?new os(NaN,NaN,NaN,0):null}function WL(t){return new os(t>>16&255,t>>8&255,t&255,1)}function Wv(t,e,n,r){return r<=0&&(t=e=n=NaN),new os(t,e,n,r)}function RAe(t){return t instanceof Ny||(t=Tm(t)),t?(t=t.rgb(),new os(t.r,t.g,t.b,t.opacity)):new os}function BT(t,e,n,r){return arguments.length===1?RAe(t):new os(t,e,n,r??1)}function os(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}VE(os,BT,t5(Ny,{brighter(t){return t=t==null?Px:Math.pow(Px,t),new os(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?km:Math.pow(km,t),new os(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new os(ju(this.r),ju(this.g),ju(this.b),Dx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:UL,formatHex:UL,formatHex8:LAe,formatRgb:GL,toString:GL}));function UL(){return`#${$u(this.r)}${$u(this.g)}${$u(this.b)}`}function LAe(){return`#${$u(this.r)}${$u(this.g)}${$u(this.b)}${$u((isNaN(this.opacity)?1:this.opacity)*255)}`}function GL(){const t=Dx(this.opacity);return`${t===1?"rgb(":"rgba("}${ju(this.r)}, ${ju(this.g)}, ${ju(this.b)}${t===1?")":`, ${t})`}`}function Dx(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ju(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function $u(t){return t=ju(t),(t<16?"0":"")+t.toString(16)}function HL(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ui(t,e,n,r)}function n5(t){if(t instanceof Ui)return new Ui(t.h,t.s,t.l,t.opacity);if(t instanceof Ny||(t=Tm(t)),!t)return new Ui;if(t instanceof Ui)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,s=Math.min(e,n,r),i=Math.max(e,n,r),o=NaN,a=i-s,l=(i+s)/2;return a?(e===i?o=(n-r)/a+(n<r)*6:n===i?o=(r-e)/a+2:o=(e-n)/a+4,a/=l<.5?i+s:2-i-s,o*=60):a=l>0&&l<1?0:o,new Ui(o,a,l,t.opacity)}function FAe(t,e,n,r){return arguments.length===1?n5(t):new Ui(t,e,n,r??1)}function Ui(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}VE(Ui,FAe,t5(Ny,{brighter(t){return t=t==null?Px:Math.pow(Px,t),new Ui(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?km:Math.pow(km,t),new Ui(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,s=2*n-r;return new os(ak(t>=240?t-240:t+120,s,r),ak(t,s,r),ak(t<120?t+240:t-120,s,r),this.opacity)},clamp(){return new Ui(KL(this.h),Uv(this.s),Uv(this.l),Dx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Dx(this.opacity);return`${t===1?"hsl(":"hsla("}${KL(this.h)}, ${Uv(this.s)*100}%, ${Uv(this.l)*100}%${t===1?")":`, ${t})`}`}}));function KL(t){return t=(t||0)%360,t<0?t+360:t}function Uv(t){return Math.max(0,Math.min(1,t||0))}function ak(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const WE=t=>()=>t;function MAe(t,e){return function(n){return t+n*e}}function zAe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function BAe(t){return(t=+t)==1?r5:function(e,n){return n-e?zAe(e,n,t):WE(isNaN(e)?n:e)}}function r5(t,e){var n=e-t;return n?MAe(t,n):WE(isNaN(t)?e:t)}const qL=function t(e){var n=BAe(e);function r(s,i){var o=n((s=BT(s)).r,(i=BT(i)).r),a=n(s.g,i.g),l=n(s.b,i.b),u=r5(s.opacity,i.opacity);return function(c){return s.r=o(c),s.g=a(c),s.b=l(c),s.opacity=u(c),s+""}}return r.gamma=t,r}(1);function jAe(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),s;return function(i){for(s=0;s<n;++s)r[s]=t[s]*(1-i)+e[s]*i;return r}}function VAe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function WAe(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,s=new Array(r),i=new Array(n),o;for(o=0;o<r;++o)s[o]=Sf(t[o],e[o]);for(;o<n;++o)i[o]=e[o];return function(a){for(o=0;o<r;++o)i[o]=s[o](a);return i}}function UAe(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Rx(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function GAe(t,e){var n={},r={},s;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in t?n[s]=Sf(t[s],e[s]):r[s]=e[s];return function(i){for(s in n)r[s]=n[s](i);return r}}var jT=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lk=new RegExp(jT.source,"g");function HAe(t){return function(){return t}}function KAe(t){return function(e){return t(e)+""}}function qAe(t,e){var n=jT.lastIndex=lk.lastIndex=0,r,s,i,o=-1,a=[],l=[];for(t=t+"",e=e+"";(r=jT.exec(t))&&(s=lk.exec(e));)(i=s.index)>n&&(i=e.slice(n,i),a[o]?a[o]+=i:a[++o]=i),(r=r[0])===(s=s[0])?a[o]?a[o]+=s:a[++o]=s:(a[++o]=null,l.push({i:o,x:Rx(r,s)})),n=lk.lastIndex;return n<e.length&&(i=e.slice(n),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?KAe(l[0].x):HAe(e):(e=l.length,function(u){for(var c=0,d;c<e;++c)a[(d=l[c]).i]=d.x(u);return a.join("")})}function Sf(t,e){var n=typeof e,r;return e==null||n==="boolean"?WE(e):(n==="number"?Rx:n==="string"?(r=Tm(e))?(e=r,qL):qAe:e instanceof Tm?qL:e instanceof Date?UAe:VAe(e)?jAe:Array.isArray(e)?WAe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?GAe:Rx)(t,e)}function UE(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function XAe(t,e){e===void 0&&(e=t,t=Sf);for(var n=0,r=e.length-1,s=e[0],i=new Array(r<0?0:r);n<r;)i[n]=t(s,s=e[++n]);return function(o){var a=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return i[a](o-a)}}function ZAe(t){return function(){return t}}function Lx(t){return+t}var XL=[0,1];function Rr(t){return t}function VT(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:ZAe(isNaN(e)?NaN:.5)}function YAe(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function QAe(t,e,n){var r=t[0],s=t[1],i=e[0],o=e[1];return s<r?(r=VT(s,r),i=n(o,i)):(r=VT(r,s),i=n(i,o)),function(a){return i(r(a))}}function JAe(t,e,n){var r=Math.min(t.length,e.length)-1,s=new Array(r),i=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)s[o]=VT(t[o],t[o+1]),i[o]=n(e[o],e[o+1]);return function(a){var l=Ty(t,a,1,r)-1;return i[l](s[l](a))}}function Iy(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function d_(){var t=XL,e=XL,n=Sf,r,s,i,o=Rr,a,l,u;function c(){var f=Math.min(t.length,e.length);return o!==Rr&&(o=YAe(t[0],t[f-1])),a=f>2?JAe:QAe,l=u=null,d}function d(f){return f==null||isNaN(f=+f)?i:(l||(l=a(t.map(r),e,n)))(r(o(f)))}return d.invert=function(f){return o(s((u||(u=a(e,t.map(r),Rx)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,Lx),c()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),c()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=UE,c()},d.clamp=function(f){return arguments.length?(o=f?!0:Rr,c()):o!==Rr},d.interpolate=function(f){return arguments.length?(n=f,c()):n},d.unknown=function(f){return arguments.length?(i=f,d):i},function(f,p){return r=f,s=p,c()}}function GE(){return d_()(Rr,Rr)}function eOe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Fx(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function nh(t){return t=Fx(Math.abs(t)),t?t[1]:NaN}function tOe(t,e){return function(n,r){for(var s=n.length,i=[],o=0,a=t[0],l=0;s>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),i.push(n.substring(s-=a,s+a)),!((l+=a+1)>r));)a=t[o=(o+1)%t.length];return i.reverse().join(e)}}function nOe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var rOe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Nm(t){if(!(e=rOe.exec(t)))throw new Error("invalid format: "+t);var e;return new HE({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Nm.prototype=HE.prototype;function HE(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}HE.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sOe(t){e:for(var e=t.length,n=1,r=-1,s;n<e;++n)switch(t[n]){case".":r=s=n;break;case"0":r===0&&(r=n),s=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(s+1):t}var s5;function iOe(t,e){var n=Fx(t,e);if(!n)return t+"";var r=n[0],s=n[1],i=s-(s5=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Fx(t,Math.max(0,e+i-1))[0]}function ZL(t,e){var n=Fx(t,e);if(!n)return t+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const YL={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:eOe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ZL(t*100,e),r:ZL,s:iOe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function QL(t){return t}var JL=Array.prototype.map,eF=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function oOe(t){var e=t.grouping===void 0||t.thousands===void 0?QL:tOe(JL.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",s=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?QL:nOe(JL.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(d){d=Nm(d);var f=d.fill,p=d.align,m=d.sign,y=d.symbol,v=d.zero,x=d.width,b=d.comma,_=d.precision,S=d.trim,k=d.type;k==="n"?(b=!0,k="g"):YL[k]||(_===void 0&&(_=12),S=!0,k="g"),(v||f==="0"&&p==="=")&&(v=!0,f="0",p="=");var T=y==="$"?n:y==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",$=y==="$"?r:/[%p]/.test(k)?o:"",A=YL[k],D=/[defgprs%]/.test(k);_=_===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function F(M){var j=T,H=$,K,Q,Z;if(k==="c")H=A(M)+H,M="";else{M=+M;var se=M<0||1/M<0;if(M=isNaN(M)?l:A(Math.abs(M),_),S&&(M=sOe(M)),se&&+M==0&&m!=="+"&&(se=!1),j=(se?m==="("?m:a:m==="-"||m==="("?"":m)+j,H=(k==="s"?eF[8+s5/3]:"")+H+(se&&m==="("?")":""),D){for(K=-1,Q=M.length;++K<Q;)if(Z=M.charCodeAt(K),48>Z||Z>57){H=(Z===46?s+M.slice(K+1):M.slice(K))+H,M=M.slice(0,K);break}}}b&&!v&&(M=e(M,1/0));var B=j.length+M.length+H.length,J=B<x?new Array(x-B+1).join(f):"";switch(b&&v&&(M=e(J+M,J.length?x-H.length:1/0),J=""),p){case"<":M=j+M+H+J;break;case"=":M=j+J+M+H;break;case"^":M=J.slice(0,B=J.length>>1)+j+M+H+J.slice(B);break;default:M=J+j+M+H;break}return i(M)}return F.toString=function(){return d+""},F}function c(d,f){var p=u((d=Nm(d),d.type="f",d)),m=Math.max(-8,Math.min(8,Math.floor(nh(f)/3)))*3,y=Math.pow(10,-m),v=eF[8+m/3];return function(x){return p(y*x)+v}}return{format:u,formatPrefix:c}}var Gv,KE,i5;aOe({thousands:",",grouping:[3],currency:["$",""]});function aOe(t){return Gv=oOe(t),KE=Gv.format,i5=Gv.formatPrefix,Gv}function lOe(t){return Math.max(0,-nh(Math.abs(t)))}function uOe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(nh(e)/3)))*3-nh(Math.abs(t)))}function cOe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,nh(e)-nh(t))+1}function o5(t,e,n,r){var s=MT(t,e,n),i;switch(r=Nm(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(i=uOe(s,o))&&(r.precision=i),i5(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(i=cOe(s,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=i-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(i=lOe(s))&&(r.precision=i-(r.type==="%")*2);break}}return KE(r)}function Kl(t){var e=t.domain;return t.ticks=function(n){var r=e();return LT(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var s=e();return o5(s[0],s[s.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),s=0,i=r.length-1,o=r[s],a=r[i],l,u,c=10;for(a<o&&(u=o,o=a,a=u,u=s,s=i,i=u);c-- >0;){if(u=FT(o,a,n),u===l)return r[s]=o,r[i]=a,e(r);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return t},t}function a5(){var t=GE();return t.copy=function(){return Iy(t,a5())},Ci.apply(t,arguments),Kl(t)}function l5(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,Lx),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return l5(t).unknown(e)},t=arguments.length?Array.from(t,Lx):[0,1],Kl(n)}function u5(t,e){t=t.slice();var n=0,r=t.length-1,s=t[n],i=t[r],o;return i<s&&(o=n,n=r,r=o,o=s,s=i,i=o),t[n]=e.floor(s),t[r]=e.ceil(i),t}function tF(t){return Math.log(t)}function nF(t){return Math.exp(t)}function dOe(t){return-Math.log(-t)}function hOe(t){return-Math.exp(-t)}function fOe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function pOe(t){return t===10?fOe:t===Math.E?Math.exp:e=>Math.pow(t,e)}function mOe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function rF(t){return(e,n)=>-t(-e,n)}function qE(t){const e=t(tF,nF),n=e.domain;let r=10,s,i;function o(){return s=mOe(r),i=pOe(r),n()[0]<0?(s=rF(s),i=rF(i),t(dOe,hOe)):t(tF,nF),e}return e.base=function(a){return arguments.length?(r=+a,o()):r},e.domain=function(a){return arguments.length?(n(a),o()):n()},e.ticks=a=>{const l=n();let u=l[0],c=l[l.length-1];const d=c<u;d&&([u,c]=[c,u]);let f=s(u),p=s(c),m,y;const v=a==null?10:+a;let x=[];if(!(r%1)&&p-f<v){if(f=Math.floor(f),p=Math.ceil(p),u>0){for(;f<=p;++f)for(m=1;m<r;++m)if(y=f<0?m/i(-f):m*i(f),!(y<u)){if(y>c)break;x.push(y)}}else for(;f<=p;++f)for(m=r-1;m>=1;--m)if(y=f>0?m/i(-f):m*i(f),!(y<u)){if(y>c)break;x.push(y)}x.length*2<v&&(x=LT(u,c,v))}else x=LT(f,p,Math.min(p-f,v)).map(i);return d?x.reverse():x},e.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=Nm(l)).precision==null&&(l.trim=!0),l=KE(l)),a===1/0)return l;const u=Math.max(1,r*a/e.ticks().length);return c=>{let d=c/i(Math.round(s(c)));return d*r<r-.5&&(d*=r),d<=u?l(c):""}},e.nice=()=>n(u5(n(),{floor:a=>i(Math.floor(s(a))),ceil:a=>i(Math.ceil(s(a)))})),e}function c5(){const t=qE(d_()).domain([1,10]);return t.copy=()=>Iy(t,c5()).base(t.base()),Ci.apply(t,arguments),t}function sF(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function iF(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function XE(t){var e=1,n=t(sF(e),iF(e));return n.constant=function(r){return arguments.length?t(sF(e=+r),iF(e)):e},Kl(n)}function d5(){var t=XE(d_());return t.copy=function(){return Iy(t,d5()).constant(t.constant())},Ci.apply(t,arguments)}function oF(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function gOe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function yOe(t){return t<0?-t*t:t*t}function ZE(t){var e=t(Rr,Rr),n=1;function r(){return n===1?t(Rr,Rr):n===.5?t(gOe,yOe):t(oF(n),oF(1/n))}return e.exponent=function(s){return arguments.length?(n=+s,r()):n},Kl(e)}function YE(){var t=ZE(d_());return t.copy=function(){return Iy(t,YE()).exponent(t.exponent())},Ci.apply(t,arguments),t}function vOe(){return YE.apply(null,arguments).exponent(.5)}function aF(t){return Math.sign(t)*t*t}function xOe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function h5(){var t=GE(),e=[0,1],n=!1,r;function s(i){var o=xOe(t(i));return isNaN(o)?r:n?Math.round(o):o}return s.invert=function(i){return t.invert(aF(i))},s.domain=function(i){return arguments.length?(t.domain(i),s):t.domain()},s.range=function(i){return arguments.length?(t.range((e=Array.from(i,Lx)).map(aF)),s):e.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(n=!!i,s):n},s.clamp=function(i){return arguments.length?(t.clamp(i),s):t.clamp()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return h5(t.domain(),e).round(n).clamp(t.clamp()).unknown(r)},Ci.apply(s,arguments),Kl(s)}function f5(){var t=[],e=[],n=[],r;function s(){var o=0,a=Math.max(1,e.length);for(n=new Array(a-1);++o<a;)n[o-1]=SAe(t,o/a);return i}function i(o){return o==null||isNaN(o=+o)?r:e[Ty(n,o)]}return i.invertExtent=function(o){var a=e.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:t[0],a<n.length?n[a]:t[t.length-1]]},i.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let a of o)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(fl),s()},i.range=function(o){return arguments.length?(e=Array.from(o),s()):e.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.quantiles=function(){return n.slice()},i.copy=function(){return f5().domain(t).range(e).unknown(r)},Ci.apply(i,arguments)}function p5(){var t=0,e=1,n=1,r=[.5],s=[0,1],i;function o(l){return l!=null&&l<=l?s[Ty(r,l,0,n)]:i}function a(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*e-(l-n)*t)/(n+1);return o}return o.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,a()):[t,e]},o.range=function(l){return arguments.length?(n=(s=Array.from(l)).length-1,a()):s.slice()},o.invertExtent=function(l){var u=s.indexOf(l);return u<0?[NaN,NaN]:u<1?[t,r[0]]:u>=n?[r[n-1],e]:[r[u-1],r[u]]},o.unknown=function(l){return arguments.length&&(i=l),o},o.thresholds=function(){return r.slice()},o.copy=function(){return p5().domain([t,e]).range(s).unknown(i)},Ci.apply(Kl(o),arguments)}function m5(){var t=[.5],e=[0,1],n,r=1;function s(i){return i!=null&&i<=i?e[Ty(t,i,0,r)]:n}return s.domain=function(i){return arguments.length?(t=Array.from(i),r=Math.min(t.length,e.length-1),s):t.slice()},s.range=function(i){return arguments.length?(e=Array.from(i),r=Math.min(t.length,e.length-1),s):e.slice()},s.invertExtent=function(i){var o=e.indexOf(i);return[t[o-1],t[o]]},s.unknown=function(i){return arguments.length?(n=i,s):n},s.copy=function(){return m5().domain(t).range(e).unknown(n)},Ci.apply(s,arguments)}const uk=new Date,ck=new Date;function Mn(t,e,n,r){function s(i){return t(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=i=>(t(i=new Date(+i)),i),s.ceil=i=>(t(i=new Date(i-1)),e(i,1),t(i),i),s.round=i=>{const o=s(i),a=s.ceil(i);return i-o<a-i?o:a},s.offset=(i,o)=>(e(i=new Date(+i),o==null?1:Math.floor(o)),i),s.range=(i,o,a)=>{const l=[];if(i=s.ceil(i),a=a==null?1:Math.floor(a),!(i<o)||!(a>0))return l;let u;do l.push(u=new Date(+i)),e(i,a),t(i);while(u<i&&i<o);return l},s.filter=i=>Mn(o=>{if(o>=o)for(;t(o),!i(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!i(o););else for(;--a>=0;)for(;e(o,1),!i(o););}),n&&(s.count=(i,o)=>(uk.setTime(+i),ck.setTime(+o),t(uk),t(ck),Math.floor(n(uk,ck))),s.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(r?o=>r(o)%i===0:o=>s.count(0,o)%i===0):s)),s}const Mx=Mn(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Mx.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Mn(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):Mx);Mx.range;const sa=1e3,di=sa*60,ia=di*60,ba=ia*24,QE=ba*7,lF=ba*30,dk=ba*365,Eu=Mn(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*sa)},(t,e)=>(e-t)/sa,t=>t.getUTCSeconds());Eu.range;const JE=Mn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*sa)},(t,e)=>{t.setTime(+t+e*di)},(t,e)=>(e-t)/di,t=>t.getMinutes());JE.range;const eA=Mn(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*di)},(t,e)=>(e-t)/di,t=>t.getUTCMinutes());eA.range;const tA=Mn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*sa-t.getMinutes()*di)},(t,e)=>{t.setTime(+t+e*ia)},(t,e)=>(e-t)/ia,t=>t.getHours());tA.range;const nA=Mn(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*ia)},(t,e)=>(e-t)/ia,t=>t.getUTCHours());nA.range;const $y=Mn(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*di)/ba,t=>t.getDate()-1);$y.range;const h_=Mn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ba,t=>t.getUTCDate()-1);h_.range;const g5=Mn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ba,t=>Math.floor(t/ba));g5.range;function Dc(t){return Mn(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*di)/QE)}const f_=Dc(0),zx=Dc(1),bOe=Dc(2),wOe=Dc(3),rh=Dc(4),_Oe=Dc(5),SOe=Dc(6);f_.range;zx.range;bOe.range;wOe.range;rh.range;_Oe.range;SOe.range;function Rc(t){return Mn(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/QE)}const p_=Rc(0),Bx=Rc(1),kOe=Rc(2),COe=Rc(3),sh=Rc(4),TOe=Rc(5),NOe=Rc(6);p_.range;Bx.range;kOe.range;COe.range;sh.range;TOe.range;NOe.range;const rA=Mn(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());rA.range;const sA=Mn(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());sA.range;const wa=Mn(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());wa.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mn(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});wa.range;const _a=Mn(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());_a.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mn(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});_a.range;function y5(t,e,n,r,s,i){const o=[[Eu,1,sa],[Eu,5,5*sa],[Eu,15,15*sa],[Eu,30,30*sa],[i,1,di],[i,5,5*di],[i,15,15*di],[i,30,30*di],[s,1,ia],[s,3,3*ia],[s,6,6*ia],[s,12,12*ia],[r,1,ba],[r,2,2*ba],[n,1,QE],[e,1,lF],[e,3,3*lF],[t,1,dk]];function a(u,c,d){const f=c<u;f&&([u,c]=[c,u]);const p=d&&typeof d.range=="function"?d:l(u,c,d),m=p?p.range(u,+c+1):[];return f?m.reverse():m}function l(u,c,d){const f=Math.abs(c-u)/d,p=zE(([,,v])=>v).right(o,f);if(p===o.length)return t.every(MT(u/dk,c/dk,d));if(p===0)return Mx.every(Math.max(MT(u,c,d),1));const[m,y]=o[f/o[p-1][2]<o[p][2]/f?p-1:p];return m.every(y)}return[a,l]}const[IOe,$Oe]=y5(_a,sA,p_,g5,nA,eA),[EOe,AOe]=y5(wa,rA,f_,$y,tA,JE);function hk(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function fk(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ap(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function OOe(t){var e=t.dateTime,n=t.date,r=t.time,s=t.periods,i=t.days,o=t.shortDays,a=t.months,l=t.shortMonths,u=lp(s),c=up(s),d=lp(i),f=up(i),p=lp(o),m=up(o),y=lp(a),v=up(a),x=lp(l),b=up(l),_={a:se,A:B,b:J,B:Y,c:null,d:pF,e:pF,f:tPe,g:dPe,G:fPe,H:QOe,I:JOe,j:ePe,L:v5,m:nPe,M:rPe,p:ie,q:ne,Q:yF,s:vF,S:sPe,u:iPe,U:oPe,V:aPe,w:lPe,W:uPe,x:null,X:null,y:cPe,Y:hPe,Z:pPe,"%":gF},S={a:pe,A:me,b:de,B:fe,c:null,d:mF,e:mF,f:vPe,g:IPe,G:EPe,H:mPe,I:gPe,j:yPe,L:b5,m:xPe,M:bPe,p:ke,q:_e,Q:yF,s:vF,S:wPe,u:_Pe,U:SPe,V:kPe,w:CPe,W:TPe,x:null,X:null,y:NPe,Y:$Pe,Z:APe,"%":gF},k={a:F,A:M,b:j,B:H,c:K,d:hF,e:hF,f:qOe,g:dF,G:cF,H:fF,I:fF,j:UOe,L:KOe,m:WOe,M:GOe,p:D,q:VOe,Q:ZOe,s:YOe,S:HOe,u:FOe,U:MOe,V:zOe,w:LOe,W:BOe,x:Q,X:Z,y:dF,Y:cF,Z:jOe,"%":XOe};_.x=T(n,_),_.X=T(r,_),_.c=T(e,_),S.x=T(n,S),S.X=T(r,S),S.c=T(e,S);function T(ue,be){return function(xe){var le=[],Me=-1,Be=0,He=ue.length,Ge,lt,ht;for(xe instanceof Date||(xe=new Date(+xe));++Me<He;)ue.charCodeAt(Me)===37&&(le.push(ue.slice(Be,Me)),(lt=uF[Ge=ue.charAt(++Me)])!=null?Ge=ue.charAt(++Me):lt=Ge==="e"?" ":"0",(ht=be[Ge])&&(Ge=ht(xe,lt)),le.push(Ge),Be=Me+1);return le.push(ue.slice(Be,Me)),le.join("")}}function $(ue,be){return function(xe){var le=ap(1900,void 0,1),Me=A(le,ue,xe+="",0),Be,He;if(Me!=xe.length)return null;if("Q"in le)return new Date(le.Q);if("s"in le)return new Date(le.s*1e3+("L"in le?le.L:0));if(be&&!("Z"in le)&&(le.Z=0),"p"in le&&(le.H=le.H%12+le.p*12),le.m===void 0&&(le.m="q"in le?le.q:0),"V"in le){if(le.V<1||le.V>53)return null;"w"in le||(le.w=1),"Z"in le?(Be=fk(ap(le.y,0,1)),He=Be.getUTCDay(),Be=He>4||He===0?Bx.ceil(Be):Bx(Be),Be=h_.offset(Be,(le.V-1)*7),le.y=Be.getUTCFullYear(),le.m=Be.getUTCMonth(),le.d=Be.getUTCDate()+(le.w+6)%7):(Be=hk(ap(le.y,0,1)),He=Be.getDay(),Be=He>4||He===0?zx.ceil(Be):zx(Be),Be=$y.offset(Be,(le.V-1)*7),le.y=Be.getFullYear(),le.m=Be.getMonth(),le.d=Be.getDate()+(le.w+6)%7)}else("W"in le||"U"in le)&&("w"in le||(le.w="u"in le?le.u%7:"W"in le?1:0),He="Z"in le?fk(ap(le.y,0,1)).getUTCDay():hk(ap(le.y,0,1)).getDay(),le.m=0,le.d="W"in le?(le.w+6)%7+le.W*7-(He+5)%7:le.w+le.U*7-(He+6)%7);return"Z"in le?(le.H+=le.Z/100|0,le.M+=le.Z%100,fk(le)):hk(le)}}function A(ue,be,xe,le){for(var Me=0,Be=be.length,He=xe.length,Ge,lt;Me<Be;){if(le>=He)return-1;if(Ge=be.charCodeAt(Me++),Ge===37){if(Ge=be.charAt(Me++),lt=k[Ge in uF?be.charAt(Me++):Ge],!lt||(le=lt(ue,xe,le))<0)return-1}else if(Ge!=xe.charCodeAt(le++))return-1}return le}function D(ue,be,xe){var le=u.exec(be.slice(xe));return le?(ue.p=c.get(le[0].toLowerCase()),xe+le[0].length):-1}function F(ue,be,xe){var le=p.exec(be.slice(xe));return le?(ue.w=m.get(le[0].toLowerCase()),xe+le[0].length):-1}function M(ue,be,xe){var le=d.exec(be.slice(xe));return le?(ue.w=f.get(le[0].toLowerCase()),xe+le[0].length):-1}function j(ue,be,xe){var le=x.exec(be.slice(xe));return le?(ue.m=b.get(le[0].toLowerCase()),xe+le[0].length):-1}function H(ue,be,xe){var le=y.exec(be.slice(xe));return le?(ue.m=v.get(le[0].toLowerCase()),xe+le[0].length):-1}function K(ue,be,xe){return A(ue,e,be,xe)}function Q(ue,be,xe){return A(ue,n,be,xe)}function Z(ue,be,xe){return A(ue,r,be,xe)}function se(ue){return o[ue.getDay()]}function B(ue){return i[ue.getDay()]}function J(ue){return l[ue.getMonth()]}function Y(ue){return a[ue.getMonth()]}function ie(ue){return s[+(ue.getHours()>=12)]}function ne(ue){return 1+~~(ue.getMonth()/3)}function pe(ue){return o[ue.getUTCDay()]}function me(ue){return i[ue.getUTCDay()]}function de(ue){return l[ue.getUTCMonth()]}function fe(ue){return a[ue.getUTCMonth()]}function ke(ue){return s[+(ue.getUTCHours()>=12)]}function _e(ue){return 1+~~(ue.getUTCMonth()/3)}return{format:function(ue){var be=T(ue+="",_);return be.toString=function(){return ue},be},parse:function(ue){var be=$(ue+="",!1);return be.toString=function(){return ue},be},utcFormat:function(ue){var be=T(ue+="",S);return be.toString=function(){return ue},be},utcParse:function(ue){var be=$(ue+="",!0);return be.toString=function(){return ue},be}}}var uF={"-":"",_:" ",0:"0"},rr=/^\s*\d+/,POe=/^%/,DOe=/[\\^$*+?|[\]().{}]/g;function mt(t,e,n){var r=t<0?"-":"",s=(r?-t:t)+"",i=s.length;return r+(i<n?new Array(n-i+1).join(e)+s:s)}function ROe(t){return t.replace(DOe,"\\$&")}function lp(t){return new RegExp("^(?:"+t.map(ROe).join("|")+")","i")}function up(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function LOe(t,e,n){var r=rr.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function FOe(t,e,n){var r=rr.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function MOe(t,e,n){var r=rr.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function zOe(t,e,n){var r=rr.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function BOe(t,e,n){var r=rr.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function cF(t,e,n){var r=rr.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function dF(t,e,n){var r=rr.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function jOe(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function VOe(t,e,n){var r=rr.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function WOe(t,e,n){var r=rr.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function hF(t,e,n){var r=rr.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function UOe(t,e,n){var r=rr.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function fF(t,e,n){var r=rr.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function GOe(t,e,n){var r=rr.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function HOe(t,e,n){var r=rr.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function KOe(t,e,n){var r=rr.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function qOe(t,e,n){var r=rr.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function XOe(t,e,n){var r=POe.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function ZOe(t,e,n){var r=rr.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function YOe(t,e,n){var r=rr.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function pF(t,e){return mt(t.getDate(),e,2)}function QOe(t,e){return mt(t.getHours(),e,2)}function JOe(t,e){return mt(t.getHours()%12||12,e,2)}function ePe(t,e){return mt(1+$y.count(wa(t),t),e,3)}function v5(t,e){return mt(t.getMilliseconds(),e,3)}function tPe(t,e){return v5(t,e)+"000"}function nPe(t,e){return mt(t.getMonth()+1,e,2)}function rPe(t,e){return mt(t.getMinutes(),e,2)}function sPe(t,e){return mt(t.getSeconds(),e,2)}function iPe(t){var e=t.getDay();return e===0?7:e}function oPe(t,e){return mt(f_.count(wa(t)-1,t),e,2)}function x5(t){var e=t.getDay();return e>=4||e===0?rh(t):rh.ceil(t)}function aPe(t,e){return t=x5(t),mt(rh.count(wa(t),t)+(wa(t).getDay()===4),e,2)}function lPe(t){return t.getDay()}function uPe(t,e){return mt(zx.count(wa(t)-1,t),e,2)}function cPe(t,e){return mt(t.getFullYear()%100,e,2)}function dPe(t,e){return t=x5(t),mt(t.getFullYear()%100,e,2)}function hPe(t,e){return mt(t.getFullYear()%1e4,e,4)}function fPe(t,e){var n=t.getDay();return t=n>=4||n===0?rh(t):rh.ceil(t),mt(t.getFullYear()%1e4,e,4)}function pPe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+mt(e/60|0,"0",2)+mt(e%60,"0",2)}function mF(t,e){return mt(t.getUTCDate(),e,2)}function mPe(t,e){return mt(t.getUTCHours(),e,2)}function gPe(t,e){return mt(t.getUTCHours()%12||12,e,2)}function yPe(t,e){return mt(1+h_.count(_a(t),t),e,3)}function b5(t,e){return mt(t.getUTCMilliseconds(),e,3)}function vPe(t,e){return b5(t,e)+"000"}function xPe(t,e){return mt(t.getUTCMonth()+1,e,2)}function bPe(t,e){return mt(t.getUTCMinutes(),e,2)}function wPe(t,e){return mt(t.getUTCSeconds(),e,2)}function _Pe(t){var e=t.getUTCDay();return e===0?7:e}function SPe(t,e){return mt(p_.count(_a(t)-1,t),e,2)}function w5(t){var e=t.getUTCDay();return e>=4||e===0?sh(t):sh.ceil(t)}function kPe(t,e){return t=w5(t),mt(sh.count(_a(t),t)+(_a(t).getUTCDay()===4),e,2)}function CPe(t){return t.getUTCDay()}function TPe(t,e){return mt(Bx.count(_a(t)-1,t),e,2)}function NPe(t,e){return mt(t.getUTCFullYear()%100,e,2)}function IPe(t,e){return t=w5(t),mt(t.getUTCFullYear()%100,e,2)}function $Pe(t,e){return mt(t.getUTCFullYear()%1e4,e,4)}function EPe(t,e){var n=t.getUTCDay();return t=n>=4||n===0?sh(t):sh.ceil(t),mt(t.getUTCFullYear()%1e4,e,4)}function APe(){return"+0000"}function gF(){return"%"}function yF(t){return+t}function vF(t){return Math.floor(+t/1e3)}var Yc,_5,S5;OPe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function OPe(t){return Yc=OOe(t),_5=Yc.format,Yc.parse,S5=Yc.utcFormat,Yc.utcParse,Yc}function PPe(t){return new Date(t)}function DPe(t){return t instanceof Date?+t:+new Date(+t)}function iA(t,e,n,r,s,i,o,a,l,u){var c=GE(),d=c.invert,f=c.domain,p=u(".%L"),m=u(":%S"),y=u("%I:%M"),v=u("%I %p"),x=u("%a %d"),b=u("%b %d"),_=u("%B"),S=u("%Y");function k(T){return(l(T)<T?p:a(T)<T?m:o(T)<T?y:i(T)<T?v:r(T)<T?s(T)<T?x:b:n(T)<T?_:S)(T)}return c.invert=function(T){return new Date(d(T))},c.domain=function(T){return arguments.length?f(Array.from(T,DPe)):f().map(PPe)},c.ticks=function(T){var $=f();return t($[0],$[$.length-1],T??10)},c.tickFormat=function(T,$){return $==null?k:u($)},c.nice=function(T){var $=f();return(!T||typeof T.range!="function")&&(T=e($[0],$[$.length-1],T??10)),T?f(u5($,T)):c},c.copy=function(){return Iy(c,iA(t,e,n,r,s,i,o,a,l,u))},c}function RPe(){return Ci.apply(iA(EOe,AOe,wa,rA,f_,$y,tA,JE,Eu,_5).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function LPe(){return Ci.apply(iA(IOe,$Oe,_a,sA,p_,h_,nA,eA,Eu,S5).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function m_(){var t=0,e=1,n,r,s,i,o=Rr,a=!1,l;function u(d){return d==null||isNaN(d=+d)?l:o(s===0?.5:(d=(i(d)-n)*s,a?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([t,e]=d,n=i(t=+t),r=i(e=+e),s=n===r?0:1/(r-n),u):[t,e]},u.clamp=function(d){return arguments.length?(a=!!d,u):a},u.interpolator=function(d){return arguments.length?(o=d,u):o};function c(d){return function(f){var p,m;return arguments.length?([p,m]=f,o=d(p,m),u):[o(0),o(1)]}}return u.range=c(Sf),u.rangeRound=c(UE),u.unknown=function(d){return arguments.length?(l=d,u):l},function(d){return i=d,n=d(t),r=d(e),s=n===r?0:1/(r-n),u}}function ql(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function k5(){var t=Kl(m_()(Rr));return t.copy=function(){return ql(t,k5())},La.apply(t,arguments)}function C5(){var t=qE(m_()).domain([1,10]);return t.copy=function(){return ql(t,C5()).base(t.base())},La.apply(t,arguments)}function T5(){var t=XE(m_());return t.copy=function(){return ql(t,T5()).constant(t.constant())},La.apply(t,arguments)}function oA(){var t=ZE(m_());return t.copy=function(){return ql(t,oA()).exponent(t.exponent())},La.apply(t,arguments)}function FPe(){return oA.apply(null,arguments).exponent(.5)}function N5(){var t=[],e=Rr;function n(r){if(r!=null&&!isNaN(r=+r))return e((Ty(t,r,1)-1)/(t.length-1))}return n.domain=function(r){if(!arguments.length)return t.slice();t=[];for(let s of r)s!=null&&!isNaN(s=+s)&&t.push(s);return t.sort(fl),n},n.interpolator=function(r){return arguments.length?(e=r,n):e},n.range=function(){return t.map((r,s)=>e(s/(t.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(s,i)=>_Ae(t,i/r))},n.copy=function(){return N5(e).domain(t)},La.apply(n,arguments)}function g_(){var t=0,e=.5,n=1,r=1,s,i,o,a,l,u=Rr,c,d=!1,f;function p(y){return isNaN(y=+y)?f:(y=.5+((y=+c(y))-i)*(r*y<r*i?a:l),u(d?Math.max(0,Math.min(1,y)):y))}p.domain=function(y){return arguments.length?([t,e,n]=y,s=c(t=+t),i=c(e=+e),o=c(n=+n),a=s===i?0:.5/(i-s),l=i===o?0:.5/(o-i),r=i<s?-1:1,p):[t,e,n]},p.clamp=function(y){return arguments.length?(d=!!y,p):d},p.interpolator=function(y){return arguments.length?(u=y,p):u};function m(y){return function(v){var x,b,_;return arguments.length?([x,b,_]=v,u=XAe(y,[x,b,_]),p):[u(0),u(.5),u(1)]}}return p.range=m(Sf),p.rangeRound=m(UE),p.unknown=function(y){return arguments.length?(f=y,p):f},function(y){return c=y,s=y(t),i=y(e),o=y(n),a=s===i?0:.5/(i-s),l=i===o?0:.5/(o-i),r=i<s?-1:1,p}}function I5(){var t=Kl(g_()(Rr));return t.copy=function(){return ql(t,I5())},La.apply(t,arguments)}function $5(){var t=qE(g_()).domain([.1,1,10]);return t.copy=function(){return ql(t,$5()).base(t.base())},La.apply(t,arguments)}function E5(){var t=XE(g_());return t.copy=function(){return ql(t,E5()).constant(t.constant())},La.apply(t,arguments)}function aA(){var t=ZE(g_());return t.copy=function(){return ql(t,aA()).exponent(t.exponent())},La.apply(t,arguments)}function MPe(){return aA.apply(null,arguments).exponent(.5)}const _p=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:jE,scaleDiverging:I5,scaleDivergingLog:$5,scaleDivergingPow:aA,scaleDivergingSqrt:MPe,scaleDivergingSymlog:E5,scaleIdentity:l5,scaleImplicit:zT,scaleLinear:a5,scaleLog:c5,scaleOrdinal:BE,scalePoint:CAe,scalePow:YE,scaleQuantile:f5,scaleQuantize:p5,scaleRadial:h5,scaleSequential:k5,scaleSequentialLog:C5,scaleSequentialPow:oA,scaleSequentialQuantile:N5,scaleSequentialSqrt:FPe,scaleSequentialSymlog:T5,scaleSqrt:vOe,scaleSymlog:d5,scaleThreshold:m5,scaleTime:RPe,scaleUtc:LPe,tickFormat:o5},Symbol.toStringTag,{value:"Module"}));var Xl=t=>t.chartData,zPe=he([Xl],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),y_=(t,e,n,r)=>r?zPe(t):Xl(t);function ih(t){if(Array.isArray(t)&&t.length===2){var[e,n]=t;if(Fs(e)&&Fs(n))return!0}return!1}function xF(t,e,n){return n?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function BPe(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[n,r]=t,s,i;if(Fs(n))s=n;else if(typeof n=="function")return;if(Fs(r))i=r;else if(typeof r=="function")return;var o=[s,i];if(ih(o))return o}}function jPe(t,e,n){if(!(!n&&e==null)){if(typeof t=="function"&&e!=null)try{var r=t(e,n);if(ih(r))return xF(r,e,n)}catch{}if(Array.isArray(t)&&t.length===2){var[s,i]=t,o,a;if(s==="auto")e!=null&&(o=Math.min(...e));else if(De(s))o=s;else if(typeof s=="function")try{e!=null&&(o=s(e==null?void 0:e[0]))}catch{}else if(typeof s=="string"&&mL.test(s)){var l=mL.exec(s);if(l==null||e==null)o=void 0;else{var u=+l[1];o=e[0]-u}}else o=e==null?void 0:e[0];if(i==="auto")e!=null&&(a=Math.max(...e));else if(De(i))a=i;else if(typeof i=="function")try{e!=null&&(a=i(e==null?void 0:e[1]))}catch{}else if(typeof i=="string"&&gL.test(i)){var c=gL.exec(i);if(c==null||e==null)a=void 0;else{var d=+c[1];a=e[1]+d}}else a=e==null?void 0:e[1];var f=[o,a];if(ih(f))return e==null?f:xF(f,e,n)}}}var kf=1e9,VPe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},uA,Ht=!0,bi="[DecimalError] ",Vu=bi+"Invalid argument: ",lA=bi+"Exponent out of range: ",Cf=Math.floor,pu=Math.pow,WPe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ks,Vn=1e7,Ft=7,A5=9007199254740991,jx=Cf(A5/Ft),Oe={};Oe.absoluteValue=Oe.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Oe.comparedTo=Oe.cmp=function(t){var e,n,r,s,i=this;if(t=new i.constructor(t),i.s!==t.s)return i.s||-t.s;if(i.e!==t.e)return i.e>t.e^i.s<0?1:-1;for(r=i.d.length,s=t.d.length,e=0,n=r<s?r:s;e<n;++e)if(i.d[e]!==t.d[e])return i.d[e]>t.d[e]^i.s<0?1:-1;return r===s?0:r>s^i.s<0?1:-1};Oe.decimalPlaces=Oe.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*Ft;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};Oe.dividedBy=Oe.div=function(t){return ua(this,new this.constructor(t))};Oe.dividedToIntegerBy=Oe.idiv=function(t){var e=this,n=e.constructor;return It(ua(e,new n(t),0,1),n.precision)};Oe.equals=Oe.eq=function(t){return!this.cmp(t)};Oe.exponent=function(){return Cn(this)};Oe.greaterThan=Oe.gt=function(t){return this.cmp(t)>0};Oe.greaterThanOrEqualTo=Oe.gte=function(t){return this.cmp(t)>=0};Oe.isInteger=Oe.isint=function(){return this.e>this.d.length-2};Oe.isNegative=Oe.isneg=function(){return this.s<0};Oe.isPositive=Oe.ispos=function(){return this.s>0};Oe.isZero=function(){return this.s===0};Oe.lessThan=Oe.lt=function(t){return this.cmp(t)<0};Oe.lessThanOrEqualTo=Oe.lte=function(t){return this.cmp(t)<1};Oe.logarithm=Oe.log=function(t){var e,n=this,r=n.constructor,s=r.precision,i=s+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(ks))throw Error(bi+"NaN");if(n.s<1)throw Error(bi+(n.s?"NaN":"-Infinity"));return n.eq(ks)?new r(0):(Ht=!1,e=ua(Im(n,i),Im(t,i),i),Ht=!0,It(e,s))};Oe.minus=Oe.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?D5(e,t):O5(e,(t.s=-t.s,t))};Oe.modulo=Oe.mod=function(t){var e,n=this,r=n.constructor,s=r.precision;if(t=new r(t),!t.s)throw Error(bi+"NaN");return n.s?(Ht=!1,e=ua(n,t,0,1).times(t),Ht=!0,n.minus(e)):It(new r(n),s)};Oe.naturalExponential=Oe.exp=function(){return P5(this)};Oe.naturalLogarithm=Oe.ln=function(){return Im(this)};Oe.negated=Oe.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Oe.plus=Oe.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?O5(e,t):D5(e,(t.s=-t.s,t))};Oe.precision=Oe.sd=function(t){var e,n,r,s=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Vu+t);if(e=Cn(s)+1,r=s.d.length-1,n=r*Ft+1,r=s.d[r],r){for(;r%10==0;r/=10)n--;for(r=s.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};Oe.squareRoot=Oe.sqrt=function(){var t,e,n,r,s,i,o,a=this,l=a.constructor;if(a.s<1){if(!a.s)return new l(0);throw Error(bi+"NaN")}for(t=Cn(a),Ht=!1,s=Math.sqrt(+a),s==0||s==1/0?(e=_o(a.d),(e.length+t)%2==0&&(e+="0"),s=Math.sqrt(e),t=Cf((t+1)/2)-(t<0||t%2),s==1/0?e="5e"+t:(e=s.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new l(e)):r=new l(s.toString()),n=l.precision,s=o=n+3;;)if(i=r,r=i.plus(ua(a,i,o+2)).times(.5),_o(i.d).slice(0,o)===(e=_o(r.d)).slice(0,o)){if(e=e.slice(o-3,o+1),s==o&&e=="4999"){if(It(i,n+1,0),i.times(i).eq(a)){r=i;break}}else if(e!="9999")break;o+=4}return Ht=!0,It(r,n)};Oe.times=Oe.mul=function(t){var e,n,r,s,i,o,a,l,u,c=this,d=c.constructor,f=c.d,p=(t=new d(t)).d;if(!c.s||!t.s)return new d(0);for(t.s*=c.s,n=c.e+t.e,l=f.length,u=p.length,l<u&&(i=f,f=p,p=i,o=l,l=u,u=o),i=[],o=l+u,r=o;r--;)i.push(0);for(r=u;--r>=0;){for(e=0,s=l+r;s>r;)a=i[s]+p[r]*f[s-r-1]+e,i[s--]=a%Vn|0,e=a/Vn|0;i[s]=(i[s]+e)%Vn|0}for(;!i[--o];)i.pop();return e?++n:i.shift(),t.d=i,t.e=n,Ht?It(t,d.precision):t};Oe.toDecimalPlaces=Oe.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(Fo(t,0,kf),e===void 0?e=r.rounding:Fo(e,0,8),It(n,t+Cn(n)+1,e))};Oe.toExponential=function(t,e){var n,r=this,s=r.constructor;return t===void 0?n=hc(r,!0):(Fo(t,0,kf),e===void 0?e=s.rounding:Fo(e,0,8),r=It(new s(r),t+1,e),n=hc(r,!0,t+1)),n};Oe.toFixed=function(t,e){var n,r,s=this,i=s.constructor;return t===void 0?hc(s):(Fo(t,0,kf),e===void 0?e=i.rounding:Fo(e,0,8),r=It(new i(s),t+Cn(s)+1,e),n=hc(r.abs(),!1,t+Cn(r)+1),s.isneg()&&!s.isZero()?"-"+n:n)};Oe.toInteger=Oe.toint=function(){var t=this,e=t.constructor;return It(new e(t),Cn(t)+1,e.rounding)};Oe.toNumber=function(){return+this};Oe.toPower=Oe.pow=function(t){var e,n,r,s,i,o,a=this,l=a.constructor,u=12,c=+(t=new l(t));if(!t.s)return new l(ks);if(a=new l(a),!a.s){if(t.s<1)throw Error(bi+"Infinity");return a}if(a.eq(ks))return a;if(r=l.precision,t.eq(ks))return It(a,r);if(e=t.e,n=t.d.length-1,o=e>=n,i=a.s,o){if((n=c<0?-c:c)<=A5){for(s=new l(ks),e=Math.ceil(r/Ft+4),Ht=!1;n%2&&(s=s.times(a),wF(s.d,e)),n=Cf(n/2),n!==0;)a=a.times(a),wF(a.d,e);return Ht=!0,t.s<0?new l(ks).div(s):It(s,r)}}else if(i<0)throw Error(bi+"NaN");return i=i<0&&t.d[Math.max(e,n)]&1?-1:1,a.s=1,Ht=!1,s=t.times(Im(a,r+u)),Ht=!0,s=P5(s),s.s=i,s};Oe.toPrecision=function(t,e){var n,r,s=this,i=s.constructor;return t===void 0?(n=Cn(s),r=hc(s,n<=i.toExpNeg||n>=i.toExpPos)):(Fo(t,1,kf),e===void 0?e=i.rounding:Fo(e,0,8),s=It(new i(s),t,e),n=Cn(s),r=hc(s,t<=n||n<=i.toExpNeg,t)),r};Oe.toSignificantDigits=Oe.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(Fo(t,1,kf),e===void 0?e=r.rounding:Fo(e,0,8)),It(new r(n),t,e)};Oe.toString=Oe.valueOf=Oe.val=Oe.toJSON=Oe[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=Cn(t),n=t.constructor;return hc(t,e<=n.toExpNeg||e>=n.toExpPos)};function O5(t,e){var n,r,s,i,o,a,l,u,c=t.constructor,d=c.precision;if(!t.s||!e.s)return e.s||(e=new c(t)),Ht?It(e,d):e;if(l=t.d,u=e.d,o=t.e,s=e.e,l=l.slice(),i=o-s,i){for(i<0?(r=l,i=-i,a=u.length):(r=u,s=o,a=l.length),o=Math.ceil(d/Ft),a=o>a?o+1:a+1,i>a&&(i=a,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(a=l.length,i=u.length,a-i<0&&(i=a,r=u,u=l,l=r),n=0;i;)n=(l[--i]=l[i]+u[i]+n)/Vn|0,l[i]%=Vn;for(n&&(l.unshift(n),++s),a=l.length;l[--a]==0;)l.pop();return e.d=l,e.e=s,Ht?It(e,d):e}function Fo(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Vu+t)}function _o(t){var e,n,r,s=t.length-1,i="",o=t[0];if(s>0){for(i+=o,e=1;e<s;e++)r=t[e]+"",n=Ft-r.length,n&&(i+=Ka(n)),i+=r;o=t[e],r=o+"",n=Ft-r.length,n&&(i+=Ka(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var ua=function(){function t(r,s){var i,o=0,a=r.length;for(r=r.slice();a--;)i=r[a]*s+o,r[a]=i%Vn|0,o=i/Vn|0;return o&&r.unshift(o),r}function e(r,s,i,o){var a,l;if(i!=o)l=i>o?1:-1;else for(a=l=0;a<i;a++)if(r[a]!=s[a]){l=r[a]>s[a]?1:-1;break}return l}function n(r,s,i){for(var o=0;i--;)r[i]-=o,o=r[i]<s[i]?1:0,r[i]=o*Vn+r[i]-s[i];for(;!r[0]&&r.length>1;)r.shift()}return function(r,s,i,o){var a,l,u,c,d,f,p,m,y,v,x,b,_,S,k,T,$,A,D=r.constructor,F=r.s==s.s?1:-1,M=r.d,j=s.d;if(!r.s)return new D(r);if(!s.s)throw Error(bi+"Division by zero");for(l=r.e-s.e,$=j.length,k=M.length,p=new D(F),m=p.d=[],u=0;j[u]==(M[u]||0);)++u;if(j[u]>(M[u]||0)&&--l,i==null?b=i=D.precision:o?b=i+(Cn(r)-Cn(s))+1:b=i,b<0)return new D(0);if(b=b/Ft+2|0,u=0,$==1)for(c=0,j=j[0],b++;(u<k||c)&&b--;u++)_=c*Vn+(M[u]||0),m[u]=_/j|0,c=_%j|0;else{for(c=Vn/(j[0]+1)|0,c>1&&(j=t(j,c),M=t(M,c),$=j.length,k=M.length),S=$,y=M.slice(0,$),v=y.length;v<$;)y[v++]=0;A=j.slice(),A.unshift(0),T=j[0],j[1]>=Vn/2&&++T;do c=0,a=e(j,y,$,v),a<0?(x=y[0],$!=v&&(x=x*Vn+(y[1]||0)),c=x/T|0,c>1?(c>=Vn&&(c=Vn-1),d=t(j,c),f=d.length,v=y.length,a=e(d,y,f,v),a==1&&(c--,n(d,$<f?A:j,f))):(c==0&&(a=c=1),d=j.slice()),f=d.length,f<v&&d.unshift(0),n(y,d,v),a==-1&&(v=y.length,a=e(j,y,$,v),a<1&&(c++,n(y,$<v?A:j,v))),v=y.length):a===0&&(c++,y=[0]),m[u++]=c,a&&y[0]?y[v++]=M[S]||0:(y=[M[S]],v=1);while((S++<k||y[0]!==void 0)&&b--)}return m[0]||m.shift(),p.e=l,It(p,o?i+Cn(p)+1:i)}}();function P5(t,e){var n,r,s,i,o,a,l=0,u=0,c=t.constructor,d=c.precision;if(Cn(t)>16)throw Error(lA+Cn(t));if(!t.s)return new c(ks);for(Ht=!1,a=d,o=new c(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(r=Math.log(pu(2,u))/Math.LN10*2+5|0,a+=r,n=s=i=new c(ks),c.precision=a;;){if(s=It(s.times(t),a),n=n.times(++l),o=i.plus(ua(s,n,a)),_o(o.d).slice(0,a)===_o(i.d).slice(0,a)){for(;u--;)i=It(i.times(i),a);return c.precision=d,e==null?(Ht=!0,It(i,d)):i}i=o}}function Cn(t){for(var e=t.e*Ft,n=t.d[0];n>=10;n/=10)e++;return e}function pk(t,e,n){if(e>t.LN10.sd())throw Ht=!0,n&&(t.precision=n),Error(bi+"LN10 precision limit exceeded");return It(new t(t.LN10),e)}function Ka(t){for(var e="";t--;)e+="0";return e}function Im(t,e){var n,r,s,i,o,a,l,u,c,d=1,f=10,p=t,m=p.d,y=p.constructor,v=y.precision;if(p.s<1)throw Error(bi+(p.s?"NaN":"-Infinity"));if(p.eq(ks))return new y(0);if(e==null?(Ht=!1,u=v):u=e,p.eq(10))return e==null&&(Ht=!0),pk(y,u);if(u+=f,y.precision=u,n=_o(m),r=n.charAt(0),i=Cn(p),Math.abs(i)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)p=p.times(t),n=_o(p.d),r=n.charAt(0),d++;i=Cn(p),r>1?(p=new y("0."+n),i++):p=new y(r+"."+n.slice(1))}else return l=pk(y,u+2,v).times(i+""),p=Im(new y(r+"."+n.slice(1)),u-f).plus(l),y.precision=v,e==null?(Ht=!0,It(p,v)):p;for(a=o=p=ua(p.minus(ks),p.plus(ks),u),c=It(p.times(p),u),s=3;;){if(o=It(o.times(c),u),l=a.plus(ua(o,new y(s),u)),_o(l.d).slice(0,u)===_o(a.d).slice(0,u))return a=a.times(2),i!==0&&(a=a.plus(pk(y,u+2,v).times(i+""))),a=ua(a,new y(d),u),y.precision=v,e==null?(Ht=!0,It(a,v)):a;a=l,s+=2}}function bF(t,e){var n,r,s;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(s=e.length;e.charCodeAt(s-1)===48;)--s;if(e=e.slice(r,s),e){if(s-=r,n=n-r-1,t.e=Cf(n/Ft),t.d=[],r=(n+1)%Ft,n<0&&(r+=Ft),r<s){for(r&&t.d.push(+e.slice(0,r)),s-=Ft;r<s;)t.d.push(+e.slice(r,r+=Ft));e=e.slice(r),r=Ft-e.length}else r-=s;for(;r--;)e+="0";if(t.d.push(+e),Ht&&(t.e>jx||t.e<-jx))throw Error(lA+n)}else t.s=0,t.e=0,t.d=[0];return t}function It(t,e,n){var r,s,i,o,a,l,u,c,d=t.d;for(o=1,i=d[0];i>=10;i/=10)o++;if(r=e-o,r<0)r+=Ft,s=e,u=d[c=0];else{if(c=Math.ceil((r+1)/Ft),i=d.length,c>=i)return t;for(u=i=d[c],o=1;i>=10;i/=10)o++;r%=Ft,s=r-Ft+o}if(n!==void 0&&(i=pu(10,o-s-1),a=u/i%10|0,l=e<0||d[c+1]!==void 0||u%i,l=n<4?(a||l)&&(n==0||n==(t.s<0?3:2)):a>5||a==5&&(n==4||l||n==6&&(r>0?s>0?u/pu(10,o-s):0:d[c-1])%10&1||n==(t.s<0?8:7))),e<1||!d[0])return l?(i=Cn(t),d.length=1,e=e-i-1,d[0]=pu(10,(Ft-e%Ft)%Ft),t.e=Cf(-e/Ft)||0):(d.length=1,d[0]=t.e=t.s=0),t;if(r==0?(d.length=c,i=1,c--):(d.length=c+1,i=pu(10,Ft-r),d[c]=s>0?(u/pu(10,o-s)%pu(10,s)|0)*i:0),l)for(;;)if(c==0){(d[0]+=i)==Vn&&(d[0]=1,++t.e);break}else{if(d[c]+=i,d[c]!=Vn)break;d[c--]=0,i=1}for(r=d.length;d[--r]===0;)d.pop();if(Ht&&(t.e>jx||t.e<-jx))throw Error(lA+Cn(t));return t}function D5(t,e){var n,r,s,i,o,a,l,u,c,d,f=t.constructor,p=f.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new f(t),Ht?It(e,p):e;if(l=t.d,d=e.d,r=e.e,u=t.e,l=l.slice(),o=u-r,o){for(c=o<0,c?(n=l,o=-o,a=d.length):(n=d,r=u,a=l.length),s=Math.max(Math.ceil(p/Ft),a)+2,o>s&&(o=s,n.length=1),n.reverse(),s=o;s--;)n.push(0);n.reverse()}else{for(s=l.length,a=d.length,c=s<a,c&&(a=s),s=0;s<a;s++)if(l[s]!=d[s]){c=l[s]<d[s];break}o=0}for(c&&(n=l,l=d,d=n,e.s=-e.s),a=l.length,s=d.length-a;s>0;--s)l[a++]=0;for(s=d.length;s>o;){if(l[--s]<d[s]){for(i=s;i&&l[--i]===0;)l[i]=Vn-1;--l[i],l[s]+=Vn}l[s]-=d[s]}for(;l[--a]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(e.d=l,e.e=r,Ht?It(e,p):e):new f(0)}function hc(t,e,n){var r,s=Cn(t),i=_o(t.d),o=i.length;return e?(n&&(r=n-o)>0?i=i.charAt(0)+"."+i.slice(1)+Ka(r):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(s<0?"e":"e+")+s):s<0?(i="0."+Ka(-s-1)+i,n&&(r=n-o)>0&&(i+=Ka(r))):s>=o?(i+=Ka(s+1-o),n&&(r=n-s-1)>0&&(i=i+"."+Ka(r))):((r=s+1)<o&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-o)>0&&(s+1===o&&(i+="."),i+=Ka(r))),t.s<0?"-"+i:i}function wF(t,e){if(t.length>e)return t.length=e,!0}function R5(t){var e,n,r;function s(i){var o=this;if(!(o instanceof s))return new s(i);if(o.constructor=s,i instanceof s){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Vu+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return bF(o,i.toString())}else if(typeof i!="string")throw Error(Vu+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,WPe.test(i))bF(o,i);else throw Error(Vu+i)}if(s.prototype=Oe,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=R5,s.config=s.set=UPe,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return s.config(t),s}function UPe(t){if(!t||typeof t!="object")throw Error(bi+"Object expected");var e,n,r,s=["precision",1,kf,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<s.length;e+=3)if((r=t[n=s[e]])!==void 0)if(Cf(r)===r&&r>=s[e+1]&&r<=s[e+2])this[n]=r;else throw Error(Vu+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Vu+n+": "+r);return this}var uA=R5(VPe);ks=new uA(1);const wt=uA;var GPe=t=>t,L5={},F5=t=>t===L5,_F=t=>function e(){return arguments.length===0||arguments.length===1&&F5(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},M5=(t,e)=>t===1?e:_F(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];var i=r.filter(o=>o!==L5).length;return i>=t?e(...r):M5(t-i,_F(function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];var u=r.map(c=>F5(c)?a.shift():c);return e(...u,...a)}))}),v_=t=>M5(t.length,t),WT=(t,e)=>{for(var n=[],r=t;r<e;++r)n[r-t]=r;return n},HPe=v_((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(n=>e[n]).map(t)),KPe=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.length)return GPe;var s=n.reverse(),i=s[0],o=s.slice(1);return function(){return o.reduce((a,l)=>l(a),i(...arguments))}},UT=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),z5=t=>{var e=null,n=null;return function(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return e&&s.every((o,a)=>{var l;return o===((l=e)===null||l===void 0?void 0:l[a])})||(e=s,n=t(...s)),n}};function B5(t){var e;return t===0?e=1:e=Math.floor(new wt(t).abs().log(10).toNumber())+1,e}function j5(t,e,n){for(var r=new wt(t),s=0,i=[];r.lt(e)&&s<1e5;)i.push(r.toNumber()),r=r.add(n),s++;return i}v_((t,e,n)=>{var r=+t,s=+e;return r+n*(s-r)});v_((t,e,n)=>{var r=e-+t;return r=r||1/0,(n-t)/r});v_((t,e,n)=>{var r=e-+t;return r=r||1/0,Math.max(0,Math.min(1,(n-t)/r))});var V5=t=>{var[e,n]=t,[r,s]=[e,n];return e>n&&([r,s]=[n,e]),[r,s]},W5=(t,e,n)=>{if(t.lte(0))return new wt(0);var r=B5(t.toNumber()),s=new wt(10).pow(r),i=t.div(s),o=r!==1?.05:.1,a=new wt(Math.ceil(i.div(o).toNumber())).add(n).mul(o),l=a.mul(s);return e?new wt(l.toNumber()):new wt(Math.ceil(l.toNumber()))},qPe=(t,e,n)=>{var r=new wt(1),s=new wt(t);if(!s.isint()&&n){var i=Math.abs(t);i<1?(r=new wt(10).pow(B5(t)-1),s=new wt(Math.floor(s.div(r).toNumber())).mul(r)):i>1&&(s=new wt(Math.floor(t)))}else t===0?s=new wt(Math.floor((e-1)/2)):n||(s=new wt(Math.floor(t)));var o=Math.floor((e-1)/2),a=KPe(HPe(l=>s.add(new wt(l-o).mul(r)).toNumber()),WT);return a(0,e)},U5=function(e,n,r,s){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-e)/(r-1)))return{step:new wt(0),tickMin:new wt(0),tickMax:new wt(0)};var o=W5(new wt(n).sub(e).div(r-1),s,i),a;e<=0&&n>=0?a=new wt(0):(a=new wt(e).add(n).div(2),a=a.sub(new wt(a).mod(o)));var l=Math.ceil(a.sub(e).div(o).toNumber()),u=Math.ceil(new wt(n).sub(a).div(o).toNumber()),c=l+u+1;return c>r?U5(e,n,r,s,i+1):(c<r&&(u=n>0?u+(r-c):u,l=n>0?l:l+(r-c)),{step:o,tickMin:a.sub(new wt(l).mul(o)),tickMax:a.add(new wt(u).mul(o))})};function XPe(t){var[e,n]=t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(r,2),[o,a]=V5([e,n]);if(o===-1/0||a===1/0){var l=a===1/0?[o,...WT(0,r-1).map(()=>1/0)]:[...WT(0,r-1).map(()=>-1/0),a];return e>n?UT(l):l}if(o===a)return qPe(o,r,s);var{step:u,tickMin:c,tickMax:d}=U5(o,a,i,s,0),f=j5(c,d.add(new wt(.1).mul(u)),u);return e>n?UT(f):f}function ZPe(t,e){var[n,r]=t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,o]=V5([n,r]);if(i===-1/0||o===1/0)return[n,r];if(i===o)return[i];var a=Math.max(e,2),l=W5(new wt(o).sub(i).div(a-1),s,0),u=[...j5(new wt(i),new wt(o),l),o];return s===!1&&(u=u.map(c=>Math.round(c))),n>r?UT(u):u}var YPe=z5(XPe),QPe=z5(ZPe),G5=t=>t.rootProps.maxBarSize,JPe=t=>t.rootProps.barGap,H5=t=>t.rootProps.barCategoryGap,eDe=t=>t.rootProps.barSize,x_=t=>t.rootProps.stackOffset,cA=t=>t.options.chartName,dA=t=>t.rootProps.syncId,K5=t=>t.rootProps.syncMethod,hA=t=>t.options.eventEmitter,ea={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ws={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},b_=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},tDe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:ea.angleAxisId,includeHidden:!1,name:void 0,reversed:ea.reversed,scale:ea.scale,tick:ea.tick,tickCount:void 0,ticks:void 0,type:ea.type,unit:void 0},nDe={allowDataOverflow:ws.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ws.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ws.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ws.scale,tick:ws.tick,tickCount:ws.tickCount,ticks:void 0,type:ws.type,unit:void 0},rDe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:ea.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ea.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ea.scale,tick:ea.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},sDe={allowDataOverflow:ws.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ws.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ws.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ws.scale,tick:ws.tick,tickCount:ws.tickCount,ticks:void 0,type:"category",unit:void 0},fA=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?rDe:tDe,pA=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?sDe:nDe,w_=t=>t.polarOptions,mA=he([Da,Ra,nr],s2e),q5=he([w_,mA],(t,e)=>{if(t!=null)return no(t.innerRadius,e,0)}),X5=he([w_,mA],(t,e)=>{if(t!=null)return no(t.outerRadius,e,e*.8)}),iDe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:n}=t;return[e,n]},Z5=he([w_],iDe);he([fA,Z5],b_);var Y5=he([mA,q5,X5],(t,e,n)=>{if(!(t==null||e==null||n==null))return[e,n]});he([pA,Y5],b_);var Q5=he([yt,w_,q5,X5,Da,Ra],(t,e,n,r,s,i)=>{if(!(t!=="centric"&&t!=="radial"||e==null||n==null||r==null)){var{cx:o,cy:a,startAngle:l,endAngle:u}=e;return{cx:no(o,s,s/2),cy:no(a,i,i/2),innerRadius:n,outerRadius:r,startAngle:l,endAngle:u,clockWise:!1}}}),Nn=(t,e)=>e,__=(t,e,n)=>n;function gA(t){return t==null?void 0:t.id}var zn=t=>{var e=yt(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Tf=t=>t.tooltip.settings.axisId,Bn=t=>{var e=zn(t),n=Tf(t);return Ey(t,e,n)};function J5(t,e,n){var{chartData:r=[]}=e,s=n==null?void 0:n.dataKey,i=new Map;return t.forEach(o=>{var a,l=(a=o.data)!==null&&a!==void 0?a:r;if(!(l==null||l.length===0)){var u=gA(o);l.forEach((c,d)=>{var f=s==null?d:String(qn(c,s,null)),p=qn(c,o.dataKey,0),m;i.has(f)?m=i.get(f):m={},Object.assign(m,{[u]:p}),i.set(f,m)})}}),Array.from(i.values())}function S_(t){return t.stackId!=null&&t.dataKey!=null}function SF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Vx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?SF(Object(n),!0).forEach(function(r){oDe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):SF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function oDe(t,e,n){return(e=aDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aDe(t){var e=lDe(t,"string");return typeof e=="symbol"?e:e+""}function lDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var GT=[0,"auto"],vs={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},jo=(t,e)=>{var n=t.cartesianAxis.xAxis[e];return n??vs},xs={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:GT,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:o_},Fa=(t,e)=>{var n=t.cartesianAxis.yAxis[e];return n??xs},uDe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},yA=(t,e)=>{var n=t.cartesianAxis.zAxis[e];return n??uDe},gs=(t,e,n)=>{switch(e){case"xAxis":return jo(t,n);case"yAxis":return Fa(t,n);case"zAxis":return yA(t,n);case"angleAxis":return fA(t,n);case"radiusAxis":return pA(t,n);default:throw new Error("Unexpected axis type: ".concat(e))}},cDe=(t,e,n)=>{switch(e){case"xAxis":return jo(t,n);case"yAxis":return Fa(t,n);default:throw new Error("Unexpected axis type: ".concat(e))}},Ey=(t,e,n)=>{switch(e){case"xAxis":return jo(t,n);case"yAxis":return Fa(t,n);case"angleAxis":return fA(t,n);case"radiusAxis":return pA(t,n);default:throw new Error("Unexpected axis type: ".concat(e))}},e8=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function t8(t,e){return n=>{switch(t){case"xAxis":return"xAxisId"in n&&n.xAxisId===e;case"yAxis":return"yAxisId"in n&&n.yAxisId===e;case"zAxis":return"zAxisId"in n&&n.zAxisId===e;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===e;default:return!1}}}var k_=t=>t.graphicalItems.cartesianItems,dDe=he([Nn,__],t8),n8=(t,e,n)=>t.filter(n).filter(r=>(e==null?void 0:e.includeHidden)===!0?!0:!r.hide),Ay=he([k_,gs,dDe],n8),r8=he([Ay],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(S_)),s8=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),i8=he([Ay],s8),o8=t=>t.map(e=>e.data).filter(Boolean).flat(1),hDe=he([Ay],o8),a8=(t,e)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:s}=e;return t.length>0?t:n.slice(r,s+1)},vA=he([hDe,y_],a8),l8=(t,e,n)=>(e==null?void 0:e.dataKey)!=null?t.map(r=>({value:qn(r,e.dataKey)})):n.length>0?n.map(r=>r.dataKey).flatMap(r=>t.map(s=>({value:qn(s,r)}))):t.map(r=>({value:r})),C_=he([vA,gs,Ay],l8);function u8(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function Lc(t){return t.filter(e=>yi(e)||e instanceof Date).map(Number).filter(e=>Ur(e)===!1)}function fDe(t,e,n){return!n||typeof e!="number"||Ur(e)?[]:n.length?Lc(n.flatMap(r=>{var s=qn(t,r.dataKey),i,o;if(Array.isArray(s)?[i,o]=s:i=o=s,!(!Fs(i)||!Fs(o)))return[e-i,e+o]})):[]}var pDe=he([r8,y_,Bn],J5),c8=(t,e,n)=>{var r={},s=e.reduce((i,o)=>(o.stackId==null||(i[o.stackId]==null&&(i[o.stackId]=[]),i[o.stackId].push(o)),i),r);return Object.fromEntries(Object.entries(s).map(i=>{var[o,a]=i,l=a.map(gA);return[o,{stackedData:b2e(t,l,n),graphicalItems:a}]}))},HT=he([pDe,r8,x_],c8),d8=(t,e,n)=>{var{dataStartIndex:r,dataEndIndex:s}=e;if(n!=="zAxis"){var i=C2e(t,r,s);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},mDe=he([HT,Xl,Nn],d8),h8=(t,e,n,r,s)=>n.length>0?t.flatMap(i=>n.flatMap(o=>{var a,l,u=(a=r[o.id])===null||a===void 0?void 0:a.filter(d=>u8(s,d)),c=qn(i,(l=e.dataKey)!==null&&l!==void 0?l:o.dataKey);return{value:c,errorDomain:fDe(i,c,u)}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(i=>({value:qn(i,e.dataKey),errorDomain:[]})):t.map(i=>({value:i,errorDomain:[]})),T_=t=>t.errorBars,f8=(t,e,n)=>t.flatMap(r=>e[r.id]).filter(Boolean).filter(r=>u8(n,r));he([i8,T_,Nn],f8);var gDe=he([vA,gs,i8,T_,Nn],h8);function yDe(t){var{value:e}=t;if(yi(e)||e instanceof Date)return e}var kF=t=>{var e=t.flatMap(r=>[r.value,r.errorDomain]).flat(1),n=Lc(e);if(n.length!==0)return[Math.min(...n),Math.max(...n)]},vDe=(t,e,n)=>{var r=t.map(yDe).filter(s=>s!=null);return n&&(e.dataKey==null||e.allowDuplicatedCategory&&rH(r))?Z6(0,t.length):e.allowDuplicatedCategory?r:Array.from(new Set(r))},xA=t=>{var e;if(t==null||!("domain"in t))return GT;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var n=Lc(t.ticks);return[Math.min(...n),Math.max(...n)]}if(t.type==="category")return t.ticks.map(String)}return(e=t==null?void 0:t.domain)!==null&&e!==void 0?e:GT},Wx=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var s=n.filter(Boolean);if(s.length!==0){var i=s.flat(),o=Math.min(...i),a=Math.max(...i);return[o,a]}},p8=t=>t.referenceElements.dots,Nf=(t,e,n)=>t.filter(r=>r.ifOverflow==="extendDomain").filter(r=>e==="xAxis"?r.xAxisId===n:r.yAxisId===n),xDe=he([p8,Nn,__],Nf),m8=t=>t.referenceElements.areas,bDe=he([m8,Nn,__],Nf),g8=t=>t.referenceElements.lines,wDe=he([g8,Nn,__],Nf),y8=(t,e)=>{var n=Lc(t.map(r=>e==="xAxis"?r.x:r.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},_De=he(xDe,Nn,y8),v8=(t,e)=>{var n=Lc(t.flatMap(r=>[e==="xAxis"?r.x1:r.y1,e==="xAxis"?r.x2:r.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},SDe=he([bDe,Nn],v8),x8=(t,e)=>{var n=Lc(t.map(r=>e==="xAxis"?r.x:r.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},kDe=he(wDe,Nn,x8),CDe=he(_De,kDe,SDe,(t,e,n)=>Wx(t,n,e)),TDe=he([gs],xA),b8=(t,e,n,r,s,i,o)=>{var a=BPe(e,t.allowDataOverflow);if(a!=null)return a;var l=i==="vertical"&&o==="xAxis"||i==="horizontal"&&o==="yAxis",u=l?Wx(n,s,kF(r)):Wx(s,kF(r));return jPe(e,u,t.allowDataOverflow)},NDe=he([gs,TDe,mDe,gDe,CDe,yt,Nn],b8),IDe=[0,1],w8=(t,e,n,r,s,i,o)=>{if(!((t==null||n==null||n.length===0)&&o===void 0)){var{dataKey:a,type:l}=t,u=Hl(e,i);return u&&a==null?Z6(0,n.length):l==="category"?vDe(r,t,u):s==="expand"?IDe:o}},bA=he([gs,yt,vA,C_,x_,Nn,NDe],w8),_8=(t,e,n,r,s)=>{if(t!=null){var{scale:i,type:o}=t;if(i==="auto")return e==="radial"&&s==="radiusAxis"?"band":e==="radial"&&s==="angleAxis"?"linear":o==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var a="scale".concat(ky(i));return a in _p?a:"point"}}},Oy=he([gs,yt,e8,cA,Nn],_8);function $De(t){if(t!=null){if(t in _p)return _p[t]();var e="scale".concat(ky(t));if(e in _p)return _p[e]()}}function wA(t,e,n,r){if(!(n==null||r==null)){if(typeof t.scale=="function")return t.scale.copy().domain(n).range(r);var s=$De(e);if(s!=null){var i=s.domain(n).range(r);return m2e(i),i}}}var S8=(t,e,n)=>{var r=xA(e);if(!(n!=="auto"&&n!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(r)&&(r[0]==="auto"||r[1]==="auto")&&ih(t))return YPe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&ih(t))return QPe(t,e.tickCount,e.allowDecimals)}},_A=he([bA,Ey,Oy],S8),k8=(t,e,n,r)=>{if(r!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&ih(e)&&Array.isArray(n)&&n.length>0){var s=e[0],i=n[0],o=e[1],a=n[n.length-1];return[Math.min(s,i),Math.max(o,a)]}return e},EDe=he([gs,bA,_A,Nn],k8),ADe=he(C_,gs,(t,e)=>{if(!(!e||e.type!=="number")){var n=1/0,r=Array.from(Lc(t.map(a=>a.value))).sort((a,l)=>a-l);if(r.length<2)return 1/0;var s=r[r.length-1]-r[0];if(s===0)return 1/0;for(var i=0;i<r.length-1;i++){var o=r[i+1]-r[i];n=Math.min(n,o)}return n/s}}),C8=he(ADe,yt,H5,nr,(t,e,n,r)=>r,(t,e,n,r,s)=>{if(!Fs(t))return 0;var i=e==="vertical"?r.height:r.width;if(s==="gap")return t*i/2;if(s==="no-gap"){var o=no(n,t*i),a=t*i/2;return a-o-(a-o)/i*o}return 0}),ODe=(t,e)=>{var n=jo(t,e);return n==null||typeof n.padding!="string"?0:C8(t,"xAxis",e,n.padding)},PDe=(t,e)=>{var n=Fa(t,e);return n==null||typeof n.padding!="string"?0:C8(t,"yAxis",e,n.padding)},DDe=he(jo,ODe,(t,e)=>{var n,r;if(t==null)return{left:0,right:0};var{padding:s}=t;return typeof s=="string"?{left:e,right:e}:{left:((n=s.left)!==null&&n!==void 0?n:0)+e,right:((r=s.right)!==null&&r!==void 0?r:0)+e}}),RDe=he(Fa,PDe,(t,e)=>{var n,r;if(t==null)return{top:0,bottom:0};var{padding:s}=t;return typeof s=="string"?{top:e,bottom:e}:{top:((n=s.top)!==null&&n!==void 0?n:0)+e,bottom:((r=s.bottom)!==null&&r!==void 0?r:0)+e}}),LDe=he([nr,DDe,l_,a_,(t,e,n)=>n],(t,e,n,r,s)=>{var{padding:i}=r;return s?[i.left,n.width-i.right]:[t.left+e.left,t.left+t.width-e.right]}),FDe=he([nr,yt,RDe,l_,a_,(t,e,n)=>n],(t,e,n,r,s,i)=>{var{padding:o}=s;return i?[r.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-n.bottom,t.top+n.top]:[t.top+n.top,t.top+t.height-n.bottom]}),Py=(t,e,n,r)=>{var s;switch(e){case"xAxis":return LDe(t,n,r);case"yAxis":return FDe(t,n,r);case"zAxis":return(s=yA(t,n))===null||s===void 0?void 0:s.range;case"angleAxis":return Z5(t);case"radiusAxis":return Y5(t,n);default:return}},T8=he([gs,Py],b_),$l=he([gs,Oy,EDe,T8],wA);he([Ay,T_,Nn],f8);function N8(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var N_=(t,e)=>e,I_=(t,e,n)=>n,MDe=he(PE,N_,I_,(t,e,n)=>t.filter(r=>r.orientation===e).filter(r=>r.mirror===n).sort(N8)),zDe=he(DE,N_,I_,(t,e,n)=>t.filter(r=>r.orientation===e).filter(r=>r.mirror===n).sort(N8)),I8=(t,e)=>({width:t.width,height:e.height}),BDe=(t,e)=>{var n=typeof e.width=="number"?e.width:o_;return{width:n,height:t.height}},$8=he(nr,jo,I8),jDe=(t,e,n)=>{switch(e){case"top":return t.top;case"bottom":return n-t.bottom;default:return 0}},VDe=(t,e,n)=>{switch(e){case"left":return t.left;case"right":return n-t.right;default:return 0}},WDe=he(Ra,nr,MDe,N_,I_,(t,e,n,r,s)=>{var i={},o;return n.forEach(a=>{var l=I8(e,a);o==null&&(o=jDe(e,r,t));var u=r==="top"&&!s||r==="bottom"&&s;i[a.id]=o-Number(u)*l.height,o+=(u?-1:1)*l.height}),i}),UDe=he(Da,nr,zDe,N_,I_,(t,e,n,r,s)=>{var i={},o;return n.forEach(a=>{var l=BDe(e,a);o==null&&(o=VDe(e,r,t));var u=r==="left"&&!s||r==="right"&&s;i[a.id]=o-Number(u)*l.width,o+=(u?-1:1)*l.width}),i}),GDe=(t,e)=>{var n=nr(t),r=jo(t,e);if(r!=null){var s=WDe(t,r.orientation,r.mirror),i=s[e];return i==null?{x:n.left,y:0}:{x:n.left,y:i}}},HDe=(t,e)=>{var n=nr(t),r=Fa(t,e);if(r!=null){var s=UDe(t,r.orientation,r.mirror),i=s[e];return i==null?{x:0,y:n.top}:{x:i,y:n.top}}},E8=he(nr,Fa,(t,e)=>{var n=typeof e.width=="number"?e.width:o_;return{width:n,height:t.height}}),CF=(t,e,n)=>{switch(e){case"xAxis":return $8(t,n).width;case"yAxis":return E8(t,n).height;default:return}},A8=(t,e,n,r)=>{if(n!=null){var{allowDuplicatedCategory:s,type:i,dataKey:o}=n,a=Hl(t,r),l=e.map(u=>u.value);if(o&&a&&i==="category"&&s&&rH(l))return l}},SA=he([yt,C_,gs,Nn],A8),O8=(t,e,n,r)=>{if(!(n==null||n.dataKey==null)){var{type:s,scale:i}=n,o=Hl(t,r);if(o&&(s==="number"||i!=="auto"))return e.map(a=>a.value)}},kA=he([yt,C_,Ey,Nn],O8),TF=he([yt,cDe,Oy,$l,SA,kA,Py,_A,Nn],(t,e,n,r,s,i,o,a,l)=>{if(e==null)return null;var u=Hl(t,l);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:l,categoricalDomain:i,duplicateDomain:s,isCategorical:u,niceTicks:a,range:o,realScaleType:n,scale:r}}),KDe=(t,e,n,r,s,i,o,a,l)=>{if(!(e==null||r==null)){var u=Hl(t,l),{type:c,ticks:d,tickCount:f}=e,p=n==="scaleBand"&&typeof r.bandwidth=="function"?r.bandwidth()/2:2,m=c==="category"&&r.bandwidth?r.bandwidth()/p:0;m=l==="angleAxis"&&i!=null&&i.length>=2?is(i[0]-i[1])*2*m:m;var y=d||s;if(y){var v=y.map((x,b)=>{var _=o?o.indexOf(x):x;return{index:b,coordinate:r(_)+m,value:x,offset:m}});return v.filter(x=>!Ur(x.coordinate))}return u&&a?a.map((x,b)=>({coordinate:r(x)+m,value:x,index:b,offset:m})):r.ticks?r.ticks(f).map(x=>({coordinate:r(x)+m,value:x,offset:m})):r.domain().map((x,b)=>({coordinate:r(x)+m,value:o?o[x]:x,index:b,offset:m}))}},P8=he([yt,Ey,Oy,$l,_A,Py,SA,kA,Nn],KDe),qDe=(t,e,n,r,s,i,o)=>{if(!(e==null||n==null||r==null||r[0]===r[1])){var a=Hl(t,o),{tickCount:l}=e,u=0;return u=o==="angleAxis"&&(r==null?void 0:r.length)>=2?is(r[0]-r[1])*2*u:u,a&&i?i.map((c,d)=>({coordinate:n(c)+u,value:c,index:d,offset:u})):n.ticks?n.ticks(l).map(c=>({coordinate:n(c)+u,value:c,offset:u})):n.domain().map((c,d)=>({coordinate:n(c)+u,value:s?s[c]:c,index:d,offset:u}))}},El=he([yt,Ey,$l,Py,SA,kA,Nn],qDe),Al=he(gs,$l,(t,e)=>{if(!(t==null||e==null))return Vx(Vx({},t),{},{scale:e})}),XDe=he([gs,Oy,bA,T8],wA);he((t,e,n)=>yA(t,n),XDe,(t,e)=>{if(!(t==null||e==null))return Vx(Vx({},t),{},{scale:e})});var ZDe=he([yt,PE,DE],(t,e,n)=>{switch(t){case"horizontal":return e.some(r=>r.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(r=>r.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),D8=t=>t.options.defaultTooltipEventType,R8=t=>t.options.validateTooltipEventTypes;function L8(t,e,n){if(t==null)return e;var r=t?"axis":"item";return n==null?e:n.includes(r)?r:e}function CA(t,e){var n=D8(t),r=R8(t);return L8(e,n,r)}function YDe(t){return Fe(e=>CA(e,t))}var F8=(t,e)=>{var n,r=Number(e);if(!(Ur(r)||e==null))return r>=0?t==null||(n=t[r])===null||n===void 0?void 0:n.value:void 0},QDe=t=>t.tooltip.settings,Za={active:!1,index:null,dataKey:void 0,coordinate:void 0},JDe={itemInteraction:{click:Za,hover:Za},axisInteraction:{click:Za,hover:Za},keyboardInteraction:Za,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},M8=Vs({name:"tooltip",initialState:JDe,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var n=la(t).tooltipItemPayloads.indexOf(e.payload);n>-1&&t.tooltipItemPayloads.splice(n,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:eRe,removeTooltipEntrySettings:tRe,setTooltipSettingsState:nRe,setActiveMouseOverItemIndex:z8,mouseLeaveItem:rRe,mouseLeaveChart:B8,setActiveClickItemIndex:sRe,setMouseOverAxisIndex:j8,setMouseClickAxisIndex:iRe,setSyncInteraction:KT,setKeyboardInteraction:qT}=M8.actions,oRe=M8.reducer;function NF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Hv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?NF(Object(n),!0).forEach(function(r){aRe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):NF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function aRe(t,e,n){return(e=lRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lRe(t){var e=uRe(t,"string");return typeof e=="symbol"?e:e+""}function uRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cRe(t,e,n){return e==="axis"?n==="click"?t.axisInteraction.click:t.axisInteraction.hover:n==="click"?t.itemInteraction.click:t.itemInteraction.hover}function dRe(t){return t.index!=null}var V8=(t,e,n,r)=>{if(e==null)return Za;var s=cRe(t,e,n);if(s==null)return Za;if(s.active)return s;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var i=t.settings.active===!0;if(dRe(s)){if(i)return Hv(Hv({},s),{},{active:!0})}else if(r!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return Hv(Hv({},Za),{},{coordinate:s.coordinate})},TA=(t,e)=>{var n=t==null?void 0:t.index;if(n==null)return null;var r=Number(n);if(!Fs(r))return n;var s=0,i=1/0;return e.length>0&&(i=e.length-1),String(Math.max(s,Math.min(r,i)))},W8=(t,e,n,r,s,i,o,a)=>{if(!(i==null||a==null)){var l=o[0],u=l==null?void 0:a(l.positions,i);if(u!=null)return u;var c=s==null?void 0:s[Number(i)];if(c)switch(n){case"horizontal":return{x:c.coordinate,y:(r.top+e)/2};default:return{x:(r.left+t)/2,y:c.coordinate}}}},U8=(t,e,n,r)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var s;return n==="hover"?s=t.itemInteraction.hover.dataKey:s=t.itemInteraction.click.dataKey,s==null&&r!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(i=>{var o;return((o=i.settings)===null||o===void 0?void 0:o.dataKey)===s})},Dy=t=>t.options.tooltipPayloadSearcher,If=t=>t.tooltip;function IF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function $F(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?IF(Object(n),!0).forEach(function(r){hRe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):IF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function hRe(t,e,n){return(e=fRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fRe(t){var e=pRe(t,"string");return typeof e=="symbol"?e:e+""}function pRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mRe(t,e){return t??e}var G8=(t,e,n,r,s,i,o)=>{if(!(e==null||i==null)){var{chartData:a,computedData:l,dataStartIndex:u,dataEndIndex:c}=n,d=[];return t.reduce((f,p)=>{var m,{dataDefinedOnItem:y,settings:v}=p,x=mRe(y,a),b=Array.isArray(x)?k6(x,u,c):x,_=(m=v==null?void 0:v.dataKey)!==null&&m!==void 0?m:r==null?void 0:r.dataKey,S=v==null?void 0:v.nameKey,k;if(r!=null&&r.dataKey&&Array.isArray(b)&&!Array.isArray(b[0])&&o==="axis"?k=sH(b,r.dataKey,s):k=i(b,e,l,S),Array.isArray(k))k.forEach($=>{var A=$F($F({},v),{},{name:$.name,unit:$.unit,color:void 0,fill:void 0});f.push(yL({tooltipEntrySettings:A,dataKey:$.dataKey,payload:$.payload,value:qn($.payload,$.dataKey),name:$.name}))});else{var T;f.push(yL({tooltipEntrySettings:v,dataKey:_,payload:k,value:qn(k,_),name:(T=qn(k,S))!==null&&T!==void 0?T:v==null?void 0:v.name}))}return f},d)}},NA=he([Bn,yt,e8,cA,zn],_8),gRe=he([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),yRe=he([zn,Tf],t8),Ry=he([gRe,Bn,yRe],n8),vRe=he([Ry],t=>t.filter(S_)),xRe=he([Ry],o8),$f=he([xRe,Xl],a8),bRe=he([vRe,Xl,Bn],J5),IA=he([$f,Bn,Ry],l8),wRe=he([Bn],xA),_Re=he([Ry],t=>t.filter(S_)),SRe=he([bRe,_Re,x_],c8),kRe=he([SRe,Xl,zn],d8),CRe=he([Ry],s8),TRe=he([$f,Bn,CRe,T_,zn],h8),NRe=he([p8,zn,Tf],Nf),IRe=he([NRe,zn],y8),$Re=he([m8,zn,Tf],Nf),ERe=he([$Re,zn],v8),ARe=he([g8,zn,Tf],Nf),ORe=he([ARe,zn],x8),PRe=he([IRe,ORe,ERe],Wx),DRe=he([Bn,wRe,kRe,TRe,PRe,yt,zn],b8),H8=he([Bn,yt,$f,IA,x_,zn,DRe],w8),RRe=he([H8,Bn,NA],S8),LRe=he([Bn,H8,RRe,zn],k8),K8=t=>{var e=zn(t),n=Tf(t),r=!1;return Py(t,e,n,r)},q8=he([Bn,K8],b_),X8=he([Bn,NA,LRe,q8],wA),FRe=he([yt,IA,Bn,zn],A8),MRe=he([yt,IA,Bn,zn],O8),zRe=(t,e,n,r,s,i,o,a)=>{if(e){var{type:l}=e,u=Hl(t,a);if(r){var c=n==="scaleBand"&&r.bandwidth?r.bandwidth()/2:2,d=l==="category"&&r.bandwidth?r.bandwidth()/c:0;return d=a==="angleAxis"&&s!=null&&(s==null?void 0:s.length)>=2?is(s[0]-s[1])*2*d:d,u&&o?o.map((f,p)=>({coordinate:r(f)+d,value:f,index:p,offset:d})):r.domain().map((f,p)=>({coordinate:r(f)+d,value:i?i[f]:f,index:p,offset:d}))}}},Ma=he([yt,Bn,NA,X8,K8,FRe,MRe,zn],zRe),$A=he([D8,R8,QDe],(t,e,n)=>L8(n.shared,t,e)),Z8=t=>t.tooltip.settings.trigger,EA=t=>t.tooltip.settings.defaultIndex,$_=he([If,$A,Z8,EA],V8),fc=he([$_,$f],TA),Y8=he([Ma,fc],F8),Q8=he([$_],t=>{if(t)return t.dataKey}),J8=he([If,$A,Z8,EA],U8),BRe=he([Da,Ra,yt,nr,Ma,EA,J8,Dy],W8),jRe=he([$_,BRe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),VRe=he([$_],t=>t.active),WRe=he([J8,fc,Xl,Bn,Y8,Dy,$A],G8),URe=he([WRe],t=>{if(t!=null){var e=t.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(e))}});function EF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function AF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?EF(Object(n),!0).forEach(function(r){GRe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):EF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function GRe(t,e,n){return(e=HRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HRe(t){var e=KRe(t,"string");return typeof e=="symbol"?e:e+""}function KRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qRe=()=>Fe(Bn),XRe=()=>{var t=qRe(),e=Fe(Ma),n=Fe(X8);return _m(AF(AF({},t),{},{scale:n}),e)},ZRe=()=>Fe(cA),AA=(t,e)=>e,eK=(t,e,n)=>n,OA=(t,e,n,r)=>r,YRe=he(Ma,t=>Q1(t,e=>e.coordinate)),PA=he([If,AA,eK,OA],V8),tK=he([PA,$f],TA),QRe=(t,e,n)=>{if(e!=null){var r=If(t);return e==="axis"?n==="hover"?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:n==="hover"?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}},nK=he([If,AA,eK,OA],U8),Ux=he([Da,Ra,yt,nr,Ma,OA,nK,Dy],W8),JRe=he([PA,Ux],(t,e)=>{var n;return(n=t.coordinate)!==null&&n!==void 0?n:e}),rK=he(Ma,tK,F8),eLe=he([nK,tK,Xl,Bn,rK,Dy,AA],G8),tLe=he([PA],t=>({isActive:t.active,activeIndex:t.index})),nLe=(t,e,n,r,s,i,o,a)=>{if(!(!t||!e||!r||!s||!i)){var l=T2e(t.chartX,t.chartY,e,n,a);if(l){var u=I2e(l,e),c=f2e(u,o,i,r,s),d=N2e(e,i,c,l);return{activeIndex:String(c),activeCoordinate:d}}}};function XT(){return XT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},XT.apply(null,arguments)}function OF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Kv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?OF(Object(n),!0).forEach(function(r){rLe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function rLe(t,e,n){return(e=sLe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sLe(t){var e=iLe(t,"string");return typeof e=="symbol"?e:e+""}function iLe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oLe(t){var{coordinate:e,payload:n,index:r,offset:s,tooltipAxisBandSize:i,layout:o,cursor:a,tooltipEventType:l,chartName:u}=t,c=e,d=n,f=r;if(!a||!c||u!=="ScatterChart"&&l!=="axis")return null;var p,m;if(u==="ScatterChart")p=c,m=$Ee;else if(u==="BarChart")p=EEe(o,c,s,i),m=W6;else if(o==="radial"){var{cx:y,cy:v,radius:x,startAngle:b,endAngle:_}=U6(c);p={cx:y,cy:v,startAngle:b,endAngle:_,innerRadius:x,outerRadius:x},m=H6}else p={points:uAe(o,c,s)},m=O6;var S=typeof a=="object"&&"className"in a?a.className:void 0,k=Kv(Kv(Kv(Kv({stroke:"#ccc",pointerEvents:"none"},s),p),Qt(a,!1)),{},{payload:d,payloadIndex:f,className:xt("recharts-tooltip-cursor",S)});return E.isValidElement(a)?E.cloneElement(a,k):E.createElement(m,k)}function aLe(t){var e=XRe(),n=$6(),r=c_(),s=ZRe();return E.createElement(oLe,XT({},t,{coordinate:t.coordinate,index:t.index,payload:t.payload,offset:n,layout:r,tooltipAxisBandSize:e,chartName:s}))}var sK=E.createContext(null),lLe=()=>E.useContext(sK),iK={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function i(l,u,c,d,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var p=new s(c,d||l,f),m=n?n+u:u;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],p]:l._events[m].push(p):(l._events[m]=p,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,d;if(this._eventsCount===0)return u;for(d in c=this._events)e.call(c,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=n?n+u:u,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,p=d.length,m=new Array(p);f<p;f++)m[f]=d[f].fn;return m},a.prototype.listenerCount=function(u){var c=n?n+u:u,d=this._events[c];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,c,d,f,p,m){var y=n?n+u:u;if(!this._events[y])return!1;var v=this._events[y],x=arguments.length,b,_;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,c),!0;case 3:return v.fn.call(v.context,c,d),!0;case 4:return v.fn.call(v.context,c,d,f),!0;case 5:return v.fn.call(v.context,c,d,f,p),!0;case 6:return v.fn.call(v.context,c,d,f,p,m),!0}for(_=1,b=new Array(x-1);_<x;_++)b[_-1]=arguments[_];v.fn.apply(v.context,b)}else{var S=v.length,k;for(_=0;_<S;_++)switch(v[_].once&&this.removeListener(u,v[_].fn,void 0,!0),x){case 1:v[_].fn.call(v[_].context);break;case 2:v[_].fn.call(v[_].context,c);break;case 3:v[_].fn.call(v[_].context,c,d);break;case 4:v[_].fn.call(v[_].context,c,d,f);break;default:if(!b)for(k=1,b=new Array(x-1);k<x;k++)b[k-1]=arguments[k];v[_].fn.apply(v[_].context,b)}}return!0},a.prototype.on=function(u,c,d){return i(this,u,c,d,!1)},a.prototype.once=function(u,c,d){return i(this,u,c,d,!0)},a.prototype.removeListener=function(u,c,d,f){var p=n?n+u:u;if(!this._events[p])return this;if(!c)return o(this,p),this;var m=this._events[p];if(m.fn)m.fn===c&&(!f||m.once)&&(!d||m.context===d)&&o(this,p);else{for(var y=0,v=[],x=m.length;y<x;y++)(m[y].fn!==c||f&&!m[y].once||d&&m[y].context!==d)&&v.push(m[y]);v.length?this._events[p]=v.length===1?v[0]:v:o(this,p)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=n?n+u:u,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(iK);var uLe=iK.exports;const cLe=wi(uLe);var $m=new cLe,ZT="recharts.syncEvent.tooltip",PF="recharts.syncEvent.brush";function oK(t,e){if(e){var n=Number.parseInt(e,10);if(!Ur(n))return t==null?void 0:t[n]}}var dLe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},aK=Vs({name:"options",initialState:dLe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),hLe=aK.reducer,{createEventEmitter:fLe}=aK.actions;function pLe(t){return t.tooltip.syncInteraction}var mLe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},lK=Vs({name:"chartData",initialState:mLe,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:n,endIndex:r}=e.payload;n!=null&&(t.dataStartIndex=n),r!=null&&(t.dataEndIndex=r)}}}),{setChartData:DF,setDataStartEndIndexes:gLe,setComputedData:Dje}=lK.actions,yLe=lK.reducer,uK=()=>{};function vLe(){var t=Fe(dA),e=Fe(hA),n=gn(),r=Fe(K5),s=Fe(Ma),i=c_(),o=u_(),a=Fe(l=>l.rootProps.className);E.useEffect(()=>{if(t==null)return uK;var l=(u,c,d)=>{if(e!==d&&t===u){if(r==="index"){n(c);return}if(s!=null){var f;if(typeof r=="function"){var p={activeTooltipIndex:c.payload.index==null?void 0:Number(c.payload.index),isTooltipActive:c.payload.active,activeIndex:c.payload.index==null?void 0:Number(c.payload.index),activeLabel:c.payload.label,activeDataKey:c.payload.dataKey,activeCoordinate:c.payload.coordinate},m=r(s,p);f=s[m]}else r==="value"&&(f=s.find(T=>String(T.value)===c.payload.label));var{coordinate:y}=c.payload;if(f==null||c.payload.active===!1||y==null||o==null){n(KT({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:v,y:x}=y,b=Math.min(v,o.x+o.width),_=Math.min(x,o.y+o.height),S={x:i==="horizontal"?f.coordinate:b,y:i==="horizontal"?_:f.coordinate},k=KT({active:c.payload.active,coordinate:S,dataKey:c.payload.dataKey,index:String(f.index),label:c.payload.label});n(k)}}};return $m.on(ZT,l),()=>{$m.off(ZT,l)}},[a,n,e,t,r,s,i,o])}function xLe(){var t=Fe(dA),e=Fe(hA),n=gn();E.useEffect(()=>{if(t==null)return uK;var r=(s,i,o)=>{e!==o&&t===s&&n(gLe(i))};return $m.on(PF,r),()=>{$m.off(PF,r)}},[n,e,t])}function bLe(){var t=gn();E.useEffect(()=>{t(fLe())},[t]),vLe(),xLe()}function wLe(t,e,n,r,s,i){var o=Fe(f=>QRe(f,t,e)),a=Fe(hA),l=Fe(dA),u=Fe(K5),c=Fe(pLe),d=c==null?void 0:c.active;E.useEffect(()=>{if(!d&&l!=null&&a!=null){var f=KT({active:i,coordinate:n,dataKey:o,index:s,label:typeof r=="number"?String(r):r});$m.emit(ZT,l,f,a)}},[d,n,o,s,r,a,l,u,i])}function RF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function LF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?RF(Object(n),!0).forEach(function(r){_Le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _Le(t,e,n){return(e=SLe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SLe(t){var e=kLe(t,"string");return typeof e=="symbol"?e:e+""}function kLe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CLe(t){return t.dataKey}function TLe(t,e){return E.isValidElement(t)?E.cloneElement(t,e):typeof t=="function"?E.createElement(t,e):E.createElement(aEe,e)}var FF=[],NLe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!_f.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function YT(t){var e=Bo(t,NLe),{active:n,allowEscapeViewBox:r,animationDuration:s,animationEasing:i,content:o,filterNull:a,isAnimationActive:l,offset:u,payloadUniqBy:c,position:d,reverseDirection:f,useTranslate3d:p,wrapperStyle:m,cursor:y,shared:v,trigger:x,defaultIndex:b,portal:_,axisId:S}=e,k=gn(),T=typeof b=="number"?String(b):b;E.useEffect(()=>{k(nRe({shared:v,trigger:x,axisId:S,active:n,defaultIndex:T}))},[k,v,x,S,n,T]);var $=u_(),A=A6(),D=YDe(v),{activeIndex:F,isActive:M}=Fe(de=>tLe(de,D,x,T)),j=Fe(de=>eLe(de,D,x,T)),H=Fe(de=>rK(de,D,x,T)),K=Fe(de=>JRe(de,D,x,T)),Q=j,Z=lLe(),se=n??M,[B,J]=JH([Q,se]),Y=D==="axis"?H:void 0;wLe(D,x,K,Y,F,se);var ie=_??Z;if(ie==null)return null;var ne=Q??FF;se||(ne=FF),a&&ne.length&&(ne=jH(Q.filter(de=>de.value!=null&&(de.hide!==!0||e.includeHidden)),c,CLe));var pe=ne.length>0,me=E.createElement(pEe,{allowEscapeViewBox:r,animationDuration:s,animationEasing:i,isAnimationActive:l,active:se,coordinate:K,hasPayload:pe,offset:u,position:d,reverseDirection:f,useTranslate3d:p,viewBox:$,wrapperStyle:m,lastBoundingBox:B,innerRef:J,hasPortalFromProps:!!_},TLe(o,LF(LF({},e),{},{payload:ne,label:Y,active:se,coordinate:K,accessibilityLayer:A})));return E.createElement(E.Fragment,null,mb.createPortal(me,ie),se&&E.createElement(aLe,{cursor:y,tooltipEventType:D,coordinate:K,payload:Q,index:F}))}var cK={},dK={},hK={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,r,{signal:s,edges:i}={}){let o,a=null;const l=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),c=()=>{a!==null&&(n.apply(o,a),o=void 0,a=null)},d=()=>{u&&c(),y()};let f=null;const p=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,d()},r)},m=()=>{f!==null&&(clearTimeout(f),f=null)},y=()=>{m(),o=void 0,a=null},v=()=>{c()},x=function(...b){if(s!=null&&s.aborted)return;o=this,a=b;const _=f==null;p(),l&&_&&c()};return x.schedule=p,x.cancel=y,x.flush=v,s==null||s.addEventListener("abort",y,{once:!0}),x}t.debounce=e})(hK);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hK;function n(r,s=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:a=!0,maxWait:l}=i,u=Array(2);o&&(u[0]="leading"),a&&(u[1]="trailing");let c,d=null;const f=e.debounce(function(...y){c=r.apply(this,y),d=null},s,{edges:u}),p=function(...y){return l!=null&&(d===null&&(d=Date.now()),Date.now()-d>=l)?(c=r.apply(this,y),d=Date.now(),f.cancel(),f.schedule(),c):(f.apply(this,y),c)},m=()=>(f.flush(),c);return p.cancel=f.cancel,p.flush=m,p}t.debounce=n})(dK);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=dK;function n(r,s=0,i={}){const{leading:o=!0,trailing:a=!0}=i;return e.debounce(r,s,{leading:o,maxWait:s,trailing:a})}t.throttle=n})(cK);var ILe=cK.throttle;const $Le=wi(ILe);var Pp=function(e,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i]};function MF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function mk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?MF(Object(n),!0).forEach(function(r){ELe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):MF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ELe(t,e,n){return(e=ALe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ALe(t){var e=OLe(t,"string");return typeof e=="symbol"?e:e+""}function OLe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fK=E.forwardRef((t,e)=>{var{aspect:n,initialDimension:r={width:-1,height:-1},width:s="100%",height:i="100%",minWidth:o=0,minHeight:a,maxHeight:l,children:u,debounce:c=0,id:d,className:f,onResize:p,style:m={}}=t,y=E.useRef(null),v=E.useRef();v.current=p,E.useImperativeHandle(e,()=>y.current);var[x,b]=E.useState({containerWidth:r.width,containerHeight:r.height}),_=E.useCallback((k,T)=>{b($=>{var A=Math.round(k),D=Math.round(T);return $.containerWidth===A&&$.containerHeight===D?$:{containerWidth:A,containerHeight:D}})},[]);E.useEffect(()=>{var k=D=>{var F,{width:M,height:j}=D[0].contentRect;_(M,j),(F=v.current)===null||F===void 0||F.call(v,M,j)};c>0&&(k=$Le(k,c,{trailing:!0,leading:!1}));var T=new ResizeObserver(k),{width:$,height:A}=y.current.getBoundingClientRect();return _($,A),T.observe(y.current),()=>{T.disconnect()}},[_,c]);var S=E.useMemo(()=>{var{containerWidth:k,containerHeight:T}=x;if(k<0||T<0)return null;Pp(Nu(s)||Nu(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,i),Pp(!n||n>0,"The aspect(%s) must be greater than zero.",n);var $=Nu(s)?k:s,A=Nu(i)?T:i;return n&&n>0&&($?A=$/n:A&&($=A*n),l&&A>l&&(A=l)),Pp($>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,$,A,s,i,o,a,n),E.Children.map(u,D=>E.cloneElement(D,{width:$,height:A,style:mk({width:$,height:A},D.props.style)}))},[n,u,i,l,a,o,x,s]);return E.createElement("div",{id:d?"".concat(d):void 0,className:xt("recharts-responsive-container",f),style:mk(mk({},m),{},{width:s,height:i,minWidth:o,minHeight:a,maxHeight:l}),ref:y},E.createElement("div",{style:{width:0,height:0,overflow:"visible"}},S))}),pK=t=>null;pK.displayName="Cell";function PLe(t,e,n){return(e=DLe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DLe(t){var e=RLe(t,"string");return typeof e=="symbol"?e:e+""}function RLe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LLe{constructor(e){PLe(this,"cache",new Map),this.maxSize=e}get(e){var n=this.cache.get(e);return n!==void 0&&(this.cache.delete(e),this.cache.set(e,n)),n}set(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function zF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function FLe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?zF(Object(n),!0).forEach(function(r){MLe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function MLe(t,e,n){return(e=zLe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zLe(t){var e=BLe(t,"string");return typeof e=="symbol"?e:e+""}function BLe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jLe={cacheSize:2e3,enableCache:!0},mK=FLe({},jLe),BF=new LLe(mK.cacheSize),VLe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},jF="recharts_measurement_span";function WLe(t,e){var n=e.fontSize||"",r=e.fontFamily||"",s=e.fontWeight||"",i=e.fontStyle||"",o=e.letterSpacing||"",a=e.textTransform||"";return"".concat(t,"|").concat(n,"|").concat(r,"|").concat(s,"|").concat(i,"|").concat(o,"|").concat(a)}var VF=(t,e)=>{try{var n=document.getElementById(jF);n||(n=document.createElement("span"),n.setAttribute("id",jF),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,VLe,e),n.textContent="".concat(t);var r=n.getBoundingClientRect();return{width:r.width,height:r.height}}catch{return{width:0,height:0}}},Dp=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||_f.isSsr)return{width:0,height:0};if(!mK.enableCache)return VF(e,n);var r=WLe(e,n),s=BF.get(r);if(s)return s;var i=VF(e,n);return BF.set(r,i),i},WF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,UF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ULe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,GLe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,gK={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},HLe=Object.keys(gK),pd="NaN";function KLe(t,e){return t*gK[e]}class Jr{static parse(e){var n,[,r,s]=(n=GLe.exec(e))!==null&&n!==void 0?n:[];return new Jr(parseFloat(r),s??"")}constructor(e,n){this.num=e,this.unit=n,this.num=e,this.unit=n,Ur(e)&&(this.unit=""),n!==""&&!ULe.test(n)&&(this.num=NaN,this.unit=""),HLe.includes(n)&&(this.num=KLe(e,n),this.unit="px")}add(e){return this.unit!==e.unit?new Jr(NaN,""):new Jr(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new Jr(NaN,""):new Jr(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Jr(NaN,""):new Jr(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new Jr(NaN,""):new Jr(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ur(this.num)}}function yK(t){if(t.includes(pd))return pd;for(var e=t;e.includes("*")||e.includes("/");){var n,[,r,s,i]=(n=WF.exec(e))!==null&&n!==void 0?n:[],o=Jr.parse(r??""),a=Jr.parse(i??""),l=s==="*"?o.multiply(a):o.divide(a);if(l.isNaN())return pd;e=e.replace(WF,l.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,c,d,f]=(u=UF.exec(e))!==null&&u!==void 0?u:[],p=Jr.parse(c??""),m=Jr.parse(f??""),y=d==="+"?p.add(m):p.subtract(m);if(y.isNaN())return pd;e=e.replace(UF,y.toString())}return e}var GF=/\(([^()]*)\)/;function qLe(t){for(var e=t,n;(n=GF.exec(e))!=null;){var[,r]=n;e=e.replace(GF,yK(r))}return e}function XLe(t){var e=t.replace(/\s+/g,"");return e=qLe(e),e=yK(e),e}function ZLe(t){try{return XLe(t)}catch{return pd}}function gk(t){var e=ZLe(t.slice(5,-1));return e===pd?"":e}var YLe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],QLe=["dx","dy","angle","className","breakAll"];function QT(){return QT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},QT.apply(null,arguments)}function HF(t,e){if(t==null)return{};var n,r,s=JLe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function JLe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var vK=/[ \f\n\r\t\v\u2028\u2029]+/,xK=t=>{var{children:e,breakAll:n,style:r}=t;try{var s=[];jt(e)||(n?s=e.toString().split(""):s=e.toString().split(vK));var i=s.map(a=>({word:a,width:Dp(a,r).width})),o=n?0:Dp(" ",r).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}},eFe=(t,e,n,r,s)=>{var{maxLines:i,children:o,style:a,breakAll:l}=t,u=De(i),c=o,d=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return M.reduce((j,H)=>{var{word:K,width:Q}=H,Z=j[j.length-1];if(Z&&(r==null||s||Z.width+Q+n<Number(r)))Z.words.push(K),Z.width+=Q+n;else{var se={words:[K],width:Q};j.push(se)}return j},[])},f=d(e),p=F=>F.reduce((M,j)=>M.width>j.width?M:j);if(!u||s)return f;var m=f.length>i||p(f).width>Number(r);if(!m)return f;for(var y="…",v=F=>{var M=c.slice(0,F),j=xK({breakAll:l,style:a,children:M+y}).wordsWithComputedWidth,H=d(j),K=H.length>i||p(H).width>Number(r);return[K,H]},x=0,b=c.length-1,_=0,S;x<=b&&_<=c.length-1;){var k=Math.floor((x+b)/2),T=k-1,[$,A]=v(T),[D]=v(k);if(!$&&!D&&(x=k+1),$&&D&&(b=k-1),!$&&D){S=A;break}_++}return S||f},KF=t=>{var e=jt(t)?[]:t.toString().split(vK);return[{words:e}]},tFe=t=>{var{width:e,scaleToFit:n,children:r,style:s,breakAll:i,maxLines:o}=t;if((e||n)&&!_f.isSsr){var a,l,u=xK({breakAll:i,children:r,style:s});if(u){var{wordsWithComputedWidth:c,spaceWidth:d}=u;a=c,l=d}else return KF(r);return eFe({breakAll:i,children:r,maxLines:o,style:s},a,l,e,n)}return KF(r)},qF="#808080",DA=E.forwardRef((t,e)=>{var{x:n=0,y:r=0,lineHeight:s="1em",capHeight:i="0.71em",scaleToFit:o=!1,textAnchor:a="start",verticalAnchor:l="end",fill:u=qF}=t,c=HF(t,YLe),d=E.useMemo(()=>tFe({breakAll:c.breakAll,children:c.children,maxLines:c.maxLines,scaleToFit:o,style:c.style,width:c.width}),[c.breakAll,c.children,c.maxLines,o,c.style,c.width]),{dx:f,dy:p,angle:m,className:y,breakAll:v}=c,x=HF(c,QLe);if(!yi(n)||!yi(r))return null;var b=n+(De(f)?f:0),_=r+(De(p)?p:0),S;switch(l){case"start":S=gk("calc(".concat(i,")"));break;case"middle":S=gk("calc(".concat((d.length-1)/2," * -").concat(s," + (").concat(i," / 2))"));break;default:S=gk("calc(".concat(d.length-1," * -").concat(s,")"));break}var k=[];if(o){var T=d[0].width,{width:$}=c;k.push("scale(".concat(De($)?$/T:1,")"))}return m&&k.push("rotate(".concat(m,", ").concat(b,", ").concat(_,")")),k.length&&(x.transform=k.join(" ")),E.createElement("text",QT({},Qt(x,!0),{ref:e,x:b,y:_,className:xt("recharts-text",y),textAnchor:a,fill:u.includes("url")?qF:u}),d.map((A,D)=>{var F=A.words.join(v?"":" ");return E.createElement("tspan",{x:b,dy:D===0?S:s,key:"".concat(F,"-").concat(D)},F)}))});DA.displayName="Text";var nFe=["offset"],rFe=["labelRef"];function XF(t,e){if(t==null)return{};var n,r,s=sFe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function sFe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function ZF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function tn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ZF(Object(n),!0).forEach(function(r){iFe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function iFe(t,e,n){return(e=oFe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oFe(t){var e=aFe(t,"string");return typeof e=="symbol"?e:e+""}function aFe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ta(){return ta=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ta.apply(null,arguments)}var lFe=t=>{var{value:e,formatter:n}=t,r=jt(t.children)?e:t.children;return typeof n=="function"?n(r):r},RA=t=>t!=null&&typeof t=="function",uFe=(t,e)=>{var n=is(e-t),r=Math.min(Math.abs(e-t),360);return n*r},cFe=(t,e,n,r)=>{var{position:s,offset:i,className:o}=t,{cx:a,cy:l,innerRadius:u,outerRadius:c,startAngle:d,endAngle:f,clockWise:p}=r,m=(u+c)/2,y=uFe(d,f),v=y>=0?1:-1,x,b;s==="insideStart"?(x=d+v*i,b=p):s==="insideEnd"?(x=f-v*i,b=!p):s==="end"&&(x=f+v*i,b=p),b=y<=0?b:!b;var _=cr(a,l,m,x),S=cr(a,l,m,x+(b?1:-1)*359),k="M".concat(_.x,",").concat(_.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(b?0:1,`,
    `).concat(S.x,",").concat(S.y),T=jt(t.id)?xm("recharts-radial-line-"):t.id;return E.createElement("text",ta({},n,{dominantBaseline:"central",className:xt("recharts-radial-bar-label",o)}),E.createElement("defs",null,E.createElement("path",{id:T,d:k})),E.createElement("textPath",{xlinkHref:"#".concat(T)},e))},dFe=(t,e,n)=>{var{cx:r,cy:s,innerRadius:i,outerRadius:o,startAngle:a,endAngle:l}=t,u=(a+l)/2;if(n==="outside"){var{x:c,y:d}=cr(r,s,o+e,u);return{x:c,y:d,textAnchor:c>=r?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:r,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:r,y:s,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:r,y:s,textAnchor:"middle",verticalAnchor:"end"};var f=(i+o)/2,{x:p,y:m}=cr(r,s,f,u);return{x:p,y:m,textAnchor:"middle",verticalAnchor:"middle"}},hFe=(t,e)=>{var{parentViewBox:n,offset:r,position:s}=t,{x:i,y:o,width:a,height:l}=e,u=l>=0?1:-1,c=u*r,d=u>0?"end":"start",f=u>0?"start":"end",p=a>=0?1:-1,m=p*r,y=p>0?"end":"start",v=p>0?"start":"end";if(s==="top"){var x={x:i+a/2,y:o-u*r,textAnchor:"middle",verticalAnchor:d};return tn(tn({},x),n?{height:Math.max(o-n.y,0),width:a}:{})}if(s==="bottom"){var b={x:i+a/2,y:o+l+c,textAnchor:"middle",verticalAnchor:f};return tn(tn({},b),n?{height:Math.max(n.y+n.height-(o+l),0),width:a}:{})}if(s==="left"){var _={x:i-m,y:o+l/2,textAnchor:y,verticalAnchor:"middle"};return tn(tn({},_),n?{width:Math.max(_.x-n.x,0),height:l}:{})}if(s==="right"){var S={x:i+a+m,y:o+l/2,textAnchor:v,verticalAnchor:"middle"};return tn(tn({},S),n?{width:Math.max(n.x+n.width-S.x,0),height:l}:{})}var k=n?{width:a,height:l}:{};return s==="insideLeft"?tn({x:i+m,y:o+l/2,textAnchor:v,verticalAnchor:"middle"},k):s==="insideRight"?tn({x:i+a-m,y:o+l/2,textAnchor:y,verticalAnchor:"middle"},k):s==="insideTop"?tn({x:i+a/2,y:o+c,textAnchor:"middle",verticalAnchor:f},k):s==="insideBottom"?tn({x:i+a/2,y:o+l-c,textAnchor:"middle",verticalAnchor:d},k):s==="insideTopLeft"?tn({x:i+m,y:o+c,textAnchor:v,verticalAnchor:f},k):s==="insideTopRight"?tn({x:i+a-m,y:o+c,textAnchor:y,verticalAnchor:f},k):s==="insideBottomLeft"?tn({x:i+m,y:o+l-c,textAnchor:v,verticalAnchor:d},k):s==="insideBottomRight"?tn({x:i+a-m,y:o+l-c,textAnchor:y,verticalAnchor:d},k):s&&typeof s=="object"&&(De(s.x)||Nu(s.x))&&(De(s.y)||Nu(s.y))?tn({x:i+no(s.x,a),y:o+no(s.y,l),textAnchor:"end",verticalAnchor:"end"},k):tn({x:i+a/2,y:o+l/2,textAnchor:"middle",verticalAnchor:"middle"},k)},fFe=t=>"cx"in t&&De(t.cx);function ts(t){var{offset:e=5}=t,n=XF(t,nFe),r=tn({offset:e},n),{viewBox:s,position:i,value:o,children:a,content:l,className:u="",textBreakAll:c,labelRef:d}=r,f=Fe(Q5),p=u_(),m=i==="center"?p:f??p,y=s||m;if(!y||jt(o)&&jt(a)&&!E.isValidElement(l)&&typeof l!="function")return null;var v=tn(tn({},r),{},{viewBox:y});if(E.isValidElement(l)){var{labelRef:x}=v,b=XF(v,rFe);return E.cloneElement(l,b)}var _;if(typeof l=="function"){if(_=E.createElement(l,v),E.isValidElement(_))return _}else _=lFe(r);var S=fFe(y),k=Qt(r,!0);if(S&&(i==="insideStart"||i==="insideEnd"||i==="end"))return cFe(r,_,k,y);var T=S?dFe(y,r.offset,r.position):hFe(r,y);return E.createElement(DA,ta({ref:d,className:xt("recharts-label",u)},k,T,{breakAll:c}),_)}ts.displayName="Label";var bK=t=>{var{cx:e,cy:n,angle:r,startAngle:s,endAngle:i,r:o,radius:a,innerRadius:l,outerRadius:u,x:c,y:d,top:f,left:p,width:m,height:y,clockWise:v,labelViewBox:x}=t;if(x)return x;if(De(m)&&De(y)){if(De(c)&&De(d))return{x:c,y:d,width:m,height:y};if(De(f)&&De(p))return{x:f,y:p,width:m,height:y}}if(De(c)&&De(d))return{x:c,y:d,width:0,height:0};if(De(e)&&De(n))return{cx:e,cy:n,startAngle:s||r||0,endAngle:i||r||0,innerRadius:l||0,outerRadius:u||a||o||0,clockWise:v};if(t.viewBox)return t.viewBox},pFe=(t,e,n)=>{if(!t)return null;var r={viewBox:e,labelRef:n};return t===!0?E.createElement(ts,ta({key:"label-implicit"},r)):yi(t)?E.createElement(ts,ta({key:"label-implicit",value:t},r)):E.isValidElement(t)?t.type===ts?E.cloneElement(t,tn({key:"label-implicit"},r)):E.createElement(ts,ta({key:"label-implicit",content:t},r)):RA(t)?E.createElement(ts,ta({key:"label-implicit",content:t},r)):t&&typeof t=="object"?E.createElement(ts,ta({},t,{key:"label-implicit"},r)):null},mFe=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var{children:s,labelRef:i}=e,o=bK(e),a=cE(s,ts).map((u,c)=>E.cloneElement(u,{viewBox:n||o,key:"label-".concat(c)}));if(!r)return a;var l=pFe(e.label,n||o,i);return[l,...a]};ts.parseViewBox=bK;ts.renderCallByParent=mFe;var wK={},_K={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n[n.length-1]}t.last=e})(_K);var SK={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return Array.isArray(n)?n:Array.from(n)}t.toArray=e})(SK);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_K,n=SK,r=K1;function s(i){if(r.isArrayLike(i))return e.last(n.toArray(i))}t.last=s})(wK);var gFe=wK.last;const yFe=wi(gFe);var vFe=["valueAccessor"],xFe=["data","dataKey","clockWise","id","textBreakAll"];function Gx(){return Gx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gx.apply(null,arguments)}function YF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function QF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?YF(Object(n),!0).forEach(function(r){bFe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function bFe(t,e,n){return(e=wFe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wFe(t){var e=_Fe(t,"string");return typeof e=="symbol"?e:e+""}function _Fe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JF(t,e){if(t==null)return{};var n,r,s=SFe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function SFe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var kFe=t=>Array.isArray(t.value)?yFe(t.value):t.value;function pl(t){var{valueAccessor:e=kFe}=t,n=JF(t,vFe),{data:r,dataKey:s,clockWise:i,id:o,textBreakAll:a}=n,l=JF(n,xFe);return!r||!r.length?null:E.createElement(vi,{className:"recharts-label-list"},r.map((u,c)=>{var d=jt(s)?e(u,c):qn(u&&u.payload,s),f=jt(o)?{}:{id:"".concat(o,"-").concat(c)};return E.createElement(ts,Gx({},Qt(u,!0),l,f,{parentViewBox:u.parentViewBox,value:d,textBreakAll:a,viewBox:ts.parseViewBox(jt(i)?u:QF(QF({},u),{},{clockWise:i})),key:"label-".concat(c),index:c}))}))}pl.displayName="LabelList";function CFe(t,e){return t?t===!0?E.createElement(pl,{key:"labelList-implicit",data:e}):E.isValidElement(t)||RA(t)?E.createElement(pl,{key:"labelList-implicit",data:e,content:t}):typeof t=="object"?E.createElement(pl,Gx({data:e},t,{key:"labelList-implicit"})):null:null}function TFe(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var{children:r}=t,s=cE(r,pl).map((o,a)=>E.cloneElement(o,{data:e,key:"labelList-".concat(a)}));if(!n)return s;var i=CFe(t.label,e);return[i,...s]}pl.renderCallByParent=TFe;function JT(){return JT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},JT.apply(null,arguments)}var kK=t=>{var{cx:e,cy:n,r,className:s}=t,i=xt("recharts-dot",s);return e===+e&&n===+n&&r===+r?E.createElement("circle",JT({},Pc(t),uE(t),{className:i,cx:e,cy:n,r})):null},NFe={radiusAxis:{},angleAxis:{}},CK=Vs({name:"polarAxis",initialState:NFe,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:Rje,removeRadiusAxis:Lje,addAngleAxis:Fje,removeAngleAxis:Mje}=CK.actions,IFe=CK.reducer,TK={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){var s;if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const i=n[Symbol.toStringTag];return i==null||!((s=Object.getOwnPropertyDescriptor(n,Symbol.toStringTag))!=null&&s.writable)?!1:n.toString()===`[object ${i}]`}let r=n;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(n)===r}t.isPlainObject=e})(TK);var $Fe=TK.isPlainObject;const EFe=wi($Fe);function Hx(){return Hx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hx.apply(null,arguments)}var eM=(t,e,n,r,s)=>{var i=n-r,o;return o="M ".concat(t,",").concat(e),o+="L ".concat(t+n,",").concat(e),o+="L ".concat(t+n-i/2,",").concat(e+s),o+="L ".concat(t+n-i/2-r,",").concat(e+s),o+="L ".concat(t,",").concat(e," Z"),o},AFe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},OFe=t=>{var e=Bo(t,AFe),n=E.useRef(),[r,s]=E.useState(-1);E.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var v=n.current.getTotalLength();v&&s(v)}catch{}},[]);var{x:i,y:o,upperWidth:a,lowerWidth:l,height:u,className:c}=e,{animationEasing:d,animationDuration:f,animationBegin:p,isUpdateAnimationActive:m}=e;if(i!==+i||o!==+o||a!==+a||l!==+l||u!==+u||a===0&&l===0||u===0)return null;var y=xt("recharts-trapezoid",c);return m?E.createElement(Ex,{canBegin:r>0,from:{upperWidth:0,lowerWidth:0,height:u,x:i,y:o},to:{upperWidth:a,lowerWidth:l,height:u,x:i,y:o},duration:f,animationEasing:d,isActive:m},v=>{var{upperWidth:x,lowerWidth:b,height:_,x:S,y:k}=v;return E.createElement(Ex,{canBegin:r>0,from:"0px ".concat(r===-1?1:r,"px"),to:"".concat(r,"px 0px"),attributeName:"strokeDasharray",begin:p,duration:f,easing:d},E.createElement("path",Hx({},Qt(e,!0),{className:y,d:eM(S,k,x,b,_),ref:n})))}):E.createElement("g",null,E.createElement("path",Hx({},Qt(e,!0),{className:y,d:eM(i,o,a,l,u)})))},PFe=["option","shapeType","propTransformer","activeClassName","isActive"];function DFe(t,e){if(t==null)return{};var n,r,s=RFe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function RFe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function tM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Kx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?tM(Object(n),!0).forEach(function(r){LFe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function LFe(t,e,n){return(e=FFe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FFe(t){var e=MFe(t,"string");return typeof e=="symbol"?e:e+""}function MFe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zFe(t,e){return Kx(Kx({},e),t)}function BFe(t,e){return t==="symbols"}function nM(t){var{shapeType:e,elementProps:n}=t;switch(e){case"rectangle":return E.createElement(W6,n);case"trapezoid":return E.createElement(OFe,n);case"sector":return E.createElement(H6,n);case"symbols":if(BFe(e))return E.createElement(mE,n);break;default:return null}}function jFe(t){return E.isValidElement(t)?t.props:t}function VFe(t){var{option:e,shapeType:n,propTransformer:r=zFe,activeClassName:s="recharts-active-shape",isActive:i}=t,o=DFe(t,PFe),a;if(E.isValidElement(e))a=E.cloneElement(e,Kx(Kx({},o),jFe(e)));else if(typeof e=="function")a=e(o);else if(EFe(e)&&typeof e!="boolean"){var l=r(e,o);a=E.createElement(nM,{shapeType:n,elementProps:l})}else{var u=o;a=E.createElement(nM,{shapeType:n,elementProps:u})}return i?E.createElement(vi,{className:s},a):a}var NK=(t,e)=>{var n=gn();return(r,s)=>i=>{t==null||t(r,s,i),n(z8({activeIndex:String(s),activeDataKey:e,activeCoordinate:r.tooltipPosition}))}},IK=t=>{var e=gn();return(n,r)=>s=>{t==null||t(n,r,s),e(rRe())}},$K=(t,e)=>{var n=gn();return(r,s)=>i=>{t==null||t(r,s,i),n(sRe({activeIndex:String(s),activeDataKey:e,activeCoordinate:r.tooltipPosition}))}};function EK(t){var{fn:e,args:n}=t,r=gn(),s=qr();return E.useEffect(()=>{if(!s){var i=e(n);return r(eRe(i)),()=>{r(tRe(i))}}},[e,n,r,s]),null}var WFe=()=>{};function AK(t){var{legendPayload:e}=t,n=gn(),r=qr();return E.useEffect(()=>r?WFe:(n(W2e(e)),()=>{n(U2e(e))}),[n,r,e]),null}function OK(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=E.useRef(xm(e)),r=E.useRef(t);return r.current!==t&&(n.current=xm(e),r.current=t),n.current}var yk,UFe=()=>{var[t]=E.useState(()=>xm("uid-"));return t},GFe=(yk=t7.useId)!==null&&yk!==void 0?yk:UFe;function HFe(t,e){var n=GFe();return e||(t?"".concat(t,"-").concat(n):n)}var KFe=E.createContext(void 0),PK=t=>{var{id:e,type:n,children:r}=t,s=HFe("recharts-".concat(n),e);return E.createElement(KFe.Provider,{value:s},r(s))},qFe={cartesianItems:[],polarItems:[]},DK=Vs({name:"graphicalItems",initialState:qFe,reducers:{addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:n,next:r}=e.payload,s=la(t).cartesianItems.indexOf(n);s>-1&&(t.cartesianItems[s]=r)},removeCartesianGraphicalItem(t,e){var n=la(t).cartesianItems.indexOf(e.payload);n>-1&&t.cartesianItems.splice(n,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var n=la(t).polarItems.indexOf(e.payload);n>-1&&t.polarItems.splice(n,1)}}}),{addCartesianGraphicalItem:XFe,replaceCartesianGraphicalItem:ZFe,removeCartesianGraphicalItem:YFe,addPolarGraphicalItem:zje,removePolarGraphicalItem:Bje}=DK.actions,QFe=DK.reducer;function RK(t){var e=gn(),n=E.useRef(null);return E.useEffect(()=>{n.current===null?e(XFe(t)):n.current!==t&&e(ZFe({prev:n.current,next:t})),n.current=t},[e,t]),E.useEffect(()=>()=>{n.current&&(e(YFe(n.current)),n.current=null)},[e]),null}function JFe(){}var eMe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},rM={t:0},vk={t:1};function LK(t){var e=Bo(t,eMe),{isActive:n,canBegin:r,duration:s,easing:i,begin:o,onAnimationEnd:a,onAnimationStart:l,children:u}=e,c=V6("JavascriptAnimate",e.animationManager),[d,f]=E.useState(n?rM:vk),p=E.useRef(null);return E.useEffect(()=>{n||f(vk)},[n]),E.useEffect(()=>{if(!n||!r)return JFe;var m=j6(rM,vk,z6(i),s,f,c.getTimeoutController()),y=()=>{p.current=m()};return c.start([l,o,y,s,a]),()=>{c.stop(),p.current&&p.current(),a()}},[n,r,s,i,o,l,a,c]),u(d.t)}var tMe=he([nr],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),nMe=he([tMe,Da,Ra],(t,e,n)=>{if(!(!t||e==null||n==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,n-t.top-t.bottom)}}),LA=()=>Fe(nMe),rMe=()=>Fe(URe);function sM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function iM(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?sM(Object(n),!0).forEach(function(r){sMe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function sMe(t,e,n){return(e=iMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iMe(t){var e=oMe(t,"string");return typeof e=="symbol"?e:e+""}function oMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var aMe=t=>{var{point:e,childIndex:n,mainColor:r,activeDot:s,dataKey:i}=t;if(s===!1||e.x==null||e.y==null)return null;var o=iM(iM({index:n,dataKey:i,cx:e.x,cy:e.y,r:4,fill:r??"none",strokeWidth:2,stroke:"#fff",payload:e.payload,value:e.value},Qt(s,!1)),uE(s)),a;return E.isValidElement(s)?a=E.cloneElement(s,o):typeof s=="function"?a=s(o):a=E.createElement(kK,o),E.createElement(vi,{className:"recharts-active-dot"},a)};function lMe(t){var{points:e,mainColor:n,activeDot:r,itemDataKey:s}=t,i=Fe(fc),o=rMe();if(e==null||o==null)return null;var a=e.find(l=>o.includes(l.payload));return jt(a)?null:aMe({point:a,childIndex:Number(i),mainColor:n,dataKey:s,activeDot:r})}var uMe="Invariant failed";function cMe(t,e){throw new Error(uMe)}var dMe=["x","y"];function eN(){return eN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},eN.apply(null,arguments)}function oM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function cp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oM(Object(n),!0).forEach(function(r){hMe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function hMe(t,e,n){return(e=fMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fMe(t){var e=pMe(t,"string");return typeof e=="symbol"?e:e+""}function pMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mMe(t,e){if(t==null)return{};var n,r,s=gMe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function gMe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function yMe(t,e){var{x:n,y:r}=t,s=mMe(t,dMe),i="".concat(n),o=parseInt(i,10),a="".concat(r),l=parseInt(a,10),u="".concat(e.height||s.height),c=parseInt(u,10),d="".concat(e.width||s.width),f=parseInt(d,10);return cp(cp(cp(cp(cp({},e),s),o?{x:o}:{}),l?{y:l}:{}),{},{height:c,width:f,name:e.name,radius:e.radius})}function FK(t){return E.createElement(VFe,eN({shapeType:"rectangle",propTransformer:yMe,activeClassName:"recharts-active-bar"},t))}var vMe=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r,s)=>{if(De(e))return e;var i=De(r)||jt(r);return i?e(r,s):(i||cMe(),n)}},xMe={},MK=Vs({name:"errorBars",initialState:xMe,reducers:{addErrorBar:(t,e)=>{var{itemId:n,errorBar:r}=e.payload;t[n]||(t[n]=[]),t[n].push(r)},removeErrorBar:(t,e)=>{var{itemId:n,errorBar:r}=e.payload;t[n]&&(t[n]=t[n].filter(s=>s.dataKey!==r.dataKey||s.direction!==r.direction))}}}),{addErrorBar:jje,removeErrorBar:Vje}=MK.actions,bMe=MK.reducer,wMe=["children"];function _Me(t,e){if(t==null)return{};var n,r,s=SMe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function SMe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var kMe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},CMe=E.createContext(kMe);function zK(t){var{children:e}=t,n=_Me(t,wMe);return E.createElement(CMe.Provider,{value:n},e)}function FA(t,e){var n,r,s=Fe(u=>jo(u,t)),i=Fe(u=>Fa(u,e)),o=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:vs.allowDataOverflow,a=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:xs.allowDataOverflow,l=o||a;return{needClip:l,needClipX:o,needClipY:a}}function BK(t){var{xAxisId:e,yAxisId:n,clipPathId:r}=t,s=LA(),{needClipX:i,needClipY:o,needClip:a}=FA(e,n);if(!a)return null;var{x:l,y:u,width:c,height:d}=s;return E.createElement("clipPath",{id:"clipPath-".concat(r)},E.createElement("rect",{x:i?l:l-c/2,y:o?u:u-d/2,width:i?c:c*2,height:o?d:d*2}))}var TMe=["onMouseEnter","onMouseLeave","onClick"],NMe=["value","background","tooltipPosition"],IMe=["id"],$Me=["onMouseEnter","onClick","onMouseLeave"];function oh(){return oh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oh.apply(null,arguments)}function aM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Sr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?aM(Object(n),!0).forEach(function(r){EMe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function EMe(t,e,n){return(e=AMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AMe(t){var e=OMe(t,"string");return typeof e=="symbol"?e:e+""}function OMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qx(t,e){if(t==null)return{};var n,r,s=PMe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function PMe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var DMe=t=>{var{dataKey:e,name:n,fill:r,legendType:s,hide:i}=t;return[{inactive:i,dataKey:e,type:s,color:r,value:i_(n,e),payload:t}]};function RMe(t){var{dataKey:e,stroke:n,strokeWidth:r,fill:s,name:i,hide:o,unit:a}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:r,fill:s,dataKey:e,nameKey:void 0,name:i_(i,e),hide:o,type:t.tooltipType,color:t.fill,unit:a}}}function LMe(t){var e=Fe(fc),{data:n,dataKey:r,background:s,allOtherBarProps:i}=t,{onMouseEnter:o,onMouseLeave:a,onClick:l}=i,u=qx(i,TMe),c=NK(o,r),d=IK(a),f=$K(l,r);if(!s||n==null)return null;var p=Qt(s,!1);return E.createElement(E.Fragment,null,n.map((m,y)=>{var{value:v,background:x,tooltipPosition:b}=m,_=qx(m,NMe);if(!x)return null;var S=c(m,y),k=d(m,y),T=f(m,y),$=Sr(Sr(Sr(Sr(Sr({option:s,isActive:String(y)===e},_),{},{fill:"#eee"},x),p),W1(u,m,y)),{},{onMouseEnter:S,onMouseLeave:k,onClick:T,dataKey:r,index:y,className:"recharts-bar-background-rectangle"});return E.createElement(FK,oh({key:"background-bar-".concat(y)},$))}))}function jK(t){var{data:e,props:n,showLabels:r}=t,s=Pc(n),{id:i}=s,o=qx(s,IMe),{shape:a,dataKey:l,activeBar:u}=n,c=Fe(fc),d=Fe(Q8),{onMouseEnter:f,onClick:p,onMouseLeave:m}=n,y=qx(n,$Me),v=NK(f,l),x=IK(m),b=$K(p,l);return e?E.createElement(E.Fragment,null,e.map((_,S)=>{var k=u&&String(S)===c&&(d==null||l===d),T=k?u:a,$=Sr(Sr(Sr({},o),_),{},{isActive:k,option:T,index:S,dataKey:l});return E.createElement(vi,oh({className:"recharts-bar-rectangle"},W1(y,_,S),{onMouseEnter:v(_,S),onMouseLeave:x(_,S),onClick:b(_,S),key:"rectangle-".concat(_==null?void 0:_.x,"-").concat(_==null?void 0:_.y,"-").concat(_==null?void 0:_.value,"-").concat(S)}),E.createElement(FK,$))}),r&&pl.renderCallByParent(n,e)):null}function FMe(t){var{props:e,previousRectanglesRef:n}=t,{data:r,layout:s,isAnimationActive:i,animationBegin:o,animationDuration:a,animationEasing:l,onAnimationEnd:u,onAnimationStart:c}=e,d=n.current,f=OK(e,"recharts-bar-"),[p,m]=E.useState(!1),y=E.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),v=E.useCallback(()=>{typeof c=="function"&&c(),m(!0)},[c]);return E.createElement(LK,{begin:o,duration:a,isActive:i,easing:l,onAnimationEnd:y,onAnimationStart:v,key:f},x=>{var b=x===1?r:r==null?void 0:r.map((_,S)=>{var k=d&&d[S];if(k)return Sr(Sr({},_),{},{x:ji(k.x,_.x,x),y:ji(k.y,_.y,x),width:ji(k.width,_.width,x),height:ji(k.height,_.height,x)});if(s==="horizontal"){var T=ji(0,_.height,x);return Sr(Sr({},_),{},{y:_.y+_.height-T,height:T})}var $=ji(0,_.width,x);return Sr(Sr({},_),{},{width:$})});return x>0&&(n.current=b??null),b==null?null:E.createElement(vi,null,E.createElement(jK,{props:e,data:b,showLabels:!p}))})}function MMe(t){var{data:e,isAnimationActive:n}=t,r=E.useRef(null);return n&&e&&e.length&&(r.current==null||r.current!==e)?E.createElement(FMe,{previousRectanglesRef:r,props:t}):E.createElement(jK,{props:t,data:e,showLabels:!0})}var VK=0,zMe=(t,e)=>{var n=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:n,errorVal:qn(t,e)}};class BMe extends E.PureComponent{render(){var{hide:e,data:n,dataKey:r,className:s,xAxisId:i,yAxisId:o,needClip:a,background:l,id:u}=this.props;if(e)return null;var c=xt("recharts-bar",s),d=u;return E.createElement(vi,{className:c,id:u},a&&E.createElement("defs",null,E.createElement(BK,{clipPathId:d,xAxisId:i,yAxisId:o})),E.createElement(vi,{className:"recharts-bar-rectangles",clipPath:a?"url(#clipPath-".concat(d,")"):void 0},E.createElement(LMe,{data:n,dataKey:r,background:l,allOtherBarProps:this.props}),E.createElement(MMe,this.props)),this.props.children)}}var jMe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!_f.isSsr,legendType:"rect",minPointSize:VK,xAxisId:0,yAxisId:0};function VMe(t){var{xAxisId:e,yAxisId:n,hide:r,legendType:s,minPointSize:i,activeBar:o,animationBegin:a,animationDuration:l,animationEasing:u,isAnimationActive:c}=t,{needClip:d}=FA(e,n),f=c_(),p=qr(),m=cE(t.children,pK),y=Fe(b=>m3e(b,e,n,p,t.id,m));if(f!=="vertical"&&f!=="horizontal")return null;var v,x=y==null?void 0:y[0];return x==null||x.height==null||x.width==null?v=0:v=f==="vertical"?x.height/2:x.width/2,E.createElement(zK,{xAxisId:e,yAxisId:n,data:y,dataPointFormatter:zMe,errorBarOffset:v},E.createElement(BMe,oh({},t,{layout:f,needClip:d,data:y,xAxisId:e,yAxisId:n,hide:r,legendType:s,minPointSize:i,activeBar:o,animationBegin:a,animationDuration:l,animationEasing:u,isAnimationActive:c})))}function WMe(t){var{layout:e,barSettings:{dataKey:n,minPointSize:r},pos:s,bandSize:i,xAxis:o,yAxis:a,xAxisTicks:l,yAxisTicks:u,stackedData:c,displayedData:d,offset:f,cells:p}=t,m=e==="horizontal"?a:o,y=c?m.scale.domain():null,v=_2e({numericAxis:m});return d.map((x,b)=>{var _,S,k,T,$,A;c?_=g2e(c[b],y):(_=qn(x,n),Array.isArray(_)||(_=[v,_]));var D=vMe(r,VK)(_[1],b);if(e==="horizontal"){var F,[M,j]=[a.scale(_[0]),a.scale(_[1])];S=pL({axis:o,ticks:l,bandSize:i,offset:s.offset,entry:x,index:b}),k=(F=j??M)!==null&&F!==void 0?F:void 0,T=s.size;var H=M-j;if($=Ur(H)?0:H,A={x:S,y:f.top,width:T,height:f.height},Math.abs(D)>0&&Math.abs($)<Math.abs(D)){var K=is($||D)*(Math.abs(D)-Math.abs($));k-=K,$+=K}}else{var[Q,Z]=[o.scale(_[0]),o.scale(_[1])];if(S=Q,k=pL({axis:a,ticks:u,bandSize:i,offset:s.offset,entry:x,index:b}),T=Z-Q,$=s.size,A={x:f.left,y:k,width:f.width,height:$},Math.abs(D)>0&&Math.abs(T)<Math.abs(D)){var se=is(T||D)*(Math.abs(D)-Math.abs(T));T+=se}}if(S==null||k==null||T==null||$==null)return null;var B=Sr(Sr({},x),{},{x:S,y:k,width:T,height:$,value:c?_:_[1],payload:x,background:A,tooltipPosition:{x:S+T/2,y:k+$/2}},p&&p[b]&&p[b].props);return B}).filter(Boolean)}function WK(t){var e=Bo(t,jMe),n=qr();return E.createElement(PK,{id:e.id,type:"bar"},r=>E.createElement(E.Fragment,null,E.createElement(AK,{legendPayload:DMe(e)}),E.createElement(EK,{fn:RMe,args:e}),E.createElement(RK,{type:"bar",id:r,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:w2e(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),E.createElement(VMe,oh({},e,{id:r}))))}WK.displayName="Bar";function lM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function qv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lM(Object(n),!0).forEach(function(r){UMe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function UMe(t,e,n){return(e=GMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GMe(t){var e=HMe(t,"string");return typeof e=="symbol"?e:e+""}function HMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KMe=(t,e)=>e,qMe=(t,e,n)=>n,XMe=(t,e,n,r)=>r,ZMe=(t,e,n,r,s)=>s,Ly=he([k_,ZMe],(t,e)=>t.filter(n=>n.type==="bar").find(n=>n.id===e)),YMe=he([Ly],t=>t==null?void 0:t.maxBarSize),QMe=(t,e,n,r,s,i)=>i,uM=(t,e,n)=>{var r=n??t;if(!jt(r))return no(r,e,0)},JMe=he([yt,k_,KMe,qMe,XMe],(t,e,n,r,s)=>e.filter(i=>t==="horizontal"?i.xAxisId===n:i.yAxisId===r).filter(i=>i.isPanorama===s).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),e3e=(t,e,n,r)=>{var s=yt(t);return s==="horizontal"?HT(t,"yAxis",n,r):HT(t,"xAxis",e,r)},t3e=(t,e,n)=>{var r=yt(t);return r==="horizontal"?CF(t,"xAxis",e):CF(t,"yAxis",n)},n3e=(t,e,n)=>{var r={},s=t.filter(S_),i=t.filter(u=>u.stackId==null),o=s.reduce((u,c)=>(u[c.stackId]||(u[c.stackId]=[]),u[c.stackId].push(c),u),r),a=Object.entries(o).map(u=>{var[c,d]=u,f=d.map(m=>m.dataKey),p=uM(e,n,d[0].barSize);return{stackId:c,dataKeys:f,barSize:p}}),l=i.map(u=>{var c=[u.dataKey].filter(f=>f!=null),d=uM(e,n,u.barSize);return{stackId:void 0,dataKeys:c,barSize:d}});return[...a,...l]},r3e=he([JMe,eDe,t3e],n3e),s3e=(t,e,n,r,s)=>{var i,o,a=Ly(t,e,n,r,s);if(a!=null){var l=yt(t),u=G5(t),{maxBarSize:c}=a,d=jt(c)?u:c,f,p;return l==="horizontal"?(f=Al(t,"xAxis",e,r),p=El(t,"xAxis",e,r)):(f=Al(t,"yAxis",n,r),p=El(t,"yAxis",n,r)),(i=(o=_m(f,p,!0))!==null&&o!==void 0?o:d)!==null&&i!==void 0?i:0}},UK=(t,e,n,r)=>{var s=yt(t),i,o;return s==="horizontal"?(i=Al(t,"xAxis",e,r),o=El(t,"xAxis",e,r)):(i=Al(t,"yAxis",n,r),o=El(t,"yAxis",n,r)),_m(i,o)};function i3e(t,e,n,r,s){var i=r.length;if(!(i<1)){var o=no(t,n,0,!0),a,l=[];if(Fs(r[0].barSize)){var u=!1,c=n/i,d=r.reduce((x,b)=>x+(b.barSize||0),0);d+=(i-1)*o,d>=n&&(d-=(i-1)*o,o=0),d>=n&&c>0&&(u=!0,c*=.9,d=i*c);var f=(n-d)/2>>0,p={offset:f-o,size:0};a=r.reduce((x,b)=>{var _,S={stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:p.offset+p.size+o,size:u?c:(_=b.barSize)!==null&&_!==void 0?_:0}},k=[...x,S];return p=k[k.length-1].position,k},l)}else{var m=no(e,n,0,!0);n-2*m-(i-1)*o<=0&&(o=0);var y=(n-2*m-(i-1)*o)/i;y>1&&(y>>=0);var v=Fs(s)?Math.min(y,s):y;a=r.reduce((x,b,_)=>[...x,{stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:m+(y+o)*_+(y-v)/2,size:v}}],l)}return a}}var o3e=(t,e,n,r,s,i,o)=>{var a=jt(o)?e:o,l=i3e(n,r,s!==i?s:i,t,a);return s!==i&&l!=null&&(l=l.map(u=>qv(qv({},u),{},{position:qv(qv({},u.position),{},{offset:u.position.offset-s/2})}))),l},a3e=he([r3e,G5,JPe,H5,s3e,UK,YMe],o3e),l3e=(t,e,n,r)=>Al(t,"xAxis",e,r),u3e=(t,e,n,r)=>Al(t,"yAxis",n,r),c3e=(t,e,n,r)=>El(t,"xAxis",e,r),d3e=(t,e,n,r)=>El(t,"yAxis",n,r),h3e=he([a3e,Ly],(t,e)=>{if(!(t==null||e==null)){var n=t.find(r=>r.stackId===e.stackId&&e.dataKey!=null&&r.dataKeys.includes(e.dataKey));if(n!=null)return n.position}}),f3e=(t,e)=>{var n=gA(e);if(!(!t||n==null||e==null)){var{stackId:r}=e;if(r!=null){var s=t[r];if(s){var{stackedData:i}=s;if(i)return i.find(o=>o.key===n)}}}},p3e=he([e3e,Ly],f3e),m3e=he([nr,l3e,u3e,c3e,d3e,h3e,yt,y_,UK,p3e,Ly,QMe],(t,e,n,r,s,i,o,a,l,u,c,d)=>{var{chartData:f,dataStartIndex:p,dataEndIndex:m}=a;if(!(c==null||i==null||o!=="horizontal"&&o!=="vertical"||e==null||n==null||r==null||s==null||l==null)){var{data:y}=c,v;if(y!=null&&y.length>0?v=y:v=f==null?void 0:f.slice(p,m+1),v!=null)return WMe({layout:o,barSettings:c,pos:i,bandSize:l,xAxis:e,yAxis:n,xAxisTicks:r,yAxisTicks:s,stackedData:u,displayedData:v,offset:t,cells:d})}}),g3e=t=>{var{chartData:e}=t,n=gn(),r=qr();return E.useEffect(()=>r?()=>{}:(n(DF(e)),()=>{n(DF(void 0))}),[e,n,r]),null},cM={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},GK=Vs({name:"brush",initialState:cM,reducers:{setBrushSettings(t,e){return e.payload==null?cM:e.payload}}}),{setBrushSettings:Wje}=GK.actions,y3e=GK.reducer;function dM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Xv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dM(Object(n),!0).forEach(function(r){HK(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function HK(t,e,n){return(e=v3e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v3e(t){var e=x3e(t,"string");return typeof e=="symbol"?e:e+""}function x3e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var b3e=(t,e)=>{var{x:n,y:r}=t,{x:s,y:i}=e;return{x:Math.min(n,s),y:Math.min(r,i),width:Math.abs(s-n),height:Math.abs(i-r)}},w3e=t=>{var{x1:e,y1:n,x2:r,y2:s}=t;return b3e({x:e,y:n},{x:r,y:s})};class E_{static create(e){return new E_(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:n,position:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(r)switch(r){case"start":return this.scale(e);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(e)+i}default:return this.scale(e)}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var n=this.range(),r=n[0],s=n[n.length-1];return r<=s?e>=r&&e<=s:e>=s&&e<=r}}HK(E_,"EPS",1e-4);var _3e=t=>{var e=Object.keys(t).reduce((n,r)=>Xv(Xv({},n),{},{[r]:E_.create(t[r])}),{});return Xv(Xv({},e),{},{apply(n){var{bandAware:r,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.fromEntries(Object.entries(n).map(i=>{var[o,a]=i;return[o,e[o].apply(a,{bandAware:r,position:s})]}))},isInRange(n){return Object.keys(n).every(r=>e[r].isInRange(n[r]))}})};function S3e(t){return(t%180+180)%180}var k3e=function(e){var{width:n,height:r}=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=S3e(s),o=i*Math.PI/180,a=Math.atan(r/n),l=o>a&&o<Math.PI-a?r/Math.sin(o):n/Math.cos(o);return Math.abs(l)},C3e={dots:[],areas:[],lines:[]},KK=Vs({name:"referenceElements",initialState:C3e,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var n=la(t).dots.findIndex(r=>r===e.payload);n!==-1&&t.dots.splice(n,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var n=la(t).areas.findIndex(r=>r===e.payload);n!==-1&&t.areas.splice(n,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var n=la(t).lines.findIndex(r=>r===e.payload);n!==-1&&t.lines.splice(n,1)}}}),{addDot:Uje,removeDot:Gje,addArea:Hje,removeArea:Kje,addLine:T3e,removeLine:N3e}=KK.actions,I3e=KK.reducer,qK=E.createContext(void 0),$3e=t=>{var{children:e}=t,[n]=E.useState("".concat(xm("recharts"),"-clip")),r=LA();if(r==null)return null;var{x:s,y:i,width:o,height:a}=r;return E.createElement(qK.Provider,{value:n},E.createElement("defs",null,E.createElement("clipPath",{id:n},E.createElement("rect",{x:s,y:i,height:a,width:o}))),e)},E3e=()=>E.useContext(qK);function hM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function fM(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?hM(Object(n),!0).forEach(function(r){MA(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function MA(t,e,n){return(e=A3e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A3e(t){var e=O3e(t,"string");return typeof e=="symbol"?e:e+""}function O3e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tN(){return tN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tN.apply(null,arguments)}var P3e=(t,e)=>{var n;return E.isValidElement(t)?n=E.cloneElement(t,e):typeof t=="function"?n=t(e):n=E.createElement("line",tN({},e,{className:"recharts-reference-line-line"})),n},D3e=(t,e,n,r,s,i,o,a,l)=>{var{x:u,y:c,width:d,height:f}=s;if(n){var{y:p}=l,m=t.y.apply(p,{position:i});if(Ur(m)||l.ifOverflow==="discard"&&!t.y.isInRange(m))return null;var y=[{x:u+d,y:m},{x:u,y:m}];return a==="left"?y.reverse():y}if(e){var{x:v}=l,x=t.x.apply(v,{position:i});if(Ur(x)||l.ifOverflow==="discard"&&!t.x.isInRange(x))return null;var b=[{x,y:c+f},{x,y:c}];return o==="top"?b.reverse():b}if(r){var{segment:_}=l,S=_.map(k=>t.apply(k,{position:i}));return l.ifOverflow==="discard"&&S.some(k=>!t.isInRange(k))?null:S}return null};function R3e(t){var e=gn();return E.useEffect(()=>(e(T3e(t)),()=>{e(N3e(t))})),null}function L3e(t){var{x:e,y:n,segment:r,xAxisId:s,yAxisId:i,shape:o,className:a,ifOverflow:l}=t,u=qr(),c=E3e(),d=Fe(M=>jo(M,s)),f=Fe(M=>Fa(M,i)),p=Fe(M=>$l(M,"xAxis",s,u)),m=Fe(M=>$l(M,"yAxis",i,u)),y=u_(),v=yi(e),x=yi(n);if(!c||!y||d==null||f==null||p==null||m==null)return null;var b=_3e({x:p,y:m}),_=r&&r.length===2,S=D3e(b,v,x,_,y,t.position,d.orientation,f.orientation,t);if(!S)return null;var[{x:k,y:T},{x:$,y:A}]=S,D=l==="hidden"?"url(#".concat(c,")"):void 0,F=fM(fM({clipPath:D},Qt(t,!0)),{},{x1:k,y1:T,x2:$,y2:A});return E.createElement(vi,{className:xt("recharts-reference-line",a)},P3e(o,F),ts.renderCallByParent(t,w3e({x1:k,y1:T,x2:$,y2:A})))}function F3e(t){return E.createElement(E.Fragment,null,E.createElement(R3e,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y}),E.createElement(L3e,t))}class zA extends E.Component{render(){return E.createElement(F3e,this.props)}}MA(zA,"displayName","ReferenceLine");MA(zA,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function xk(t,e){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(e,n)||t[n]!==e[n]))return!1;for(var r in e)if({}.hasOwnProperty.call(e,r)&&!{}.hasOwnProperty.call(t,r))return!1;return!0}function XK(t,e,n){if(e<1)return[];if(e===1&&n===void 0)return t;for(var r=[],s=0;s<t.length;s+=e)r.push(t[s]);return r}function M3e(t,e,n){var r={width:t.width+e.width,height:t.height+e.height};return k3e(r,n)}function z3e(t,e,n){var r=n==="width",{x:s,y:i,width:o,height:a}=t;return e===1?{start:r?s:i,end:r?s+o:i+a}:{start:r?s+o:i+a,end:r?s:i}}function Xx(t,e,n,r,s){if(t*e<t*r||t*e>t*s)return!1;var i=n();return t*(e-t*i/2-r)>=0&&t*(e+t*i/2-s)<=0}function B3e(t,e){return XK(t,e+1)}function j3e(t,e,n,r,s){for(var i=(r||[]).slice(),{start:o,end:a}=e,l=0,u=1,c=o,d=function(){var m=r==null?void 0:r[l];if(m===void 0)return{v:XK(r,u)};var y=l,v,x=()=>(v===void 0&&(v=n(m,y)),v),b=m.coordinate,_=l===0||Xx(t,b,x,c,a);_||(l=0,c=o,u+=1),_&&(c=b+t*(x()/2+s),l+=u)},f;u<=i.length;)if(f=d(),f)return f.v;return[]}function pM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function vr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pM(Object(n),!0).forEach(function(r){V3e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function V3e(t,e,n){return(e=W3e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W3e(t){var e=U3e(t,"string");return typeof e=="symbol"?e:e+""}function U3e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function G3e(t,e,n,r,s){for(var i=(r||[]).slice(),o=i.length,{start:a}=e,{end:l}=e,u=function(f){var p=i[f],m,y=()=>(m===void 0&&(m=n(p,f)),m);if(f===o-1){var v=t*(p.coordinate+t*y()/2-l);i[f]=p=vr(vr({},p),{},{tickCoord:v>0?p.coordinate-v*t:p.coordinate})}else i[f]=p=vr(vr({},p),{},{tickCoord:p.coordinate});var x=Xx(t,p.tickCoord,y,a,l);x&&(l=p.tickCoord-t*(y()/2+s),i[f]=vr(vr({},p),{},{isShow:!0}))},c=o-1;c>=0;c--)u(c);return i}function H3e(t,e,n,r,s,i){var o=(r||[]).slice(),a=o.length,{start:l,end:u}=e;if(i){var c=r[a-1],d=n(c,a-1),f=t*(c.coordinate+t*d/2-u);o[a-1]=c=vr(vr({},c),{},{tickCoord:f>0?c.coordinate-f*t:c.coordinate});var p=Xx(t,c.tickCoord,()=>d,l,u);p&&(u=c.tickCoord-t*(d/2+s),o[a-1]=vr(vr({},c),{},{isShow:!0}))}for(var m=i?a-1:a,y=function(b){var _=o[b],S,k=()=>(S===void 0&&(S=n(_,b)),S);if(b===0){var T=t*(_.coordinate-t*k()/2-l);o[b]=_=vr(vr({},_),{},{tickCoord:T<0?_.coordinate-T*t:_.coordinate})}else o[b]=_=vr(vr({},_),{},{tickCoord:_.coordinate});var $=Xx(t,_.tickCoord,k,l,u);$&&(l=_.tickCoord+t*(k()/2+s),o[b]=vr(vr({},_),{},{isShow:!0}))},v=0;v<m;v++)y(v);return o}function BA(t,e,n){var{tick:r,ticks:s,viewBox:i,minTickGap:o,orientation:a,interval:l,tickFormatter:u,unit:c,angle:d}=t;if(!s||!s.length||!r)return[];if(De(l)||_f.isSsr){var f;return(f=B3e(s,De(l)?l:0))!==null&&f!==void 0?f:[]}var p=[],m=a==="top"||a==="bottom"?"width":"height",y=c&&m==="width"?Dp(c,{fontSize:e,letterSpacing:n}):{width:0,height:0},v=(_,S)=>{var k=typeof u=="function"?u(_.value,S):_.value;return m==="width"?M3e(Dp(k,{fontSize:e,letterSpacing:n}),y,d):Dp(k,{fontSize:e,letterSpacing:n})[m]},x=s.length>=2?is(s[1].coordinate-s[0].coordinate):1,b=z3e(i,x,m);return l==="equidistantPreserveStart"?j3e(x,b,v,s,o):(l==="preserveStart"||l==="preserveStartEnd"?p=H3e(x,b,v,s,o,l==="preserveStartEnd"):p=G3e(x,b,v,s,o),p.filter(_=>_.isShow))}var K3e=["viewBox"],q3e=["viewBox"];function md(){return md=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},md.apply(null,arguments)}function mM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function In(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?mM(Object(n),!0).forEach(function(r){jA(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function gM(t,e){if(t==null)return{};var n,r,s=X3e(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function X3e(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function jA(t,e,n){return(e=Z3e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z3e(t){var e=Y3e(t,"string");return typeof e=="symbol"?e:e+""}function Y3e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zl extends E.Component{constructor(e){super(e),this.tickRefs=E.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(e,n){var{viewBox:r}=e,s=gM(e,K3e),i=this.props,{viewBox:o}=i,a=gM(i,q3e);return!xk(r,o)||!xk(s,a)||!xk(n,this.state)}getTickLineCoord(e){var{x:n,y:r,width:s,height:i,orientation:o,tickSize:a,mirror:l,tickMargin:u}=this.props,c,d,f,p,m,y,v=l?-1:1,x=e.tickSize||a,b=De(e.tickCoord)?e.tickCoord:e.coordinate;switch(o){case"top":c=d=e.coordinate,p=r+ +!l*i,f=p-v*x,y=f-v*u,m=b;break;case"left":f=p=e.coordinate,d=n+ +!l*s,c=d-v*x,m=c-v*u,y=b;break;case"right":f=p=e.coordinate,d=n+ +l*s,c=d+v*x,m=c+v*u,y=b;break;default:c=d=e.coordinate,p=r+ +l*i,f=p+v*x,y=f+v*u,m=b;break}return{line:{x1:c,y1:f,x2:d,y2:p},tick:{x:m,y}}}getTickTextAnchor(){var{orientation:e,mirror:n}=this.props,r;switch(e){case"left":r=n?"start":"end";break;case"right":r=n?"end":"start";break;default:r="middle";break}return r}getTickVerticalAnchor(){var{orientation:e,mirror:n}=this.props;switch(e){case"left":case"right":return"middle";case"top":return n?"start":"end";default:return n?"end":"start"}}renderAxisLine(){var{x:e,y:n,width:r,height:s,orientation:i,mirror:o,axisLine:a}=this.props,l=In(In(In({},Qt(this.props,!1)),Qt(a,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var u=+(i==="top"&&!o||i==="bottom"&&o);l=In(In({},l),{},{x1:e,y1:n+u*s,x2:e+r,y2:n+u*s})}else{var c=+(i==="left"&&!o||i==="right"&&o);l=In(In({},l),{},{x1:e+c*r,y1:n,x2:e+c*r,y2:n+s})}return E.createElement("line",md({},l,{className:xt("recharts-cartesian-axis-line",uc(a,"className"))}))}static renderTickItem(e,n,r){var s,i=xt(n.className,"recharts-cartesian-axis-tick-value");if(E.isValidElement(e))s=E.cloneElement(e,In(In({},n),{},{className:i}));else if(typeof e=="function")s=e(In(In({},n),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=xt(o,e.className)),s=E.createElement(DA,md({},n,{className:o}),r)}return s}renderTicks(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:s,stroke:i,tick:o,tickFormatter:a,unit:l,padding:u}=this.props,c=BA(In(In({},this.props),{},{ticks:r}),e,n),d=this.getTickTextAnchor(),f=this.getTickVerticalAnchor(),p=Pc(this.props),m=Qt(o,!1),y=In(In({},p),{},{fill:"none"},Qt(s,!1)),v=c.map((x,b)=>{var{line:_,tick:S}=this.getTickLineCoord(x),k=In(In(In(In({textAnchor:d,verticalAnchor:f},p),{},{stroke:"none",fill:i},m),S),{},{index:b,payload:x,visibleTicksCount:c.length,tickFormatter:a,padding:u});return E.createElement(vi,md({className:"recharts-cartesian-axis-tick",key:"tick-".concat(x.value,"-").concat(x.coordinate,"-").concat(x.tickCoord)},W1(this.props,x,b)),s&&E.createElement("line",md({},y,_,{className:xt("recharts-cartesian-axis-tick-line",uc(s,"className"))})),o&&Zl.renderTickItem(o,k,"".concat(typeof a=="function"?a(x.value,b):x.value).concat(l||"")))});return v.length>0?E.createElement("g",{className:"recharts-cartesian-axis-ticks"},v):null}render(){var{axisLine:e,width:n,height:r,className:s,hide:i}=this.props;if(i)return null;var{ticks:o}=this.props;return n!=null&&n<=0||r!=null&&r<=0?null:E.createElement(vi,{className:xt("recharts-cartesian-axis",s),ref:a=>{if(a){var l=a.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(l);var u=l[0];if(u){var c=window.getComputedStyle(u).fontSize,d=window.getComputedStyle(u).letterSpacing;(c!==this.state.fontSize||d!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(u).fontSize,letterSpacing:window.getComputedStyle(u).letterSpacing})}}}},e&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,o),ts.renderCallByParent(this.props))}}jA(Zl,"displayName","CartesianAxis");jA(Zl,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Q3e=["x1","y1","x2","y2","key"],J3e=["offset"],eze=["xAxisId","yAxisId"],tze=["xAxisId","yAxisId"];function yM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function kr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yM(Object(n),!0).forEach(function(r){nze(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function nze(t,e,n){return(e=rze(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rze(t){var e=sze(t,"string");return typeof e=="symbol"?e:e+""}function sze(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Au(){return Au=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Au.apply(null,arguments)}function Zx(t,e){if(t==null)return{};var n,r,s=ize(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function ize(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var oze=t=>{var{fill:e}=t;if(!e||e==="none")return null;var{fillOpacity:n,x:r,y:s,width:i,height:o,ry:a}=t;return E.createElement("rect",{x:r,y:s,ry:a,width:i,height:o,stroke:"none",fill:e,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function ZK(t,e){var n;if(E.isValidElement(t))n=E.cloneElement(t,e);else if(typeof t=="function")n=t(e);else{var{x1:r,y1:s,x2:i,y2:o,key:a}=e,l=Zx(e,Q3e),u=Pc(l),{offset:c}=u,d=Zx(u,J3e);n=E.createElement("line",Au({},d,{x1:r,y1:s,x2:i,y2:o,fill:"none",key:a}))}return n}function aze(t){var{x:e,width:n,horizontal:r=!0,horizontalPoints:s}=t;if(!r||!s||!s.length)return null;var{xAxisId:i,yAxisId:o}=t,a=Zx(t,eze),l=s.map((u,c)=>{var d=kr(kr({},a),{},{x1:e,y1:u,x2:e+n,y2:u,key:"line-".concat(c),index:c});return ZK(r,d)});return E.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function lze(t){var{y:e,height:n,vertical:r=!0,verticalPoints:s}=t;if(!r||!s||!s.length)return null;var{xAxisId:i,yAxisId:o}=t,a=Zx(t,tze),l=s.map((u,c)=>{var d=kr(kr({},a),{},{x1:u,y1:e,x2:u,y2:e+n,key:"line-".concat(c),index:c});return ZK(r,d)});return E.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function uze(t){var{horizontalFill:e,fillOpacity:n,x:r,y:s,width:i,height:o,horizontalPoints:a,horizontal:l=!0}=t;if(!l||!e||!e.length)return null;var u=a.map(d=>Math.round(d+s-s)).sort((d,f)=>d-f);s!==u[0]&&u.unshift(0);var c=u.map((d,f)=>{var p=!u[f+1],m=p?s+o-d:u[f+1]-d;if(m<=0)return null;var y=f%e.length;return E.createElement("rect",{key:"react-".concat(f),y:d,x:r,height:m,width:i,stroke:"none",fill:e[y],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return E.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},c)}function cze(t){var{vertical:e=!0,verticalFill:n,fillOpacity:r,x:s,y:i,width:o,height:a,verticalPoints:l}=t;if(!e||!n||!n.length)return null;var u=l.map(d=>Math.round(d+s-s)).sort((d,f)=>d-f);s!==u[0]&&u.unshift(0);var c=u.map((d,f)=>{var p=!u[f+1],m=p?s+o-d:u[f+1]-d;if(m<=0)return null;var y=f%n.length;return E.createElement("rect",{key:"react-".concat(f),x:d,y:i,width:m,height:a,stroke:"none",fill:n[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return E.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},c)}var dze=(t,e)=>{var{xAxis:n,width:r,height:s,offset:i}=t;return C6(BA(kr(kr(kr({},Zl.defaultProps),n),{},{ticks:T6(n),viewBox:{x:0,y:0,width:r,height:s}})),i.left,i.left+i.width,e)},hze=(t,e)=>{var{yAxis:n,width:r,height:s,offset:i}=t;return C6(BA(kr(kr(kr({},Zl.defaultProps),n),{},{ticks:T6(n),viewBox:{x:0,y:0,width:r,height:s}})),i.top,i.top+i.height,e)},fze={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Yx(t){var e=RE(),n=LE(),r=$6(),s=kr(kr({},Bo(t,fze)),{},{x:De(t.x)?t.x:r.left,y:De(t.y)?t.y:r.top,width:De(t.width)?t.width:r.width,height:De(t.height)?t.height:r.height}),{xAxisId:i,yAxisId:o,x:a,y:l,width:u,height:c,syncWithTicks:d,horizontalValues:f,verticalValues:p}=s,m=qr(),y=Fe(D=>TF(D,"xAxis",i,m)),v=Fe(D=>TF(D,"yAxis",o,m));if(!De(u)||u<=0||!De(c)||c<=0||!De(a)||a!==+a||!De(l)||l!==+l)return null;var x=s.verticalCoordinatesGenerator||dze,b=s.horizontalCoordinatesGenerator||hze,{horizontalPoints:_,verticalPoints:S}=s;if((!_||!_.length)&&typeof b=="function"){var k=f&&f.length,T=b({yAxis:v?kr(kr({},v),{},{ticks:k?f:v.ticks}):void 0,width:e,height:n,offset:r},k?!0:d);Pp(Array.isArray(T),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(_=T)}if((!S||!S.length)&&typeof x=="function"){var $=p&&p.length,A=x({xAxis:y?kr(kr({},y),{},{ticks:$?p:y.ticks}):void 0,width:e,height:n,offset:r},$?!0:d);Pp(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(S=A)}return E.createElement("g",{className:"recharts-cartesian-grid"},E.createElement(oze,{fill:s.fill,fillOpacity:s.fillOpacity,x:s.x,y:s.y,width:s.width,height:s.height,ry:s.ry}),E.createElement(uze,Au({},s,{horizontalPoints:_})),E.createElement(cze,Au({},s,{verticalPoints:S})),E.createElement(aze,Au({},s,{offset:r,horizontalPoints:_,xAxis:y,yAxis:v})),E.createElement(lze,Au({},s,{offset:r,verticalPoints:S,xAxis:y,yAxis:v})))}Yx.displayName="CartesianGrid";var YK=(t,e,n,r)=>Al(t,"xAxis",e,r),QK=(t,e,n,r)=>El(t,"xAxis",e,r),JK=(t,e,n,r)=>Al(t,"yAxis",n,r),eq=(t,e,n,r)=>El(t,"yAxis",n,r),pze=he([yt,YK,JK,QK,eq],(t,e,n,r,s)=>Hl(t,"xAxis")?_m(e,r,!1):_m(n,s,!1)),mze=(t,e,n,r,s)=>s;function gze(t){return t.type==="line"}var yze=he([k_,mze],(t,e)=>t.filter(gze).find(n=>n.id===e)),vze=he([yt,YK,JK,QK,eq,yze,pze,y_],(t,e,n,r,s,i,o,a)=>{var{chartData:l,dataStartIndex:u,dataEndIndex:c}=a;if(!(i==null||e==null||n==null||r==null||s==null||r.length===0||s.length===0||o==null)){var{dataKey:d,data:f}=i,p;if(f!=null&&f.length>0?p=f:p=l==null?void 0:l.slice(u,c+1),p!=null)return zze({layout:t,xAxis:e,yAxis:n,xAxisTicks:r,yAxisTicks:s,dataKey:d,bandSize:o,displayedData:p})}}),xze=["id"],bze=["type","layout","connectNulls","needClip"],wze=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function vM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Vi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vM(Object(n),!0).forEach(function(r){_ze(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _ze(t,e,n){return(e=Sze(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sze(t){var e=kze(t,"string");return typeof e=="symbol"?e:e+""}function kze(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VA(t,e){if(t==null)return{};var n,r,s=Cze(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Cze(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function pc(){return pc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pc.apply(null,arguments)}var Tze=t=>{var{dataKey:e,name:n,stroke:r,legendType:s,hide:i}=t;return[{inactive:i,dataKey:e,type:s,color:r,value:i_(n,e),payload:t}]};function Nze(t){var{dataKey:e,data:n,stroke:r,strokeWidth:s,fill:i,name:o,hide:a,unit:l}=t;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:i,dataKey:e,nameKey:void 0,name:i_(o,e),hide:a,type:t.tooltipType,color:t.stroke,unit:l}}}var tq=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function Ize(t,e){for(var n=t.length%2!==0?[...t,0]:t,r=[],s=0;s<e;++s)r=[...r,...n];return r}var $ze=(t,e,n)=>{var r=n.reduce((d,f)=>d+f);if(!r)return tq(e,t);for(var s=Math.floor(t/r),i=t%r,o=e-t,a=[],l=0,u=0;l<n.length;u+=n[l],++l)if(u+n[l]>i){a=[...n.slice(0,l),i-u];break}var c=a.length%2===0?[0,o]:[o];return[...Ize(n,s),...a,...c].map(d=>"".concat(d,"px")).join(", ")};function Eze(t,e){var n;if(E.isValidElement(t))n=E.cloneElement(t,e);else if(typeof t=="function")n=t(e);else{var r=xt("recharts-line-dot",typeof t!="boolean"?t.className:"");n=E.createElement(kK,pc({},e,{className:r}))}return n}function Aze(t,e){return t==null?!1:e?!0:t.length===1}function Oze(t){var{clipPathId:e,points:n,props:r}=t,{dot:s,dataKey:i,needClip:o}=r;if(!Aze(n,s))return null;var{id:a}=r,l=VA(r,xze),u=aH(s),c=Pc(l),d=Qt(s,!0),f=n.map((m,y)=>{var v=Vi(Vi(Vi({key:"dot-".concat(y),r:3},c),d),{},{index:y,cx:m.x,cy:m.y,dataKey:i,value:m.value,payload:m.payload,points:n});return Eze(s,v)}),p={clipPath:o?"url(#clipPath-".concat(u?"":"dots-").concat(e,")"):void 0};return E.createElement(vi,pc({className:"recharts-line-dots",key:"dots"},p),f)}function nN(t){var{clipPathId:e,pathRef:n,points:r,strokeDasharray:s,props:i,showLabels:o}=t,{type:a,layout:l,connectNulls:u,needClip:c}=i,d=VA(i,bze),f=Vi(Vi({},Qt(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:c?"url(#clipPath-".concat(e,")"):void 0,points:r,type:a,layout:l,connectNulls:u,strokeDasharray:s??i.strokeDasharray});return E.createElement(E.Fragment,null,(r==null?void 0:r.length)>1&&E.createElement(O6,pc({},f,{pathRef:n})),E.createElement(Oze,{points:r,clipPathId:e,props:i}),o&&pl.renderCallByParent(i,r))}function Pze(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function Dze(t){var{clipPathId:e,props:n,pathRef:r,previousPointsRef:s,longestAnimatedLengthRef:i}=t,{points:o,strokeDasharray:a,isAnimationActive:l,animationBegin:u,animationDuration:c,animationEasing:d,animateNewValues:f,width:p,height:m,onAnimationEnd:y,onAnimationStart:v}=n,x=s.current,b=OK(n,"recharts-line-"),[_,S]=E.useState(!1),k=E.useCallback(()=>{typeof y=="function"&&y(),S(!1)},[y]),T=E.useCallback(()=>{typeof v=="function"&&v(),S(!0)},[v]),$=Pze(r.current),A=i.current;return E.createElement(LK,{begin:u,duration:c,isActive:l,easing:d,onAnimationEnd:k,onAnimationStart:T,key:b},D=>{var F=ji(A,$+A,D),M=Math.min(F,$),j;if(a){var H="".concat(a).split(/[,\s]+/gim).map(Z=>parseFloat(Z));j=$ze(M,$,H)}else j=tq($,M);if(x){var K=x.length/o.length,Q=D===1?o:o.map((Z,se)=>{var B=Math.floor(se*K);if(x[B]){var J=x[B];return Vi(Vi({},Z),{},{x:ji(J.x,Z.x,D),y:ji(J.y,Z.y,D)})}return f?Vi(Vi({},Z),{},{x:ji(p*2,Z.x,D),y:ji(m/2,Z.y,D)}):Vi(Vi({},Z),{},{x:Z.x,y:Z.y})});return s.current=Q,E.createElement(nN,{props:n,points:Q,clipPathId:e,pathRef:r,showLabels:!_,strokeDasharray:j})}return D>0&&$>0&&(s.current=o,i.current=M),E.createElement(nN,{props:n,points:o,clipPathId:e,pathRef:r,showLabels:!_,strokeDasharray:j})})}function Rze(t){var{clipPathId:e,props:n}=t,{points:r,isAnimationActive:s}=n,i=E.useRef(null),o=E.useRef(0),a=E.useRef(null),l=i.current;return s&&r&&r.length&&l!==r?E.createElement(Dze,{props:n,clipPathId:e,previousPointsRef:i,longestAnimatedLengthRef:o,pathRef:a}):E.createElement(nN,{props:n,points:r,clipPathId:e,pathRef:a,showLabels:!0})}var Lze=(t,e)=>({x:t.x,y:t.y,value:t.value,errorVal:qn(t.payload,e)});class Fze extends E.Component{render(){var e,{hide:n,dot:r,points:s,className:i,xAxisId:o,yAxisId:a,top:l,left:u,width:c,height:d,id:f,needClip:p}=this.props;if(n)return null;var m=xt("recharts-line",i),y=f,{r:v=3,strokeWidth:x=2}=(e=Qt(r,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},b=aH(r),_=v*2+x;return E.createElement(E.Fragment,null,E.createElement(vi,{className:m},p&&E.createElement("defs",null,E.createElement(BK,{clipPathId:y,xAxisId:o,yAxisId:a}),!b&&E.createElement("clipPath",{id:"clipPath-dots-".concat(y)},E.createElement("rect",{x:u-_/2,y:l-_/2,width:c+_,height:d+_}))),E.createElement(Rze,{props:this.props,clipPathId:y}),E.createElement(zK,{xAxisId:o,yAxisId:a,data:s,dataPointFormatter:Lze,errorBarOffset:0},this.props.children)),E.createElement(lMe,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var nq={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!_f.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function Mze(t){var e=Bo(t,nq),{activeDot:n,animateNewValues:r,animationBegin:s,animationDuration:i,animationEasing:o,connectNulls:a,dot:l,hide:u,isAnimationActive:c,label:d,legendType:f,xAxisId:p,yAxisId:m,id:y}=e,v=VA(e,wze),{needClip:x}=FA(p,m),b=LA(),_=c_(),S=qr(),k=Fe(F=>vze(F,p,m,S,y));if(_!=="horizontal"&&_!=="vertical"||k==null||b==null)return null;var{height:T,width:$,x:A,y:D}=b;return E.createElement(Fze,pc({},v,{id:y,connectNulls:a,dot:l,activeDot:n,animateNewValues:r,animationBegin:s,animationDuration:i,animationEasing:o,isAnimationActive:c,hide:u,label:d,legendType:f,xAxisId:p,yAxisId:m,points:k,layout:_,height:T,width:$,left:A,top:D,needClip:x}))}function zze(t){var{layout:e,xAxis:n,yAxis:r,xAxisTicks:s,yAxisTicks:i,dataKey:o,bandSize:a,displayedData:l}=t;return l.map((u,c)=>{var d=qn(u,o);if(e==="horizontal"){var f=fL({axis:n,ticks:s,bandSize:a,entry:u,index:c}),p=jt(d)?null:r.scale(d);return{x:f,y:p,value:d,payload:u}}var m=jt(d)?null:n.scale(d),y=fL({axis:r,ticks:i,bandSize:a,entry:u,index:c});return m==null||y==null?null:{x:m,y,value:d,payload:u}}).filter(Boolean)}function Yo(t){var e=Bo(t,nq),n=qr();return E.createElement(PK,{id:e.id,type:"line"},r=>E.createElement(E.Fragment,null,E.createElement(AK,{legendPayload:Tze(e)}),E.createElement(EK,{fn:Nze,args:e}),E.createElement(RK,{type:"line",id:r,data:e.data,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,hide:e.hide,isPanorama:n}),E.createElement(Mze,pc({},e,{id:r}))))}Yo.displayName="Line";function xM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function bM(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xM(Object(n),!0).forEach(function(r){Bze(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Bze(t,e,n){return(e=jze(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jze(t){var e=Vze(t,"string");return typeof e=="symbol"?e:e+""}function Vze(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Wze={xAxis:{},yAxis:{},zAxis:{}},rq=Vs({name:"cartesianAxis",initialState:Wze,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:n,width:r}=e.payload;t.yAxis[n]&&(t.yAxis[n]=bM(bM({},t.yAxis[n]),{},{width:r}))}}}),{addXAxis:Uze,removeXAxis:Gze,addYAxis:Hze,removeYAxis:Kze,addZAxis:qje,removeZAxis:Xje,updateYAxisWidth:qze}=rq.actions,Xze=rq.reducer,Zze=["children"],Yze=["dangerouslySetInnerHTML","ticks"];function sq(t,e,n){return(e=Qze(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qze(t){var e=Jze(t,"string");return typeof e=="symbol"?e:e+""}function Jze(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rN(){return rN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rN.apply(null,arguments)}function iq(t,e){if(t==null)return{};var n,r,s=eBe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function eBe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function tBe(t){var e=gn(),n=E.useMemo(()=>{var{children:i}=t,o=iq(t,Zze);return o},[t]),r=Fe(i=>jo(i,n.id)),s=n===r;return E.useEffect(()=>(e(Uze(n)),()=>{e(Gze(n))}),[n,e]),s?t.children:null}var nBe=t=>{var{xAxisId:e,className:n}=t,r=Fe(I6),s=qr(),i="xAxis",o=Fe(p=>$l(p,i,e,s)),a=Fe(p=>P8(p,i,e,s)),l=Fe(p=>$8(p,e)),u=Fe(p=>GDe(p,e));if(l==null||u==null)return null;var{dangerouslySetInnerHTML:c,ticks:d}=t,f=iq(t,Yze);return E.createElement(Zl,rN({},f,{scale:o,x:u.x,y:u.y,width:l.width,height:l.height,className:xt("recharts-".concat(i," ").concat(i),n),viewBox:r,ticks:a}))},rBe=t=>{var e,n,r,s,i;return E.createElement(tBe,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.xAxisId,scale:t.scale,type:t.type,padding:t.padding,allowDataOverflow:t.allowDataOverflow,domain:t.domain,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,includeHidden:(n=t.includeHidden)!==null&&n!==void 0?n:!1,reversed:t.reversed,ticks:t.ticks,height:t.height,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(r=t.angle)!==null&&r!==void 0?r:0,minTickGap:(s=t.minTickGap)!==null&&s!==void 0?s:5,tick:(i=t.tick)!==null&&i!==void 0?i:!0,tickFormatter:t.tickFormatter},E.createElement(nBe,t))};class Em extends E.Component{render(){return E.createElement(rBe,this.props)}}sq(Em,"displayName","XAxis");sq(Em,"defaultProps",{allowDataOverflow:vs.allowDataOverflow,allowDecimals:vs.allowDecimals,allowDuplicatedCategory:vs.allowDuplicatedCategory,height:vs.height,hide:!1,mirror:vs.mirror,orientation:vs.orientation,padding:vs.padding,reversed:vs.reversed,scale:vs.scale,tickCount:vs.tickCount,type:vs.type,xAxisId:0});var sBe=t=>{var{ticks:e,label:n,labelGapWithTick:r=5,tickSize:s=0,tickMargin:i=0}=t,o=0;if(e){e.forEach(c=>{if(c){var d=c.getBoundingClientRect();d.width>o&&(o=d.width)}});var a=n?n.getBoundingClientRect().width:0,l=s+i,u=o+l+a+(n?r:0);return Math.round(u)}return 0},iBe=["dangerouslySetInnerHTML","ticks"];function oq(t,e,n){return(e=oBe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oBe(t){var e=aBe(t,"string");return typeof e=="symbol"?e:e+""}function aBe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sN(){return sN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sN.apply(null,arguments)}function lBe(t,e){if(t==null)return{};var n,r,s=uBe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function uBe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function cBe(t){var e=gn();return E.useEffect(()=>(e(Hze(t)),()=>{e(Kze(t))}),[t,e]),null}var dBe=t=>{var e,{yAxisId:n,className:r,width:s,label:i}=t,o=E.useRef(null),a=E.useRef(null),l=Fe(I6),u=qr(),c=gn(),d="yAxis",f=Fe(_=>$l(_,d,n,u)),p=Fe(_=>E8(_,n)),m=Fe(_=>HDe(_,n)),y=Fe(_=>P8(_,d,n,u));if(E.useLayoutEffect(()=>{var _;if(!(s!=="auto"||!p||RA(i)||E.isValidElement(i))){var S=o.current,k=S==null||(_=S.tickRefs)===null||_===void 0?void 0:_.current,{tickSize:T,tickMargin:$}=S.props,A=sBe({ticks:k,label:a.current,labelGapWithTick:5,tickSize:T,tickMargin:$});Math.round(p.width)!==Math.round(A)&&c(qze({id:n,width:A}))}},[o,o==null||(e=o.current)===null||e===void 0||(e=e.tickRefs)===null||e===void 0?void 0:e.current,p==null?void 0:p.width,p,c,i,n,s]),p==null||m==null)return null;var{dangerouslySetInnerHTML:v,ticks:x}=t,b=lBe(t,iBe);return E.createElement(Zl,sN({},b,{ref:o,labelRef:a,scale:f,x:m.x,y:m.y,width:p.width,height:p.height,className:xt("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:y}))},hBe=t=>{var e,n,r,s,i;return E.createElement(E.Fragment,null,E.createElement(cBe,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:(n=t.includeHidden)!==null&&n!==void 0?n:!1,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(r=t.angle)!==null&&r!==void 0?r:0,minTickGap:(s=t.minTickGap)!==null&&s!==void 0?s:5,tick:(i=t.tick)!==null&&i!==void 0?i:!0,tickFormatter:t.tickFormatter}),E.createElement(dBe,t))},fBe={allowDataOverflow:xs.allowDataOverflow,allowDecimals:xs.allowDecimals,allowDuplicatedCategory:xs.allowDuplicatedCategory,hide:!1,mirror:xs.mirror,orientation:xs.orientation,padding:xs.padding,reversed:xs.reversed,scale:xs.scale,tickCount:xs.tickCount,type:xs.type,width:xs.width,yAxisId:0};class Am extends E.Component{render(){return E.createElement(hBe,this.props)}}oq(Am,"displayName","YAxis");oq(Am,"defaultProps",fBe);var pBe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fy=E;function mBe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gBe=typeof Object.is=="function"?Object.is:mBe,yBe=Fy.useSyncExternalStore,vBe=Fy.useRef,xBe=Fy.useEffect,bBe=Fy.useMemo,wBe=Fy.useDebugValue;pBe.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=vBe(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=bBe(function(){function l(p){if(!u){if(u=!0,c=p,p=r(p),s!==void 0&&o.hasValue){var m=o.value;if(s(m,p))return d=m}return d=p}if(m=d,gBe(c,p))return m;var y=r(p);return s!==void 0&&s(m,y)?(c=p,m):(c=p,d=y)}var u=!1,c,d,f=n===void 0?null:n;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,n,r,s]);var a=yBe(t,i[0],i[1]);return xBe(function(){o.hasValue=!0,o.value=a},[a]),wBe(a),a};function _Be(t){t()}function SBe(){let t=null,e=null;return{clear(){t=null,e=null},notify(){_Be(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var wM={notify(){},get:()=>[]};function kBe(t,e){let n,r=wM,s=0,i=!1;function o(y){c();const v=r.subscribe(y);let x=!1;return()=>{x||(x=!0,v(),d())}}function a(){r.notify()}function l(){m.onStateChange&&m.onStateChange()}function u(){return i}function c(){s++,n||(n=t.subscribe(l),r=SBe())}function d(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=wM)}function f(){i||(i=!0,c())}function p(){i&&(i=!1,d())}const m={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:u,trySubscribe:f,tryUnsubscribe:p,getListeners:()=>r};return m}var CBe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TBe=CBe(),NBe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",IBe=NBe(),$Be=()=>TBe||IBe?E.useLayoutEffect:E.useEffect,EBe=$Be(),bk=Symbol.for("react-redux-context"),wk=typeof globalThis<"u"?globalThis:{};function ABe(){if(!E.createContext)return{};const t=wk[bk]??(wk[bk]=new Map);let e=t.get(E.createContext);return e||(e=E.createContext(null),t.set(E.createContext,e)),e}var OBe=ABe();function PBe(t){const{children:e,context:n,serverState:r,store:s}=t,i=E.useMemo(()=>{const l=kBe(s);return{store:s,subscription:l,getServerState:r?()=>r:void 0}},[s,r]),o=E.useMemo(()=>s.getState(),[s]);EBe(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==s.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,o]);const a=n||OBe;return E.createElement(a.Provider,{value:i},e)}var DBe=PBe,RBe=(t,e)=>e,WA=he([RBe,yt,Q5,zn,q8,Ma,YRe,nr],nLe),UA=t=>{var e=t.currentTarget.getBoundingClientRect(),n=e.width/t.currentTarget.offsetWidth,r=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/n),chartY:Math.round((t.clientY-e.top)/r)}},aq=xi("mouseClick"),lq=Cy();lq.startListening({actionCreator:aq,effect:(t,e)=>{var n=t.payload,r=WA(e.getState(),UA(n));(r==null?void 0:r.activeIndex)!=null&&e.dispatch(iRe({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var iN=xi("mouseMove"),uq=Cy();uq.startListening({actionCreator:iN,effect:(t,e)=>{var n=t.payload,r=e.getState(),s=CA(r,r.tooltip.settings.shared),i=WA(r,UA(n));s==="axis"&&((i==null?void 0:i.activeIndex)!=null?e.dispatch(j8({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):e.dispatch(B8()))}});function LBe(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":e}var _M={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},cq=Vs({name:"rootProps",initialState:_M,reducers:{updateOptions:(t,e)=>{var n;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(n=e.payload.barGap)!==null&&n!==void 0?n:_M.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),FBe=cq.reducer,{updateOptions:MBe}=cq.actions,dq=Vs({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:Zje}=dq.actions,zBe=dq.reducer,hq=xi("keyDown"),fq=xi("focus"),GA=Cy();GA.startListening({actionCreator:hq,effect:(t,e)=>{var n=e.getState(),r=n.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:s}=n.tooltip,i=t.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=Number(TA(s,$f(n))),a=Ma(n);if(i==="Enter"){var l=Ux(n,"axis","hover",String(s.index));e.dispatch(qT({active:!s.active,activeIndex:s.index,activeDataKey:s.dataKey,activeCoordinate:l}));return}var u=ZDe(n),c=u==="left-to-right"?1:-1,d=i==="ArrowRight"?1:-1,f=o+d*c;if(!(a==null||f>=a.length||f<0)){var p=Ux(n,"axis","hover",String(f));e.dispatch(qT({active:!0,activeIndex:f.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});GA.startListening({actionCreator:fq,effect:(t,e)=>{var n=e.getState(),r=n.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:s}=n.tooltip;if(!s.active&&s.index==null){var i="0",o=Ux(n,"axis","hover",String(i));e.dispatch(qT({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:o}))}}}});var Js=xi("externalEvent"),pq=Cy();pq.startListening({actionCreator:Js,effect:(t,e)=>{if(t.payload.handler!=null){var n=e.getState(),r={activeCoordinate:jRe(n),activeDataKey:Q8(n),activeIndex:fc(n),activeLabel:Y8(n),activeTooltipIndex:fc(n),isTooltipActive:VRe(n)};t.payload.handler(r,t.payload.reactEvent)}}});var BBe=he([If],t=>t.tooltipItemPayloads),jBe=he([BBe,Dy,(t,e,n)=>e,(t,e,n)=>n],(t,e,n,r)=>{var s=t.find(a=>a.settings.dataKey===r);if(s!=null){var{positions:i}=s;if(i!=null){var o=e(i,n);return o}}}),mq=xi("touchMove"),gq=Cy();gq.startListening({actionCreator:mq,effect:(t,e)=>{var n=t.payload,r=e.getState(),s=CA(r,r.tooltip.settings.shared);if(s==="axis"){var i=WA(r,UA({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&e.dispatch(j8({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(s==="item"){var o,a=n.touches[0],l=document.elementFromPoint(a.clientX,a.clientY);if(!l||!l.getAttribute)return;var u=l.getAttribute(E2e),c=(o=l.getAttribute(A2e))!==null&&o!==void 0?o:void 0,d=jBe(e.getState(),u,c);e.dispatch(z8({activeDataKey:c,activeIndex:u,activeCoordinate:d}))}}});var VBe=t6({brush:y3e,cartesianAxis:Xze,chartData:yLe,errorBars:bMe,graphicalItems:QFe,layout:J$e,legend:G2e,options:hLe,polarAxis:IFe,polarOptions:zBe,referenceElements:I3e,rootProps:FBe,tooltip:oRe}),WBe=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return k$e({reducer:VBe,preloadedState:e,middleware:r=>r({serializableCheck:!1}).concat([lq.middleware,uq.middleware,GA.middleware,pq.middleware,gq.middleware]),devTools:{serialize:{replacer:LBe},name:"recharts-".concat(n)}})};function UBe(t){var{preloadedState:e,children:n,reduxStoreName:r}=t,s=qr(),i=E.useRef(null);if(s)return n;i.current==null&&(i.current=WBe(e,r));var o=CE;return E.createElement(DBe,{context:o,store:i.current},n)}function GBe(t){var{layout:e,width:n,height:r,margin:s}=t,i=gn(),o=qr();return E.useEffect(()=>{o||(i(Z$e(e)),i(Y$e({width:n,height:r})),i(X$e(s)))},[i,o,e,n,r,s]),null}function HBe(t){var e=gn();return E.useEffect(()=>{e(MBe(t))},[e,t]),null}var KBe=["children"];function qBe(t,e){if(t==null)return{};var n,r,s=XBe(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function XBe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Qx(){return Qx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qx.apply(null,arguments)}var ZBe={width:"100%",height:"100%"},YBe=E.forwardRef((t,e)=>{var n=RE(),r=LE(),s=A6();if(!Nx(n)||!Nx(r))return null;var{children:i,otherAttributes:o,title:a,desc:l}=t,u,c;return typeof o.tabIndex=="number"?u=o.tabIndex:u=s?0:void 0,typeof o.role=="string"?c=o.role:c=s?"application":void 0,E.createElement(dE,Qx({},o,{title:a,desc:l,role:c,tabIndex:u,width:n,height:r,style:ZBe,ref:e}),i)}),QBe=t=>{var{children:e}=t,n=Fe(l_);if(!n)return null;var{width:r,height:s,y:i,x:o}=n;return E.createElement(dE,{width:r,height:s,x:o,y:i},e)},SM=E.forwardRef((t,e)=>{var{children:n}=t,r=qBe(t,KBe),s=qr();return s?E.createElement(QBe,null,n):E.createElement(YBe,Qx({ref:e},r),n)});function JBe(){var t=gn(),[e,n]=E.useState(null),r=Fe($2e);return E.useEffect(()=>{if(e!=null){var s=e.getBoundingClientRect(),i=s.width/e.offsetWidth;Fs(i)&&i!==r&&t(Q$e(i))}},[e,t,r]),n}function kM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function eje(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kM(Object(n),!0).forEach(function(r){tje(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function tje(t,e,n){return(e=nje(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nje(t){var e=rje(t,"string");return typeof e=="symbol"?e:e+""}function rje(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sje=E.forwardRef((t,e)=>{var{children:n,className:r,height:s,onClick:i,onContextMenu:o,onDoubleClick:a,onMouseDown:l,onMouseEnter:u,onMouseLeave:c,onMouseMove:d,onMouseUp:f,onTouchEnd:p,onTouchMove:m,onTouchStart:y,style:v,width:x}=t,b=gn(),[_,S]=E.useState(null),[k,T]=E.useState(null);bLe();var $=JBe(),A=E.useCallback(ne=>{$(ne),typeof e=="function"&&e(ne),S(ne),T(ne)},[$,e,S,T]),D=E.useCallback(ne=>{b(aq(ne)),b(Js({handler:i,reactEvent:ne}))},[b,i]),F=E.useCallback(ne=>{b(iN(ne)),b(Js({handler:u,reactEvent:ne}))},[b,u]),M=E.useCallback(ne=>{b(B8()),b(Js({handler:c,reactEvent:ne}))},[b,c]),j=E.useCallback(ne=>{b(iN(ne)),b(Js({handler:d,reactEvent:ne}))},[b,d]),H=E.useCallback(()=>{b(fq())},[b]),K=E.useCallback(ne=>{b(hq(ne.key))},[b]),Q=E.useCallback(ne=>{b(Js({handler:o,reactEvent:ne}))},[b,o]),Z=E.useCallback(ne=>{b(Js({handler:a,reactEvent:ne}))},[b,a]),se=E.useCallback(ne=>{b(Js({handler:l,reactEvent:ne}))},[b,l]),B=E.useCallback(ne=>{b(Js({handler:f,reactEvent:ne}))},[b,f]),J=E.useCallback(ne=>{b(Js({handler:y,reactEvent:ne}))},[b,y]),Y=E.useCallback(ne=>{b(mq(ne)),b(Js({handler:m,reactEvent:ne}))},[b,m]),ie=E.useCallback(ne=>{b(Js({handler:p,reactEvent:ne}))},[b,p]);return E.createElement(sK.Provider,{value:_},E.createElement(lH.Provider,{value:k},E.createElement("div",{className:xt("recharts-wrapper",r),style:eje({position:"relative",cursor:"default",width:x,height:s},v),onClick:D,onContextMenu:Q,onDoubleClick:Z,onFocus:H,onKeyDown:K,onMouseDown:se,onMouseEnter:F,onMouseLeave:M,onMouseMove:j,onMouseUp:B,onTouchEnd:ie,onTouchMove:Y,onTouchStart:J,ref:A},n)))}),ije=["children","className","width","height","style","compact","title","desc"];function oje(t,e){if(t==null)return{};var n,r,s=aje(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function aje(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var lje=E.forwardRef((t,e)=>{var{children:n,className:r,width:s,height:i,style:o,compact:a,title:l,desc:u}=t,c=oje(t,ije),d=Pc(c);return a?E.createElement(SM,{otherAttributes:d,title:l,desc:u},n):E.createElement(sje,{className:r,style:o,width:s,height:i,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},E.createElement(SM,{otherAttributes:d,title:l,desc:u,ref:e},E.createElement($3e,null,n)))}),uje=["width","height"];function oN(){return oN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oN.apply(null,arguments)}function cje(t,e){if(t==null)return{};var n,r,s=dje(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function dje(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var hje={top:5,right:5,bottom:5,left:5},fje={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:hje,reverseStackOrder:!1,syncMethod:"index"},yq=E.forwardRef(function(e,n){var r,s=Bo(e.categoricalChartProps,fje),{width:i,height:o}=s,a=cje(s,uje);if(!Nx(i)||!Nx(o))return null;var{chartName:l,defaultTooltipEventType:u,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,categoricalChartProps:f}=e,p={chartName:l,defaultTooltipEventType:u,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,eventEmitter:void 0};return E.createElement(UBe,{preloadedState:{options:p},reduxStoreName:(r=f.id)!==null&&r!==void 0?r:l},E.createElement(g3e,{chartData:f.data}),E.createElement(GBe,{width:i,height:o,layout:s.layout,margin:s.margin}),E.createElement(HBe,{accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className}),E.createElement(lje,oN({},a,{width:i,height:o,ref:n})))}),pje=["axis"],vq=E.forwardRef((t,e)=>E.createElement(yq,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:pje,tooltipPayloadSearcher:oK,categoricalChartProps:t,ref:e})),mje=["axis","item"],gje=E.forwardRef((t,e)=>E.createElement(yq,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:mje,tooltipPayloadSearcher:oK,categoricalChartProps:t,ref:e}));const yje=({locationId:t,currentTime:e,detections:n=[],detectionService:r})=>{const[s,i]=E.useState([]),[o,a]=E.useState(null),[l,u]=E.useState(!1);E.useEffect(()=>{n.length===0&&e>5?u(!0):n.length>0&&u(!1)},[n,e]),E.useEffect(()=>{o&&clearInterval(o);const p=setInterval(()=>{if(r){const m=r.getAggregatedData(0,e+1,15),y=Math.max(300,e+60);for(let v=m.length*15;v<=y;v+=15)m.push({time:v,cars:0,trucks:0,buses:0,motorcycles:0,bicycles:0,pedestrians:0});i(m)}},1e3);return a(p),()=>{p&&clearInterval(p)}},[e,r,t,o]),E.useEffect(()=>{if(r&&n.length>0){const p=r.getTrafficCount(n);console.log("Current traffic count:",p)}},[n,r]);const c=p=>{const m=Math.floor(p/60),y=p%60;return`${m}:${y.toString().padStart(2,"0")}`},d=n.length,f=s.reduce((p,m)=>(p.cars+=m.cars,p.trucks+=m.trucks,p.buses+=m.buses,p.motorcycles+=m.motorcycles,p.bicycles+=m.bicycles,p.pedestrians+=m.pedestrians,p),{cars:0,trucks:0,buses:0,motorcycles:0,bicycles:0,pedestrians:0});return z.jsxs("div",{style:{width:"100%",height:"500px"},children:[z.jsx("h3",{children:"📡 Real-time Detection Volume"}),l?z.jsxs("div",{style:{padding:"40px",textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:"8px",margin:"20px 0"},children:[z.jsx("h4",{style:{color:"#6c757d",marginBottom:"16px"},children:"🎥 Server-Processed Video Mode"}),z.jsxs("p",{style:{color:"#6c757d",lineHeight:"1.5"},children:["This video uses pre-processed detection data with embedded bounding boxes.",z.jsx("br",{}),"Real-time detection data is not available in this mode.",z.jsx("br",{}),z.jsx("strong",{children:'Check the "Virtual Loop Traffic Volume" chart below for traffic analysis.'})]})]}):z.jsxs(z.Fragment,{children:[z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px",padding:"10px",backgroundColor:"#f5f5f5",borderRadius:"8px"},children:[z.jsxs("div",{children:[z.jsx("strong",{children:"Current Detections:"})," ",d]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Total Counted:"})," ",Object.values(f).reduce((p,m)=>p+m,0)]})]}),z.jsx(fK,{width:"100%",height:"80%",children:z.jsxs(vq,{data:s,margin:{top:5,right:30,left:20,bottom:5},children:[z.jsx(Yx,{strokeDasharray:"3 3"}),z.jsx(Em,{dataKey:"time",tickFormatter:c,label:{value:"Time (mm:ss)",position:"insideBottom",offset:-5}}),z.jsx(Am,{label:{value:"Count",angle:-90,position:"insideLeft"}}),z.jsx(YT,{labelFormatter:p=>`Time: ${c(p)}`}),z.jsx(th,{}),z.jsx(Yo,{type:"monotone",dataKey:"cars",stroke:"#FF6B6B",name:"Cars",strokeWidth:2,dot:!1}),z.jsx(Yo,{type:"monotone",dataKey:"trucks",stroke:"#4ECDC4",name:"Trucks",strokeWidth:2,dot:!1}),z.jsx(Yo,{type:"monotone",dataKey:"buses",stroke:"#45B7D1",name:"Buses",strokeWidth:2,dot:!1}),z.jsx(Yo,{type:"monotone",dataKey:"motorcycles",stroke:"#FFA500",name:"Motorcycles",strokeWidth:2,dot:!1}),z.jsx(Yo,{type:"monotone",dataKey:"bicycles",stroke:"#98D8C8",name:"Bicycles",strokeWidth:2,dot:!1}),z.jsx(Yo,{type:"monotone",dataKey:"pedestrians",stroke:"#FFD93D",name:"Pedestrians",strokeWidth:2,dot:!1}),e>0&&z.jsx(zA,{x:Math.floor(e/15)*15,stroke:"red",strokeWidth:2,strokeDasharray:"5 5",label:{value:"Current",position:"top"}})]})})]})]})},vje=({locationId:t,currentTime:e=0,onTimeSelect:n})=>{const[r,s]=E.useState(null),[i,o]=E.useState(!1),[a,l]=E.useState(null),[u,c]=E.useState("line"),d=Rp.useCallback(async()=>{if(t){o(!0),l(null);try{const _=`${t}_traffic_data.json`;let S=await fetch(`${bu}/processed/${encodeURIComponent(_)}`);if(S.status===404&&(S=await fetch(`${bu}/processed-videos/${encodeURIComponent(_)}`)),!S.ok){if(S.status===404)l("No traffic volume data available. Process video with virtual loops first.");else throw new Error(`HTTP ${S.status}: ${S.statusText}`);return}const k=await S.json();s(k),console.log("📊 Loaded traffic data:",{location:k.location_id,totalCrossings:k.total_crossings,loops:Object.keys(k.virtual_loops).length,timeIntervals:k.time_series.length})}catch(_){console.error("Error loading traffic data:",_),l(_ instanceof Error?_.message:"Failed to load traffic data")}finally{o(!1)}}},[t]);E.useEffect(()=>{d()},[d]);const f=_=>{const S=Math.floor(_/60),k=Math.floor(_%60);return`${S}:${k.toString().padStart(2,"0")}`},p=()=>r?r.time_series.map(_=>({time:f(_.timestamp),timestamp:_.timestamp,totalCount:_.total_count,PC:_.vehicle_counts.PC||0,Truck:_.vehicle_counts.Truck||0,Bus:_.vehicle_counts.Bus||0,"Bk/Mc":_.vehicle_counts["Bk/Mc"]||0,Ped:_.vehicle_counts.Ped||0})):[],m=()=>({PC:"#22c55e",Truck:"#ef4444",Bus:"#3b82f6","Bk/Mc":"#eab308",Ped:"#f97316"}),y=()=>{if(!r)return null;const _=Object.entries(r.virtual_loops).reduce((S,[,k])=>(Object.entries(k.vehicle_counts).forEach(([T,$])=>{S[T]=(S[T]||0)+$}),S),{});return{totalCrossings:r.total_crossings,totalByType:_,loopCount:Object.keys(r.virtual_loops).length,duration:r.time_series.length*r.interval_seconds}};if(i)return z.jsx("div",{className:"traffic-chart-container",children:z.jsxs("div",{className:"loading-indicator",children:[z.jsx("div",{className:"loading-spinner"}),z.jsx("p",{children:"Loading traffic volume data..."})]})});if(a)return z.jsx("div",{className:"traffic-chart-container",children:z.jsxs("div",{className:"error-message",children:[z.jsx("h3",{children:"⚠️ Traffic Volume Data"}),z.jsx("p",{children:a}),z.jsx("button",{onClick:d,className:"retry-button",children:"Retry"})]})});if(!r)return z.jsx("div",{className:"traffic-chart-container",children:z.jsxs("div",{className:"no-data-message",children:[z.jsx("h3",{children:"📊 Traffic Volume Analysis"}),z.jsx("p",{children:"No traffic data available for this location."})]})});const v=p(),x=y(),b=m();return z.jsxs("div",{className:"traffic-chart-container",children:[z.jsxs("div",{className:"chart-header",children:[z.jsx("h3",{children:"🚦 Virtual Loop Traffic Volume"}),z.jsxs("div",{className:"chart-controls",children:[z.jsx("button",{className:u==="line"?"active":"",onClick:()=>c("line"),children:"Line Chart"}),z.jsx("button",{className:u==="bar"?"active":"",onClick:()=>c("bar"),children:"Bar Chart"})]})]}),x&&z.jsxs("div",{className:"traffic-summary",children:[z.jsxs("div",{className:"summary-stats",children:[z.jsxs("div",{className:"stat-item",children:[z.jsx("span",{className:"stat-label",children:"Total Crossings:"}),z.jsx("span",{className:"stat-value",children:x.totalCrossings})]}),z.jsxs("div",{className:"stat-item",children:[z.jsx("span",{className:"stat-label",children:"Virtual Loops:"}),z.jsx("span",{className:"stat-value",children:x.loopCount})]}),z.jsxs("div",{className:"stat-item",children:[z.jsx("span",{className:"stat-label",children:"Duration:"}),z.jsx("span",{className:"stat-value",children:f(x.duration)})]})]}),z.jsx("div",{className:"vehicle-breakdown",children:Object.entries(x.totalByType).map(([_,S])=>z.jsxs("div",{className:"vehicle-stat",children:[z.jsx("div",{className:"vehicle-color",style:{backgroundColor:b[_]}}),z.jsxs("span",{className:"vehicle-type",children:[_,":"]}),z.jsx("span",{className:"vehicle-count",children:S})]},_))})]}),z.jsx("div",{className:"chart-wrapper",children:z.jsx(fK,{width:"100%",height:300,children:u==="line"?z.jsxs(vq,{data:v,onClick:_=>{var S,k,T;return n==null?void 0:n(((T=(k=(S=_.activePayload)==null?void 0:S[0])==null?void 0:k.payload)==null?void 0:T.timestamp)||0)},children:[z.jsx(Yx,{strokeDasharray:"3 3"}),z.jsx(Em,{dataKey:"time",tick:{fontSize:12}}),z.jsx(Am,{}),z.jsx(YT,{labelStyle:{color:"#333"},contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"4px"}}),z.jsx(th,{}),Object.entries(b).map(([_,S])=>z.jsx(Yo,{type:"monotone",dataKey:_,stroke:S,strokeWidth:2,dot:{r:4},connectNulls:!1},_)),e>0&&z.jsx(Yo,{type:"monotone",dataKey:()=>null,stroke:"#ff0000",strokeWidth:2,strokeDasharray:"5,5",dot:!1})]}):z.jsxs(gje,{data:v,onClick:_=>{var S,k,T;return n==null?void 0:n(((T=(k=(S=_.activePayload)==null?void 0:S[0])==null?void 0:k.payload)==null?void 0:T.timestamp)||0)},children:[z.jsx(Yx,{strokeDasharray:"3 3"}),z.jsx(Em,{dataKey:"time",tick:{fontSize:12}}),z.jsx(Am,{}),z.jsx(YT,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"4px"}}),z.jsx(th,{}),Object.entries(b).map(([_,S])=>z.jsx(WK,{dataKey:_,fill:S,stackId:"vehicles"},_))]})})}),z.jsxs("div",{className:"chart-info",children:[z.jsxs("p",{children:[z.jsx("strong",{children:"Virtual Loops:"})," ",Object.keys(r.virtual_loops).join(", ")]}),z.jsxs("p",{children:[z.jsx("strong",{children:"Data Interval:"})," ",r.interval_seconds,"s |",z.jsx("strong",{children:" Processing:"})," ",new Date(r.processing_timestamp).toLocaleString()]})]}),z.jsx("style",{jsx:!0,children:`
        .traffic-chart-container {
          background: white;
          border-radius: 8px;
          padding: 20px;
          margin: 20px 0;
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .chart-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 16px;
        }

        .chart-header h3 {
          margin: 0;
          color: #1e293b;
          font-size: 1.2em;
        }

        .chart-controls {
          display: flex;
          gap: 8px;
        }

        .chart-controls button {
          padding: 6px 12px;
          border: 1px solid #d1d5db;
          background: white;
          border-radius: 4px;
          cursor: pointer;
          font-size: 14px;
          transition: all 0.2s;
        }

        .chart-controls button:hover {
          background: #f3f4f6;
        }

        .chart-controls button.active {
          background: #3b82f6;
          color: white;
          border-color: #3b82f6;
        }

        .traffic-summary {
          display: flex;
          justify-content: space-between;
          margin-bottom: 20px;
          padding: 16px;
          background: #f8fafc;
          border-radius: 6px;
        }

        .summary-stats {
          display: flex;
          gap: 20px;
        }

        .stat-item {
          display: flex;
          flex-direction: column;
        }

        .stat-label {
          font-size: 12px;
          color: #64748b;
          margin-bottom: 2px;
        }

        .stat-value {
          font-size: 18px;
          font-weight: bold;
          color: #1e293b;
        }

        .vehicle-breakdown {
          display: flex;
          gap: 16px;
          flex-wrap: wrap;
        }

        .vehicle-stat {
          display: flex;
          align-items: center;
          gap: 6px;
        }

        .vehicle-color {
          width: 12px;
          height: 12px;
          border-radius: 2px;
        }

        .vehicle-type {
          font-size: 14px;
          color: #64748b;
        }

        .vehicle-count {
          font-size: 14px;
          font-weight: bold;
          color: #1e293b;
        }

        .chart-wrapper {
          margin: 20px 0;
        }

        .chart-info {
          margin-top: 16px;
          padding-top: 16px;
          border-top: 1px solid #e5e7eb;
          font-size: 14px;
          color: #64748b;
        }

        .chart-info p {
          margin: 4px 0;
        }

        .loading-indicator, .error-message, .no-data-message {
          text-align: center;
          padding: 40px 20px;
        }

        .loading-spinner {
          width: 40px;
          height: 40px;
          border: 4px solid #f3f3f3;
          border-top: 4px solid #3b82f6;
          border-radius: 50%;
          animation: spin 1s linear infinite;
          margin: 0 auto 16px;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        .error-message h3 {
          color: #dc2626;
          margin-bottom: 12px;
        }

        .retry-button {
          background: #3b82f6;
          color: white;
          border: none;
          padding: 8px 16px;
          border-radius: 4px;
          cursor: pointer;
          margin-top: 12px;
        }

        .retry-button:hover {
          background: #2563eb;
        }
      `})]})},xq=[{id:"mta",name:"MTA",description:"Metropolitan Transportation Authority Classification",categories:[{id:"bus",name:"Bus",color:"#3B82F6"},{id:"subway_vehicle",name:"Subway Service Vehicle",color:"#8B5CF6"},{id:"passenger_car",name:"Passenger Car",color:"#10B981"},{id:"taxi",name:"Taxi/For-Hire",color:"#F59E0B"},{id:"truck",name:"Truck",color:"#EF4444"},{id:"motorcycle",name:"Motorcycle",color:"#06B6D4"},{id:"bicycle",name:"Bicycle",color:"#84CC16"},{id:"pedestrian",name:"Pedestrian",color:"#EC4899"}]},{id:"fhwa",name:"FHWA Axle-based (PANYNJ)",description:"Federal Highway Administration / Port Authority Classification",categories:[{id:"class1",name:"Class 1: Motorcycles",color:"#06B6D4"},{id:"class2",name:"Class 2: Passenger Cars",color:"#10B981"},{id:"class3",name:"Class 3: Light Trucks (2 Axles, 4 Tires)",color:"#84CC16"},{id:"class4",name:"Class 4: Buses",color:"#3B82F6"},{id:"class5",name:"Class 5: Single Unit Trucks (2 Axles, 6 Tires)",color:"#F59E0B"},{id:"class6",name:"Class 6: Single Unit Trucks (3 Axles)",color:"#FB923C"},{id:"class7",name:"Class 7: Single Unit Trucks (4+ Axles)",color:"#F87171"},{id:"class8",name:"Class 8: Single Trailer Trucks (3-4 Axles)",color:"#EF4444"},{id:"class9",name:"Class 9: Single Trailer Trucks (5 Axles)",color:"#DC2626"},{id:"class10",name:"Class 10: Single Trailer Trucks (6+ Axles)",color:"#B91C1C"},{id:"class11",name:"Class 11: Multi-Trailer Trucks (5-6 Axles)",color:"#991B1B"},{id:"class12",name:"Class 12: Multi-Trailer Trucks (6+ Axles)",color:"#7F1D1D"},{id:"class13",name:"Class 13: Multi-Trailer Trucks (7+ Axles)",color:"#450A0A"}]},{id:"gvwr",name:"GVWR",description:"Gross Vehicle Weight Rating Classification",categories:[{id:"class1",name:"Class 1: ≤ 6,000 lbs",color:"#DBEAFE"},{id:"class2a",name:"Class 2a: 6,001-8,500 lbs",color:"#BFDBFE"},{id:"class2b",name:"Class 2b: 8,501-10,000 lbs",color:"#93C5FD"},{id:"class3",name:"Class 3: 10,001-14,000 lbs",color:"#60A5FA"},{id:"class4",name:"Class 4: 14,001-16,000 lbs",color:"#3B82F6"},{id:"class5",name:"Class 5: 16,001-19,500 lbs",color:"#2563EB"},{id:"class6",name:"Class 6: 19,501-26,000 lbs",color:"#1D4ED8"},{id:"class7",name:"Class 7: 26,001-33,000 lbs",color:"#1E40AF"},{id:"class8",name:"Class 8: > 33,000 lbs",color:"#1E3A8A"}]}],xje=({selectedSchema:t,onSchemaSelect:e,onAddCustomSchema:n})=>z.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[z.jsx("h2",{style:{margin:"0 0 15px 0",fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:"Classification Schema"}),z.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[xq.map(r=>z.jsxs("button",{onClick:()=>e(r),style:{padding:"16px",border:(t==null?void 0:t.id)===r.id?"2px solid #3B82F6":"2px solid #E5E7EB",borderRadius:"8px",background:(t==null?void 0:t.id)===r.id?"#EFF6FF":"white",cursor:"pointer",textAlign:"left",transition:"all 0.2s",position:"relative"},onMouseEnter:s=>{(t==null?void 0:t.id)!==r.id&&(s.currentTarget.style.borderColor="#93C5FD",s.currentTarget.style.background="#F9FAFB")},onMouseLeave:s=>{(t==null?void 0:t.id)!==r.id&&(s.currentTarget.style.borderColor="#E5E7EB",s.currentTarget.style.background="white")},children:[(t==null?void 0:t.id)===r.id&&z.jsx("div",{style:{position:"absolute",top:"8px",right:"8px",width:"20px",height:"20px",borderRadius:"50%",background:"#3B82F6",display:"flex",alignItems:"center",justifyContent:"center"},children:z.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:z.jsx("path",{d:"M2 6L5 9L10 3",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),z.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#1f2937",marginBottom:"4px"},children:r.name}),z.jsx("div",{style:{fontSize:"13px",color:"#6B7280",lineHeight:"1.4"},children:r.description}),z.jsxs("div",{style:{marginTop:"8px",fontSize:"12px",color:"#9CA3AF"},children:[r.categories.length," categories"]})]},r.id)),z.jsxs("button",{onClick:n,style:{padding:"16px",border:"2px dashed #D1D5DB",borderRadius:"8px",background:"white",cursor:"pointer",textAlign:"center",transition:"all 0.2s",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseEnter:r=>{r.currentTarget.style.borderColor="#93C5FD",r.currentTarget.style.background="#F9FAFB"},onMouseLeave:r=>{r.currentTarget.style.borderColor="#D1D5DB",r.currentTarget.style.background="white"},children:[z.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",children:[z.jsx("rect",{x:"1",y:"1",width:"30",height:"30",rx:"7",stroke:"#9CA3AF",strokeWidth:"2",strokeDasharray:"4 4"}),z.jsx("path",{d:"M16 10V22M10 16H22",stroke:"#9CA3AF",strokeWidth:"2",strokeLinecap:"round"})]}),z.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#6B7280"},children:"Add Custom Schema"}),z.jsx("div",{style:{fontSize:"13px",color:"#9CA3AF"},children:"Create your own classification"})]})]}),t&&z.jsxs("div",{style:{marginTop:"20px",padding:"16px",background:"#F9FAFB",borderRadius:"8px",border:"1px solid #E5E7EB"},children:[z.jsxs("div",{style:{fontSize:"14px",fontWeight:"600",color:"#4B5563",marginBottom:"12px"},children:["Categories in ",t.name,":"]}),z.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:t.categories.map(r=>z.jsxs("div",{style:{padding:"6px 12px",borderRadius:"6px",background:r.color+"20",border:`1px solid ${r.color}40`,fontSize:"13px",color:"#1f2937",display:"flex",alignItems:"center",gap:"6px"},children:[z.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:r.color}}),r.name]},r.id))})]})]}),bje=({isOpen:t,onClose:e,onSave:n})=>{const[r,s]=E.useState(""),[i,o]=E.useState(""),[a,l]=E.useState([{id:"1",name:"",color:"#3B82F6"}]),u=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#84CC16","#F97316","#6366F1"],c=()=>{const y=(a.length+1).toString();l([...a,{id:y,name:"",color:u[a.length%u.length]}])},d=(y,v,x)=>{const b=[...a];b[y]={...b[y],[v]:x},l(b)},f=y=>{l(a.filter((v,x)=>x!==y))},p=()=>{if(!r||a.some(v=>!v.name)){alert("Please fill in all required fields");return}const y={id:`custom_${Date.now()}`,name:r,description:i,categories:a.map((v,x)=>({...v,id:`cat_${x}`})),isCustom:!0};n(y),m()},m=()=>{s(""),o(""),l([{id:"1",name:"",color:"#3B82F6"}]),e()};return t?z.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:z.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},children:[z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[z.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:"600",color:"#1f2937"},children:"Create Custom Classification Schema"}),z.jsx("button",{onClick:m,style:{background:"none",border:"none",cursor:"pointer",padding:"4px"},children:z.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:z.jsx("path",{d:"M6 6L18 18M6 18L18 6",stroke:"#6B7280",strokeWidth:"2",strokeLinecap:"round"})})})]}),z.jsxs("div",{style:{marginBottom:"20px"},children:[z.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Schema Name *"}),z.jsx("input",{type:"text",value:r,onChange:y=>s(y.target.value),placeholder:"e.g., Custom Traffic Classification",style:{width:"100%",padding:"10px 12px",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px",outline:"none"}})]}),z.jsxs("div",{style:{marginBottom:"20px"},children:[z.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Description"}),z.jsx("textarea",{value:i,onChange:y=>o(y.target.value),placeholder:"Describe your classification schema...",rows:3,style:{width:"100%",padding:"10px 12px",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px",outline:"none",resize:"vertical"}})]}),z.jsxs("div",{style:{marginBottom:"20px"},children:[z.jsx("label",{style:{display:"block",marginBottom:"12px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Categories *"}),a.map((y,v)=>z.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px",alignItems:"center"},children:[z.jsx("input",{type:"text",value:y.name,onChange:x=>d(v,"name",x.target.value),placeholder:"Category name",style:{flex:1,padding:"8px 12px",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px",outline:"none"}}),z.jsx("input",{type:"color",value:y.color,onChange:x=>d(v,"color",x.target.value),style:{width:"50px",height:"38px",border:"1px solid #D1D5DB",borderRadius:"6px",cursor:"pointer"}}),a.length>1&&z.jsx("button",{onClick:()=>f(v),style:{padding:"8px",background:"#FEE2E2",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:z.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"#EF4444",children:z.jsx("path",{d:"M4 4L12 12M4 12L12 4",stroke:"#EF4444",strokeWidth:"2",strokeLinecap:"round"})})})]},v)),z.jsxs("button",{onClick:c,style:{marginTop:"8px",padding:"8px 16px",background:"#EFF6FF",border:"1px solid #3B82F6",borderRadius:"6px",color:"#3B82F6",fontSize:"14px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[z.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:z.jsx("path",{d:"M8 4V12M4 8H12",stroke:"#3B82F6",strokeWidth:"2",strokeLinecap:"round"})}),"Add Category"]})]}),z.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",paddingTop:"16px",borderTop:"1px solid #E5E7EB"},children:[z.jsx("button",{onClick:m,style:{padding:"10px 20px",background:"white",border:"1px solid #D1D5DB",borderRadius:"6px",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),z.jsx("button",{onClick:p,style:{padding:"10px 20px",background:"#3B82F6",border:"none",borderRadius:"6px",color:"white",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Create Schema"})]})]})}):null},wje=({onVideoUpload:t})=>{const[e,n]=E.useState(!1),[r,s]=E.useState(""),[i,o]=E.useState(!1),a=E.useRef(null),l=m=>{m.preventDefault(),n(!0)},u=m=>{m.preventDefault(),n(!1)},c=m=>{m.preventDefault(),n(!1);const v=Array.from(m.dataTransfer.files).find(x=>x.type.startsWith("video/"));v?f(v):alert("Please upload a valid video file (MP4, WebM, AVI, MOV, etc.)")},d=m=>{var v;const y=(v=m.target.files)==null?void 0:v[0];y&&f(y)},f=async m=>{if(!r.trim()){alert("Please enter a location name for this video");return}if(m.size>500*1024*1024){alert("File size is too large. Please upload videos smaller than 500MB.");return}o(!0);try{t(m,r.trim()),s(""),a.current&&(a.current.value="")}catch(y){console.error("Upload failed:",y),alert("Upload failed. Please try again.")}finally{o(!1)}},p=()=>{var m;(m=a.current)==null||m.click()};return z.jsxs("div",{className:"video-uploader",children:[z.jsx("h3",{children:"Upload Custom Video"}),z.jsxs("div",{className:"location-input-section",children:[z.jsx("label",{htmlFor:"location-input",children:"Location Name:"}),z.jsx("input",{id:"location-input",type:"text",placeholder:"e.g., Main St & Oak Ave",value:r,onChange:m=>s(m.target.value),className:"location-input",disabled:i})]}),z.jsxs("div",{className:`upload-zone ${e?"dragging":""} ${i?"uploading":""}`,onDragOver:l,onDragLeave:u,onDrop:c,onClick:p,children:[z.jsx("input",{ref:a,type:"file",accept:"video/*",onChange:d,style:{display:"none"},disabled:i}),z.jsx("div",{className:"upload-content",children:i?z.jsxs(z.Fragment,{children:[z.jsx("div",{className:"upload-spinner",children:"⏳"}),z.jsx("p",{children:"Processing video..."})]}):z.jsxs(z.Fragment,{children:[z.jsx("div",{className:"upload-icon",children:"📹"}),z.jsxs("p",{children:[z.jsx("strong",{children:"Click to select"})," or drag and drop a video file"]}),z.jsx("p",{className:"upload-hint",children:"Supports MP4, WebM, AVI, MOV (max 500MB)"})]})})]}),z.jsx("style",{children:`
        .video-uploader {
          margin: 20px 0;
          padding: 20px;
          border: 1px solid #ddd;
          border-radius: 8px;
          background: #f9f9f9;
        }

        .location-input-section {
          margin-bottom: 15px;
        }

        .location-input-section label {
          display: block;
          margin-bottom: 5px;
          font-weight: bold;
          color: #333;
        }

        .location-input {
          width: 100%;
          padding: 8px 12px;
          border: 1px solid #ccc;
          border-radius: 4px;
          font-size: 14px;
        }

        .location-input:focus {
          outline: none;
          border-color: #007bff;
          box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }

        .upload-zone {
          border: 2px dashed #ccc;
          border-radius: 8px;
          padding: 40px 20px;
          text-align: center;
          cursor: pointer;
          transition: all 0.3s ease;
          background: white;
        }

        .upload-zone:hover {
          border-color: #007bff;
          background: #f8f9fa;
        }

        .upload-zone.dragging {
          border-color: #007bff;
          background: #e7f3ff;
          transform: scale(1.02);
        }

        .upload-zone.uploading {
          cursor: not-allowed;
          opacity: 0.7;
        }

        .upload-content {
          pointer-events: none;
        }

        .upload-icon {
          font-size: 48px;
          margin-bottom: 10px;
        }

        .upload-spinner {
          font-size: 48px;
          margin-bottom: 10px;
          animation: spin 2s linear infinite;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        .upload-zone p {
          margin: 5px 0;
          color: #666;
        }

        .upload-hint {
          font-size: 12px;
          color: #888;
        }
      `})]})},_je=({onStartProcessing:t,availableLocations:e})=>{const[n,r]=E.useState([]),[s,i]=E.useState(!1),o=async()=>{try{return n.map(c=>c.status==="processing"&&c.progress<100?{...c,progress:Math.min(c.progress+Math.random()*2,100),currentFrame:Math.floor(c.progress/100*c.totalFrames),fps:24+Math.random()*4,timeElapsed:c.timeElapsed+1}:c)}catch(c){return console.error("Failed to fetch processing progress:",c),n}},a=c=>{const d=e.find(p=>p.id===c);if(!d)return;const f={id:`job-${Date.now()}`,location:d.name,status:"processing",progress:0,currentFrame:0,totalFrames:10977,fps:0,timeElapsed:0};r(p=>[...p,f]),i(!0),t(c)};E.useEffect(()=>{if(!s)return;const c=setInterval(async()=>{const d=await o();r(d),d.some(p=>p.status==="processing"||p.status==="pending")||i(!1)},1e3);return()=>clearInterval(c)},[s,n,o]);const l=c=>{const d=Math.floor(c/60),f=c%60;return`${d}:${f.toString().padStart(2,"0")}`},u=c=>{switch(c){case"pending":return"#ffc107";case"processing":return"#007bff";case"completed":return"#28a745";case"error":return"#dc3545";default:return"#6c757d"}};return z.jsxs("div",{className:"processing-progress",children:[z.jsx("h3",{children:"🔬 YOLOv8 Server Processing"}),z.jsxs("div",{className:"processing-controls",children:[z.jsxs("select",{className:"location-selector",onChange:c=>c.target.value&&a(c.target.value),defaultValue:"",children:[z.jsx("option",{value:"",disabled:!0,children:"Select location to process"}),e.map(c=>z.jsx("option",{value:c.id,children:c.name},c.id))]}),z.jsx("p",{className:"processing-info",children:"Server-side processing adds bounding boxes and classifications"})]}),n.length>0&&z.jsxs("div",{className:"jobs-container",children:[z.jsx("h4",{children:"Processing Jobs"}),n.map(c=>z.jsxs("div",{className:"job-card",children:[z.jsxs("div",{className:"job-header",children:[z.jsx("span",{className:"job-location",children:c.location}),z.jsx("span",{className:"job-status",style:{color:u(c.status)},children:c.status.toUpperCase()})]}),z.jsxs("div",{className:"progress-bar-container",children:[z.jsx("div",{className:"progress-bar",children:z.jsx("div",{className:"progress-fill",style:{width:`${c.progress}%`,backgroundColor:u(c.status)}})}),z.jsxs("span",{className:"progress-text",children:[c.progress.toFixed(1),"%"]})]}),z.jsxs("div",{className:"job-details",children:[z.jsxs("div",{className:"detail-row",children:[z.jsxs("span",{children:["Frames: ",c.currentFrame.toLocaleString()," / ",c.totalFrames.toLocaleString()]}),z.jsxs("span",{children:["FPS: ",c.fps.toFixed(1)]})]}),z.jsxs("div",{className:"detail-row",children:[z.jsxs("span",{children:["Elapsed: ",l(c.timeElapsed)]}),c.timeRemaining&&z.jsxs("span",{children:["Remaining: ",l(c.timeRemaining)]})]})]}),c.error&&z.jsxs("div",{className:"job-error",children:["❌ Error: ",c.error]})]},c.id))]}),z.jsx("style",{children:`
        .processing-progress {
          margin: 20px 0;
          padding: 20px;
          border: 1px solid #ddd;
          border-radius: 8px;
          background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .processing-progress h3 {
          margin: 0 0 15px 0;
          color: #495057;
        }

        .processing-controls {
          margin-bottom: 20px;
        }

        .location-selector {
          width: 100%;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 4px;
          font-size: 14px;
          background: white;
        }

        .processing-info {
          margin: 8px 0 0 0;
          font-size: 12px;
          color: #6c757d;
          font-style: italic;
        }

        .jobs-container h4 {
          margin: 0 0 15px 0;
          color: #495057;
        }

        .job-card {
          background: white;
          border: 1px solid #dee2e6;
          border-radius: 6px;
          padding: 15px;
          margin-bottom: 10px;
          box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .job-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 10px;
        }

        .job-location {
          font-weight: bold;
          color: #495057;
        }

        .job-status {
          font-size: 12px;
          font-weight: bold;
          padding: 2px 6px;
          border-radius: 3px;
          background: rgba(0,0,0,0.1);
        }

        .progress-bar-container {
          display: flex;
          align-items: center;
          gap: 10px;
          margin-bottom: 10px;
        }

        .progress-bar {
          flex: 1;
          height: 20px;
          background: #e9ecef;
          border-radius: 10px;
          overflow: hidden;
        }

        .progress-fill {
          height: 100%;
          transition: width 0.3s ease;
          border-radius: 10px;
        }

        .progress-text {
          font-size: 12px;
          font-weight: bold;
          color: #495057;
          min-width: 45px;
        }

        .job-details {
          font-size: 12px;
          color: #6c757d;
        }

        .detail-row {
          display: flex;
          justify-content: space-between;
          margin-bottom: 4px;
        }

        .job-error {
          margin-top: 10px;
          padding: 8px;
          background: #f8d7da;
          color: #721c24;
          border-radius: 4px;
          font-size: 12px;
        }
      `})]})},CM="/UMDL2/assets/lab_logo-CLnPW8RL.png",Sje={"74th-Amsterdam-Columbus":[40.5761,-74.1412],"Amsterdam-80th":[40.5338,-74.2369],"Columbus-86th":[40.903,-73.85]};function kje(){const[t,e]=E.useState(null),[n,r]=E.useState(0),[s,i]=E.useState([]),[o,a]=E.useState(xq[0]),[l,u]=E.useState([]),[c,d]=E.useState(!1),[f,p]=E.useState([]),[m,y]=E.useState([]),[v,x]=E.useState(!0),b=E.useRef(new ZG);E.useEffect(()=>{(async()=>{try{const M=await fetch(du.locations);if(M.ok){const H=(await M.json()).locations.map(K=>({id:K.id,name:K.name,coordinates:Sje[K.id]||[40.7831,-73.9778],videoPath:K.original_video_url?`${YG()}${K.original_video_url}`:""}));y(H);try{const K=sNe();if(nNe()&&K){const Q=H.find(Z=>Z.id===K);Q&&(e(Q),r(0),b.current.clearHistory())}}catch{}}else console.error("Failed to fetch locations from backend"),y([])}catch(M){console.error("Error fetching locations:",M),y([])}finally{x(!1)}})()},[]);const _=F=>{e(F),r(0),b.current.clearHistory(),setTimeout(()=>{const M=document.querySelector(".details-section");M&&M.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},150)},S=F=>{r(F)},k=F=>{i(F)},T=F=>{const j={"15s":15,"30s":30,"5min":300,"15min":900}[F];if(j){const H=b.current.exportToCSV(j),K=new Blob([H],{type:"text/csv"}),Q=window.URL.createObjectURL(K),Z=document.createElement("a");Z.href=Q,Z.download=`traffic_data_${t==null?void 0:t.id}_${o==null?void 0:o.id}_${F}.csv`,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),window.URL.revokeObjectURL(Q)}},$=F=>{u([...l,F]),a(F)},A=(F,M)=>{const j=URL.createObjectURL(F),H={id:`uploaded-${Date.now()}`,name:M,coordinates:[40.7831,-73.9778],videoPath:j},K=[...f,H],Q=[...m,H];p(K),y(Q),e(H),r(0),b.current.clearHistory()},D=F=>{console.log(`Starting YOLOv8 processing for location: ${F}`)};return z.jsxs("div",{className:"app",children:[z.jsx("header",{className:"app-header",children:z.jsxs("div",{className:"header-content",children:[z.jsx("img",{src:CM,alt:"AI & Mobility Research Lab at CUNY City College of New York",className:"lab-logo"}),z.jsxs("div",{className:"header-text",children:[z.jsx("h1",{children:"Urban Mobility Data Living Laboratory (UMDL2)"}),z.jsx("p",{className:"header-subtitle",children:"AI & Mobility Research Lab at CUNY City College of New York"})]})]})}),z.jsxs("div",{className:"main-content",children:[z.jsxs("div",{className:"left-panel",children:[z.jsx(xje,{selectedSchema:o,onSchemaSelect:a,onAddCustomSchema:()=>d(!0)}),z.jsx(wje,{onVideoUpload:A}),z.jsx(_je,{onStartProcessing:D,availableLocations:m.map(F=>({id:F.id,name:F.name}))}),z.jsx("div",{className:"map-section",children:v?z.jsx("div",{style:{padding:"20px",textAlign:"center"},children:z.jsx("p",{children:"Loading locations..."})}):z.jsx($9,{locations:m,onLocationSelect:_,selectedLocation:t})})]}),t&&z.jsxs("div",{className:"details-section",children:[z.jsxs("div",{className:"location-header",children:[z.jsx("h2",{children:t.name}),o&&z.jsxs("div",{className:"selected-schema-badge",children:[z.jsx("span",{className:"schema-label",children:"Schema:"}),z.jsx("span",{className:"schema-name",children:o.name})]})]}),z.jsx("div",{className:"video-section",children:z.jsx(iNe,{videoPath:t.videoPath,locationId:t.id,onTimeUpdate:S,onDetections:k})}),z.jsxs("div",{className:"chart-section",children:[z.jsx(yje,{locationId:t.id,currentTime:n,detections:s,detectionService:b.current}),z.jsx(vje,{locationId:t.id,currentTime:n,onTimeSelect:S})]}),z.jsxs("div",{className:"export-section",children:[z.jsx("h3",{children:"Export Data"}),z.jsxs("select",{onChange:F=>T(F.target.value),defaultValue:"",children:[z.jsx("option",{value:"",disabled:!0,children:"Select aggregation level"}),z.jsx("option",{value:"15s",children:"15 seconds"}),z.jsx("option",{value:"30s",children:"30 seconds"}),z.jsx("option",{value:"5min",children:"5 minutes"}),z.jsx("option",{value:"15min",children:"15 minutes"})]})]})]})]}),z.jsx(bje,{isOpen:c,onClose:()=>d(!1),onSave:$}),z.jsx("footer",{className:"app-footer",children:z.jsxs("div",{className:"footer-content",children:[z.jsxs("div",{className:"footer-left",children:[z.jsx("img",{src:CM,alt:"AI & Mobility Research Lab at CUNY City College of New York",className:"footer-logo"}),z.jsxs("div",{className:"footer-info",children:[z.jsx("h3",{children:"AI & Mobility Research Lab at CUNY City College of New York"}),z.jsx("p",{children:"Advancing transportation through intelligent systems"})]})]}),z.jsxs("div",{className:"footer-right",children:[z.jsxs("div",{className:"footer-links",children:[z.jsx("a",{href:"https://github.com/AI-Mobility-Research-Lab/UMDL2",target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),z.jsx("span",{className:"separator",children:"•"}),z.jsx("a",{href:"https://ai-mobility-research-lab.github.io/UMDL2/",target:"_blank",rel:"noopener noreferrer",children:"Documentation"})]}),z.jsx("p",{className:"footer-copyright",children:"© 2025 AI & Mobility Research Lab at CUNY City College of New York. All rights reserved."})]})]})})]})}zz(document.getElementById("root")).render(z.jsx(E.StrictMode,{children:z.jsx(kje,{})}));
